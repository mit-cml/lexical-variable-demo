/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/blockly/blockly.js":
/*!*****************************************!*\
  !*** ./node_modules/blockly/blockly.js ***!
  \*****************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./blockly_compressed */ \"./node_modules/blockly/blockly_compressed.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(Blockly) {\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly module; just a wrapper for blockly_compressed.js.\n */\n\nreturn Blockly;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/blockly.js?");

/***/ }),

/***/ "./node_modules/blockly/blockly_compressed.js":
/*!****************************************************!*\
  !*** ./node_modules/blockly/blockly_compressed.js ***!
  \****************************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// Do not edit this file; automatically generated.\n\n/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function() {\nvar $={};\nvar register$$module$build$src$core$registry,validate$$module$build$src$core$registry,unregister$$module$build$src$core$registry,getItem$$module$build$src$core$registry,hasItem$$module$build$src$core$registry,getClass$$module$build$src$core$registry,getObject$$module$build$src$core$registry,getAllItems$$module$build$src$core$registry,getClassFromOptions$$module$build$src$core$registry,getWorkspaceById$$module$build$src$core$common,getAllWorkspaces$$module$build$src$core$common,registerWorkspace$$module$build$src$core$common,\nunregisterWorkpace$$module$build$src$core$common,getMainWorkspace$$module$build$src$core$common,setMainWorkspace$$module$build$src$core$common,getSelected$$module$build$src$core$common,setSelected$$module$build$src$core$common,getParentContainer$$module$build$src$core$common,setParentContainer$$module$build$src$core$common,svgResize$$module$build$src$core$common,getBlockTypeCounts$$module$build$src$core$common,jsonInitFactory$$module$build$src$core$common,defineBlocksWithJsonArray$$module$build$src$core$common,\ndefineBlocksWithJsonArrayInternal$$module$build$src$core$common,getNextUniqueId$$module$build$src$core$utils$idgenerator,genUid$$module$build$src$core$utils$idgenerator,setRecordUndo$$module$build$src$core$events$utils,getRecordUndo$$module$build$src$core$events$utils,fire$$module$build$src$core$events$utils,fireInternal$$module$build$src$core$events$utils,fireNow$$module$build$src$core$events$utils,filter$$module$build$src$core$events$utils,clearPendingUndo$$module$build$src$core$events$utils,isEnabled$$module$build$src$core$events$utils,\nsetGroupInternal$$module$build$src$core$events$utils,getDescendantIds$$module$build$src$core$events$utils,fromJson$$module$build$src$core$events$utils,get$$module$build$src$core$events$utils,disableOrphans$$module$build$src$core$events$utils,longStart$$module$build$src$core$touch,longStop$$module$build$src$core$touch,clearTouchIdentifier$$module$build$src$core$touch,shouldHandleEvent$$module$build$src$core$touch,getTouchIdentifierFromEvent$$module$build$src$core$touch,checkTouchIdentifier$$module$build$src$core$touch,\nconditionalBind$$module$build$src$core$browser_events,bind$$module$build$src$core$browser_events,unbind$$module$build$src$core$browser_events,isTargetInput$$module$build$src$core$browser_events,isRightButton$$module$build$src$core$browser_events,mouseToSvg$$module$build$src$core$browser_events,getScrollDeltaPixels$$module$build$src$core$browser_events,removeElem$$module$build$src$core$utils$array,register$$module$build$src$core$css,inject$$module$build$src$core$css,warn$$module$build$src$core$utils$deprecation,\ncreateSvgElement$$module$build$src$core$utils$dom,addClass$$module$build$src$core$utils$dom,removeClasses$$module$build$src$core$utils$dom,removeClass$$module$build$src$core$utils$dom,hasClass$$module$build$src$core$utils$dom,removeNode$$module$build$src$core$utils$dom,insertAfter$$module$build$src$core$utils$dom,containsNode$$module$build$src$core$utils$dom,setCssTransform$$module$build$src$core$utils$dom,startTextWidthCache$$module$build$src$core$utils$dom,stopTextWidthCache$$module$build$src$core$utils$dom,\ngetTextWidth$$module$build$src$core$utils$dom,getFastTextWidth$$module$build$src$core$utils$dom,getFastTextWidthWithSizeString$$module$build$src$core$utils$dom,measureFontMetrics$$module$build$src$core$utils$dom,getSize$$module$build$src$core$utils$style,getSizeInternal$$module$build$src$core$utils$style,getSizeWithDisplay$$module$build$src$core$utils$style,getComputedStyle$$module$build$src$core$utils$style,getPageOffset$$module$build$src$core$utils$style,getViewportPageOffset$$module$build$src$core$utils$style,\ngetBorderBox$$module$build$src$core$utils$style,scrollIntoContainerView$$module$build$src$core$utils$style,getContainerOffsetToScrollInto$$module$build$src$core$utils$style,getRelativeXY$$module$build$src$core$utils$svg_math,getInjectionDivXY$$module$build$src$core$utils$svg_math,getViewportBBox$$module$build$src$core$utils$svg_math,getDocumentScroll$$module$build$src$core$utils$svg_math,screenToWsCoordinates$$module$build$src$core$utils$svg_math,wsToScreenCoordinates$$module$build$src$core$utils$svg_math,\ninjectDependencies$$module$build$src$core$utils$xml,domToText$$module$build$src$core$utils$xml,sanitizeText$$module$build$src$core$utils$xml,convertToolboxDefToJson$$module$build$src$core$utils$toolbox,validateToolbox$$module$build$src$core$utils$toolbox,convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox,hasCategories$$module$build$src$core$utils$toolbox,hasCategoriesInternal$$module$build$src$core$utils$toolbox,isCategoryCollapsible$$module$build$src$core$utils$toolbox,convertToToolboxJson$$module$build$src$core$utils$toolbox,\nxmlToJsonArray$$module$build$src$core$utils$toolbox,addAttributes$$module$build$src$core$utils$toolbox,parseToolboxTree$$module$build$src$core$utils$toolbox,getStartPositionRect$$module$build$src$core$positionable_helpers,getCornerOppositeToolbox$$module$build$src$core$positionable_helpers,bumpPositionRect$$module$build$src$core$positionable_helpers,alert$$module$build$src$core$dialog,setAlert$$module$build$src$core$dialog,confirm$$module$build$src$core$dialog,confirmInternal$$module$build$src$core$dialog,\nsetConfirm$$module$build$src$core$dialog,prompt$$module$build$src$core$dialog,setPrompt$$module$build$src$core$dialog,isVariableBackedParameterModel$$module$build$src$core$interfaces$i_variable_backed_parameter_model,isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks,isLegacyProcedureCallBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks,flyoutCategory$$module$build$src$core$variables,flyoutCategoryBlocks$$module$build$src$core$variables,generateUniqueName$$module$build$src$core$variables,\ngenerateUniqueNameInternal$$module$build$src$core$variables,generateUniqueNameFromOptions$$module$build$src$core$variables,createVariableButtonHandler$$module$build$src$core$variables,promptName$$module$build$src$core$variables,nameUsedWithOtherType$$module$build$src$core$variables,nameUsedWithAnyType$$module$build$src$core$variables,nameUsedWithConflictingParam$$module$build$src$core$variables,checkForConflictingParamWithProcedureModels$$module$build$src$core$variables,checkForConflictingParamWithLegacyProcedures$$module$build$src$core$variables,\ngenerateVariableFieldDom$$module$build$src$core$variables,createVariable$$module$build$src$core$variables,getAddedVariables$$module$build$src$core$variables,register$$module$build$src$core$clipboard$registry,unregister$$module$build$src$core$clipboard$registry,queueRender$$module$build$src$core$render_management,finishQueuedRenders$$module$build$src$core$render_management,triggerQueuedRenders$$module$build$src$core$render_management,alwaysImmediatelyRender$$module$build$src$core$render_management,\nqueueBlock$$module$build$src$core$render_management,doRenders$$module$build$src$core$render_management,dequeueBlock$$module$build$src$core$render_management,shouldRenderRootBlock$$module$build$src$core$render_management,renderBlock$$module$build$src$core$render_management,workspaceToDom$$module$build$src$core$xml,variablesToDom$$module$build$src$core$xml,blockToDomWithXY$$module$build$src$core$xml,fieldToDom$$module$build$src$core$xml,allFieldsToDom$$module$build$src$core$xml,blockToDom$$module$build$src$core$xml,\ncloneShadow$$module$build$src$core$xml,domToText$$module$build$src$core$xml,domToPrettyText$$module$build$src$core$xml,clearWorkspaceAndLoadFromXml$$module$build$src$core$xml,appendDomToWorkspace$$module$build$src$core$xml,domToBlockInternal$$module$build$src$core$xml,domToVariables$$module$build$src$core$xml,mapSupportedXmlTags$$module$build$src$core$xml,applyMutationTagNodes$$module$build$src$core$xml,applyCommentTagNodes$$module$build$src$core$xml,applyDataTagNodes$$module$build$src$core$xml,applyFieldTagNodes$$module$build$src$core$xml,\nfindChildBlocks$$module$build$src$core$xml,applyInputTagNodes$$module$build$src$core$xml,applyNextTagNodes$$module$build$src$core$xml,domToBlockHeadless$$module$build$src$core$xml,domToField$$module$build$src$core$xml,deleteNext$$module$build$src$core$xml,isElement$$module$build$src$core$xml,isSerializable$$module$build$src$core$interfaces$i_serializable,register$$module$build$src$core$serialization$registry,unregister$$module$build$src$core$serialization$registry,save$$module$build$src$core$serialization$blocks,\nsaveAttributes$$module$build$src$core$serialization$blocks,saveCoords$$module$build$src$core$serialization$blocks,saveExtraState$$module$build$src$core$serialization$blocks,saveIcons$$module$build$src$core$serialization$blocks,saveFields$$module$build$src$core$serialization$blocks,saveInputBlocks$$module$build$src$core$serialization$blocks,saveNextBlocks$$module$build$src$core$serialization$blocks,saveConnection$$module$build$src$core$serialization$blocks,append$$module$build$src$core$serialization$blocks,\nappendInternal$$module$build$src$core$serialization$blocks,appendPrivate$$module$build$src$core$serialization$blocks,loadCoords$$module$build$src$core$serialization$blocks,loadAttributes$$module$build$src$core$serialization$blocks,loadExtraState$$module$build$src$core$serialization$blocks,tryToConnectParent$$module$build$src$core$serialization$blocks,loadIcons$$module$build$src$core$serialization$blocks,loadFields$$module$build$src$core$serialization$blocks,loadInputBlocks$$module$build$src$core$serialization$blocks,\nloadNextBlocks$$module$build$src$core$serialization$blocks,loadConnection$$module$build$src$core$serialization$blocks,initBlock$$module$build$src$core$serialization$blocks,moveBlockToNotConflict$$module$build$src$core$clipboard$block_paster,blockOverlapsOtherExactly$$module$build$src$core$clipboard$block_paster,blockIsInSnapRadius$$module$build$src$core$clipboard$block_paster,copy$$module$build$src$core$clipboard,copyInternal$$module$build$src$core$clipboard,paste$$module$build$src$core$clipboard,\npasteFromData$$module$build$src$core$clipboard,duplicate$$module$build$src$core$clipboard,duplicateInternal$$module$build$src$core$clipboard,setRole$$module$build$src$core$utils$aria,setState$$module$build$src$core$utils$aria,getDiv$$module$build$src$core$widgetdiv,testOnly_setDiv$$module$build$src$core$widgetdiv,createDom$$module$build$src$core$widgetdiv,show$$module$build$src$core$widgetdiv,hide$$module$build$src$core$widgetdiv,isVisible$$module$build$src$core$widgetdiv,hideIfOwner$$module$build$src$core$widgetdiv,\npositionInternal$$module$build$src$core$widgetdiv,positionWithAnchor$$module$build$src$core$widgetdiv,calculateX$$module$build$src$core$widgetdiv,calculateY$$module$build$src$core$widgetdiv,isRepositionable$$module$build$src$core$widgetdiv,repositionForWindowResize$$module$build$src$core$widgetdiv,getCurrentBlock$$module$build$src$core$contextmenu,setCurrentBlock$$module$build$src$core$contextmenu,show$$module$build$src$core$contextmenu,populate_$$module$build$src$core$contextmenu,position_$$module$build$src$core$contextmenu,\ncreateWidget_$$module$build$src$core$contextmenu,haltPropagation$$module$build$src$core$contextmenu,hide$$module$build$src$core$contextmenu,dispose$$module$build$src$core$contextmenu,commentDeleteOption$$module$build$src$core$contextmenu,commentDuplicateOption$$module$build$src$core$contextmenu,workspaceCommentOption$$module$build$src$core$contextmenu,toRadians$$module$build$src$core$utils$math,toDegrees$$module$build$src$core$utils$math,clamp$$module$build$src$core$utils$math,createDom$$module$build$src$core$dropdowndiv,\nsetBoundsElement$$module$build$src$core$dropdowndiv,getOwner$$module$build$src$core$dropdowndiv,getContentDiv$$module$build$src$core$dropdowndiv,clearContent$$module$build$src$core$dropdowndiv,setColour$$module$build$src$core$dropdowndiv,showPositionedByBlock$$module$build$src$core$dropdowndiv,showPositionedByField$$module$build$src$core$dropdowndiv,getScaledBboxOfBlock$$module$build$src$core$dropdowndiv,getScaledBboxOfField$$module$build$src$core$dropdowndiv,showPositionedByRect$$module$build$src$core$dropdowndiv,\nshow$$module$build$src$core$dropdowndiv,getPositionBelowMetrics$$module$build$src$core$dropdowndiv,getPositionAboveMetrics$$module$build$src$core$dropdowndiv,getPositionTopOfPageMetrics$$module$build$src$core$dropdowndiv,getPositionX$$module$build$src$core$dropdowndiv,isVisible$$module$build$src$core$dropdowndiv,hideIfOwner$$module$build$src$core$dropdowndiv,hide$$module$build$src$core$dropdowndiv,hideWithoutAnimation$$module$build$src$core$dropdowndiv,positionInternal$$module$build$src$core$dropdowndiv,\nrepositionForWindowResize$$module$build$src$core$dropdowndiv,disposeUiEffect$$module$build$src$core$block_animations,disposeUiStep$$module$build$src$core$block_animations,connectionUiEffect$$module$build$src$core$block_animations,disconnectUiEffect$$module$build$src$core$block_animations,disconnectUiStep$$module$build$src$core$block_animations,disconnectUiStop$$module$build$src$core$block_animations,startsWith$$module$build$src$core$utils$string,shortestStringLength$$module$build$src$core$utils$string,\ncommonWordPrefix$$module$build$src$core$utils$string,commonWordSuffix$$module$build$src$core$utils$string,wrapLine$$module$build$src$core$utils$string,wrapScore$$module$build$src$core$utils$string,wrapMutate$$module$build$src$core$utils$string,wrapToText$$module$build$src$core$utils$string,setCustomTooltip$$module$build$src$core$tooltip,getCustomTooltip$$module$build$src$core$tooltip,isVisible$$module$build$src$core$tooltip,getDiv$$module$build$src$core$tooltip,getTooltipOfObject$$module$build$src$core$tooltip,\ngetTargetObject$$module$build$src$core$tooltip,createDom$$module$build$src$core$tooltip,bindMouseEvents$$module$build$src$core$tooltip,unbindMouseEvents$$module$build$src$core$tooltip,onMouseOver$$module$build$src$core$tooltip,onMouseOut$$module$build$src$core$tooltip,onMouseMove$$module$build$src$core$tooltip,dispose$$module$build$src$core$tooltip,hide$$module$build$src$core$tooltip,block$$module$build$src$core$tooltip,unblock$$module$build$src$core$tooltip,renderContent$$module$build$src$core$tooltip,\nrenderDefaultContent$$module$build$src$core$tooltip,getPosition$$module$build$src$core$tooltip,show$$module$build$src$core$tooltip,deepMerge$$module$build$src$core$utils$object,hasBubble$$module$build$src$core$interfaces$i_has_bubble,getHsvSaturation$$module$build$src$core$utils$colour,setHsvSaturation$$module$build$src$core$utils$colour,getHsvValue$$module$build$src$core$utils$colour,setHsvValue$$module$build$src$core$utils$colour,parse$$module$build$src$core$utils$colour,rgbToHex$$module$build$src$core$utils$colour,\nhexToRgb$$module$build$src$core$utils$colour,hsvToHex$$module$build$src$core$utils$colour,blend$$module$build$src$core$utils$colour,hueToHex$$module$build$src$core$utils$colour,tokenizeInterpolationInternal$$module$build$src$core$utils$parsing,tokenizeInterpolation$$module$build$src$core$utils$parsing,replaceMessageReferences$$module$build$src$core$utils$parsing,checkMessageReferences$$module$build$src$core$utils$parsing,parseBlockColour$$module$build$src$core$utils$parsing,isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block,\nisObservable$$module$build$src$core$interfaces$i_observable,register$$module$build$src$core$field_registry,unregister$$module$build$src$core$field_registry,fromJsonInternal$$module$build$src$core$field_registry,trimOptions$$module$build$src$core$field_dropdown,applyTrim$$module$build$src$core$field_dropdown,validateOptions$$module$build$src$core$field_dropdown,unregister$$module$build$src$core$extensions,isRegistered$$module$build$src$core$extensions,apply$$module$build$src$core$extensions,checkNoMutatorProperties$$module$build$src$core$extensions,\ncheckXmlHooks$$module$build$src$core$extensions,checkJsonHooks$$module$build$src$core$extensions,checkMutatorDialog$$module$build$src$core$extensions,checkHasFunctionPair$$module$build$src$core$extensions,checkHasMutatorProperties$$module$build$src$core$extensions,getMutatorProperties$$module$build$src$core$extensions,mutatorPropertiesMatch$$module$build$src$core$extensions,runAfterPageLoad$$module$build$src$core$extensions,checkDropdownOptionsInTable$$module$build$src$core$extensions,extensionParentTooltip$$module$build$src$core$extensions,\npoint$$module$build$src$core$utils$svg_paths,curve$$module$build$src$core$utils$svg_paths,moveTo$$module$build$src$core$utils$svg_paths,moveBy$$module$build$src$core$utils$svg_paths,lineTo$$module$build$src$core$utils$svg_paths,line$$module$build$src$core$utils$svg_paths,lineOnAxis$$module$build$src$core$utils$svg_paths,arc$$module$build$src$core$utils$svg_paths,register$$module$build$src$core$icons$registry,unregister$$module$build$src$core$icons$registry,allProcedures$$module$build$src$core$procedures,\nprocTupleComparator$$module$build$src$core$procedures,isLegalName$$module$build$src$core$procedures,isNameUsed$$module$build$src$core$procedures,flyoutCategory$$module$build$src$core$procedures,updateMutatorFlyout$$module$build$src$core$procedures,mutatorOpenListener$$module$build$src$core$procedures,mutatorChangeListener$$module$build$src$core$procedures,getCallers$$module$build$src$core$procedures,blockIsModernCallerFor$$module$build$src$core$procedures,isDynamicShape$$module$build$src$core$renderers$common$constants,\ngetParentConnection$$module$build$src$core$keyboard_nav$ast_node,connectReciprocally$$module$build$src$core$connection,getSingleConnection$$module$build$src$core$connection,getConnectionForOrphanedOutput$$module$build$src$core$connection,register$$module$build$src$core$renderers$common$block_rendering,unregister$$module$build$src$core$renderers$common$block_rendering,init$$module$build$src$core$renderers$common$block_rendering,stringButtonClickHandler$$module$build$src$core$variables_dynamic,numberButtonClickHandler$$module$build$src$core$variables_dynamic,\ncolourButtonClickHandler$$module$build$src$core$variables_dynamic,flyoutCategory$$module$build$src$core$variables_dynamic,flyoutCategoryBlocks$$module$build$src$core$variables_dynamic,resizeSvgContents$$module$build$src$core$workspace_svg,isCopyable$$module$build$src$core$interfaces$i_copyable,registerEscape$$module$build$src$core$shortcut_items,registerDelete$$module$build$src$core$shortcut_items,registerCopy$$module$build$src$core$shortcut_items,registerCut$$module$build$src$core$shortcut_items,\nregisterPaste$$module$build$src$core$shortcut_items,registerUndo$$module$build$src$core$shortcut_items,registerRedo$$module$build$src$core$shortcut_items,registerDefaultShortcuts$$module$build$src$core$shortcut_items,saveProcedure$$module$build$src$core$serialization$procedures,saveParameter$$module$build$src$core$serialization$procedures,loadProcedure$$module$build$src$core$serialization$procedures,loadParameter$$module$build$src$core$serialization$procedures,save$$module$build$src$core$serialization$workspaces,\nload$$module$build$src$core$serialization$workspaces,bumpObjectIntoBounds$$module$build$src$core$bump_objects,bumpIntoBoundsHandler$$module$build$src$core$bump_objects,extractObjectFromEvent$$module$build$src$core$bump_objects,bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects,initIconData$$module$build$src$core$block_dragger,registerUndo$$module$build$src$core$contextmenu_items,registerRedo$$module$build$src$core$contextmenu_items,registerCleanup$$module$build$src$core$contextmenu_items,\ntoggleOption_$$module$build$src$core$contextmenu_items,registerCollapse$$module$build$src$core$contextmenu_items,registerExpand$$module$build$src$core$contextmenu_items,addDeletableBlocks_$$module$build$src$core$contextmenu_items,getDeletableBlocks_$$module$build$src$core$contextmenu_items,deleteNext_$$module$build$src$core$contextmenu_items,registerDeleteAll$$module$build$src$core$contextmenu_items,registerWorkspaceOptions_$$module$build$src$core$contextmenu_items,registerDuplicate$$module$build$src$core$contextmenu_items,\nregisterComment$$module$build$src$core$contextmenu_items,registerInline$$module$build$src$core$contextmenu_items,registerCollapseExpandBlock$$module$build$src$core$contextmenu_items,registerDisable$$module$build$src$core$contextmenu_items,registerDelete$$module$build$src$core$contextmenu_items,registerHelp$$module$build$src$core$contextmenu_items,registerBlockOptions_$$module$build$src$core$contextmenu_items,registerDefaultOptions$$module$build$src$core$contextmenu_items,inject$$module$build$src$core$inject,\ncreateDom$$module$build$src$core$inject,createMainWorkspace$$module$build$src$core$inject,init$$module$build$src$core$inject,onKeyDown$$module$build$src$core$inject,bindDocumentEvents$$module$build$src$core$inject,loadSounds$$module$build$src$core$inject,isIcon$$module$build$src$core$interfaces$i_icon,isPaster$$module$build$src$core$interfaces$i_paster,isSelectableToolboxItem$$module$build$src$core$interfaces$i_selectable_toolbox_item,hideChaff$$module$build$src$core$blockly,isRenderedElement$$module$build$src$core$interfaces$i_rendered_element,\n$jscomp;\nregister$$module$build$src$core$registry=function(a,b,c,d){if(!(a instanceof Type$$module$build$src$core$registry)&&\"string\"!==typeof a||\"\"===`${a}`.trim())throw Error('Invalid type \"'+a+'\". The type must be a non-empty string or a Blockly.registry.Type.');a=`${a}`.toLowerCase();if(\"string\"!==typeof b||\"\"===b.trim())throw Error('Invalid name \"'+b+'\". The name must be a non-empty string.');const e=b.toLowerCase();if(!c)throw Error(\"Can not register a null value\");let f=typeMap$$module$build$src$core$registry[a],g=\nnameMap$$module$build$src$core$registry[a];f||(f=typeMap$$module$build$src$core$registry[a]=Object.create(null),g=nameMap$$module$build$src$core$registry[a]=Object.create(null));validate$$module$build$src$core$registry(a,c);if(!d&&f[e])throw Error('Name \"'+e+'\" with type \"'+a+'\" already registered.');f[e]=c;g[e]=b};\nvalidate$$module$build$src$core$registry=function(a,b){switch(a){case String(Type$$module$build$src$core$registry.FIELD):if(\"function\"!==typeof b.fromJson)throw Error('Type \"'+a+'\" must have a fromJson function');}};\nunregister$$module$build$src$core$registry=function(a,b){a=`${a}`.toLowerCase();b=b.toLowerCase();const c=typeMap$$module$build$src$core$registry[a];c&&c[b]?(delete typeMap$$module$build$src$core$registry[a][b],delete nameMap$$module$build$src$core$registry[a][b]):console.warn(\"Unable to unregister [\"+b+\"][\"+a+\"] from the registry.\")};\ngetItem$$module$build$src$core$registry=function(a,b,c){a=`${a}`.toLowerCase();b=b.toLowerCase();const d=typeMap$$module$build$src$core$registry[a];if(!d||!d[b]){b=\"Unable to find [\"+b+\"][\"+a+\"] in the registry.\";if(c)throw Error(b+\" You must require or register a \"+a+\" plugin.\");console.warn(b);return null}return d[b]};hasItem$$module$build$src$core$registry=function(a,b){a=`${a}`.toLowerCase();b=b.toLowerCase();return(a=typeMap$$module$build$src$core$registry[a])?!!a[b]:!1};\ngetClass$$module$build$src$core$registry=function(a,b,c){return getItem$$module$build$src$core$registry(a,b,c)};getObject$$module$build$src$core$registry=function(a,b,c){return getItem$$module$build$src$core$registry(a,b,c)};\ngetAllItems$$module$build$src$core$registry=function(a,b,c){a=`${a}`.toLowerCase();var d=typeMap$$module$build$src$core$registry[a];if(!d){d=`Unable to find [${a}] in the registry.`;if(c)throw Error(`${d} You must require or register a ${a} plugin.`);console.warn(d);return null}if(!b)return d;a=nameMap$$module$build$src$core$registry[a];c=Object.create(null);for(const e of Object.keys(d))c[a[e]]=d[e];return c};\ngetClassFromOptions$$module$build$src$core$registry=function(a,b,c){b=b.plugins[String(a)]||DEFAULT$$module$build$src$core$registry;return\"function\"===typeof b?b:getClass$$module$build$src$core$registry(a,b,c)};getWorkspaceById$$module$build$src$core$common=function(a){return WorkspaceDB_$$module$build$src$core$common[a]||null};\ngetAllWorkspaces$$module$build$src$core$common=function(){const a=[];for(const b in WorkspaceDB_$$module$build$src$core$common)a.push(WorkspaceDB_$$module$build$src$core$common[b]);return a};registerWorkspace$$module$build$src$core$common=function(a){WorkspaceDB_$$module$build$src$core$common[a.id]=a};unregisterWorkpace$$module$build$src$core$common=function(a){delete WorkspaceDB_$$module$build$src$core$common[a.id]};getMainWorkspace$$module$build$src$core$common=function(){return mainWorkspace$$module$build$src$core$common};\nsetMainWorkspace$$module$build$src$core$common=function(a){mainWorkspace$$module$build$src$core$common=a};getSelected$$module$build$src$core$common=function(){return selected$$module$build$src$core$common};setSelected$$module$build$src$core$common=function(a){selected$$module$build$src$core$common=a};getParentContainer$$module$build$src$core$common=function(){return parentContainer$$module$build$src$core$common};\nsetParentContainer$$module$build$src$core$common=function(a){parentContainer$$module$build$src$core$common=a};\nsvgResize$$module$build$src$core$common=function(a){for(;a.options.parentWorkspace;)a=a.options.parentWorkspace;const b=a.getParentSvg(),c=a.getCachedParentSvgSize();var d=b.parentElement;if(d instanceof HTMLElement){var e=d.offsetWidth;d=d.offsetHeight;c.width!==e&&(b.setAttribute(\"width\",e+\"px\"),a.setCachedParentSvgSize(e,null));c.height!==d&&(b.setAttribute(\"height\",d+\"px\"),a.setCachedParentSvgSize(null,d));a.resize()}};\ngetBlockTypeCounts$$module$build$src$core$common=function(a,b){const c=Object.create(null),d=a.getDescendants(!0);b&&(a=a.getNextBlock())&&(a=d.indexOf(a),d.splice(a,d.length-a));for(let e=0,f;f=d[e];e++)c[f.type]?c[f.type]++:c[f.type]=1;return c};jsonInitFactory$$module$build$src$core$common=function(a){return function(){this.jsonInit(a)}};defineBlocksWithJsonArray$$module$build$src$core$common=function(a){TEST_ONLY$$module$build$src$core$common.defineBlocksWithJsonArrayInternal(a)};\ndefineBlocksWithJsonArrayInternal$$module$build$src$core$common=function(a){$.defineBlocks$$module$build$src$core$common($.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(a))};\n$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(a){const b={};for(let c=0;c<a.length;c++){const d=a[c];if(!d){console.warn(`Block definition #${c} in JSON array is ${d}. Skipping`);continue}const e=d.type;e?b[e]={init:jsonInitFactory$$module$build$src$core$common(d)}:console.warn(`Block definition #${c} in JSON array is missing a type attribute. `+\"Skipping.\")}return b};\n$.defineBlocks$$module$build$src$core$common=function(a){for(const b of Object.keys(a)){const c=a[b];b in Blocks$$module$build$src$core$blocks&&console.warn(`Block definiton \"${b}\" overwrites previous definition.`);Blocks$$module$build$src$core$blocks[b]=c}};getNextUniqueId$$module$build$src$core$utils$idgenerator=function(){return\"blockly-\"+(nextId$$module$build$src$core$utils$idgenerator++).toString(36)};genUid$$module$build$src$core$utils$idgenerator=function(){return internal$$module$build$src$core$utils$idgenerator.genUid()};\nsetRecordUndo$$module$build$src$core$events$utils=function(a){recordUndo$$module$build$src$core$events$utils=a};getRecordUndo$$module$build$src$core$events$utils=function(){return recordUndo$$module$build$src$core$events$utils};fire$$module$build$src$core$events$utils=function(a){TEST_ONLY$$module$build$src$core$events$utils.fireInternal(a)};\nfireInternal$$module$build$src$core$events$utils=function(a){if(isEnabled$$module$build$src$core$events$utils()){if(!FIRE_QUEUE$$module$build$src$core$events$utils.length)try{requestAnimationFrame(()=>{setTimeout(fireNow$$module$build$src$core$events$utils,0)})}catch(b){setTimeout(fireNow$$module$build$src$core$events$utils,0)}FIRE_QUEUE$$module$build$src$core$events$utils.push(a)}};\nfireNow$$module$build$src$core$events$utils=function(){var a=filter$$module$build$src$core$events$utils(FIRE_QUEUE$$module$build$src$core$events$utils,!0);FIRE_QUEUE$$module$build$src$core$events$utils.length=0;for(let c=0,d;d=a[c];c++)if(d.workspaceId){var b=getWorkspaceById$$module$build$src$core$common(d.workspaceId);b&&b.fireChangeListener(d)}a=new Set(a.map(c=>c.workspaceId));for(const c of a){if(!c)continue;a=getWorkspaceById$$module$build$src$core$common(c);if(!a)continue;a=a.getUndoStack();\nlet d=void 0;for(b=a.length;0<b;b--){const e=a[b-1];if(\"\"===e.group)break;else if(void 0===d)d=e.group;else if(e.group!==d)break}d&&b!=a.length-1&&(b=a.splice(b,a.length-b),b=filter$$module$build$src$core$events$utils(b,!0),a.push(...b))}};\nfilter$$module$build$src$core$events$utils=function(a,b){a=a.slice();b||a.reverse();const c=[],d=Object.create(null);for(let g=0,h;h=a[g];g++)if(!h.isNull()){var e=[h.isUiEvent?UI$$module$build$src$core$events$utils:h.type,h.blockId,h.workspaceId].join(\" \"),f=d[e];const k=f?f.event:null;if(!f)d[e]={event:h,index:g},c.push(h);else if(h.type===$.MOVE$$module$build$src$core$events$utils&&f.index===g-1)e=h,k.newParentId=e.newParentId,k.newInputName=e.newInputName,k.newCoordinate=e.newCoordinate,e.reason&&\n(k.reason?(e=new Set(e.reason.concat(k.reason)),k.reason=Array.from(e)):k.reason=e.reason),f.index=g;else if(h.type===$.CHANGE$$module$build$src$core$events$utils&&h.element===k.element&&h.name===k.name)k.newValue=h.newValue;else if(h.type===VIEWPORT_CHANGE$$module$build$src$core$events$utils)f=h,k.viewTop=f.viewTop,k.viewLeft=f.viewLeft,k.scale=f.scale,k.oldScale=f.oldScale;else if(h.type!==CLICK$$module$build$src$core$events$utils||k.type!==BUBBLE_OPEN$$module$build$src$core$events$utils)d[e]={event:h,\nindex:g},c.push(h)}a=c.filter(function(g){return!g.isNull()});b||a.reverse();for(let g=1,h;h=a[g];g++)h.type===$.CHANGE$$module$build$src$core$events$utils&&\"mutation\"===h.element&&a.unshift(a.splice(g,1)[0]);return a};clearPendingUndo$$module$build$src$core$events$utils=function(){for(let a=0,b;b=FIRE_QUEUE$$module$build$src$core$events$utils[a];a++)b.recordUndo=!1};$.disable$$module$build$src$core$events$utils=function(){disabled$$module$build$src$core$events$utils++};\n$.enable$$module$build$src$core$events$utils=function(){disabled$$module$build$src$core$events$utils--};isEnabled$$module$build$src$core$events$utils=function(){return 0===disabled$$module$build$src$core$events$utils};$.getGroup$$module$build$src$core$events$utils=function(){return group$$module$build$src$core$events$utils};$.setGroup$$module$build$src$core$events$utils=function(a){TEST_ONLY$$module$build$src$core$events$utils.setGroupInternal(a)};\nsetGroupInternal$$module$build$src$core$events$utils=function(a){group$$module$build$src$core$events$utils=\"boolean\"===typeof a?a?genUid$$module$build$src$core$utils$idgenerator():\"\":a};getDescendantIds$$module$build$src$core$events$utils=function(a){const b=[];a=a.getDescendants(!1);for(let c=0,d;d=a[c];c++)b[c]=d.id;return b};\nfromJson$$module$build$src$core$events$utils=function(a,b){const c=get$$module$build$src$core$events$utils(a.type);if(!c)throw Error(\"Unknown event type.\");return c.fromJson(a,b)};get$$module$build$src$core$events$utils=function(a){const b=getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,a);if(!b)throw Error(`Event type ${a} not found in registry.`);return b};\ndisableOrphans$$module$build$src$core$events$utils=function(a){if((a.type===$.MOVE$$module$build$src$core$events$utils||a.type===$.CREATE$$module$build$src$core$events$utils)&&a.workspaceId){var b=getWorkspaceById$$module$build$src$core$common(a.workspaceId);if(!a.blockId)throw Error(\"Encountered a blockEvent without a proper blockId\");if(a=b.getBlockById(a.blockId)){const c=recordUndo$$module$build$src$core$events$utils;try{recordUndo$$module$build$src$core$events$utils=!1;const d=a.getParent();\nif(d&&d.isEnabled()){const e=a.getDescendants(!1);for(let f=0,g;g=e[f];f++)g.setEnabled(!0)}else if((a.outputConnection||a.previousConnection)&&!b.isDragging()){do a.setEnabled(!1),a=a.getNextBlock();while(a)}}finally{recordUndo$$module$build$src$core$events$utils=c}}}};longStart$$module$build$src$core$touch=function(a,b){longStop$$module$build$src$core$touch();longPid_$$module$build$src$core$touch=setTimeout(function(){b&&b.handleRightClick(a)},LONGPRESS$$module$build$src$core$touch)};\nlongStop$$module$build$src$core$touch=function(){longPid_$$module$build$src$core$touch&&(clearTimeout(longPid_$$module$build$src$core$touch),longPid_$$module$build$src$core$touch=0)};clearTouchIdentifier$$module$build$src$core$touch=function(){touchIdentifier_$$module$build$src$core$touch=null};shouldHandleEvent$$module$build$src$core$touch=function(a){return!a.type.startsWith(\"pointer\")||a instanceof PointerEvent&&checkTouchIdentifier$$module$build$src$core$touch(a)};\ngetTouchIdentifierFromEvent$$module$build$src$core$touch=function(a){return`${a.pointerId}`};checkTouchIdentifier$$module$build$src$core$touch=function(a){const b=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);return touchIdentifier_$$module$build$src$core$touch?touchIdentifier_$$module$build$src$core$touch===b:\"pointerdown\"===a.type?(touchIdentifier_$$module$build$src$core$touch=b,!0):!1};\nconditionalBind$$module$build$src$core$browser_events=function(a,b,c,d,e){function f(h){if(e||shouldHandleEvent$$module$build$src$core$touch(h))c?d.call(c,h):d(h)}const g=[];if(b in TOUCH_MAP$$module$build$src$core$touch)for(let h=0;h<TOUCH_MAP$$module$build$src$core$touch[b].length;h++){const k=TOUCH_MAP$$module$build$src$core$touch[b][h];a.addEventListener(k,f,!1);g.push([a,k,f])}else a.addEventListener(b,f,!1),g.push([a,b,f]);return g};\nbind$$module$build$src$core$browser_events=function(a,b,c,d){function e(g){c?d.call(c,g):d(g)}const f=[];if(b in TOUCH_MAP$$module$build$src$core$touch)for(let g=0;g<TOUCH_MAP$$module$build$src$core$touch[b].length;g++){const h=TOUCH_MAP$$module$build$src$core$touch[b][g];a.addEventListener(h,e,!1);f.push([a,h,e])}else a.addEventListener(b,e,!1),f.push([a,b,e]);return f};\nunbind$$module$build$src$core$browser_events=function(a){const b=a[a.length-1][2];for(;a.length;){const [c,d,e]=a.pop();c.removeEventListener(d,e,!1)}return b};\nisTargetInput$$module$build$src$core$browser_events=function(a){if(a.target instanceof HTMLElement){if(a.target.isContentEditable||\"true\"===a.target.getAttribute(\"data-is-text-input\"))return!0;if(a.target instanceof HTMLInputElement)return a=a.target,\"text\"===a.type||\"number\"===a.type||\"email\"===a.type||\"password\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type;if(a.target instanceof HTMLTextAreaElement)return!0}return!1};\nisRightButton$$module$build$src$core$browser_events=function(a){return a.ctrlKey&&MAC$$module$build$src$core$utils$useragent?!0:2===a.button};mouseToSvg$$module$build$src$core$browser_events=function(a,b,c){const d=b.createSVGPoint();d.x=a.clientX;d.y=a.clientY;c||(c=b.getScreenCTM().inverse());return d.matrixTransform(c)};\ngetScrollDeltaPixels$$module$build$src$core$browser_events=function(a){switch(a.deltaMode){default:return{x:a.deltaX,y:a.deltaY};case 1:return{x:a.deltaX*LINE_MODE_MULTIPLIER$$module$build$src$core$browser_events,y:a.deltaY*LINE_MODE_MULTIPLIER$$module$build$src$core$browser_events};case 2:return{x:a.deltaX*PAGE_MODE_MULTIPLIER$$module$build$src$core$browser_events,y:a.deltaY*PAGE_MODE_MULTIPLIER$$module$build$src$core$browser_events}}};\nremoveElem$$module$build$src$core$utils$array=function(a,b){b=a.indexOf(b);if(-1===b)return!1;a.splice(b,1);return!0};register$$module$build$src$core$css=function(a){if(injected$$module$build$src$core$css)throw Error(\"CSS already injected\");content$$module$build$src$core$css+=\"\\n\"+a};\ninject$$module$build$src$core$css=function(a,b){injected$$module$build$src$core$css||(injected$$module$build$src$core$css=!0,a&&(a=b.replace(/[\\\\/]$/,\"\"),b=content$$module$build$src$core$css.replace(/<<<PATH>>>/g,a),content$$module$build$src$core$css=\"\",a=document.createElement(\"style\"),a.id=\"blockly-common-style\",b=document.createTextNode(b),a.appendChild(b),document.head.insertBefore(a,document.head.firstChild)))};\nwarn$$module$build$src$core$utils$deprecation=function(a,b,c,d){a=a+\" was deprecated in \"+b+\" and will be deleted in \"+c+\".\";d&&(a+=\"\\nUse \"+d+\" instead.\");console.warn(a)};createSvgElement$$module$build$src$core$utils$dom=function(a,b,c){a=document.createElementNS(SVG_NS$$module$build$src$core$utils$dom,`${a}`);for(const d in b)a.setAttribute(d,`${b[d]}`);c&&c.appendChild(a);return a};\naddClass$$module$build$src$core$utils$dom=function(a,b){b=b.split(\" \");if(b.every(c=>a.classList.contains(c)))return!1;a.classList.add(...b);return!0};removeClasses$$module$build$src$core$utils$dom=function(a,b){a.classList.remove(...b.split(\" \"))};removeClass$$module$build$src$core$utils$dom=function(a,b){b=b.split(\" \");if(b.every(c=>!a.classList.contains(c)))return!1;a.classList.remove(...b);return!0};hasClass$$module$build$src$core$utils$dom=function(a,b){return a.classList.contains(b)};\nremoveNode$$module$build$src$core$utils$dom=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};insertAfter$$module$build$src$core$utils$dom=function(a,b){const c=b.nextSibling;b=b.parentNode;if(!b)throw Error(\"Reference node has no parent.\");c?b.insertBefore(a,c):b.appendChild(a)};\ncontainsNode$$module$build$src$core$utils$dom=function(a,b){warn$$module$build$src$core$utils$deprecation(\"Blockly.utils.dom.containsNode\",\"version 10\",\"version 11\",'Use native \"contains\" DOM method');return a.contains(b)};setCssTransform$$module$build$src$core$utils$dom=function(a,b){a.style.transform=b;a.style[\"-webkit-transform\"]=b};\nstartTextWidthCache$$module$build$src$core$utils$dom=function(){cacheReference$$module$build$src$core$utils$dom++;cacheWidths$$module$build$src$core$utils$dom||(cacheWidths$$module$build$src$core$utils$dom=Object.create(null))};stopTextWidthCache$$module$build$src$core$utils$dom=function(){cacheReference$$module$build$src$core$utils$dom--;cacheReference$$module$build$src$core$utils$dom||(cacheWidths$$module$build$src$core$utils$dom=null)};\ngetTextWidth$$module$build$src$core$utils$dom=function(a){const b=a.textContent+\"\\n\"+a.className.baseVal;let c;if(cacheWidths$$module$build$src$core$utils$dom&&(c=cacheWidths$$module$build$src$core$utils$dom[b]))return c;try{c=a.getComputedTextLength()}catch(d){return 8*a.textContent.length}cacheWidths$$module$build$src$core$utils$dom&&(cacheWidths$$module$build$src$core$utils$dom[b]=c);return c};\ngetFastTextWidth$$module$build$src$core$utils$dom=function(a,b,c,d){return getFastTextWidthWithSizeString$$module$build$src$core$utils$dom(a,b+\"pt\",c,d)};\ngetFastTextWidthWithSizeString$$module$build$src$core$utils$dom=function(a,b,c,d){const e=a.textContent;a=e+\"\\n\"+a.className.baseVal;var f;if(cacheWidths$$module$build$src$core$utils$dom&&(f=cacheWidths$$module$build$src$core$utils$dom[a]))return f;canvasContext$$module$build$src$core$utils$dom||(f=document.createElement(\"canvas\"),f.className=\"blocklyComputeCanvas\",document.body.appendChild(f),canvasContext$$module$build$src$core$utils$dom=f.getContext(\"2d\"));canvasContext$$module$build$src$core$utils$dom.font=\nc+\" \"+b+\" \"+d;f=e?canvasContext$$module$build$src$core$utils$dom.measureText(e).width:0;cacheWidths$$module$build$src$core$utils$dom&&(cacheWidths$$module$build$src$core$utils$dom[a]=f);return f};\nmeasureFontMetrics$$module$build$src$core$utils$dom=function(a,b,c,d){const e=document.createElement(\"span\");e.style.font=c+\" \"+b+\" \"+d;e.textContent=a;a=document.createElement(\"div\");a.style.width=\"1px\";a.style.height=\"0\";b=document.createElement(\"div\");b.style.display=\"flex\";b.style.position=\"fixed\";b.style.top=\"0\";b.style.left=\"0\";b.appendChild(e);b.appendChild(a);document.body.appendChild(b);c={height:0,baseline:0};try{b.style.alignItems=\"baseline\",c.baseline=a.offsetTop-e.offsetTop,b.style.alignItems=\n\"flex-end\",c.height=a.offsetTop-e.offsetTop}finally{document.body.removeChild(b)}return c};getSize$$module$build$src$core$utils$style=function(a){return TEST_ONLY$$module$build$src$core$utils$style.getSizeInternal(a)};\ngetSizeInternal$$module$build$src$core$utils$style=function(a){if(\"none\"!==getComputedStyle$$module$build$src$core$utils$style(a,\"display\"))return getSizeWithDisplay$$module$build$src$core$utils$style(a);const b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility=\"hidden\";b.position=\"absolute\";b.display=\"inline\";const f=a.offsetWidth;a=a.offsetHeight;b.display=c;b.position=e;b.visibility=d;return new Size$$module$build$src$core$utils$size(f,a)};\ngetSizeWithDisplay$$module$build$src$core$utils$style=function(a){return new Size$$module$build$src$core$utils$size(a.offsetWidth,a.offsetHeight)};getComputedStyle$$module$build$src$core$utils$style=function(a,b){a=window.getComputedStyle(a);return a[b]||a.getPropertyValue(b)};\ngetPageOffset$$module$build$src$core$utils$style=function(a){const b=new Coordinate$$module$build$src$core$utils$coordinate(0,0);a=a.getBoundingClientRect();var c=document.documentElement;c=new Coordinate$$module$build$src$core$utils$coordinate(window.pageXOffset||c.scrollLeft,window.pageYOffset||c.scrollTop);b.x=a.left+c.x;b.y=a.top+c.y;return b};\ngetViewportPageOffset$$module$build$src$core$utils$style=function(){const a=document.body,b=document.documentElement;return new Coordinate$$module$build$src$core$utils$coordinate(a.scrollLeft||b.scrollLeft,a.scrollTop||b.scrollTop)};\ngetBorderBox$$module$build$src$core$utils$style=function(a){const b=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,\"borderLeftWidth\")),c=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,\"borderRightWidth\")),d=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,\"borderTopWidth\"));a=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,\"borderBottomWidth\"));return new Rect$$module$build$src$core$utils$rect(d,a,b,c)};\nscrollIntoContainerView$$module$build$src$core$utils$style=function(a,b,c){a=getContainerOffsetToScrollInto$$module$build$src$core$utils$style(a,b,c);b.scrollLeft=a.x;b.scrollTop=a.y};\ngetContainerOffsetToScrollInto$$module$build$src$core$utils$style=function(a,b,c){var d=getPageOffset$$module$build$src$core$utils$style(a),e=getPageOffset$$module$build$src$core$utils$style(b),f=getBorderBox$$module$build$src$core$utils$style(b);const g=d.x-e.x-f.left;d=d.y-e.y-f.top;e=getSizeWithDisplay$$module$build$src$core$utils$style(a);a=b.clientWidth-e.width;e=b.clientHeight-e.height;f=b.scrollLeft;b=b.scrollTop;c?(f+=g-a/2,b+=d-e/2):(f+=Math.min(g,Math.max(g-a,0)),b+=Math.min(d,Math.max(d-\ne,0)));return new Coordinate$$module$build$src$core$utils$coordinate(f,b)};\ngetRelativeXY$$module$build$src$core$utils$svg_math=function(a){const b=new Coordinate$$module$build$src$core$utils$coordinate(0,0);var c=a.x&&a.getAttribute(\"x\");const d=a.y&&a.getAttribute(\"y\");c&&(b.x=parseInt(c));d&&(b.y=parseInt(d));if(c=(c=a.getAttribute(\"transform\"))&&c.match(XY_REGEX$$module$build$src$core$utils$svg_math))b.x+=Number(c[1]),c[3]&&(b.y+=Number(c[3]));(a=a.getAttribute(\"style\"))&&-1<a.indexOf(\"translate\")&&(a=a.match(XY_STYLE_REGEX$$module$build$src$core$utils$svg_math))&&(b.x+=\nNumber(a[1]),a[3]&&(b.y+=Number(a[3])));return b};getInjectionDivXY$$module$build$src$core$utils$svg_math=function(a){let b=0,c=0;for(;a;){const d=getRelativeXY$$module$build$src$core$utils$svg_math(a);b+=d.x;c+=d.y;if(-1!==(\" \"+(a.getAttribute(\"class\")||\"\")+\" \").indexOf(\" injectionDiv \"))break;a=a.parentNode}return new Coordinate$$module$build$src$core$utils$coordinate(b,c)};\ngetViewportBBox$$module$build$src$core$utils$svg_math=function(){const a=getViewportPageOffset$$module$build$src$core$utils$style();return new Rect$$module$build$src$core$utils$rect(a.y,document.documentElement.clientHeight+a.y,a.x,document.documentElement.clientWidth+a.x)};getDocumentScroll$$module$build$src$core$utils$svg_math=function(){const a=document.documentElement,b=window;return new Coordinate$$module$build$src$core$utils$coordinate(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)};\nscreenToWsCoordinates$$module$build$src$core$utils$svg_math=function(a,b){var c=b.x;b=b.y;const d=a.getInjectionDiv().getBoundingClientRect();c=new Coordinate$$module$build$src$core$utils$coordinate(c-d.left,b-d.top);b=a.getOriginOffsetInPixels();return Coordinate$$module$build$src$core$utils$coordinate.difference(c,b).scale(1/a.scale)};\nwsToScreenCoordinates$$module$build$src$core$utils$svg_math=function(a,b){var c=b.scale(a.scale);b=c.x;c=c.y;const d=a.getInjectionDiv().getBoundingClientRect();a=a.getOriginOffsetInPixels();return new Coordinate$$module$build$src$core$utils$coordinate(b+d.left+a.x,c+d.top+a.y)};\ninjectDependencies$$module$build$src$core$utils$xml=function(a){({document:document$$module$build$src$core$utils$xml=document$$module$build$src$core$utils$xml,DOMParser:DOMParser$$module$build$src$core$utils$xml=DOMParser$$module$build$src$core$utils$xml,XMLSerializer:XMLSerializer$$module$build$src$core$utils$xml=XMLSerializer$$module$build$src$core$utils$xml}=a);domParser$$module$build$src$core$utils$xml=new DOMParser$$module$build$src$core$utils$xml;xmlSerializer$$module$build$src$core$utils$xml=\nnew XMLSerializer$$module$build$src$core$utils$xml};$.createElement$$module$build$src$core$utils$xml=function(a){return document$$module$build$src$core$utils$xml.createElementNS(NAME_SPACE$$module$build$src$core$utils$xml,a)};$.createTextNode$$module$build$src$core$utils$xml=function(a){return document$$module$build$src$core$utils$xml.createTextNode(a)};\n$.textToDom$$module$build$src$core$utils$xml=function(a){let b=domParser$$module$build$src$core$utils$xml.parseFromString(a,\"text/xml\");if(b&&b.documentElement&&!b.getElementsByTagName(\"parsererror\").length)return b.documentElement;if((b=domParser$$module$build$src$core$utils$xml.parseFromString(a,\"text/html\"))&&b.body.firstChild&&\"xml\"===b.body.firstChild.nodeName.toLowerCase())return b.body.firstChild;throw Error(`DOMParser was unable to parse: ${a}`);};\ndomToText$$module$build$src$core$utils$xml=function(a){return sanitizeText$$module$build$src$core$utils$xml(xmlSerializer$$module$build$src$core$utils$xml.serializeToString(a))};sanitizeText$$module$build$src$core$utils$xml=function(a){return a.replace(INVALID_CONTROL_CHARS$$module$build$src$core$utils$xml,b=>`&#${b.charCodeAt(0)};`)};\nconvertToolboxDefToJson$$module$build$src$core$utils$toolbox=function(a){if(!a)return null;if(a instanceof Element||\"string\"===typeof a)a=parseToolboxTree$$module$build$src$core$utils$toolbox(a),a=convertToToolboxJson$$module$build$src$core$utils$toolbox(a);validateToolbox$$module$build$src$core$utils$toolbox(a);return a};\nvalidateToolbox$$module$build$src$core$utils$toolbox=function(a){const b=a.kind;a=a.contents;if(b&&b!==FLYOUT_TOOLBOX_KIND$$module$build$src$core$utils$toolbox&&b!==CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox)throw Error(\"Invalid toolbox kind \"+b+\". Please supply either \"+FLYOUT_TOOLBOX_KIND$$module$build$src$core$utils$toolbox+\" or \"+CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox);if(!a)throw Error(\"Toolbox must have a contents attribute.\");};\nconvertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox=function(a){return a?a.contents?a.contents:Array.isArray(a)&&0<a.length&&!a[0].nodeType?a:xmlToJsonArray$$module$build$src$core$utils$toolbox(a):[]};hasCategories$$module$build$src$core$utils$toolbox=function(a){return TEST_ONLY$$module$build$src$core$utils$toolbox.hasCategoriesInternal(a)};\nhasCategoriesInternal$$module$build$src$core$utils$toolbox=function(a){if(!a)return!1;const b=a.kind;return b?b===CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox:!!a.contents.filter(function(c){return\"CATEGORY\"===c.kind.toUpperCase()}).length};isCategoryCollapsible$$module$build$src$core$utils$toolbox=function(a){return a&&a.contents?!!a.contents.filter(function(b){return\"CATEGORY\"===b.kind.toUpperCase()}).length:!1};\nconvertToToolboxJson$$module$build$src$core$utils$toolbox=function(a){const b={contents:xmlToJsonArray$$module$build$src$core$utils$toolbox(a)};a instanceof Node&&addAttributes$$module$build$src$core$utils$toolbox(a,b);return b};\nxmlToJsonArray$$module$build$src$core$utils$toolbox=function(a){const b=[];let c=a.childNodes;c||(c=a);for(let d=0,e;e=c[d];d++){if(!e.tagName)continue;a={};const f=e.tagName.toUpperCase();a.kind=f;\"BLOCK\"===f?a.blockxml=e:e.childNodes&&0<e.childNodes.length&&(a.contents=xmlToJsonArray$$module$build$src$core$utils$toolbox(e));addAttributes$$module$build$src$core$utils$toolbox(e,a);b.push(a)}return b};\naddAttributes$$module$build$src$core$utils$toolbox=function(a,b){for(let c=0;c<a.attributes.length;c++){const d=a.attributes[c];-1<d.nodeName.indexOf(\"css-\")?(b.cssconfig=b.cssconfig||{},b.cssconfig[d.nodeName.replace(\"css-\",\"\")]=d.value):b[d.nodeName]=d.value}};\nparseToolboxTree$$module$build$src$core$utils$toolbox=function(a){let b=null;if(a)if(\"string\"===typeof a){if(b=$.textToDom$$module$build$src$core$utils$xml(a),\"xml\"!==b.nodeName.toLowerCase())throw TypeError(\"Toolbox should be an <xml> document.\");}else a instanceof Element&&(b=a);return b};\ngetStartPositionRect$$module$build$src$core$positionable_helpers=function(a,b,c,d,e,f){const g=f.scrollbar&&f.scrollbar.canScrollVertically();a.horizontal===horizontalPosition$$module$build$src$core$positionable_helpers.LEFT?(c=e.absoluteMetrics.left+c,g&&f.RTL&&(c+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness)):(c=e.absoluteMetrics.left+e.viewMetrics.width-b.width-c,g&&!f.RTL&&(c-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness));a.vertical===verticalPosition$$module$build$src$core$positionable_helpers.TOP?\na=e.absoluteMetrics.top+d:(a=e.absoluteMetrics.top+e.viewMetrics.height-b.height-d,f.scrollbar&&f.scrollbar.canScrollHorizontally()&&(a-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness));return new Rect$$module$build$src$core$utils$rect(a,a+b.height,c,c+b.width)};\ngetCornerOppositeToolbox$$module$build$src$core$positionable_helpers=function(a,b){return{horizontal:b.toolboxMetrics.position===Position$$module$build$src$core$utils$toolbox.LEFT||a.horizontalLayout&&!a.RTL?horizontalPosition$$module$build$src$core$positionable_helpers.RIGHT:horizontalPosition$$module$build$src$core$positionable_helpers.LEFT,vertical:b.toolboxMetrics.position===Position$$module$build$src$core$utils$toolbox.BOTTOM?verticalPosition$$module$build$src$core$positionable_helpers.TOP:verticalPosition$$module$build$src$core$positionable_helpers.BOTTOM}};\nbumpPositionRect$$module$build$src$core$positionable_helpers=function(a,b,c,d){const e=a.left,f=a.right-a.left,g=a.bottom-a.top;for(let h=0;h<d.length;h++){const k=d[h];a.intersects(k)&&(a=c===bumpDirection$$module$build$src$core$positionable_helpers.UP?k.top-g-b:k.bottom+b,a=new Rect$$module$build$src$core$utils$rect(a,a+g,e,e+f),h=-1)}return a};alert$$module$build$src$core$dialog=function(a,b){alertImplementation$$module$build$src$core$dialog(a,b)};\nsetAlert$$module$build$src$core$dialog=function(a){alertImplementation$$module$build$src$core$dialog=a};confirm$$module$build$src$core$dialog=function(a,b){TEST_ONLY$$module$build$src$core$dialog.confirmInternal(a,b)};confirmInternal$$module$build$src$core$dialog=function(a,b){confirmImplementation$$module$build$src$core$dialog(a,b)};setConfirm$$module$build$src$core$dialog=function(a){confirmImplementation$$module$build$src$core$dialog=a};\nprompt$$module$build$src$core$dialog=function(a,b,c){promptImplementation$$module$build$src$core$dialog(a,b,c)};setPrompt$$module$build$src$core$dialog=function(a){promptImplementation$$module$build$src$core$dialog=a};isVariableBackedParameterModel$$module$build$src$core$interfaces$i_variable_backed_parameter_model=function(a){return void 0!==a.getVariableModel};isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks=function(a){return void 0!==a.getProcedureDef};\nisLegacyProcedureCallBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks=function(a){return void 0!==a.getProcedureCall&&void 0!==a.renameProcedure};$.allUsedVarModels$$module$build$src$core$variables=function(a){a=a.getAllBlocks(!1);const b=new Set;for(let c=0;c<a.length;c++){const d=a[c].getVarModels();if(d)for(let e=0;e<d.length;e++){const f=d[e];f.getId()&&b.add(f)}}return Array.from(b.values())};\n$.allDeveloperVariables$$module$build$src$core$variables=function(a){a=a.getAllBlocks(!1);const b=new Set;for(let d=0,e;e=a[d];d++){var c=e.getDeveloperVariables;if(c){c=c();for(let f=0;f<c.length;f++)b.add(c[f])}}return Array.from(b.values())};\nflyoutCategory$$module$build$src$core$variables=function(a){let b=[];const c=document.createElement(\"button\");c.setAttribute(\"text\",\"%{BKY_NEW_VARIABLE}\");c.setAttribute(\"callbackKey\",\"CREATE_VARIABLE\");a.registerButtonCallback(\"CREATE_VARIABLE\",function(d){createVariableButtonHandler$$module$build$src$core$variables(d.getTargetWorkspace())});b.push(c);a=flyoutCategoryBlocks$$module$build$src$core$variables(a);return b=b.concat(a)};\nflyoutCategoryBlocks$$module$build$src$core$variables=function(a){a=a.getVariablesOfType(\"\");const b=[];if(0<a.length){var c=a[a.length-1];if(Blocks$$module$build$src$core$blocks.variables_set){var d=$.createElement$$module$build$src$core$utils$xml(\"block\");d.setAttribute(\"type\",\"variables_set\");d.setAttribute(\"gap\",Blocks$$module$build$src$core$blocks.math_change?\"8\":\"24\");d.appendChild(generateVariableFieldDom$$module$build$src$core$variables(c));b.push(d)}Blocks$$module$build$src$core$blocks.math_change&&\n(d=$.createElement$$module$build$src$core$utils$xml(\"block\"),d.setAttribute(\"type\",\"math_change\"),d.setAttribute(\"gap\",Blocks$$module$build$src$core$blocks.variables_get?\"20\":\"8\"),d.appendChild(generateVariableFieldDom$$module$build$src$core$variables(c)),c=$.textToDom$$module$build$src$core$utils$xml('<value name=\"DELTA\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value>'),d.appendChild(c),b.push(d));if(Blocks$$module$build$src$core$blocks.variables_get){a.sort(VariableModel$$module$build$src$core$variable_model.compareByName);\nfor(let e=0,f;f=a[e];e++)c=$.createElement$$module$build$src$core$utils$xml(\"block\"),c.setAttribute(\"type\",\"variables_get\"),c.setAttribute(\"gap\",\"8\"),c.appendChild(generateVariableFieldDom$$module$build$src$core$variables(f)),b.push(c)}}return b};generateUniqueName$$module$build$src$core$variables=function(a){return TEST_ONLY$$module$build$src$core$variables.generateUniqueNameInternal(a)};\ngenerateUniqueNameInternal$$module$build$src$core$variables=function(a){return generateUniqueNameFromOptions$$module$build$src$core$variables(VAR_LETTER_OPTIONS$$module$build$src$core$variables.charAt(0),a.getAllVariableNames())};\ngenerateUniqueNameFromOptions$$module$build$src$core$variables=function(a,b){if(!b.length)return a;const c=VAR_LETTER_OPTIONS$$module$build$src$core$variables;let d=\"\",e=c.indexOf(a);for(;;){let f=!1;for(let g=0;g<b.length;g++)if(b[g].toLowerCase()===a){f=!0;break}if(!f)break;e++;e===c.length&&(e=0,d=`${Number(d)+1}`);a=c.charAt(e)+d}return a};\ncreateVariableButtonHandler$$module$build$src$core$variables=function(a,b,c){function d(f){promptName$$module$build$src$core$variables($.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,f,function(g){if(g){var h=nameUsedWithAnyType$$module$build$src$core$variables(g,a);if(h){if(h.type===e)var k=$.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace(\"%1\",h.name);else k=$.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,k=k.replace(\"%1\",h.name).replace(\"%2\",h.type);\nalert$$module$build$src$core$dialog(k,function(){d(g)})}else a.createVariable(g,e),b&&b(g)}else b&&b(null)})}const e=c||\"\";d(\"\")};\n$.renameVariable$$module$build$src$core$variables=function(a,b,c){function d(e){const f=$.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace(\"%1\",b.name);promptName$$module$build$src$core$variables(f,e,function(g){if(g){var h=nameUsedWithOtherType$$module$build$src$core$variables(g,b.type,a),k=nameUsedWithConflictingParam$$module$build$src$core$variables(b.name,g,a);if(h||k){var l=\"\";h?l=$.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace(\"%1\",h.name).replace(\"%2\",\nh.type):k&&(l=$.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace(\"%1\",g).replace(\"%2\",k));alert$$module$build$src$core$dialog(l,function(){d(g)})}else a.renameVariableById(b.getId(),g),c&&c(g)}else c&&c(null)})}d(\"\")};\npromptName$$module$build$src$core$variables=function(a,b,c){prompt$$module$build$src$core$dialog(a,b,function(d){d&&(d=d.replace(/[\\s\\xa0]+/g,\" \").trim(),d===$.Msg$$module$build$src$core$msg.RENAME_VARIABLE||d===$.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(d=null);c(d)})};nameUsedWithOtherType$$module$build$src$core$variables=function(a,b,c){c=c.getVariableMap().getAllVariables();a=a.toLowerCase();for(let d=0,e;e=c[d];d++)if(e.name.toLowerCase()===a&&e.type!==b)return e;return null};\nnameUsedWithAnyType$$module$build$src$core$variables=function(a,b){b=b.getVariableMap().getAllVariables();a=a.toLowerCase();for(let c=0,d;d=b[c];c++)if(d.name.toLowerCase()===a)return d;return null};nameUsedWithConflictingParam$$module$build$src$core$variables=function(a,b,c){return c.getProcedureMap().getProcedures().length?checkForConflictingParamWithProcedureModels$$module$build$src$core$variables(a,b,c):checkForConflictingParamWithLegacyProcedures$$module$build$src$core$variables(a,b,c)};\ncheckForConflictingParamWithProcedureModels$$module$build$src$core$variables=function(a,b,c){a=a.toLowerCase();b=b.toLowerCase();c=c.getProcedureMap().getProcedures();for(const e of c){var d=e.getParameters().filter(isVariableBackedParameterModel$$module$build$src$core$interfaces$i_variable_backed_parameter_model).map(f=>f.getVariableModel().name);if(d&&(c=d.some(f=>f.toLowerCase()===a),d=d.some(f=>f.toLowerCase()===b),c&&d))return e.getName()}return null};\ncheckForConflictingParamWithLegacyProcedures$$module$build$src$core$variables=function(a,b,c){a=a.toLowerCase();b=b.toLowerCase();c=c.getAllBlocks(!1);for(const e of c){if(!isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks(e))continue;c=e.getProcedureDef();var d=c[1];const f=d.some(g=>g.toLowerCase()===a);d=d.some(g=>g.toLowerCase()===b);if(f&&d)return c[0]}return null};\ngenerateVariableFieldDom$$module$build$src$core$variables=function(a){const b=$.createElement$$module$build$src$core$utils$xml(\"field\");b.setAttribute(\"name\",\"VAR\");b.setAttribute(\"id\",a.getId());b.setAttribute(\"variabletype\",a.type);a=$.createTextNode$$module$build$src$core$utils$xml(a.name);b.appendChild(a);return b};\n$.getOrCreateVariablePackage$$module$build$src$core$variables=function(a,b,c,d){let e=$.getVariable$$module$build$src$core$variables(a,b,c,d);e||(e=createVariable$$module$build$src$core$variables(a,b,c,d));return e};\n$.getVariable$$module$build$src$core$variables=function(a,b,c,d){const e=a.getPotentialVariableMap();let f=null;if(b&&(f=a.getVariableById(b),!f&&e&&(f=e.getVariableById(b)),f))return f;if(c){if(void 0===d)throw Error(\"Tried to look up a variable by name without a type\");f=a.getVariable(c,d);!f&&e&&(f=e.getVariable(c,d))}return f};\ncreateVariable$$module$build$src$core$variables=function(a,b,c,d){const e=a.getPotentialVariableMap();c||(c=generateUniqueName$$module$build$src$core$variables(a.isFlyout?a.targetWorkspace:a));return e?e.createVariable(c,d,b):a.createVariable(c,d,b)};getAddedVariables$$module$build$src$core$variables=function(a,b){a=a.getAllVariables();const c=[];if(b.length!==a.length)for(let d=0;d<a.length;d++){const e=a[d];-1===b.indexOf(e)&&c.push(e)}return c};\nregister$$module$build$src$core$clipboard$registry=function(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.PASTER,a,b)};unregister$$module$build$src$core$clipboard$registry=function(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.PASTER,a)};\nqueueRender$$module$build$src$core$render_management=function(a){queueBlock$$module$build$src$core$render_management(a);if(alwaysImmediatelyRender$$module$build$src$core$render_management())return doRenders$$module$build$src$core$render_management(),Promise.resolve();afterRendersPromise$$module$build$src$core$render_management||(afterRendersPromise$$module$build$src$core$render_management=new Promise(b=>{afterRendersResolver$$module$build$src$core$render_management=b;animationRequestId$$module$build$src$core$render_management=\nwindow.requestAnimationFrame(()=>{doRenders$$module$build$src$core$render_management();b()})}));return afterRendersPromise$$module$build$src$core$render_management};finishQueuedRenders$$module$build$src$core$render_management=function(){return afterRendersPromise$$module$build$src$core$render_management?afterRendersPromise$$module$build$src$core$render_management:Promise.resolve()};\ntriggerQueuedRenders$$module$build$src$core$render_management=function(a){a||window.cancelAnimationFrame(animationRequestId$$module$build$src$core$render_management);doRenders$$module$build$src$core$render_management(a);!a&&afterRendersResolver$$module$build$src$core$render_management&&afterRendersResolver$$module$build$src$core$render_management()};alwaysImmediatelyRender$$module$build$src$core$render_management=function(){return JavaFx$$module$build$src$core$utils$useragent};\nqueueBlock$$module$build$src$core$render_management=function(a){dirtyBlocks$$module$build$src$core$render_management.add(a);const b=a.getParent();b?queueBlock$$module$build$src$core$render_management(b):rootBlocks$$module$build$src$core$render_management.add(a)};\ndoRenders$$module$build$src$core$render_management=function(a){const b=a?new Set([a]):new Set([...rootBlocks$$module$build$src$core$render_management].map(e=>e.workspace)),c=[...rootBlocks$$module$build$src$core$render_management].filter(shouldRenderRootBlock$$module$build$src$core$render_management).filter(e=>b.has(e.workspace));for(var d of c)renderBlock$$module$build$src$core$render_management(d);for(const e of b)e.resizeContents();for(const e of c)d=e.getRelativeToSurfaceXY(),e.updateComponentLocations(d);\nfor(const e of c)dequeueBlock$$module$build$src$core$render_management(e);a||(afterRendersPromise$$module$build$src$core$render_management=null)};dequeueBlock$$module$build$src$core$render_management=function(a){rootBlocks$$module$build$src$core$render_management.delete(a);dirtyBlocks$$module$build$src$core$render_management.delete(a);for(const b of a.getChildren(!1))dequeueBlock$$module$build$src$core$render_management(b)};\nshouldRenderRootBlock$$module$build$src$core$render_management=function(a){return!a.isDisposed()&&!a.getParent()};renderBlock$$module$build$src$core$render_management=function(a){if(dirtyBlocks$$module$build$src$core$render_management.has(a)){for(const b of a.getChildren(!1))renderBlock$$module$build$src$core$render_management(b);a.renderEfficiently()}};\nworkspaceToDom$$module$build$src$core$xml=function(a,b){const c=$.createElement$$module$build$src$core$utils$xml(\"xml\");var d=variablesToDom$$module$build$src$core$xml($.allUsedVarModels$$module$build$src$core$variables(a));d.hasChildNodes()&&c.appendChild(d);d=a.getTopComments(!0);for(let e=0;e<d.length;e++)c.appendChild(d[e].toXmlWithXY(b));a=a.getTopBlocks(!0);for(d=0;d<a.length;d++)c.appendChild(blockToDomWithXY$$module$build$src$core$xml(a[d],b));return c};\nvariablesToDom$$module$build$src$core$xml=function(a){const b=$.createElement$$module$build$src$core$utils$xml(\"variables\");for(let c=0;c<a.length;c++){const d=a[c],e=$.createElement$$module$build$src$core$utils$xml(\"variable\");e.appendChild($.createTextNode$$module$build$src$core$utils$xml(d.name));d.type&&e.setAttribute(\"type\",d.type);e.id=d.getId();b.appendChild(e)}return b};\nblockToDomWithXY$$module$build$src$core$xml=function(a,b){if(a.isInsertionMarker()&&(a=a.getChildren(!1)[0],!a))return new DocumentFragment;let c=0;a.workspace.RTL&&(c=a.workspace.getWidth());b=blockToDom$$module$build$src$core$xml(a,b);if(isElement$$module$build$src$core$xml(b)){const d=a.getRelativeToSurfaceXY();b.setAttribute(\"x\",String(Math.round(a.workspace.RTL?c-d.x:d.x)));b.setAttribute(\"y\",String(Math.round(d.y)))}return b};\nfieldToDom$$module$build$src$core$xml=function(a){if(a.isSerializable()){const b=$.createElement$$module$build$src$core$utils$xml(\"field\");b.setAttribute(\"name\",a.name||\"\");return a.toXml(b)}return null};allFieldsToDom$$module$build$src$core$xml=function(a,b){for(let c=0;c<a.inputList.length;c++){const d=a.inputList[c];for(let e=0;e<d.fieldRow.length;e++){const f=fieldToDom$$module$build$src$core$xml(d.fieldRow[e]);f&&b.appendChild(f)}}};\nblockToDom$$module$build$src$core$xml=function(a,b){if(a.isInsertionMarker())return(b=a.getChildren(!1)[0])?blockToDom$$module$build$src$core$xml(b):new DocumentFragment;const c=$.createElement$$module$build$src$core$utils$xml(a.isShadow()?\"shadow\":\"block\");c.setAttribute(\"type\",a.type);b||(c.id=a.id);if(a.mutationToDom){var d=a.mutationToDom();d&&(d.hasChildNodes()||d.hasAttributes())&&c.appendChild(d)}allFieldsToDom$$module$build$src$core$xml(a,c);if(d=a.getCommentText()){var e=a.getIcon(IconType$$module$build$src$core$icons$icon_types.COMMENT),\nf=e.getBubbleSize();e=e.bubbleIsVisible();var g=$.createElement$$module$build$src$core$utils$xml(\"comment\");g.appendChild($.createTextNode$$module$build$src$core$utils$xml(d));g.setAttribute(\"pinned\",`${e}`);g.setAttribute(\"h\",String(f.height));g.setAttribute(\"w\",String(f.width));c.appendChild(g)}a.data&&(d=$.createElement$$module$build$src$core$utils$xml(\"data\"),d.appendChild($.createTextNode$$module$build$src$core$utils$xml(a.data)),c.appendChild(d));for(d=0;d<a.inputList.length;d++){f=a.inputList[d];\nvar h=void 0;e=!0;if(f.type!==$.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&f.type!==$.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){g=f.connection.targetBlock();f.type===$.inputTypes$$module$build$src$core$inputs$input_types.VALUE?h=$.createElement$$module$build$src$core$utils$xml(\"value\"):f.type===$.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(h=$.createElement$$module$build$src$core$utils$xml(\"statement\"));const l=f.connection.getShadowDom();\n!l||g&&g.isShadow()||h.appendChild(cloneShadow$$module$build$src$core$xml(l,b));g&&(g=blockToDom$$module$build$src$core$xml(g,b),g.nodeType===NodeType$$module$build$src$core$utils$dom.ELEMENT_NODE&&(h.appendChild(g),e=!1));h.setAttribute(\"name\",f.name);e||c.appendChild(h)}}void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&c.setAttribute(\"inline\",String(a.inputsInline));a.isCollapsed()&&c.setAttribute(\"collapsed\",\"true\");a.isEnabled()||c.setAttribute(\"disabled\",\"true\");a.isDeletable()||\na.isShadow()||c.setAttribute(\"deletable\",\"false\");a.isMovable()||a.isShadow()||c.setAttribute(\"movable\",\"false\");a.isEditable()||c.setAttribute(\"editable\",\"false\");h=a.getNextBlock();let k;h&&(d=blockToDom$$module$build$src$core$xml(h,b),d.nodeType===NodeType$$module$build$src$core$utils$dom.ELEMENT_NODE&&(k=$.createElement$$module$build$src$core$utils$xml(\"next\"),k.appendChild(d),c.appendChild(k)));a=a.nextConnection&&a.nextConnection.getShadowDom();!a||h&&h.isShadow()||k.appendChild(cloneShadow$$module$build$src$core$xml(a,\nb));return c};\ncloneShadow$$module$build$src$core$xml=function(a,b){let c=a=a.cloneNode(!0),d;for(;c;)if(b&&\"shadow\"===c.nodeName&&c.removeAttribute(\"id\"),c.firstChild)c=c.firstChild;else{for(;c&&!c.nextSibling;){d=c;c=c.parentNode;let e;d.nodeType===NodeType$$module$build$src$core$utils$dom.TEXT_NODE&&\"\"===d.data.trim()&&(null==(e=c)?void 0:e.firstChild)!==d&&removeNode$$module$build$src$core$utils$dom(d)}c&&(d=c,c=c.nextSibling,d.nodeType===NodeType$$module$build$src$core$utils$dom.TEXT_NODE&&\"\"===d.data.trim()&&\nremoveNode$$module$build$src$core$utils$dom(d))}return a};domToText$$module$build$src$core$xml=function(a){return domToText$$module$build$src$core$utils$xml(a).replace(/<(\\w+)([^<]*)\\/>/g,\"<$1$2></$1>\")};\ndomToPrettyText$$module$build$src$core$xml=function(a){a=domToText$$module$build$src$core$xml(a).split(\"<\");let b=\"\";for(let c=1;c<a.length;c++){const d=a[c];\"/\"===d[0]&&(b=b.substring(2));a[c]=b+\"<\"+d;\"/\"!==d[0]&&\"/>\"!==d.slice(-2)&&(b+=\"  \")}a=a.join(\"\\n\");a=a.replace(/(<(\\w+)\\b[^>]*>[^\\n]*)\\n *<\\/\\2>/g,\"$1</$2>\");return a.replace(/^\\n/,\"\")};\nclearWorkspaceAndLoadFromXml$$module$build$src$core$xml=function(a,b){b.setResizesEnabled(!1);b.clear();a=$.domToWorkspace$$module$build$src$core$xml(a,b);b.setResizesEnabled(!0);return a};\n$.domToWorkspace$$module$build$src$core$xml=function(a,b){let c=0;b.RTL&&(c=b.getWidth());const d=[];startTextWidthCache$$module$build$src$core$utils$dom();const e=$.getGroup$$module$build$src$core$events$utils();e||$.setGroup$$module$build$src$core$events$utils(!0);b.setResizesEnabled&&b.setResizesEnabled(!1);let f=!0;try{for(let g=0,h;h=a.childNodes[g];g++){const k=h.nodeName.toLowerCase(),l=h;if(\"block\"===k||\"shadow\"===k&&!getRecordUndo$$module$build$src$core$events$utils()){const m=domToBlockInternal$$module$build$src$core$xml(l,\nb);d.push(m.id);let n;const p=parseInt(null!=(n=l.getAttribute(\"x\"))?n:\"10\",10);let q;const r=parseInt(null!=(q=l.getAttribute(\"y\"))?q:\"10\",10);isNaN(p)||isNaN(r)||m.moveBy(b.RTL?c-p:p,r,[\"create\"]);f=!1}else{if(\"shadow\"===k)throw TypeError(\"Shadow block cannot be a top-level block.\");if(\"comment\"===k)b.rendered?WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.fromXmlRendered(l,b,c):WorkspaceComment$$module$build$src$core$workspace_comment.fromXml(l,b);else if(\"variables\"===k){if(f)domToVariables$$module$build$src$core$xml(l,\nb);else throw Error(\"'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.\");f=!1}}}}finally{$.setGroup$$module$build$src$core$events$utils(e),b.setResizesEnabled&&b.setResizesEnabled(!0),b.rendered&&triggerQueuedRenders$$module$build$src$core$render_management(),stopTextWidthCache$$module$build$src$core$utils$dom()}fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(FINISHED_LOADING$$module$build$src$core$events$utils))(b));\nreturn d};\nappendDomToWorkspace$$module$build$src$core$xml=function(a,b){if(!b.getBlocksBoundingBox)return $.domToWorkspace$$module$build$src$core$xml(a,b);var c=b.getBlocksBoundingBox();a=$.domToWorkspace$$module$build$src$core$xml(a,b);if(c&&c.top!==c.bottom){var d=c.bottom;c=b.RTL?c.right:c.left;var e=Infinity;let f=-Infinity,g=Infinity;for(let h=0;h<a.length;h++){const k=b.getBlockById(a[h]).getRelativeToSurfaceXY();k.y<g&&(g=k.y);k.x<e&&(e=k.x);k.x>f&&(f=k.x)}d=d-g+10;c=b.RTL?c-f:c-e;for(e=0;e<a.length;e++)b.getBlockById(a[e]).moveBy(c,\nd,[\"create\"])}return a};$.domToBlock$$module$build$src$core$xml=function(a,b){a=domToBlockInternal$$module$build$src$core$xml(a,b);b.rendered&&triggerQueuedRenders$$module$build$src$core$render_management();return a};\ndomToBlockInternal$$module$build$src$core$xml=function(a,b){$.disable$$module$build$src$core$events$utils();var c=b.getAllVariables();let d;try{if(d=domToBlockHeadless$$module$build$src$core$xml(a,b),b.rendered){const e=d,f=d.getDescendants(!1);e.setConnectionTracking(!1);for(let g=f.length-1;0<=g;g--)f[g].initSvg();for(let g=f.length-1;0<=g;g--)f[g].queueRender();setTimeout(function(){e.disposed||e.setConnectionTracking(!0)},1);b.resizeContents()}else{const e=d.getDescendants(!1);for(let f=e.length-\n1;0<=f;f--)e[f].initModel()}}finally{$.enable$$module$build$src$core$events$utils()}if(isEnabled$$module$build$src$core$events$utils()){a=getAddedVariables$$module$build$src$core$variables(b,c);for(b=0;b<a.length;b++)c=a[b],fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(VAR_CREATE$$module$build$src$core$events$utils))(c));fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(d))}return d};\ndomToVariables$$module$build$src$core$xml=function(a,b){for(let d=0;d<a.children.length;d++){var c=a.children[d];const e=c.getAttribute(\"type\"),f=c.getAttribute(\"id\");c=c.textContent;if(!c)break;b.createVariable(c,e,f)}};\nmapSupportedXmlTags$$module$build$src$core$xml=function(a){const b={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let c=0;c<a.children.length;c++){const d=a.children[c];if(d.nodeType!==NodeType$$module$build$src$core$utils$dom.TEXT_NODE)switch(d.nodeName.toLowerCase()){case \"mutation\":b.mutation.push(d);break;case \"comment\":b.comment.push(d);break;case \"data\":b.data.push(d);break;case \"title\":case \"field\":b.field.push(d);break;case \"value\":case \"statement\":b.input.push(d);break;case \"next\":b.next.push(d);\nbreak;default:console.warn(\"Ignoring unknown tag: \"+d.nodeName)}}return b};applyMutationTagNodes$$module$build$src$core$xml=function(a,b){let c=!1;for(let d=0;d<a.length;d++){const e=a[d];b.domToMutation&&(b.domToMutation(e),b.initSvg&&(c=!0))}return c};\napplyCommentTagNodes$$module$build$src$core$xml=function(a,b){for(let d=0;d<a.length;d++){var c=a[d];const e=c.textContent,f=\"true\"===c.getAttribute(\"pinned\");let g;const h=parseInt(null!=(g=c.getAttribute(\"w\"))?g:\"50\",10);let k;c=parseInt(null!=(k=c.getAttribute(\"h\"))?k:\"50\",10);b.setCommentText(e);const l=b.getIcon(IconType$$module$build$src$core$icons$icon_types.COMMENT);isNaN(h)||isNaN(c)||l.setBubbleSize(new Size$$module$build$src$core$utils$size(h,c));l.setBubbleVisible(f);setTimeout(()=>l.setBubbleVisible(f),\n1)}};applyDataTagNodes$$module$build$src$core$xml=function(a,b){for(let c=0;c<a.length;c++)b.data=a[c].textContent};applyFieldTagNodes$$module$build$src$core$xml=function(a,b){for(let c=0;c<a.length;c++){const d=a[c],e=d.getAttribute(\"name\");e?domToField$$module$build$src$core$xml(b,e,d):console.warn(`Ignoring unnamed field in block ${b.type}`)}};\nfindChildBlocks$$module$build$src$core$xml=function(a){let b=null,c=null;for(let d=0;d<a.childNodes.length;d++){const e=a.childNodes[d];isElement$$module$build$src$core$xml(e)&&(\"block\"===e.nodeName.toLowerCase()?b=e:\"shadow\"===e.nodeName.toLowerCase()&&(c=e))}return{childBlockElement:b,childShadowElement:c}};\napplyInputTagNodes$$module$build$src$core$xml=function(a,b,c,d){for(let f=0;f<a.length;f++){var e=a[f];const g=e.getAttribute(\"name\"),h=g?c.getInput(g):null;if(!h){console.warn(\"Ignoring non-existent input \"+g+\" in block \"+d);break}e=findChildBlocks$$module$build$src$core$xml(e);if(e.childBlockElement){if(!h.connection)throw TypeError(\"Input connection does not exist.\");domToBlockHeadless$$module$build$src$core$xml(e.childBlockElement,b,h.connection,!1)}if(e.childShadowElement){let k;null==(k=h.connection)||\nk.setShadowDom(e.childShadowElement)}}};applyNextTagNodes$$module$build$src$core$xml=function(a,b,c){for(let d=0;d<a.length;d++){const e=findChildBlocks$$module$build$src$core$xml(a[d]);if(e.childBlockElement){if(!c.nextConnection)throw TypeError(\"Next statement does not exist.\");if(c.nextConnection.isConnected())throw TypeError(\"Next statement is already connected.\");domToBlockHeadless$$module$build$src$core$xml(e.childBlockElement,b,c.nextConnection,!0)}e.childShadowElement&&c.nextConnection&&c.nextConnection.setShadowDom(e.childShadowElement)}};\ndomToBlockHeadless$$module$build$src$core$xml=function(a,b,c,d){var e;const f=a.getAttribute(\"type\");if(!f)throw TypeError(\"Block type unspecified: \"+a.outerHTML);var g=null!=(e=a.getAttribute(\"id\"))?e:void 0;e=b.newBlock(f,g);g=mapSupportedXmlTags$$module$build$src$core$xml(a);const h=applyMutationTagNodes$$module$build$src$core$xml(g.mutation,e);applyCommentTagNodes$$module$build$src$core$xml(g.comment,e);applyDataTagNodes$$module$build$src$core$xml(g.data,e);if(c)if(d)if(e.previousConnection)c.connect(e.previousConnection);\nelse throw TypeError(\"Next block does not have previous statement.\");else if(e.outputConnection)c.connect(e.outputConnection);else if(e.previousConnection)c.connect(e.previousConnection);else throw TypeError(\"Child block does not have output or previous statement.\");applyFieldTagNodes$$module$build$src$core$xml(g.field,e);applyInputTagNodes$$module$build$src$core$xml(g.input,b,e,f);applyNextTagNodes$$module$build$src$core$xml(g.next,b,e);h&&e.initSvg();(b=a.getAttribute(\"inline\"))&&e.setInputsInline(\"true\"===\nb);(b=a.getAttribute(\"disabled\"))&&e.setEnabled(\"true\"!==b&&\"disabled\"!==b);(b=a.getAttribute(\"deletable\"))&&e.setDeletable(\"true\"===b);(b=a.getAttribute(\"movable\"))&&e.setMovable(\"true\"===b);(b=a.getAttribute(\"editable\"))&&e.setEditable(\"true\"===b);(b=a.getAttribute(\"collapsed\"))&&e.setCollapsed(\"true\"===b);if(\"shadow\"===a.nodeName.toLowerCase()){a=e.getChildren(!1);for(b=0;b<a.length;b++)if(!a[b].isShadow())throw TypeError(\"Shadow block not allowed non-shadow child.\");if(e.getVarModels().length)throw TypeError(\"Shadow blocks cannot have variable references.\");\ne.setShadow(!0)}return e};domToField$$module$build$src$core$xml=function(a,b,c){const d=a.getField(b);d?d.fromXml(c):console.warn(\"Ignoring non-existent field \"+b+\" in block \"+a.type)};deleteNext$$module$build$src$core$xml=function(a){for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b];if(\"next\"===c.nodeName.toLowerCase()){a.removeChild(c);break}}};isElement$$module$build$src$core$xml=function(a){return a.nodeType===NodeType$$module$build$src$core$utils$dom.ELEMENT_NODE};\nisSerializable$$module$build$src$core$interfaces$i_serializable=function(a){return void 0!==a.saveState&&void 0!==a.loadState};register$$module$build$src$core$serialization$registry=function(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,a,b)};unregister$$module$build$src$core$serialization$registry=function(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,a)};\nsave$$module$build$src$core$serialization$blocks=function(a,{addCoordinates:b=!1,addInputBlocks:c=!0,addNextBlocks:d=!0,doFullSerialization:e=!0,saveIds:f=!0}={}){if(a.isInsertionMarker())return null;const g={type:a.type,id:f?a.id:void 0};b&&saveCoords$$module$build$src$core$serialization$blocks(a,g);saveAttributes$$module$build$src$core$serialization$blocks(a,g);saveExtraState$$module$build$src$core$serialization$blocks(a,g,e);saveIcons$$module$build$src$core$serialization$blocks(a,g,e);saveFields$$module$build$src$core$serialization$blocks(a,\ng,e);c&&saveInputBlocks$$module$build$src$core$serialization$blocks(a,g,e,f);d&&saveNextBlocks$$module$build$src$core$serialization$blocks(a,g,e,f);return g};\nsaveAttributes$$module$build$src$core$serialization$blocks=function(a,b){a.isCollapsed()&&(b.collapsed=!0);a.isEnabled()||(b.enabled=!1);a.isOwnDeletable()||(b.deletable=!1);a.isOwnMovable()||(b.movable=!1);a.isOwnEditable()||(b.editable=!1);void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&(b.inline=a.inputsInline);a.data&&(b.data=a.data)};\nsaveCoords$$module$build$src$core$serialization$blocks=function(a,b){const c=a.workspace;a=a.getRelativeToSurfaceXY();b.x=Math.round(c.RTL?c.getWidth()-a.x:a.x);b.y=Math.round(a.y)};saveExtraState$$module$build$src$core$serialization$blocks=function(a,b,c){a.saveExtraState?(a=a.saveExtraState(c),null!==a&&(b.extraState=a)):a.mutationToDom&&(a=a.mutationToDom(),null!==a&&(b.extraState=domToText$$module$build$src$core$xml(a).replace(' xmlns=\"https://developers.google.com/blockly/xml\"',\"\")))};\nsaveIcons$$module$build$src$core$serialization$blocks=function(a,b,c){const d=Object.create(null);for(const e of a.getIcons())isSerializable$$module$build$src$core$interfaces$i_serializable(e)&&(a=e.saveState(c))&&(d[e.getType().toString()]=a);Object.keys(d).length&&(b.icons=d)};\nsaveFields$$module$build$src$core$serialization$blocks=function(a,b,c){const d=Object.create(null);for(let e=0;e<a.inputList.length;e++){const f=a.inputList[e];for(let g=0;g<f.fieldRow.length;g++){const h=f.fieldRow[g];h.isSerializable()&&(d[h.name]=h.saveState(c))}}Object.keys(d).length&&(b.fields=d)};\nsaveInputBlocks$$module$build$src$core$serialization$blocks=function(a,b,c,d){const e=Object.create(null);for(let f=0;f<a.inputList.length;f++){const g=a.inputList[f];if(!g.connection)continue;const h=saveConnection$$module$build$src$core$serialization$blocks(g.connection,c,d);h&&(e[g.name]=h)}Object.keys(e).length&&(b.inputs=e)};\nsaveNextBlocks$$module$build$src$core$serialization$blocks=function(a,b,c,d){a.nextConnection&&(a=saveConnection$$module$build$src$core$serialization$blocks(a.nextConnection,c,d))&&(b.next=a)};saveConnection$$module$build$src$core$serialization$blocks=function(a,b,c){const d=a.getShadowState(!0);a=a.targetBlock();if(!d&&!a)return null;const e=Object.create(null);d&&(e.shadow=d);a&&!a.isShadow()&&(e.block=save$$module$build$src$core$serialization$blocks(a,{doFullSerialization:b,saveIds:c}));return e};\nappend$$module$build$src$core$serialization$blocks=function(a,b,{recordUndo:c=!1}={}){a=appendInternal$$module$build$src$core$serialization$blocks(a,b,{recordUndo:c});b.rendered&&triggerQueuedRenders$$module$build$src$core$render_management();return a};\nappendInternal$$module$build$src$core$serialization$blocks=function(a,b,{parentConnection:c,isShadow:d=!1,recordUndo:e=!1}={}){const f=getRecordUndo$$module$build$src$core$events$utils();setRecordUndo$$module$build$src$core$events$utils(e);(e=$.getGroup$$module$build$src$core$events$utils())||$.setGroup$$module$build$src$core$events$utils(!0);$.disable$$module$build$src$core$events$utils();let g;try{g=appendPrivate$$module$build$src$core$serialization$blocks(a,b,{parentConnection:c,isShadow:d})}finally{$.enable$$module$build$src$core$events$utils()}isEnabled$$module$build$src$core$events$utils()&&\nfire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(g));$.setGroup$$module$build$src$core$events$utils(e);setRecordUndo$$module$build$src$core$events$utils(f);if(b.rendered){const h=g;setTimeout(()=>{h.disposed||h.setConnectionTracking(!0)},1)}return g};\nappendPrivate$$module$build$src$core$serialization$blocks=function(a,b,{parentConnection:c,isShadow:d=!1}={}){if(!a.type)throw new MissingBlockType$$module$build$src$core$serialization$exceptions(a);const e=b.newBlock(a.type,a.id);e.setShadow(d);loadCoords$$module$build$src$core$serialization$blocks(e,a);loadAttributes$$module$build$src$core$serialization$blocks(e,a);loadExtraState$$module$build$src$core$serialization$blocks(e,a);tryToConnectParent$$module$build$src$core$serialization$blocks(c,e,\na);loadIcons$$module$build$src$core$serialization$blocks(e,a);loadFields$$module$build$src$core$serialization$blocks(e,a);loadInputBlocks$$module$build$src$core$serialization$blocks(e,a);loadNextBlocks$$module$build$src$core$serialization$blocks(e,a);initBlock$$module$build$src$core$serialization$blocks(e,b.rendered);return e};loadCoords$$module$build$src$core$serialization$blocks=function(a,b){let c=void 0===b.x?0:b.x;b=void 0===b.y?0:b.y;const d=a.workspace;c=d.RTL?d.getWidth()-c:c;a.moveBy(c,b)};\nloadAttributes$$module$build$src$core$serialization$blocks=function(a,b){b.collapsed&&a.setCollapsed(!0);!1===b.deletable&&a.setDeletable(!1);!1===b.movable&&a.setMovable(!1);!1===b.editable&&a.setEditable(!1);!1===b.enabled&&a.setEnabled(!1);void 0!==b.inline&&a.setInputsInline(b.inline);void 0!==b.data&&(a.data=b.data)};loadExtraState$$module$build$src$core$serialization$blocks=function(a,b){b.extraState&&(a.loadExtraState?a.loadExtraState(b.extraState):a.domToMutation&&a.domToMutation($.textToDom$$module$build$src$core$utils$xml(b.extraState)))};\ntryToConnectParent$$module$build$src$core$serialization$blocks=function(a,b,c){if(a){if(a.getSourceBlock().isShadow()&&!b.isShadow())throw new RealChildOfShadow$$module$build$src$core$serialization$exceptions(c);if(a.type===$.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var d=b.outputConnection;if(!d)throw new MissingConnection$$module$build$src$core$serialization$exceptions(\"output\",b,c);}else if(d=b.previousConnection,!d)throw new MissingConnection$$module$build$src$core$serialization$exceptions(\"previous\",\nb,c);if(!a.connect(d)){const e=b.workspace.connectionChecker;throw new BadConnectionCheck$$module$build$src$core$serialization$exceptions(e.getErrorMessage(e.canConnectWithReason(d,a,!1),d,a),a.type===$.inputTypes$$module$build$src$core$inputs$input_types.VALUE?\"output connection\":\"previous connection\",b,c);}}};\nloadIcons$$module$build$src$core$serialization$blocks=function(a,b){if(b.icons){var c=Object.keys(b.icons);for(const e of c){c=b.icons[e];var d=a.getIcon(e);if(!d){d=getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.ICON,e,!1);if(!d)throw new UnregisteredIcon$$module$build$src$core$serialization$exceptions(e,a,b);d=new d(a);a.addIcon(d)}isSerializable$$module$build$src$core$interfaces$i_serializable(d)&&d.loadState(c)}}};\nloadFields$$module$build$src$core$serialization$blocks=function(a,b){if(b.fields){var c=Object.keys(b.fields);for(let d=0;d<c.length;d++){const e=c[d],f=b.fields[e],g=a.getField(e);g?g.loadState(f):console.warn(`Ignoring non-existant field ${e} in block ${a.type}`)}}};\nloadInputBlocks$$module$build$src$core$serialization$blocks=function(a,b){if(b.inputs){var c=Object.keys(b.inputs);for(let d=0;d<c.length;d++){const e=c[d],f=a.getInput(e);if(!f||!f.connection)throw new MissingConnection$$module$build$src$core$serialization$exceptions(e,a,b);loadConnection$$module$build$src$core$serialization$blocks(f.connection,b.inputs[e])}}};\nloadNextBlocks$$module$build$src$core$serialization$blocks=function(a,b){if(b.next){if(!a.nextConnection)throw new MissingConnection$$module$build$src$core$serialization$exceptions(\"next\",a,b);loadConnection$$module$build$src$core$serialization$blocks(a.nextConnection,b.next)}};loadConnection$$module$build$src$core$serialization$blocks=function(a,b){b.shadow&&a.setShadowState(b.shadow);b.block&&appendPrivate$$module$build$src$core$serialization$blocks(b.block,a.getSourceBlock().workspace,{parentConnection:a})};\ninitBlock$$module$build$src$core$serialization$blocks=function(a,b){if(b){a.setConnectionTracking(!1);a.initSvg();a.queueRender();for(const c of a.getIcons())c.onLocationChange(a.getRelativeToSurfaceXY())}else a.initModel()};\nmoveBlockToNotConflict$$module$build$src$core$clipboard$block_paster=function(a){const b=a.workspace,c=$.config$$module$build$src$core$config.snapRadius,d=a.getRelativeToSurfaceXY(),e=new Coordinate$$module$build$src$core$utils$coordinate(0,0),f=b.getAllBlocks(!1).filter(g=>g.id!=a.id).map(g=>g.getRelativeToSurfaceXY());for(;blockOverlapsOtherExactly$$module$build$src$core$clipboard$block_paster(Coordinate$$module$build$src$core$utils$coordinate.sum(d,e),f)||blockIsInSnapRadius$$module$build$src$core$clipboard$block_paster(a,\ne,c);)b.RTL?e.translate(-c,2*c):e.translate(c,2*c);a.moveTo(Coordinate$$module$build$src$core$utils$coordinate.sum(d,e))};blockOverlapsOtherExactly$$module$build$src$core$clipboard$block_paster=function(a,b){return b.some(c=>1>=Math.abs(c.x-a.x)&&1>=Math.abs(c.y-a.y))};blockIsInSnapRadius$$module$build$src$core$clipboard$block_paster=function(a,b,c){return a.getConnections_(!1).some(d=>!!d.closest(c,b).connection)};\ncopy$$module$build$src$core$clipboard=function(a){warn$$module$build$src$core$utils$deprecation(\"Blockly.clipboard.copy\",\"v11\",\"v12\",\"myCopyable.toCopyData()\");return TEST_ONLY$$module$build$src$core$clipboard.copyInternal(a)};copyInternal$$module$build$src$core$clipboard=function(a){const b=a.toCopyData();stashedCopyData$$module$build$src$core$clipboard=b;let c;stashedWorkspace$$module$build$src$core$clipboard=null!=(c=a.workspace)?c:null;return b};\npaste$$module$build$src$core$clipboard=function(a,b,c){return a&&b?pasteFromData$$module$build$src$core$clipboard(a,b,c):stashedCopyData$$module$build$src$core$clipboard&&stashedWorkspace$$module$build$src$core$clipboard?pasteFromData$$module$build$src$core$clipboard(stashedCopyData$$module$build$src$core$clipboard,stashedWorkspace$$module$build$src$core$clipboard):null};\npasteFromData$$module$build$src$core$clipboard=function(a,b,c){let d;b=null!=(d=b.getRootWorkspace())?d:b;let e,f;return null!=(f=null==(e=getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.PASTER,a.paster,!1))?void 0:e.paste(a,b,c))?f:null};duplicate$$module$build$src$core$clipboard=function(a){warn$$module$build$src$core$utils$deprecation(\"Blockly.clipboard.duplicate\",\"v11\",\"v12\",\"Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)\");return TEST_ONLY$$module$build$src$core$clipboard.duplicateInternal(a)};\nduplicateInternal$$module$build$src$core$clipboard=function(a){const b=a.toCopyData();return b?paste$$module$build$src$core$clipboard(b,a.workspace):null};setRole$$module$build$src$core$utils$aria=function(a,b){a.setAttribute(ROLE_ATTRIBUTE$$module$build$src$core$utils$aria,b)};setState$$module$build$src$core$utils$aria=function(a,b,c){Array.isArray(c)&&(c=c.join(\" \"));a.setAttribute(ARIA_PREFIX$$module$build$src$core$utils$aria+b,`${c}`)};getDiv$$module$build$src$core$widgetdiv=function(){return containerDiv$$module$build$src$core$widgetdiv};\ntestOnly_setDiv$$module$build$src$core$widgetdiv=function(a){containerDiv$$module$build$src$core$widgetdiv=a;if(null===a){let b;null==(b=document.querySelector(\".\"+containerClassName$$module$build$src$core$widgetdiv))||b.remove()}};\ncreateDom$$module$build$src$core$widgetdiv=function(){document.querySelector(\".\"+containerClassName$$module$build$src$core$widgetdiv)||(containerDiv$$module$build$src$core$widgetdiv=document.createElement(\"div\"),containerDiv$$module$build$src$core$widgetdiv.className=containerClassName$$module$build$src$core$widgetdiv,(getParentContainer$$module$build$src$core$common()||document.body).appendChild(containerDiv$$module$build$src$core$widgetdiv))};\nshow$$module$build$src$core$widgetdiv=function(a,b,c){hide$$module$build$src$core$widgetdiv();owner$$module$build$src$core$widgetdiv=a;dispose$$module$build$src$core$widgetdiv=c;if(a=containerDiv$$module$build$src$core$widgetdiv)a.style.direction=b?\"rtl\":\"ltr\",a.style.display=\"block\",b=getMainWorkspace$$module$build$src$core$common(),rendererClassName$$module$build$src$core$widgetdiv=b.getRenderer().getClassName(),themeClassName$$module$build$src$core$widgetdiv=b.getTheme().getClassName(),rendererClassName$$module$build$src$core$widgetdiv&&\naddClass$$module$build$src$core$utils$dom(a,rendererClassName$$module$build$src$core$widgetdiv),themeClassName$$module$build$src$core$widgetdiv&&addClass$$module$build$src$core$utils$dom(a,themeClassName$$module$build$src$core$widgetdiv)};\nhide$$module$build$src$core$widgetdiv=function(){if(isVisible$$module$build$src$core$widgetdiv()){owner$$module$build$src$core$widgetdiv=null;var a=containerDiv$$module$build$src$core$widgetdiv;a&&(a.style.display=\"none\",a.style.left=\"\",a.style.top=\"\",dispose$$module$build$src$core$widgetdiv&&dispose$$module$build$src$core$widgetdiv(),dispose$$module$build$src$core$widgetdiv=null,a.textContent=\"\",rendererClassName$$module$build$src$core$widgetdiv&&(removeClass$$module$build$src$core$utils$dom(a,rendererClassName$$module$build$src$core$widgetdiv),\nrendererClassName$$module$build$src$core$widgetdiv=\"\"),themeClassName$$module$build$src$core$widgetdiv&&(removeClass$$module$build$src$core$utils$dom(a,themeClassName$$module$build$src$core$widgetdiv),themeClassName$$module$build$src$core$widgetdiv=\"\"),getMainWorkspace$$module$build$src$core$common().markFocused())}};isVisible$$module$build$src$core$widgetdiv=function(){return!!owner$$module$build$src$core$widgetdiv};\nhideIfOwner$$module$build$src$core$widgetdiv=function(a){owner$$module$build$src$core$widgetdiv===a&&hide$$module$build$src$core$widgetdiv()};positionInternal$$module$build$src$core$widgetdiv=function(a,b,c){containerDiv$$module$build$src$core$widgetdiv.style.left=a+\"px\";containerDiv$$module$build$src$core$widgetdiv.style.top=b+\"px\";containerDiv$$module$build$src$core$widgetdiv.style.height=c+\"px\"};\npositionWithAnchor$$module$build$src$core$widgetdiv=function(a,b,c,d){const e=calculateY$$module$build$src$core$widgetdiv(a,b,c);a=calculateX$$module$build$src$core$widgetdiv(a,b,c,d);0>e?positionInternal$$module$build$src$core$widgetdiv(a,0,c.height+e):positionInternal$$module$build$src$core$widgetdiv(a,e,c.height)};calculateX$$module$build$src$core$widgetdiv=function(a,b,c,d){return d?Math.min(Math.max(b.right-c.width,a.left),a.right-c.width):Math.max(Math.min(b.left,a.right-c.width),a.left)};\ncalculateY$$module$build$src$core$widgetdiv=function(a,b,c){return b.bottom+c.height>=a.bottom?b.top-c.height:b.bottom};isRepositionable$$module$build$src$core$widgetdiv=function(a){return!(null==a||!a.repositionForWindowResize)};repositionForWindowResize$$module$build$src$core$widgetdiv=function(){isRepositionable$$module$build$src$core$widgetdiv(owner$$module$build$src$core$widgetdiv)&&owner$$module$build$src$core$widgetdiv.repositionForWindowResize()||hide$$module$build$src$core$widgetdiv()};\ngetCurrentBlock$$module$build$src$core$contextmenu=function(){return currentBlock$$module$build$src$core$contextmenu};setCurrentBlock$$module$build$src$core$contextmenu=function(a){currentBlock$$module$build$src$core$contextmenu=a};\nshow$$module$build$src$core$contextmenu=function(a,b,c){show$$module$build$src$core$widgetdiv(dummyOwner$$module$build$src$core$contextmenu,c,dispose$$module$build$src$core$contextmenu);if(b.length){var d=populate_$$module$build$src$core$contextmenu(b,c);menu_$$module$build$src$core$contextmenu=d;position_$$module$build$src$core$contextmenu(d,a,c);setTimeout(function(){d.focus()},1);currentBlock$$module$build$src$core$contextmenu=null}else hide$$module$build$src$core$contextmenu()};\npopulate_$$module$build$src$core$contextmenu=function(a,b){const c=new Menu$$module$build$src$core$menu;c.setRole(Role$$module$build$src$core$utils$aria.MENU);for(let d=0;d<a.length;d++){const e=a[d],f=new MenuItem$$module$build$src$core$menuitem(e.text);f.setRightToLeft(b);f.setRole(Role$$module$build$src$core$utils$aria.MENUITEM);c.addChild(f);f.setEnabled(e.enabled);if(e.enabled)f.onAction(function(){hide$$module$build$src$core$contextmenu();requestAnimationFrame(()=>{setTimeout(()=>{e.callback(e.scope)},\n0)})},{})}return c};position_$$module$build$src$core$contextmenu=function(a,b,c){const d=getViewportBBox$$module$build$src$core$utils$svg_math();b=new Rect$$module$build$src$core$utils$rect(b.clientY+d.top,b.clientY+d.top,b.clientX+d.left,b.clientX+d.left);createWidget_$$module$build$src$core$contextmenu(a);const e=a.getSize();c&&(b.left+=e.width,b.right+=e.width,d.left+=e.width,d.right+=e.width);positionWithAnchor$$module$build$src$core$widgetdiv(d,b,e,c);a.focus()};\ncreateWidget_$$module$build$src$core$contextmenu=function(a){var b=getDiv$$module$build$src$core$widgetdiv();if(!b)throw Error(\"Attempting to create a context menu when widget div is null\");b=a.render(b);addClass$$module$build$src$core$utils$dom(b,\"blocklyContextMenu\");conditionalBind$$module$build$src$core$browser_events(b,\"contextmenu\",null,haltPropagation$$module$build$src$core$contextmenu);a.focus()};haltPropagation$$module$build$src$core$contextmenu=function(a){a.preventDefault();a.stopPropagation()};\nhide$$module$build$src$core$contextmenu=function(){hideIfOwner$$module$build$src$core$widgetdiv(dummyOwner$$module$build$src$core$contextmenu);currentBlock$$module$build$src$core$contextmenu=null};dispose$$module$build$src$core$contextmenu=function(){menu_$$module$build$src$core$contextmenu&&(menu_$$module$build$src$core$contextmenu.dispose(),menu_$$module$build$src$core$contextmenu=null)};\n$.callbackFactory$$module$build$src$core$contextmenu=function(a,b){return()=>{$.disable$$module$build$src$core$events$utils();let c;try{c=b instanceof Element?domToBlockInternal$$module$build$src$core$xml(b,a.workspace):appendInternal$$module$build$src$core$serialization$blocks(b,a.workspace);const d=a.getRelativeToSurfaceXY();d.x=a.RTL?d.x-$.config$$module$build$src$core$config.snapRadius:d.x+$.config$$module$build$src$core$config.snapRadius;d.y+=2*$.config$$module$build$src$core$config.snapRadius;\nc.moveBy(d.x,d.y)}finally{$.enable$$module$build$src$core$events$utils()}isEnabled$$module$build$src$core$events$utils()&&!c.isShadow()&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(c));c.select();return c}};\ncommentDeleteOption$$module$build$src$core$contextmenu=function(a){return{text:$.Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function(){$.setGroup$$module$build$src$core$events$utils(!0);a.dispose();$.setGroup$$module$build$src$core$events$utils(!1)}}};\ncommentDuplicateOption$$module$build$src$core$contextmenu=function(a){return{text:$.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){const b=a.toCopyData();b&&paste$$module$build$src$core$clipboard(b,a.workspace)}}};\nworkspaceCommentOption$$module$build$src$core$contextmenu=function(a,b){const c={enabled:!0};c.text=$.Msg$$module$build$src$core$msg.ADD_COMMENT;c.callback=function(){const d=new WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg(a,$.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.DEFAULT_SIZE,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.DEFAULT_SIZE);var e=a.getInjectionDiv().getBoundingClientRect();\ne=new Coordinate$$module$build$src$core$utils$coordinate(b.clientX-e.left,b.clientY-e.top);const f=a.getOriginOffsetInPixels();e=Coordinate$$module$build$src$core$utils$coordinate.difference(e,f);e.scale(1/a.scale);d.moveBy(e.x,e.y);a.rendered&&(d.initSvg(),d.render(),d.select())};return c};toRadians$$module$build$src$core$utils$math=function(a){return a*Math.PI/180};toDegrees$$module$build$src$core$utils$math=function(a){return 180*a/Math.PI};\nclamp$$module$build$src$core$utils$math=function(a,b,c){if(c<a){const d=c;c=a;a=d}return Math.max(a,Math.min(b,c))};\ncreateDom$$module$build$src$core$dropdowndiv=function(){document.querySelector(\".blocklyDropDownDiv\")||(div$$module$build$src$core$dropdowndiv=document.createElement(\"div\"),div$$module$build$src$core$dropdowndiv.className=\"blocklyDropDownDiv\",(getParentContainer$$module$build$src$core$common()||document.body).appendChild(div$$module$build$src$core$dropdowndiv),content$$module$build$src$core$dropdowndiv=document.createElement(\"div\"),content$$module$build$src$core$dropdowndiv.className=\"blocklyDropDownContent\",\ndiv$$module$build$src$core$dropdowndiv.appendChild(content$$module$build$src$core$dropdowndiv),arrow$$module$build$src$core$dropdowndiv=document.createElement(\"div\"),arrow$$module$build$src$core$dropdowndiv.className=\"blocklyDropDownArrow\",div$$module$build$src$core$dropdowndiv.appendChild(arrow$$module$build$src$core$dropdowndiv),div$$module$build$src$core$dropdowndiv.style.opacity=\"0\",div$$module$build$src$core$dropdowndiv.style.transition=\"transform \"+ANIMATION_TIME$$module$build$src$core$dropdowndiv+\n\"s, opacity \"+ANIMATION_TIME$$module$build$src$core$dropdowndiv+\"s\",div$$module$build$src$core$dropdowndiv.addEventListener(\"focusin\",function(){addClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,\"blocklyFocused\")}),div$$module$build$src$core$dropdowndiv.addEventListener(\"focusout\",function(){removeClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,\"blocklyFocused\")}))};\nsetBoundsElement$$module$build$src$core$dropdowndiv=function(a){boundsElement$$module$build$src$core$dropdowndiv=a};getOwner$$module$build$src$core$dropdowndiv=function(){return owner$$module$build$src$core$dropdowndiv};getContentDiv$$module$build$src$core$dropdowndiv=function(){return content$$module$build$src$core$dropdowndiv};\nclearContent$$module$build$src$core$dropdowndiv=function(){content$$module$build$src$core$dropdowndiv.textContent=\"\";content$$module$build$src$core$dropdowndiv.style.width=\"\"};setColour$$module$build$src$core$dropdowndiv=function(a,b){div$$module$build$src$core$dropdowndiv.style.backgroundColor=a;div$$module$build$src$core$dropdowndiv.style.borderColor=b};\nshowPositionedByBlock$$module$build$src$core$dropdowndiv=function(a,b,c,d){return showPositionedByRect$$module$build$src$core$dropdowndiv(getScaledBboxOfBlock$$module$build$src$core$dropdowndiv(b),a,c,d)};showPositionedByField$$module$build$src$core$dropdowndiv=function(a,b,c){positionToField$$module$build$src$core$dropdowndiv=!0;return showPositionedByRect$$module$build$src$core$dropdowndiv(getScaledBboxOfField$$module$build$src$core$dropdowndiv(a),a,b,c)};\ngetScaledBboxOfBlock$$module$build$src$core$dropdowndiv=function(a){var b=a.getSvgRoot();const c=a.workspace.scale,d=a.height*c;a=a.width*c;b=getPageOffset$$module$build$src$core$utils$style(b);return new Rect$$module$build$src$core$utils$rect(b.y,b.y+d,b.x,b.x+a)};getScaledBboxOfField$$module$build$src$core$dropdowndiv=function(a){a=a.getScaledBBox();return new Rect$$module$build$src$core$utils$rect(a.top,a.bottom,a.left,a.right)};\nshowPositionedByRect$$module$build$src$core$dropdowndiv=function(a,b,c,d){const e=a.left+(a.right-a.left)/2,f=a.bottom;a=a.top;d&&(a+=d);d=b.getSourceBlock();let g=d.workspace;for(;g.options.parentWorkspace;)g=g.options.parentWorkspace;setBoundsElement$$module$build$src$core$dropdowndiv(g.getParentSvg().parentNode);return show$$module$build$src$core$dropdowndiv(b,d.RTL,e,f,e,a,c)};\nshow$$module$build$src$core$dropdowndiv=function(a,b,c,d,e,f,g){owner$$module$build$src$core$dropdowndiv=a;onHide$$module$build$src$core$dropdowndiv=g||null;div$$module$build$src$core$dropdowndiv.style.direction=b?\"rtl\":\"ltr\";a=getMainWorkspace$$module$build$src$core$common();renderedClassName$$module$build$src$core$dropdowndiv=a.getRenderer().getClassName();themeClassName$$module$build$src$core$dropdowndiv=a.getTheme().getClassName();renderedClassName$$module$build$src$core$dropdowndiv&&addClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,\nrenderedClassName$$module$build$src$core$dropdowndiv);themeClassName$$module$build$src$core$dropdowndiv&&addClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,themeClassName$$module$build$src$core$dropdowndiv);return positionInternal$$module$build$src$core$dropdowndiv(c,d,e,f)};\ngetPositionBelowMetrics$$module$build$src$core$dropdowndiv=function(a,b,c,d){a=getPositionX$$module$build$src$core$dropdowndiv(a,c.left,c.right,d.width);return{initialX:a.divX,initialY:b,finalX:a.divX,finalY:b+PADDING_Y$$module$build$src$core$dropdowndiv,arrowX:a.arrowX,arrowY:-(ARROW_SIZE$$module$build$src$core$dropdowndiv/2+BORDER_SIZE$$module$build$src$core$dropdowndiv),arrowAtTop:!0,arrowVisible:!0}};\ngetPositionAboveMetrics$$module$build$src$core$dropdowndiv=function(a,b,c,d){a=getPositionX$$module$build$src$core$dropdowndiv(a,c.left,c.right,d.width);return{initialX:a.divX,initialY:b-d.height,finalX:a.divX,finalY:b-d.height-PADDING_Y$$module$build$src$core$dropdowndiv,arrowX:a.arrowX,arrowY:d.height-2*BORDER_SIZE$$module$build$src$core$dropdowndiv-ARROW_SIZE$$module$build$src$core$dropdowndiv/2,arrowAtTop:!1,arrowVisible:!0}};\ngetPositionTopOfPageMetrics$$module$build$src$core$dropdowndiv=function(a,b,c){a=getPositionX$$module$build$src$core$dropdowndiv(a,b.left,b.right,c.width);return{initialX:a.divX,initialY:0,finalX:a.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}};\ngetPositionX$$module$build$src$core$dropdowndiv=function(a,b,c,d){b=clamp$$module$build$src$core$utils$math(b,a-d/2,c-d);a=a-ARROW_SIZE$$module$build$src$core$dropdowndiv/2-b;c=ARROW_HORIZONTAL_PADDING$$module$build$src$core$dropdowndiv;a=clamp$$module$build$src$core$utils$math(c,a,d-c-ARROW_SIZE$$module$build$src$core$dropdowndiv);return{arrowX:a,divX:b}};isVisible$$module$build$src$core$dropdowndiv=function(){return!!owner$$module$build$src$core$dropdowndiv};\nhideIfOwner$$module$build$src$core$dropdowndiv=function(a,b){return owner$$module$build$src$core$dropdowndiv===a?(b?hideWithoutAnimation$$module$build$src$core$dropdowndiv():hide$$module$build$src$core$dropdowndiv(),!0):!1};\nhide$$module$build$src$core$dropdowndiv=function(){div$$module$build$src$core$dropdowndiv.style.transform=\"translate(0, 0)\";div$$module$build$src$core$dropdowndiv.style.opacity=\"0\";animateOutTimer$$module$build$src$core$dropdowndiv=setTimeout(function(){hideWithoutAnimation$$module$build$src$core$dropdowndiv()},1E3*ANIMATION_TIME$$module$build$src$core$dropdowndiv);onHide$$module$build$src$core$dropdowndiv&&(onHide$$module$build$src$core$dropdowndiv(),onHide$$module$build$src$core$dropdowndiv=null)};\nhideWithoutAnimation$$module$build$src$core$dropdowndiv=function(){isVisible$$module$build$src$core$dropdowndiv()&&(animateOutTimer$$module$build$src$core$dropdowndiv&&clearTimeout(animateOutTimer$$module$build$src$core$dropdowndiv),div$$module$build$src$core$dropdowndiv.style.transform=\"\",div$$module$build$src$core$dropdowndiv.style.left=\"\",div$$module$build$src$core$dropdowndiv.style.top=\"\",div$$module$build$src$core$dropdowndiv.style.opacity=\"0\",div$$module$build$src$core$dropdowndiv.style.display=\n\"none\",div$$module$build$src$core$dropdowndiv.style.backgroundColor=\"\",div$$module$build$src$core$dropdowndiv.style.borderColor=\"\",onHide$$module$build$src$core$dropdowndiv&&(onHide$$module$build$src$core$dropdowndiv(),onHide$$module$build$src$core$dropdowndiv=null),clearContent$$module$build$src$core$dropdowndiv(),owner$$module$build$src$core$dropdowndiv=null,renderedClassName$$module$build$src$core$dropdowndiv&&(removeClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,\nrenderedClassName$$module$build$src$core$dropdowndiv),renderedClassName$$module$build$src$core$dropdowndiv=\"\"),themeClassName$$module$build$src$core$dropdowndiv&&(removeClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,themeClassName$$module$build$src$core$dropdowndiv),themeClassName$$module$build$src$core$dropdowndiv=\"\"),getMainWorkspace$$module$build$src$core$common().markFocused())};\npositionInternal$$module$build$src$core$dropdowndiv=function(a,b,c,d){a=internal$$module$build$src$core$dropdowndiv.getPositionMetrics(a,b,c,d);a.arrowVisible?(arrow$$module$build$src$core$dropdowndiv.style.display=\"\",arrow$$module$build$src$core$dropdowndiv.style.transform=\"translate(\"+a.arrowX+\"px,\"+a.arrowY+\"px) rotate(45deg)\",arrow$$module$build$src$core$dropdowndiv.setAttribute(\"class\",a.arrowAtTop?\"blocklyDropDownArrow blocklyArrowTop\":\"blocklyDropDownArrow blocklyArrowBottom\")):arrow$$module$build$src$core$dropdowndiv.style.display=\n\"none\";b=Math.floor(a.initialX);c=Math.floor(a.initialY);d=Math.floor(a.finalX);const e=Math.floor(a.finalY);div$$module$build$src$core$dropdowndiv.style.left=b+\"px\";div$$module$build$src$core$dropdowndiv.style.top=c+\"px\";div$$module$build$src$core$dropdowndiv.style.display=\"block\";div$$module$build$src$core$dropdowndiv.style.opacity=\"1\";div$$module$build$src$core$dropdowndiv.style.transform=\"translate(\"+(d-b)+\"px,\"+(e-c)+\"px)\";return!!a.arrowAtTop};\nrepositionForWindowResize$$module$build$src$core$dropdowndiv=function(){if(owner$$module$build$src$core$dropdowndiv){var a=owner$$module$build$src$core$dropdowndiv.getSourceBlock();a=positionToField$$module$build$src$core$dropdowndiv?getScaledBboxOfField$$module$build$src$core$dropdowndiv(owner$$module$build$src$core$dropdowndiv):getScaledBboxOfBlock$$module$build$src$core$dropdowndiv(a);const b=a.left+(a.right-a.left)/2;positionInternal$$module$build$src$core$dropdowndiv(b,a.bottom,b,a.top)}else hide$$module$build$src$core$dropdowndiv()};\ndisposeUiEffect$$module$build$src$core$block_animations=function(a){if(!(100<a.getDescendants(!1).length)){var b=a.workspace,c=a.getSvgRoot();b.getAudioManager().play(\"delete\");var d=b.getSvgXY(c);c=c.cloneNode(!0);c.setAttribute(\"transform\",\"translate(\"+d.x+\",\"+d.y+\")\");b.getParentSvg().appendChild(c);disposeUiStep$$module$build$src$core$block_animations(c,{x:d.x,y:d.y,width:a.width,height:a.height},b.RTL,new Date,b.scale)}};\ndisposeUiStep$$module$build$src$core$block_animations=function(a,b,c,d,e){const f=((new Date).getTime()-d.getTime())/150;1<f?removeNode$$module$build$src$core$utils$dom(a):(a.setAttribute(\"transform\",\"translate(\"+(b.x+(c?-1:1)*b.width*e/2*f)+\",\"+(b.y+b.height*e*f)+\") scale(\"+(1-f)*e+\")\"),setTimeout(disposeUiStep$$module$build$src$core$block_animations,10,a,b,c,d,e))};\nconnectionUiEffect$$module$build$src$core$block_animations=function(a){var b=a.workspace;const c=b.scale;b.getAudioManager().play(\"click\");if(!(1>c)){var d=b.getSvgXY(a.getSvgRoot());a.outputConnection?(d.x+=(a.RTL?3:-3)*c,d.y+=13*c):a.previousConnection&&(d.x+=(a.RTL?-23:23)*c,d.y+=3*c);var e=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{cx:d.x,cy:d.y,r:0,fill:\"none\",stroke:\"#888\",\"stroke-width\":10},b.getParentSvg());a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,\n{id:\"animationCircle\",begin:\"indefinite\",attributeName:\"r\",dur:\"150ms\",from:0,to:25*c},e);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,{id:\"animationOpacity\",begin:\"indefinite\",attributeName:\"opacity\",dur:\"150ms\",from:1,to:0},e);a.beginElement();b.beginElement();setTimeout(()=>void removeNode$$module$build$src$core$utils$dom(e),150)}};\ndisconnectUiEffect$$module$build$src$core$block_animations=function(a){disconnectUiStop$$module$build$src$core$block_animations();a.workspace.getAudioManager().play(\"disconnect\");if(!(1>a.workspace.scale)){var b=a.getHeightWidth().height;b=Math.atan(10/b)/Math.PI*180;a.RTL||(b*=-1);wobblingBlock$$module$build$src$core$block_animations=a;disconnectUiStep$$module$build$src$core$block_animations(a,b,new Date)}};\ndisconnectUiStep$$module$build$src$core$block_animations=function(a,b,c){const d=((new Date).getTime()-c.getTime())/200;let e=\"\";1>=d&&(e=`skewX(${Math.round(Math.sin(d*Math.PI*3)*(1-d)*b)})`,disconnectPid$$module$build$src$core$block_animations=setTimeout(disconnectUiStep$$module$build$src$core$block_animations,10,a,b,c));a.getSvgRoot().setAttribute(\"transform\",`${a.getTranslation()} ${e}`)};\ndisconnectUiStop$$module$build$src$core$block_animations=function(){wobblingBlock$$module$build$src$core$block_animations&&(disconnectPid$$module$build$src$core$block_animations&&(clearTimeout(disconnectPid$$module$build$src$core$block_animations),disconnectPid$$module$build$src$core$block_animations=null),wobblingBlock$$module$build$src$core$block_animations.getSvgRoot().setAttribute(\"transform\",wobblingBlock$$module$build$src$core$block_animations.getTranslation()),wobblingBlock$$module$build$src$core$block_animations=\nnull)};startsWith$$module$build$src$core$utils$string=function(a,b){warn$$module$build$src$core$utils$deprecation(\"Blockly.utils.string.startsWith()\",\"April 2022\",\"April 2023\",\"Use built-in string.startsWith\");return a.startsWith(b)};shortestStringLength$$module$build$src$core$utils$string=function(a){return a.length?a.reduce(function(b,c){return b.length<c.length?b:c}).length:0};\ncommonWordPrefix$$module$build$src$core$utils$string=function(a,b){if(!a.length)return 0;if(1===a.length)return a[0].length;let c=0;b=b||shortestStringLength$$module$build$src$core$utils$string(a);let d;for(d=0;d<b;d++){var e=a[0][d];for(var f=1;f<a.length;f++)if(e!==a[f][d])return c;\" \"===e&&(c=d+1)}for(e=1;e<a.length;e++)if((f=a[e][d])&&\" \"!==f)return c;return b};\ncommonWordSuffix$$module$build$src$core$utils$string=function(a,b){if(!a.length)return 0;if(1===a.length)return a[0].length;let c=0;b=b||shortestStringLength$$module$build$src$core$utils$string(a);let d;for(d=0;d<b;d++){var e=a[0].substr(-d-1,1);for(var f=1;f<a.length;f++)if(e!==a[f].substr(-d-1,1))return c;\" \"===e&&(c=d+1)}for(e=1;e<a.length;e++)if((f=a[e].charAt(a[e].length-d-1))&&\" \"!==f)return c;return b};\n$.wrap$$module$build$src$core$utils$string=function(a,b){a=a.split(\"\\n\");for(let c=0;c<a.length;c++)a[c]=wrapLine$$module$build$src$core$utils$string(a[c],b);return a.join(\"\\n\")};\nwrapLine$$module$build$src$core$utils$string=function(a,b){if(a.length<=b)return a;const c=a.trim().split(/\\s+/);for(var d=0;d<c.length;d++)c[d].length>b&&(b=c[d].length);var e=-Infinity;let f,g=1;do{d=e;f=a;a=[];e=c.length/g;let h=1;for(let k=0;k<c.length-1;k++)h<(k+1.5)/e?(h++,a[k]=!0):a[k]=!1;a=wrapMutate$$module$build$src$core$utils$string(c,a,b);e=wrapScore$$module$build$src$core$utils$string(c,a,b);a=wrapToText$$module$build$src$core$utils$string(c,a);g++}while(e>d);return f};\nwrapScore$$module$build$src$core$utils$string=function(a,b,c){const d=[0],e=[];for(var f=0;f<a.length;f++)d[d.length-1]+=a[f].length,!0===b[f]?(d.push(0),e.push(a[f].charAt(a[f].length-1))):!1===b[f]&&d[d.length-1]++;a=Math.max(...d);b=0;for(f=0;f<d.length;f++)b-=2*Math.pow(Math.abs(c-d[f]),1.5),b-=Math.pow(a-d[f],1.5),-1!==\".?!\".indexOf(e[f])?b+=c/3:-1!==\",;)]}\".indexOf(e[f])&&(b+=c/4);1<d.length&&d[d.length-1]<=d[d.length-2]&&(b+=.5);return b};\nwrapMutate$$module$build$src$core$utils$string=function(a,b,c){let d=wrapScore$$module$build$src$core$utils$string(a,b,c),e;for(let f=0;f<b.length-1;f++){if(b[f]===b[f+1])continue;const g=[].concat(b);g[f]=!g[f];g[f+1]=!g[f+1];const h=wrapScore$$module$build$src$core$utils$string(a,g,c);h>d&&(d=h,e=g)}return e?wrapMutate$$module$build$src$core$utils$string(a,e,c):b};\nwrapToText$$module$build$src$core$utils$string=function(a,b){const c=[];for(let d=0;d<a.length;d++)c.push(a[d]),void 0!==b[d]&&c.push(b[d]?\"\\n\":\" \");return c.join(\"\")};$.isNumber$$module$build$src$core$utils$string=function(a){return/^\\s*-?\\d+(\\.\\d+)?\\s*$/.test(a)};setCustomTooltip$$module$build$src$core$tooltip=function(a){customTooltip$$module$build$src$core$tooltip=a};getCustomTooltip$$module$build$src$core$tooltip=function(){return customTooltip$$module$build$src$core$tooltip};\nisVisible$$module$build$src$core$tooltip=function(){return visible$$module$build$src$core$tooltip};getDiv$$module$build$src$core$tooltip=function(){return containerDiv$$module$build$src$core$tooltip};getTooltipOfObject$$module$build$src$core$tooltip=function(a){if(a=getTargetObject$$module$build$src$core$tooltip(a)){for(a=a.tooltip;\"function\"===typeof a;)a=a();if(\"string\"!==typeof a)throw Error(\"Tooltip function must return a string.\");return a}return\"\"};\ngetTargetObject$$module$build$src$core$tooltip=function(a){for(;a&&a.tooltip;){if(\"string\"===typeof a.tooltip||\"function\"===typeof a.tooltip)return a;a=a.tooltip}return null};createDom$$module$build$src$core$tooltip=function(){document.querySelector(\".blocklyTooltipDiv\")||(containerDiv$$module$build$src$core$tooltip=document.createElement(\"div\"),containerDiv$$module$build$src$core$tooltip.className=\"blocklyTooltipDiv\",(getParentContainer$$module$build$src$core$common()||document.body).appendChild(containerDiv$$module$build$src$core$tooltip))};\nbindMouseEvents$$module$build$src$core$tooltip=function(a){a.mouseOverWrapper_=bind$$module$build$src$core$browser_events(a,\"pointerover\",null,onMouseOver$$module$build$src$core$tooltip);a.mouseOutWrapper_=bind$$module$build$src$core$browser_events(a,\"pointerout\",null,onMouseOut$$module$build$src$core$tooltip);a.addEventListener(\"pointermove\",onMouseMove$$module$build$src$core$tooltip,!1)};\nunbindMouseEvents$$module$build$src$core$tooltip=function(a){a&&(unbind$$module$build$src$core$browser_events(a.mouseOverWrapper_),unbind$$module$build$src$core$browser_events(a.mouseOutWrapper_),a.removeEventListener(\"pointermove\",onMouseMove$$module$build$src$core$tooltip))};\nonMouseOver$$module$build$src$core$tooltip=function(a){blocked$$module$build$src$core$tooltip||(a=getTargetObject$$module$build$src$core$tooltip(a.currentTarget),element$$module$build$src$core$tooltip!==a&&(hide$$module$build$src$core$tooltip(),poisonedElement$$module$build$src$core$tooltip=null,element$$module$build$src$core$tooltip=a),clearTimeout(mouseOutPid$$module$build$src$core$tooltip))};\nonMouseOut$$module$build$src$core$tooltip=function(a){blocked$$module$build$src$core$tooltip||(mouseOutPid$$module$build$src$core$tooltip=setTimeout(function(){poisonedElement$$module$build$src$core$tooltip=element$$module$build$src$core$tooltip=null;hide$$module$build$src$core$tooltip()},1),clearTimeout(showPid$$module$build$src$core$tooltip),showPid$$module$build$src$core$tooltip=0)};\nonMouseMove$$module$build$src$core$tooltip=function(a){if(element$$module$build$src$core$tooltip&&element$$module$build$src$core$tooltip.tooltip&&!blocked$$module$build$src$core$tooltip)if(visible$$module$build$src$core$tooltip){const b=lastX$$module$build$src$core$tooltip-a.pageX;a=lastY$$module$build$src$core$tooltip-a.pageY;Math.sqrt(b*b+a*a)>RADIUS_OK$$module$build$src$core$tooltip&&hide$$module$build$src$core$tooltip()}else poisonedElement$$module$build$src$core$tooltip!==element$$module$build$src$core$tooltip&&\n(clearTimeout(showPid$$module$build$src$core$tooltip),lastX$$module$build$src$core$tooltip=a.pageX,lastY$$module$build$src$core$tooltip=a.pageY,showPid$$module$build$src$core$tooltip=setTimeout(show$$module$build$src$core$tooltip,HOVER_MS$$module$build$src$core$tooltip))};dispose$$module$build$src$core$tooltip=function(){poisonedElement$$module$build$src$core$tooltip=element$$module$build$src$core$tooltip=null;hide$$module$build$src$core$tooltip()};\nhide$$module$build$src$core$tooltip=function(){visible$$module$build$src$core$tooltip&&(visible$$module$build$src$core$tooltip=!1,containerDiv$$module$build$src$core$tooltip&&(containerDiv$$module$build$src$core$tooltip.style.display=\"none\"));showPid$$module$build$src$core$tooltip&&(clearTimeout(showPid$$module$build$src$core$tooltip),showPid$$module$build$src$core$tooltip=0)};\nblock$$module$build$src$core$tooltip=function(){hide$$module$build$src$core$tooltip();blocked$$module$build$src$core$tooltip=!0};unblock$$module$build$src$core$tooltip=function(){blocked$$module$build$src$core$tooltip=!1};\nrenderContent$$module$build$src$core$tooltip=function(){containerDiv$$module$build$src$core$tooltip&&element$$module$build$src$core$tooltip&&(\"function\"===typeof customTooltip$$module$build$src$core$tooltip?customTooltip$$module$build$src$core$tooltip(containerDiv$$module$build$src$core$tooltip,element$$module$build$src$core$tooltip):renderDefaultContent$$module$build$src$core$tooltip())};\nrenderDefaultContent$$module$build$src$core$tooltip=function(){var a=getTooltipOfObject$$module$build$src$core$tooltip(element$$module$build$src$core$tooltip);a=$.wrap$$module$build$src$core$utils$string(a,LIMIT$$module$build$src$core$tooltip);a=a.split(\"\\n\");for(let b=0;b<a.length;b++){const c=document.createElement(\"div\");c.appendChild(document.createTextNode(a[b]));containerDiv$$module$build$src$core$tooltip.appendChild(c)}};\ngetPosition$$module$build$src$core$tooltip=function(a){const b=document.documentElement.clientWidth,c=document.documentElement.clientHeight;let d=lastX$$module$build$src$core$tooltip;d=a?d-(OFFSET_X$$module$build$src$core$tooltip+containerDiv$$module$build$src$core$tooltip.offsetWidth):d+OFFSET_X$$module$build$src$core$tooltip;let e=lastY$$module$build$src$core$tooltip+OFFSET_Y$$module$build$src$core$tooltip;e+containerDiv$$module$build$src$core$tooltip.offsetHeight>c+window.scrollY&&(e-=containerDiv$$module$build$src$core$tooltip.offsetHeight+\n2*OFFSET_Y$$module$build$src$core$tooltip);a?d=Math.max(MARGINS$$module$build$src$core$tooltip-window.scrollX,d):d+containerDiv$$module$build$src$core$tooltip.offsetWidth>b+window.scrollX-2*MARGINS$$module$build$src$core$tooltip&&(d=b-containerDiv$$module$build$src$core$tooltip.offsetWidth-2*MARGINS$$module$build$src$core$tooltip);return{x:d,y:e}};\nshow$$module$build$src$core$tooltip=function(){if(!blocked$$module$build$src$core$tooltip&&(poisonedElement$$module$build$src$core$tooltip=element$$module$build$src$core$tooltip,containerDiv$$module$build$src$core$tooltip)){containerDiv$$module$build$src$core$tooltip.textContent=\"\";renderContent$$module$build$src$core$tooltip();var a=element$$module$build$src$core$tooltip.RTL;containerDiv$$module$build$src$core$tooltip.style.direction=a?\"rtl\":\"ltr\";containerDiv$$module$build$src$core$tooltip.style.display=\n\"block\";visible$$module$build$src$core$tooltip=!0;var {x:b,y:c}=getPosition$$module$build$src$core$tooltip(a);containerDiv$$module$build$src$core$tooltip.style.left=b+\"px\";containerDiv$$module$build$src$core$tooltip.style.top=c+\"px\"}};deepMerge$$module$build$src$core$utils$object=function(a,b){for(const c in b)a[c]=null!==b[c]&&\"object\"===typeof b[c]?deepMerge$$module$build$src$core$utils$object(a[c]||Object.create(null),b[c]):b[c];return a};\nhasBubble$$module$build$src$core$interfaces$i_has_bubble=function(a){return void 0!==a.bubbleIsVisible&&void 0!==a.setBubbleVisible};getHsvSaturation$$module$build$src$core$utils$colour=function(){return hsvSaturation$$module$build$src$core$utils$colour};setHsvSaturation$$module$build$src$core$utils$colour=function(a){hsvSaturation$$module$build$src$core$utils$colour=a};getHsvValue$$module$build$src$core$utils$colour=function(){return hsvValue$$module$build$src$core$utils$colour};\nsetHsvValue$$module$build$src$core$utils$colour=function(a){hsvValue$$module$build$src$core$utils$colour=a};\nparse$$module$build$src$core$utils$colour=function(a){a=`${a}`.toLowerCase().trim();var b=names$$module$build$src$core$utils$colour[a];if(b)return b;b=\"0x\"===a.substring(0,2)?\"#\"+a.substring(2):a;b=\"#\"===b[0]?b:\"#\"+b;if(/^#[0-9a-f]{6}$/.test(b))return b;if(/^#[0-9a-f]{3}$/.test(b))return[\"#\",b[1],b[1],b[2],b[2],b[3],b[3]].join(\"\");var c=a.match(/^(?:rgb)?\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);return c&&(a=Number(c[1]),b=Number(c[2]),c=Number(c[3]),0<=a&&256>a&&0<=b&&256>b&&0<=c&&256>c)?rgbToHex$$module$build$src$core$utils$colour(a,\nb,c):null};rgbToHex$$module$build$src$core$utils$colour=function(a,b,c){b=a<<16|b<<8|c;return 16>a?\"#\"+(16777216|b).toString(16).substr(1):\"#\"+b.toString(16)};hexToRgb$$module$build$src$core$utils$colour=function(a){a=parse$$module$build$src$core$utils$colour(a);if(!a)return[0,0,0];a=parseInt(a.substr(1),16);return[a>>16,a>>8&255,a&255]};\nhsvToHex$$module$build$src$core$utils$colour=function(a,b,c){let d=0,e=0,f=0;if(0===b)f=e=d=c;else{const g=Math.floor(a/60),h=a/60-g;a=c*(1-b);const k=c*(1-b*h);b=c*(1-b*(1-h));switch(g){case 1:d=k;e=c;f=a;break;case 2:d=a;e=c;f=b;break;case 3:d=a;e=k;f=c;break;case 4:d=b;e=a;f=c;break;case 5:d=c;e=a;f=k;break;case 6:case 0:d=c,e=b,f=a}}return rgbToHex$$module$build$src$core$utils$colour(Math.floor(d),Math.floor(e),Math.floor(f))};\nblend$$module$build$src$core$utils$colour=function(a,b,c){a=parse$$module$build$src$core$utils$colour(a);if(!a)return null;b=parse$$module$build$src$core$utils$colour(b);if(!b)return null;a=hexToRgb$$module$build$src$core$utils$colour(a);b=hexToRgb$$module$build$src$core$utils$colour(b);return rgbToHex$$module$build$src$core$utils$colour(Math.round(b[0]+c*(a[0]-b[0])),Math.round(b[1]+c*(a[1]-b[1])),Math.round(b[2]+c*(a[2]-b[2])))};\nhueToHex$$module$build$src$core$utils$colour=function(a){return hsvToHex$$module$build$src$core$utils$colour(a,hsvSaturation$$module$build$src$core$utils$colour,255*hsvValue$$module$build$src$core$utils$colour)};\ntokenizeInterpolationInternal$$module$build$src$core$utils$parsing=function(a,b,c){const d=[];var e=a.split(\"\");e.push(\"\");var f=0;a=[];let g=null;for(let l=0;l<e.length;l++){var h=e[l];if(0===f)if(\"%\"===h)(f=a.join(\"\"))&&d.push(f),a.length=0,f=1;else if(c&&\"\\n\"===h){const m=a.join(\"\");m&&d.push(m);a.length=0;d.push(h)}else a.push(h);else if(1===f)\"%\"===h?(a.push(h),f=0):b&&\"0\"<=h&&\"9\">=h?(f=2,g=h,(h=a.join(\"\"))&&d.push(h),a.length=0):\"{\"===h?f=3:(a.push(\"%\",h),f=0);else if(2===f)if(\"0\"<=h&&\"9\">=\nh)g+=h;else{var k=void 0;d.push(parseInt(null!=(k=g)?k:\"\",10));l--;f=0}else 3===f&&(\"\"===h?(a.splice(0,0,\"%{\"),l--,f=0):\"}\"!==h?a.push(h):(f=a.join(\"\"),/[A-Z]\\w*/i.test(f)?(h=f.toUpperCase(),(h=h.startsWith(\"BKY_\")?h.substring(4):null)&&h in $.Msg$$module$build$src$core$msg?(f=$.Msg$$module$build$src$core$msg[h],\"string\"===typeof f?Array.prototype.push.apply(d,tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(f,b,c)):b?d.push(`${f}`):d.push(f)):d.push(\"%{\"+f+\"}\")):d.push(\"%{\"+f+\"}\"),\nf=a.length=0))}(b=a.join(\"\"))&&d.push(b);k=[];a.length=0;for(e=0;e<d.length;e++)\"string\"!==typeof d[e]||c&&\"\\n\"===d[e]?((b=a.join(\"\"))&&k.push(b),a.length=0,k.push(d[e])):a.push(d[e]);(b=a.join(\"\"))&&k.push(b);a.length=0;return k};tokenizeInterpolation$$module$build$src$core$utils$parsing=function(a){return tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(a,!0,!0)};\nreplaceMessageReferences$$module$build$src$core$utils$parsing=function(a){if(\"string\"!==typeof a)return a;a=tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(a,!1,!1);return a.length?String(a[0]):\"\"};\ncheckMessageReferences$$module$build$src$core$utils$parsing=function(a){let b=!0;const c=$.Msg$$module$build$src$core$msg,d=a.match(/%{BKY_[A-Z]\\w*}/gi);if(d)for(let e=0;e<d.length;e++){const f=d[e].toUpperCase();void 0===c[f.slice(6,-1)]&&(console.warn(\"No message string for \"+d[e]+\" in \"+a),b=!1)}return b};\nparseBlockColour$$module$build$src$core$utils$parsing=function(a){const b=\"string\"===typeof a?replaceMessageReferences$$module$build$src$core$utils$parsing(a):a;var c=Number(b);if(!isNaN(c)&&0<=c&&360>=c)return{hue:c,hex:hsvToHex$$module$build$src$core$utils$colour(c,getHsvSaturation$$module$build$src$core$utils$colour(),255*getHsvValue$$module$build$src$core$utils$colour())};if(c=parse$$module$build$src$core$utils$colour(b))return{hue:null,hex:c};c='Invalid colour: \"'+b+'\"';a!==b&&(c+=' (from \"'+\na+'\")');throw Error(c);};isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block=function(a){return void 0!==a.getProcedureModel&&void 0!==a.doProcedureUpdate&&void 0!==a.isProcedureDef};isObservable$$module$build$src$core$interfaces$i_observable=function(a){return void 0!==a.startPublishing&&void 0!==a.stopPublishing};register$$module$build$src$core$field_registry=function(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.FIELD,a,b)};\nunregister$$module$build$src$core$field_registry=function(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.FIELD,a)};$.fromJson$$module$build$src$core$field_registry=function(a){return TEST_ONLY$$module$build$src$core$field_registry.fromJsonInternal(a)};\nfromJsonInternal$$module$build$src$core$field_registry=function(a){const b=getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.FIELD,a.type);if(b){if(\"function\"!==typeof b.fromJson)throw new TypeError(\"returned Field was not a IRegistrableField\");return b.fromJson(a)}console.warn(\"Blockly could not create a field of type \"+a.type+\". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached.\");\nreturn null};\ntrimOptions$$module$build$src$core$field_dropdown=function(a){let b=!1;const c=a.map(([g,h])=>{if(\"string\"===typeof g)return[replaceMessageReferences$$module$build$src$core$utils$parsing(g),h];b=!0;return[null!==g.alt?Object.assign({},g,{alt:replaceMessageReferences$$module$build$src$core$utils$parsing(g.alt)}):Object.assign({},g),h]});if(b||2>a.length)return{options:c};var d=c.map(([g])=>g),e=shortestStringLength$$module$build$src$core$utils$string(d);a=commonWordPrefix$$module$build$src$core$utils$string(d,e);\nconst f=commonWordSuffix$$module$build$src$core$utils$string(d,e);if(!a&&!f||e<=a+f)return{options:c};e=a?d[0].substring(0,a-1):void 0;d=f?d[0].substr(1-f):void 0;return{options:applyTrim$$module$build$src$core$field_dropdown(c,a,f),prefix:e,suffix:d}};applyTrim$$module$build$src$core$field_dropdown=function(a,b,c){return a.map(([d,e])=>[d.substring(b,d.length-c),e])};\nvalidateOptions$$module$build$src$core$field_dropdown=function(a){if(!Array.isArray(a))throw TypeError(\"FieldDropdown options must be an array.\");if(!a.length)throw TypeError(\"FieldDropdown options must not be an empty array.\");let b=!1;for(let c=0;c<a.length;c++){const d=a[c];Array.isArray(d)?\"string\"!==typeof d[1]?(b=!0,console.error(\"Invalid option[\"+c+\"]: Each FieldDropdown option id must be a string. Found \"+d[1]+\" in: \",d)):d[0]&&\"string\"!==typeof d[0]&&\"string\"!==typeof d[0].src&&(b=!0,console.error(\"Invalid option[\"+\nc+\"]: Each FieldDropdown option must have a string label or image description. Found\"+d[0]+\" in: \",d)):(b=!0,console.error(\"Invalid option[\"+c+\"]: Each FieldDropdown option must be an array. Found: \",d))}if(b)throw TypeError(\"Found invalid FieldDropdown options.\");};\n$.register$$module$build$src$core$extensions=function(a,b){if(\"string\"!==typeof a||\"\"===a.trim())throw Error('Error: Invalid extension name \"'+a+'\"');if(allExtensions$$module$build$src$core$extensions[a])throw Error('Error: Extension \"'+a+'\" is already registered.');if(\"function\"!==typeof b)throw Error('Error: Extension \"'+a+'\" must be a function');allExtensions$$module$build$src$core$extensions[a]=b};\n$.registerMixin$$module$build$src$core$extensions=function(a,b){if(!b||\"object\"!==typeof b)throw Error('Error: Mixin \"'+a+'\" must be a object');$.register$$module$build$src$core$extensions(a,function(){this.mixin(b)})};\n$.registerMutator$$module$build$src$core$extensions=function(a,b,c,d){const e='Error when registering mutator \"'+a+'\": ';checkHasMutatorProperties$$module$build$src$core$extensions(e,b);const f=checkMutatorDialog$$module$build$src$core$extensions(b,e);if(c&&\"function\"!==typeof c)throw Error(e+'Extension \"'+a+'\" is not a function');$.register$$module$build$src$core$extensions(a,function(){f&&this.setMutator(new $.MutatorIcon$$module$build$src$core$icons$mutator_icon(d||[],this));this.mixin(b);c&&c.apply(this)})};\nunregister$$module$build$src$core$extensions=function(a){isRegistered$$module$build$src$core$extensions(a)?delete allExtensions$$module$build$src$core$extensions[a]:console.warn('No extension mapping for name \"'+a+'\" found to unregister')};isRegistered$$module$build$src$core$extensions=function(a){return!!allExtensions$$module$build$src$core$extensions[a]};\napply$$module$build$src$core$extensions=function(a,b,c){const d=allExtensions$$module$build$src$core$extensions[a];if(\"function\"!==typeof d)throw Error('Error: Extension \"'+a+'\" not found.');let e;c?checkNoMutatorProperties$$module$build$src$core$extensions(a,b):e=getMutatorProperties$$module$build$src$core$extensions(b);d.apply(b);if(c)checkHasMutatorProperties$$module$build$src$core$extensions('Error after applying mutator \"'+a+'\": ',b);else if(!mutatorPropertiesMatch$$module$build$src$core$extensions(e,\nb))throw Error('Error when applying extension \"'+a+'\": mutation properties changed when applying a non-mutator extension.');};checkNoMutatorProperties$$module$build$src$core$extensions=function(a,b){if(getMutatorProperties$$module$build$src$core$extensions(b).length)throw Error('Error: tried to apply mutation \"'+a+'\" to a block that already has mutator functions.  Block id: '+b.id);};\ncheckXmlHooks$$module$build$src$core$extensions=function(a,b){return checkHasFunctionPair$$module$build$src$core$extensions(a.mutationToDom,a.domToMutation,b+\" mutationToDom/domToMutation\")};checkJsonHooks$$module$build$src$core$extensions=function(a,b){return checkHasFunctionPair$$module$build$src$core$extensions(a.saveExtraState,a.loadExtraState,b+\" saveExtraState/loadExtraState\")};\ncheckMutatorDialog$$module$build$src$core$extensions=function(a,b){return checkHasFunctionPair$$module$build$src$core$extensions(a.compose,a.decompose,b+\" compose/decompose\")};checkHasFunctionPair$$module$build$src$core$extensions=function(a,b,c){if(a&&b){if(\"function\"!==typeof a||\"function\"!==typeof b)throw Error(c+\" must be a function\");return!0}if(!a&&!b)return!1;throw Error(c+\"Must have both or neither functions\");};\ncheckHasMutatorProperties$$module$build$src$core$extensions=function(a,b){const c=checkXmlHooks$$module$build$src$core$extensions(b,a),d=checkJsonHooks$$module$build$src$core$extensions(b,a);if(!c&&!d)throw Error(a+\"Mutations must contain either XML hooks, or JSON hooks, or both\");checkMutatorDialog$$module$build$src$core$extensions(b,a)};\ngetMutatorProperties$$module$build$src$core$extensions=function(a){const b=[];void 0!==a.domToMutation&&b.push(a.domToMutation);void 0!==a.mutationToDom&&b.push(a.mutationToDom);void 0!==a.saveExtraState&&b.push(a.saveExtraState);void 0!==a.loadExtraState&&b.push(a.loadExtraState);void 0!==a.compose&&b.push(a.compose);void 0!==a.decompose&&b.push(a.decompose);return b};\nmutatorPropertiesMatch$$module$build$src$core$extensions=function(a,b){b=getMutatorProperties$$module$build$src$core$extensions(b);if(b.length!==a.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0};\nrunAfterPageLoad$$module$build$src$core$extensions=function(a){if(\"object\"!==typeof document)throw Error(\"runAfterPageLoad() requires browser document.\");if(\"complete\"===document.readyState)a();else{const b=setInterval(function(){\"complete\"===document.readyState&&(clearInterval(b),a())},10)}};\n$.buildTooltipForDropdown$$module$build$src$core$extensions=function(a,b){const c=[];return function(){-1===c.indexOf(this.type)&&(checkDropdownOptionsInTable$$module$build$src$core$extensions(this,a,b),c.push(this.type));this.setTooltip(function(){const d=String(this.getFieldValue(a));return replaceMessageReferences$$module$build$src$core$utils$parsing(b[d])}.bind(this))}};\ncheckDropdownOptionsInTable$$module$build$src$core$extensions=function(a,b,c){var d=a.getField(b);if(d instanceof FieldDropdown$$module$build$src$core$field_dropdown&&!d.isOptionListDynamic()){d=d.getOptions();for(const [,e]of d)void 0===c[e]&&console.warn(`No tooltip mapping for value ${e} of field `+`${b} of block type ${a.type}.`)}};\n$.buildTooltipWithFieldText$$module$build$src$core$extensions=function(a,b){return function(){this.setTooltip(function(){const c=this.getField(b);return replaceMessageReferences$$module$build$src$core$utils$parsing(a).replace(\"%1\",c?c.getText():\"\")}.bind(this))}};extensionParentTooltip$$module$build$src$core$extensions=function(){const a=this.tooltip;this.setTooltip(function(){const b=this.getParent();return b&&b.getInputsInline()&&b.tooltip||a}.bind(this))};\npoint$$module$build$src$core$utils$svg_paths=function(a,b){return\" \"+a+\",\"+b+\" \"};curve$$module$build$src$core$utils$svg_paths=function(a,b){return\" \"+a+b.join(\"\")};moveTo$$module$build$src$core$utils$svg_paths=function(a,b){return\" M \"+a+\",\"+b+\" \"};moveBy$$module$build$src$core$utils$svg_paths=function(a,b){return\" m \"+a+\",\"+b+\" \"};lineTo$$module$build$src$core$utils$svg_paths=function(a,b){return\" l \"+a+\",\"+b+\" \"};line$$module$build$src$core$utils$svg_paths=function(a){return\" l\"+a.join(\"\")};\nlineOnAxis$$module$build$src$core$utils$svg_paths=function(a,b){return\" \"+a+\" \"+b+\" \"};arc$$module$build$src$core$utils$svg_paths=function(a,b,c,d){return a+\" \"+c+\" \"+c+\" \"+b+d};register$$module$build$src$core$icons$registry=function(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.ICON,a.toString(),b)};unregister$$module$build$src$core$icons$registry=function(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.ICON,a)};\nallProcedures$$module$build$src$core$procedures=function(a){const b=a.getProcedureMap().getProcedures().filter(d=>!d.getReturnTypes()).map(d=>[d.getName(),d.getParameters().map(e=>e.getName()),!1]);a.getBlocksByType(\"procedures_defnoreturn\",!1).forEach(d=>{!isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(d)&&isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks(d)&&b.push(d.getProcedureDef())});const c=a.getProcedureMap().getProcedures().filter(d=>\n!!d.getReturnTypes()).map(d=>[d.getName(),d.getParameters().map(e=>e.getName()),!0]);a.getBlocksByType(\"procedures_defreturn\",!1).forEach(d=>{!isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(d)&&isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks(d)&&c.push(d.getProcedureDef())});b.sort(procTupleComparator$$module$build$src$core$procedures);c.sort(procTupleComparator$$module$build$src$core$procedures);return[b,c]};\nprocTupleComparator$$module$build$src$core$procedures=function(a,b){return a[0].localeCompare(b[0],void 0,{sensitivity:\"base\"})};$.findLegalName$$module$build$src$core$procedures=function(a,b){if(b.isInFlyout)return a;for(a=a||$.Msg$$module$build$src$core$msg.UNNAMED_KEY||\"unnamed\";!isLegalName$$module$build$src$core$procedures(a,b.workspace,b);){const c=a.match(/^(.*?)(\\d+)$/);a=c?c[1]+(parseInt(c[2])+1):a+\"2\"}return a};\nisLegalName$$module$build$src$core$procedures=function(a,b,c){return!isNameUsed$$module$build$src$core$procedures(a,b,c)};\nisNameUsed$$module$build$src$core$procedures=function(a,b,c){for(const d of b.getAllBlocks(!1))if(d!==c&&isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks(d)&&$.Names$$module$build$src$core$names.equals(d.getProcedureDef()[0],a))return!0;c=c&&isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(c)?null==c?void 0:c.getProcedureModel():void 0;for(const d of b.getProcedureMap().getProcedures())if(d!==c&&$.Names$$module$build$src$core$names.equals(d.getName(),\na))return!0;return!1};\n$.rename$$module$build$src$core$procedures=function(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;a=a.trim();const c=$.findLegalName$$module$build$src$core$procedures(a,b);isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(b)&&!b.isInsertionMarker()&&b.getProcedureModel().setName(c);const d=this.getValue();if(d!==a&&d!==c)for(a=b.workspace.getAllBlocks(!1),b=0;b<a.length;b++){const e=a[b];e.renameProcedure&&e.renameProcedure(d,c)}return c};\nflyoutCategory$$module$build$src$core$procedures=function(a){function b(f,g){for(let k=0;k<f.length;k++){var h=f[k][0];const l=f[k][1],m=$.createElement$$module$build$src$core$utils$xml(\"block\");m.setAttribute(\"type\",g);m.setAttribute(\"gap\",\"16\");const n=$.createElement$$module$build$src$core$utils$xml(\"mutation\");n.setAttribute(\"name\",h);m.appendChild(n);for(h=0;h<l.length;h++){const p=$.createElement$$module$build$src$core$utils$xml(\"arg\");p.setAttribute(\"name\",l[h]);n.appendChild(p)}c.push(m)}}\nconst c=[];if(Blocks$$module$build$src$core$blocks.procedures_defnoreturn){var d=$.createElement$$module$build$src$core$utils$xml(\"block\");d.setAttribute(\"type\",\"procedures_defnoreturn\");d.setAttribute(\"gap\",\"16\");var e=$.createElement$$module$build$src$core$utils$xml(\"field\");e.setAttribute(\"name\",\"NAME\");e.appendChild($.createTextNode$$module$build$src$core$utils$xml($.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE));d.appendChild(e);c.push(d)}Blocks$$module$build$src$core$blocks.procedures_defreturn&&\n(d=$.createElement$$module$build$src$core$utils$xml(\"block\"),d.setAttribute(\"type\",\"procedures_defreturn\"),d.setAttribute(\"gap\",\"16\"),e=$.createElement$$module$build$src$core$utils$xml(\"field\"),e.setAttribute(\"name\",\"NAME\"),e.appendChild($.createTextNode$$module$build$src$core$utils$xml($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(e),c.push(d));Blocks$$module$build$src$core$blocks.procedures_ifreturn&&(d=$.createElement$$module$build$src$core$utils$xml(\"block\"),\nd.setAttribute(\"type\",\"procedures_ifreturn\"),d.setAttribute(\"gap\",\"16\"),c.push(d));c.length&&c[c.length-1].setAttribute(\"gap\",\"24\");a=allProcedures$$module$build$src$core$procedures(a);b(a[0],\"procedures_callnoreturn\");b(a[1],\"procedures_callreturn\");return c};\nupdateMutatorFlyout$$module$build$src$core$procedures=function(a){var b=[],c=a.getBlocksByType(\"procedures_mutatorarg\",!1);for(let f=0,g;g=c[f];f++)b.push(g.getFieldValue(\"NAME\"));c=$.createElement$$module$build$src$core$utils$xml(\"xml\");const d=$.createElement$$module$build$src$core$utils$xml(\"block\");d.setAttribute(\"type\",\"procedures_mutatorarg\");const e=$.createElement$$module$build$src$core$utils$xml(\"field\");e.setAttribute(\"name\",\"NAME\");b=generateUniqueNameFromOptions$$module$build$src$core$variables($.DEFAULT_ARG$$module$build$src$core$procedures,\nb);b=$.createTextNode$$module$build$src$core$utils$xml(b);e.appendChild(b);d.appendChild(e);c.appendChild(d);a.updateToolbox(c)};\nmutatorOpenListener$$module$build$src$core$procedures=function(a){if(a.type===BUBBLE_OPEN$$module$build$src$core$events$utils&&\"mutator\"===a.bubbleType&&a.isOpen&&a.blockId){a=getWorkspaceById$$module$build$src$core$common(a.workspaceId).getBlockById(a.blockId);var b=a.type;if(\"procedures_defnoreturn\"===b||\"procedures_defreturn\"===b)a=a.getIcon($.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),updateMutatorFlyout$$module$build$src$core$procedures(a),a.addChangeListener(mutatorChangeListener$$module$build$src$core$procedures)}};\nmutatorChangeListener$$module$build$src$core$procedures=function(a){if(a.type===$.CREATE$$module$build$src$core$events$utils||a.type===$.DELETE$$module$build$src$core$events$utils||a.type===$.CHANGE$$module$build$src$core$events$utils||a.type===BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils)a=getWorkspaceById$$module$build$src$core$common(a.workspaceId),updateMutatorFlyout$$module$build$src$core$procedures(a)};\ngetCallers$$module$build$src$core$procedures=function(a,b){return b.getAllBlocks(!1).filter(c=>blockIsModernCallerFor$$module$build$src$core$procedures(c,a)||isLegacyProcedureCallBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks(c)&&$.Names$$module$build$src$core$names.equals(c.getProcedureCall(),a))};\nblockIsModernCallerFor$$module$build$src$core$procedures=function(a,b){return isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(a)&&!a.isProcedureDef()&&a.getProcedureModel()&&$.Names$$module$build$src$core$names.equals(a.getProcedureModel().getName(),b)};\n$.mutateCallers$$module$build$src$core$procedures=function(a){const b=getRecordUndo$$module$build$src$core$events$utils();var c=a.getProcedureDef()[0];const d=a.mutationToDom(!0);a=getCallers$$module$build$src$core$procedures(c,a.workspace);for(let f=0,g;g=a[f];f++){c=(c=g.mutationToDom())&&domToText$$module$build$src$core$utils$xml(c);g.domToMutation&&g.domToMutation(d);var e=g.mutationToDom();e=e&&domToText$$module$build$src$core$utils$xml(e);c!==e&&(setRecordUndo$$module$build$src$core$events$utils(!1),\nfire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(g,\"mutation\",null,c,e)),setRecordUndo$$module$build$src$core$events$utils(b))}};\n$.getDefinition$$module$build$src$core$procedures=function(a,b){for(const c of b.getAllBlocks(!1))if(isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(c)&&c.isProcedureDef()&&$.Names$$module$build$src$core$names.equals(c.getProcedureModel().getName(),a)||isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks(c)&&$.Names$$module$build$src$core$names.equals(c.getProcedureDef()[0],a))return c;return null};\nisDynamicShape$$module$build$src$core$renderers$common$constants=function(a){return a.isDynamic};getParentConnection$$module$build$src$core$keyboard_nav$ast_node=function(a){let b=a.outputConnection;if(!b||a.previousConnection&&a.previousConnection.isConnected())b=a.previousConnection;return b};connectReciprocally$$module$build$src$core$connection=function(a,b){if(!a||!b)throw Error(\"Cannot connect null connections.\");a.targetConnection=b;b.targetConnection=a};\ngetSingleConnection$$module$build$src$core$connection=function(a,b){let c=null;b=b.outputConnection;const d=null==b?void 0:b.getConnectionChecker();for(let e=0,f;f=a.inputList[e];e++){const g=f.connection;let h;if(g&&(null==(h=d)?0:h.canConnect(b,g,!1))){if(c)return null;c=g}}return c};getConnectionForOrphanedOutput$$module$build$src$core$connection=function(a,b){let c;for(;c=getSingleConnection$$module$build$src$core$connection(a,b);)if(a=c.targetBlock(),!a||a.isShadow())return c;return null};\nregister$$module$build$src$core$renderers$common$block_rendering=function(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.RENDERER,a,b)};unregister$$module$build$src$core$renderers$common$block_rendering=function(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.RENDERER,a)};\ninit$$module$build$src$core$renderers$common$block_rendering=function(a,b,c){a=new (getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.RENDERER,a))(a);a.init(b,c);return a};stringButtonClickHandler$$module$build$src$core$variables_dynamic=function(a){createVariableButtonHandler$$module$build$src$core$variables(a.getTargetWorkspace(),void 0,\"String\")};\nnumberButtonClickHandler$$module$build$src$core$variables_dynamic=function(a){createVariableButtonHandler$$module$build$src$core$variables(a.getTargetWorkspace(),void 0,\"Number\")};colourButtonClickHandler$$module$build$src$core$variables_dynamic=function(a){createVariableButtonHandler$$module$build$src$core$variables(a.getTargetWorkspace(),void 0,\"Colour\")};\nflyoutCategory$$module$build$src$core$variables_dynamic=function(a){let b=[],c=document.createElement(\"button\");c.setAttribute(\"text\",$.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE);c.setAttribute(\"callbackKey\",\"CREATE_VARIABLE_STRING\");b.push(c);c=document.createElement(\"button\");c.setAttribute(\"text\",$.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE);c.setAttribute(\"callbackKey\",\"CREATE_VARIABLE_NUMBER\");b.push(c);c=document.createElement(\"button\");c.setAttribute(\"text\",$.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE);\nc.setAttribute(\"callbackKey\",\"CREATE_VARIABLE_COLOUR\");b.push(c);a.registerButtonCallback(\"CREATE_VARIABLE_STRING\",stringButtonClickHandler$$module$build$src$core$variables_dynamic);a.registerButtonCallback(\"CREATE_VARIABLE_NUMBER\",numberButtonClickHandler$$module$build$src$core$variables_dynamic);a.registerButtonCallback(\"CREATE_VARIABLE_COLOUR\",colourButtonClickHandler$$module$build$src$core$variables_dynamic);a=flyoutCategoryBlocks$$module$build$src$core$variables_dynamic(a);return b=b.concat(a)};\nflyoutCategoryBlocks$$module$build$src$core$variables_dynamic=function(a){a=a.getAllVariables();const b=[];if(0<a.length){if(Blocks$$module$build$src$core$blocks.variables_set_dynamic){var c=a[a.length-1];const d=$.createElement$$module$build$src$core$utils$xml(\"block\");d.setAttribute(\"type\",\"variables_set_dynamic\");d.setAttribute(\"gap\",\"24\");d.appendChild(generateVariableFieldDom$$module$build$src$core$variables(c));b.push(d)}if(Blocks$$module$build$src$core$blocks.variables_get_dynamic){a.sort(VariableModel$$module$build$src$core$variable_model.compareByName);\nfor(let d=0,e;e=a[d];d++)c=$.createElement$$module$build$src$core$utils$xml(\"block\"),c.setAttribute(\"type\",\"variables_get_dynamic\"),c.setAttribute(\"gap\",\"8\"),c.appendChild(generateVariableFieldDom$$module$build$src$core$variables(e)),b.push(c)}}return b};resizeSvgContents$$module$build$src$core$workspace_svg=function(a){a.resizeContents()};isCopyable$$module$build$src$core$interfaces$i_copyable=function(a){return void 0!==a.toCopyData};\nregisterEscape$$module$build$src$core$shortcut_items=function(){ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.ESCAPE,preconditionFn(a){return!a.options.readOnly},callback(a){a.hideChaff();return!0},keyCodes:[KeyCodes$$module$build$src$core$utils$keycodes.ESC]})};\nregisterDelete$$module$build$src$core$shortcut_items=function(){ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.DELETE,preconditionFn(a){const b=getSelected$$module$build$src$core$common();return!a.options.readOnly&&null!=b&&b.isDeletable()},callback(a,b){b.preventDefault();if(Gesture$$module$build$src$core$gesture.inProgress())return!1;getSelected$$module$build$src$core$common().checkAndDelete();return!0},keyCodes:[KeyCodes$$module$build$src$core$utils$keycodes.DELETE,\nKeyCodes$$module$build$src$core$utils$keycodes.BACKSPACE]})};\nregisterCopy$$module$build$src$core$shortcut_items=function(){const a=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.C,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.C,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.C,\n[KeyCodes$$module$build$src$core$utils$keycodes.META]);ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.COPY,preconditionFn(d){const e=getSelected$$module$build$src$core$common();return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress()&&null!=e&&e.isDeletable()&&e.isMovable()&&isCopyable$$module$build$src$core$interfaces$i_copyable(e)},callback(d,e){e.preventDefault();d.hideChaff();e=getSelected$$module$build$src$core$common();\nif(!e||!isCopyable$$module$build$src$core$interfaces$i_copyable(e))return!1;copyData$$module$build$src$core$shortcut_items=e.toCopyData();copyWorkspace$$module$build$src$core$shortcut_items=d;return!!copyData$$module$build$src$core$shortcut_items},keyCodes:[a,b,c]})};\nregisterCut$$module$build$src$core$shortcut_items=function(){const a=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.X,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.X,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.X,\n[KeyCodes$$module$build$src$core$utils$keycodes.META]);ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.CUT,preconditionFn(d){const e=getSelected$$module$build$src$core$common();return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress()&&null!=e&&e instanceof BlockSvg$$module$build$src$core$block_svg&&e.isDeletable()&&e.isMovable()&&!e.workspace.isFlyout},callback(d){const e=getSelected$$module$build$src$core$common();\nif(!e||!isCopyable$$module$build$src$core$interfaces$i_copyable(e))return!1;copyData$$module$build$src$core$shortcut_items=e.toCopyData();copyWorkspace$$module$build$src$core$shortcut_items=d;e.checkAndDelete();return!0},keyCodes:[a,b,c]})};\nregisterPaste$$module$build$src$core$shortcut_items=function(){const a=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.V,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.V,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.V,\n[KeyCodes$$module$build$src$core$utils$keycodes.META]);ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.PASTE,preconditionFn(d){return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress()},callback(){return copyData$$module$build$src$core$shortcut_items&&copyWorkspace$$module$build$src$core$shortcut_items?!!paste$$module$build$src$core$clipboard(copyData$$module$build$src$core$shortcut_items,copyWorkspace$$module$build$src$core$shortcut_items):\n!1},keyCodes:[a,b,c]})};\nregisterUndo$$module$build$src$core$shortcut_items=function(){const a=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.META]);\nShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.UNDO,preconditionFn(d){return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress()},callback(d){d.hideChaff();d.undo(!1);return!0},keyCodes:[a,b,c]})};\nregisterRedo$$module$build$src$core$shortcut_items=function(){const a=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.SHIFT,KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.SHIFT,\nKeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.SHIFT,KeyCodes$$module$build$src$core$utils$keycodes.META]),d=ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Y,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]);ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.REDO,\npreconditionFn(e){return!Gesture$$module$build$src$core$gesture.inProgress()&&!e.options.readOnly},callback(e){e.hideChaff();e.undo(!0);return!0},keyCodes:[a,b,c,d]})};\nregisterDefaultShortcuts$$module$build$src$core$shortcut_items=function(){registerEscape$$module$build$src$core$shortcut_items();registerDelete$$module$build$src$core$shortcut_items();registerCopy$$module$build$src$core$shortcut_items();registerCut$$module$build$src$core$shortcut_items();registerPaste$$module$build$src$core$shortcut_items();registerUndo$$module$build$src$core$shortcut_items();registerRedo$$module$build$src$core$shortcut_items()};\nsaveProcedure$$module$build$src$core$serialization$procedures=function(a){const b={id:a.getId(),name:a.getName(),returnTypes:a.getReturnTypes()};if(!a.getParameters().length)return b;b.parameters=a.getParameters().map(c=>saveParameter$$module$build$src$core$serialization$procedures(c));return b};saveParameter$$module$build$src$core$serialization$procedures=function(a){const b={id:a.getId(),name:a.getName()};if(!a.getTypes().length)return b;b.types=a.getTypes();return b};\nloadProcedure$$module$build$src$core$serialization$procedures=function(a,b,c,d){a=(new a(d,c.name,c.id)).setReturnTypes(c.returnTypes);if(!c.parameters)return a;for(const [e,f]of c.parameters.entries())a.insertParameter(loadParameter$$module$build$src$core$serialization$procedures(b,f,d),e);return a};loadParameter$$module$build$src$core$serialization$procedures=function(a,b,c){a=new a(c,b.name,b.id);b.types&&a.setTypes(b.types);return a};\nsave$$module$build$src$core$serialization$workspaces=function(a){const b=Object.create(null),c=getAllItems$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,!0);for(const d in c){let e;const f=null==(e=c[d])?void 0:e.save(a);f&&(b[d]=f)}return b};\nload$$module$build$src$core$serialization$workspaces=function(a,b,{recordUndo:c=!1}={}){var d=getAllItems$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,!0);if(d){d=Object.entries(d).sort((f,g)=>g[1].priority-f[1].priority);var e=getRecordUndo$$module$build$src$core$events$utils();setRecordUndo$$module$build$src$core$events$utils(c);(c=$.getGroup$$module$build$src$core$events$utils())||$.setGroup$$module$build$src$core$events$utils(!0);startTextWidthCache$$module$build$src$core$utils$dom();\nb instanceof WorkspaceSvg$$module$build$src$core$workspace_svg&&b.setResizesEnabled(!1);for(const [,f]of d.reverse()){let g;null==(g=f)||g.clear(b)}for(let [f,g]of d.reverse())if(a[f]){let h;null==(h=g)||h.load(a[f],b)}b instanceof WorkspaceSvg$$module$build$src$core$workspace_svg&&b.setResizesEnabled(!0);stopTextWidthCache$$module$build$src$core$utils$dom();fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(FINISHED_LOADING$$module$build$src$core$events$utils))(b));\n$.setGroup$$module$build$src$core$events$utils(c);setRecordUndo$$module$build$src$core$events$utils(e)}};bumpObjectIntoBounds$$module$build$src$core$bump_objects=function(a,b,c){const d=c.getBoundingRectangle(),e=d.right-d.left,f=clamp$$module$build$src$core$utils$math(b.top,d.top,b.top+b.height-(d.bottom-d.top))-d.top;let g=b.left;b=b.left+b.width-e;a.RTL?g=Math.min(b,g):b=Math.max(g,b);return(a=clamp$$module$build$src$core$utils$math(g,d.left,b)-d.left)||f?(c.moveBy(a,f,[\"inbounds\"]),!0):!1};\nbumpIntoBoundsHandler$$module$build$src$core$bump_objects=function(a){return b=>{var c=a.getMetricsManager();if(c.hasFixedEdges()&&!a.isDragging()){var d;if(-1!==BUMP_EVENTS$$module$build$src$core$events$utils.indexOf(null!=(d=b.type)?d:\"\")){d=c.getScrollMetrics(!0);const e=extractObjectFromEvent$$module$build$src$core$bump_objects(a,b);e&&(c=$.getGroup$$module$build$src$core$events$utils()||!1,$.setGroup$$module$build$src$core$events$utils(b.group),bumpObjectIntoBounds$$module$build$src$core$bump_objects(a,\nd,e)&&!b.group&&console.warn(\"Moved object in bounds but there was no event group. This may break undo.\"),$.setGroup$$module$build$src$core$events$utils(c))}else b.type===VIEWPORT_CHANGE$$module$build$src$core$events$utils&&b.scale&&b.oldScale&&b.scale>b.oldScale&&bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects(a)}}};\nextractObjectFromEvent$$module$build$src$core$bump_objects=function(a,b){let c=null;switch(b.type){case $.CREATE$$module$build$src$core$events$utils:case $.MOVE$$module$build$src$core$events$utils:(c=a.getBlockById(b.blockId))&&(c=c.getRootBlock());break;case COMMENT_CREATE$$module$build$src$core$events$utils:case COMMENT_MOVE$$module$build$src$core$events$utils:c=a.getCommentById(b.commentId)}return c};\nbumpTopObjectsIntoBounds$$module$build$src$core$bump_objects=function(a){var b=a.getMetricsManager();if(b.hasFixedEdges()&&!a.isDragging()){b=b.getScrollMetrics(!0);var c=a.getTopBoundedElements();for(let d=0,e;e=c[d];d++)bumpObjectIntoBounds$$module$build$src$core$bump_objects(a,b,e)}};\ninitIconData$$module$build$src$core$block_dragger=function(a,b){const c=[];for(const d of a.getIcons())if(!hasBubble$$module$build$src$core$interfaces$i_has_bubble(d)||d.bubbleIsVisible())c.push({location:b,icon:d}),d.onLocationChange(b);for(const d of a.getChildren(!1))c.push(...initIconData$$module$build$src$core$block_dragger(d,Coordinate$$module$build$src$core$utils$coordinate.sum(b,d.relativeCoords)));return c};\nregisterUndo$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.UNDO},preconditionFn(a){return 0<a.workspace.getUndoStack().length?\"enabled\":\"disabled\"},callback(a){a.workspace.undo(!1)},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:\"undoWorkspace\",weight:1})};\nregisterRedo$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.REDO},preconditionFn(a){return 0<a.workspace.getRedoStack().length?\"enabled\":\"disabled\"},callback(a){a.workspace.undo(!0)},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:\"redoWorkspace\",weight:2})};\nregisterCleanup$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(a){return a.workspace.isMovable()?1<a.workspace.getTopBlocks(!1).length?\"enabled\":\"disabled\":\"hidden\"},callback(a){a.workspace.cleanUp()},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:\"cleanWorkspace\",weight:3})};\ntoggleOption_$$module$build$src$core$contextmenu_items=function(a,b){function c(f){e--;f.setCollapsed(a);0===e&&$.setGroup$$module$build$src$core$events$utils(!1)}let d=0,e=0;$.setGroup$$module$build$src$core$events$utils(!0);for(let f=0;f<b.length;f++){let g=b[f];for(;g;)e++,setTimeout(c.bind(null,g),d),g=g.getNextBlock(),d+=10}};\nregisterCollapse$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(let b=0;b<a.length;b++){let c=a[b];for(;c;){if(!c.isCollapsed())return\"enabled\";c=c.getNextBlock()}}return\"disabled\"}return\"hidden\"},callback(a){toggleOption_$$module$build$src$core$contextmenu_items(!0,\na.workspace.getTopBlocks(!0))},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:\"collapseWorkspace\",weight:4})};\nregisterExpand$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(let b=0;b<a.length;b++){let c=a[b];for(;c;){if(c.isCollapsed())return\"enabled\";c=c.getNextBlock()}}return\"disabled\"}return\"hidden\"},callback(a){toggleOption_$$module$build$src$core$contextmenu_items(!1,\na.workspace.getTopBlocks(!0))},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:\"expandWorkspace\",weight:5})};addDeletableBlocks_$$module$build$src$core$contextmenu_items=function(a,b){if(a.isDeletable())Array.prototype.push.apply(b,a.getDescendants(!1));else{a=a.getChildren(!1);for(let c=0;c<a.length;c++)addDeletableBlocks_$$module$build$src$core$contextmenu_items(a[c],b)}};\ngetDeletableBlocks_$$module$build$src$core$contextmenu_items=function(a){const b=[];a=a.getTopBlocks(!0);for(let c=0;c<a.length;c++)addDeletableBlocks_$$module$build$src$core$contextmenu_items(a[c],b);return b};\ndeleteNext_$$module$build$src$core$contextmenu_items=function(a,b){b?$.setGroup$$module$build$src$core$events$utils(b):($.setGroup$$module$build$src$core$events$utils(!0),b=$.getGroup$$module$build$src$core$events$utils());const c=a.shift();c&&(c.isDeadOrDying()?deleteNext_$$module$build$src$core$contextmenu_items(a,b):(c.dispose(!1,!0),setTimeout(deleteNext_$$module$build$src$core$contextmenu_items,10,a,b)));$.setGroup$$module$build$src$core$events$utils(!1)};\nregisterDeleteAll$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(a){if(!a.workspace)return\"\";a=getDeletableBlocks_$$module$build$src$core$contextmenu_items(a.workspace).length;return 1===a?$.Msg$$module$build$src$core$msg.DELETE_BLOCK:$.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace(\"%1\",`${a}`)},preconditionFn(a){return a.workspace?0<getDeletableBlocks_$$module$build$src$core$contextmenu_items(a.workspace).length?\n\"enabled\":\"disabled\":\"disabled\"},callback(a){if(a.workspace){a.workspace.cancelCurrentGesture();var b=getDeletableBlocks_$$module$build$src$core$contextmenu_items(a.workspace);2>b.length?deleteNext_$$module$build$src$core$contextmenu_items(b):confirm$$module$build$src$core$dialog($.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace(\"%1\",String(b.length)),function(c){c&&deleteNext_$$module$build$src$core$contextmenu_items(b)})}},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,\nid:\"workspaceDelete\",weight:6})};registerWorkspaceOptions_$$module$build$src$core$contextmenu_items=function(){registerUndo$$module$build$src$core$contextmenu_items();registerRedo$$module$build$src$core$contextmenu_items();registerCleanup$$module$build$src$core$contextmenu_items();registerCollapse$$module$build$src$core$contextmenu_items();registerExpand$$module$build$src$core$contextmenu_items();registerDeleteAll$$module$build$src$core$contextmenu_items()};\nregisterDuplicate$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(a){a=a.block;return!a.isInFlyout&&a.isDeletable()&&a.isMovable()?a.isDuplicatable()?\"enabled\":\"disabled\":\"hidden\"},callback(a){if(a.block){var b=a.block.toCopyData();b&&paste$$module$build$src$core$clipboard(b,a.block.workspace)}},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,\nid:\"blockDuplicate\",weight:1})};\nregisterComment$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(a){return a.block.hasIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE)?$.Msg$$module$build$src$core$msg.REMOVE_COMMENT:$.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(a){a=a.block;return!a.isInFlyout&&a.workspace.options.comments&&!a.isCollapsed()&&a.isEditable()?\"enabled\":\"hidden\"},callback(a){a=a.block;a.hasIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE)?\na.setCommentText(null):a.setCommentText(\"\")},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:\"blockComment\",weight:2})};\nregisterInline$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(a){return a.block.getInputsInline()?$.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:$.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(a){a=a.block;if(!a.isInFlyout&&a.isMovable()&&!a.isCollapsed())for(let b=1;b<a.inputList.length;b++)if(!(a.inputList[b-1]instanceof StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs||\na.inputList[b]instanceof StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs))return\"enabled\";return\"hidden\"},callback(a){a.block.setInputsInline(!a.block.getInputsInline())},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:\"blockInline\",weight:3})};\nregisterCollapseExpandBlock$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(a){return a.block.isCollapsed()?$.Msg$$module$build$src$core$msg.EXPAND_BLOCK:$.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(a){a=a.block;return!a.isInFlyout&&a.isMovable()&&a.workspace.options.collapse?\"enabled\":\"hidden\"},callback(a){a.block.setCollapsed(!a.block.isCollapsed())},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,\nid:\"blockCollapseExpand\",weight:4})};\nregisterDisable$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(a){return a.block.isEnabled()?$.Msg$$module$build$src$core$msg.DISABLE_BLOCK:$.Msg$$module$build$src$core$msg.ENABLE_BLOCK},preconditionFn(a){a=a.block;return!a.isInFlyout&&a.workspace.options.disable&&a.isEditable()?a.getInheritedDisabled()?\"disabled\":\"enabled\":\"hidden\"},callback(a){a=a.block;const b=$.getGroup$$module$build$src$core$events$utils();\nb||$.setGroup$$module$build$src$core$events$utils(!0);a.setEnabled(!a.isEnabled());$.setGroup$$module$build$src$core$events$utils(b)},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:\"blockDisable\",weight:5})};\nregisterDelete$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(a){var b=a.block;a=b.getDescendants(!1).length;(b=b.getNextBlock())&&(a-=b.getDescendants(!1).length);return 1===a?$.Msg$$module$build$src$core$msg.DELETE_BLOCK:$.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace(\"%1\",`${a}`)},preconditionFn(a){return!a.block.isInFlyout&&a.block.isDeletable()?\"enabled\":\"hidden\"},callback(a){a.block&&\na.block.checkAndDelete()},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:\"blockDelete\",weight:6})};\nregisterHelp$$module$build$src$core$contextmenu_items=function(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText(){return $.Msg$$module$build$src$core$msg.HELP},preconditionFn(a){a=a.block;return(\"function\"===typeof a.helpUrl?a.helpUrl():a.helpUrl)?\"enabled\":\"hidden\"},callback(a){a.block.showHelp()},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:\"blockHelp\",weight:7})};\nregisterBlockOptions_$$module$build$src$core$contextmenu_items=function(){registerDuplicate$$module$build$src$core$contextmenu_items();registerComment$$module$build$src$core$contextmenu_items();registerInline$$module$build$src$core$contextmenu_items();registerCollapseExpandBlock$$module$build$src$core$contextmenu_items();registerDisable$$module$build$src$core$contextmenu_items();registerDelete$$module$build$src$core$contextmenu_items();registerHelp$$module$build$src$core$contextmenu_items()};\nregisterDefaultOptions$$module$build$src$core$contextmenu_items=function(){registerWorkspaceOptions_$$module$build$src$core$contextmenu_items();registerBlockOptions_$$module$build$src$core$contextmenu_items()};\ninject$$module$build$src$core$inject=function(a,b){var c=null;c=\"string\"===typeof a?document.getElementById(a)||document.querySelector(a):a;let d;if(!document.contains(c)&&document!==(null==(d=c)?void 0:d.ownerDocument))throw Error(\"Error: container is not in current document\");a=new Options$$module$build$src$core$options(b||{});b=document.createElement(\"div\");b.className=\"injectionDiv\";b.tabIndex=0;setState$$module$build$src$core$utils$aria(b,State$$module$build$src$core$utils$aria.LABEL,$.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL);\nc.appendChild(b);c=createDom$$module$build$src$core$inject(b,a);const e=createMainWorkspace$$module$build$src$core$inject(b,c,a);init$$module$build$src$core$inject(e);setMainWorkspace$$module$build$src$core$common(e);svgResize$$module$build$src$core$common(e);b.addEventListener(\"focusin\",function(){setMainWorkspace$$module$build$src$core$common(e)});return e};\ncreateDom$$module$build$src$core$inject=function(a,b){a.setAttribute(\"dir\",\"LTR\");inject$$module$build$src$core$css(b.hasCss,b.pathToMedia);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{xmlns:SVG_NS$$module$build$src$core$utils$dom,\"xmlns:html\":HTML_NS$$module$build$src$core$utils$dom,\"xmlns:xlink\":XLINK_NS$$module$build$src$core$utils$dom,version:\"1.1\",\"class\":\"blocklySvg\",tabindex:\"0\"},a);const c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.DEFS,\n{},a),d=String(Math.random()).substring(2);b.gridPattern=Grid$$module$build$src$core$grid.createDom(d,b.gridOptions,c);return a};\ncreateMainWorkspace$$module$build$src$core$inject=function(a,b,c){c.parentWorkspace=null;c=new WorkspaceSvg$$module$build$src$core$workspace_svg(c);const d=c.options;c.scale=d.zoomOptions.startScale;b.appendChild(c.createDom(\"blocklyMainBackground\",a));var e=c.getRenderer().getClassName();e&&addClass$$module$build$src$core$utils$dom(a,e);(e=c.getTheme().getClassName())&&addClass$$module$build$src$core$utils$dom(a,e);!d.hasCategories&&d.languageTree&&(a=c.addFlyout(Svg$$module$build$src$core$utils$svg.SVG),\ninsertAfter$$module$build$src$core$utils$dom(a,b));d.hasTrashcan&&c.addTrashcan();d.zoomOptions&&d.zoomOptions.controls&&c.addZoomControls();c.getThemeManager().subscribe(b,\"workspaceBackgroundColour\",\"background-color\");c.translate(0,0);c.addChangeListener(bumpIntoBoundsHandler$$module$build$src$core$bump_objects(c));svgResize$$module$build$src$core$common(c);createDom$$module$build$src$core$widgetdiv();createDom$$module$build$src$core$dropdowndiv();createDom$$module$build$src$core$tooltip();return c};\ninit$$module$build$src$core$inject=function(a){const b=a.options;var c=a.getParentSvg();conditionalBind$$module$build$src$core$browser_events(c.parentNode,\"contextmenu\",null,function(d){isTargetInput$$module$build$src$core$browser_events(d)||d.preventDefault()});c=conditionalBind$$module$build$src$core$browser_events(window,\"resize\",null,function(){hide$$module$build$src$core$tooltip();a.hideComponents(!0);repositionForWindowResize$$module$build$src$core$dropdowndiv();repositionForWindowResize$$module$build$src$core$widgetdiv();\nsvgResize$$module$build$src$core$common(a);bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects(a)});a.setResizeHandlerWrapper(c);bindDocumentEvents$$module$build$src$core$inject();if(b.languageTree){c=a.getToolbox();const d=a.getFlyout(!0);c?c.init():d&&(d.init(a),d.show(b.languageTree),\"function\"===typeof d.scrollToStart&&d.scrollToStart())}b.hasTrashcan&&a.trashcan.init();b.zoomOptions&&b.zoomOptions.controls&&a.zoomControls_.init();b.moveOptions&&b.moveOptions.scrollbars?(a.scrollbar=\nnew ScrollbarPair$$module$build$src$core$scrollbar_pair(a,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.horizontal,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.vertical,\"blocklyMainWorkspaceScrollbar\"),a.scrollbar.resize()):a.setMetrics({x:.5,y:.5});b.hasSounds&&loadSounds$$module$build$src$core$inject(b.pathToMedia,a)};\nonKeyDown$$module$build$src$core$inject=function(a){const b=getMainWorkspace$$module$build$src$core$common();if(b&&!(isTargetInput$$module$build$src$core$browser_events(a)||b.rendered&&!b.isVisible()))ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.onKeyDown(b,a)};\nbindDocumentEvents$$module$build$src$core$inject=function(){documentEventsBound$$module$build$src$core$inject||(conditionalBind$$module$build$src$core$browser_events(document,\"scroll\",null,function(){const a=getAllWorkspaces$$module$build$src$core$common();for(let b=0,c;c=a[b];b++)c instanceof WorkspaceSvg$$module$build$src$core$workspace_svg&&c.updateInverseScreenCTM()}),conditionalBind$$module$build$src$core$browser_events(document,\"keydown\",null,onKeyDown$$module$build$src$core$inject),bind$$module$build$src$core$browser_events(document,\n\"touchend\",null,longStop$$module$build$src$core$touch),bind$$module$build$src$core$browser_events(document,\"touchcancel\",null,longStop$$module$build$src$core$touch),IPAD$$module$build$src$core$utils$useragent&&conditionalBind$$module$build$src$core$browser_events(window,\"orientationchange\",document,function(){svgResize$$module$build$src$core$common(getMainWorkspace$$module$build$src$core$common())}));documentEventsBound$$module$build$src$core$inject=!0};\nloadSounds$$module$build$src$core$inject=function(a,b){function c(){for(;e.length;){const f=e.pop();f&&unbind$$module$build$src$core$browser_events(f)}d.preload()}const d=b.getAudioManager();d.load([a+\"click.mp3\",a+\"click.wav\",a+\"click.ogg\"],\"click\");d.load([a+\"disconnect.wav\",a+\"disconnect.mp3\",a+\"disconnect.ogg\"],\"disconnect\");d.load([a+\"delete.mp3\",a+\"delete.ogg\",a+\"delete.wav\"],\"delete\");const e=[];e.push(conditionalBind$$module$build$src$core$browser_events(document,\"pointermove\",null,c,!0));\ne.push(conditionalBind$$module$build$src$core$browser_events(document,\"touchstart\",null,c,!0))};isIcon$$module$build$src$core$interfaces$i_icon=function(a){return void 0!==a.getType&&void 0!==a.initView&&void 0!==a.dispose&&void 0!==a.getWeight&&void 0!==a.getSize&&void 0!==a.applyColour&&void 0!==a.hideForInsertionMarker&&void 0!==a.updateEditable&&void 0!==a.updateCollapsed&&void 0!==a.isShownWhenCollapsed&&void 0!==a.setOffsetInBlock&&void 0!==a.onLocationChange&&void 0!==a.onClick};\nisPaster$$module$build$src$core$interfaces$i_paster=function(a){return void 0!==a.paste};isSelectableToolboxItem$$module$build$src$core$interfaces$i_selectable_toolbox_item=function(a){return a.isSelectable()};hideChaff$$module$build$src$core$blockly=function(a){getMainWorkspace$$module$build$src$core$common().hideChaff(a)};isRenderedElement$$module$build$src$core$interfaces$i_rendered_element=function(a){return void 0!==a.getSvgRoot};$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;\n$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||\"function\"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};\n$jscomp.getGlobal=function(a){a=[\"object\"==typeof globalThis&&globalThis,a,\"object\"==typeof window&&window,\"object\"==typeof self&&self,\"object\"==typeof __webpack_require__.g&&__webpack_require__.g];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error(\"Cannot find global object\");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol(\"x\");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};\n$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX=\"$jscp$\";var $jscomp$lookupPolyfilledValue=function(a,b,c){if(!c||null!=a){c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]}};$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};\n$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(\".\");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};\n$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(\".\");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&\"es6\"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?\n$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+\"$\"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill(\"globalThis\",function(a){return a||$jscomp.global},\"es_2020\",\"es3\");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.initSymbol=function(){};\n$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+=\"\");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill(\"Array.prototype.values\",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b,c){return c})}},\"es8\",\"es3\");\n$jscomp.polyfill(\"Array.prototype.flat\",function(a){return a?a:function(b){b=void 0===b?1:b;var c=[];Array.prototype.forEach.call(this,function(d){Array.isArray(d)&&0<b?(d=Array.prototype.flat.call(d,b-1),c.push.apply(c,d)):c.push(d)});return c}},\"es9\",\"es5\");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill(\"Object.entries\",function(a){return a?a:function(b){var c=[],d;for(d in b)$jscomp.owns(b,d)&&c.push([d,b[d]]);return c}},\"es8\",\"es3\");\n$jscomp.polyfill(\"Object.values\",function(a){return a?a:function(b){var c=[],d;for(d in b)$jscomp.owns(b,d)&&c.push(b[d]);return c}},\"es8\",\"es3\");var typeMap$$module$build$src$core$registry=Object.create(null),TEST_ONLY$$module$build$src$core$registry={typeMap:typeMap$$module$build$src$core$registry},nameMap$$module$build$src$core$registry=Object.create(null),DEFAULT$$module$build$src$core$registry=\"default\",Type$$module$build$src$core$registry=class{constructor(a){this.name=a}toString(){return this.name}};\nType$$module$build$src$core$registry.CONNECTION_CHECKER=new Type$$module$build$src$core$registry(\"connectionChecker\");Type$$module$build$src$core$registry.CURSOR=new Type$$module$build$src$core$registry(\"cursor\");Type$$module$build$src$core$registry.EVENT=new Type$$module$build$src$core$registry(\"event\");Type$$module$build$src$core$registry.FIELD=new Type$$module$build$src$core$registry(\"field\");Type$$module$build$src$core$registry.INPUT=new Type$$module$build$src$core$registry(\"input\");\nType$$module$build$src$core$registry.RENDERER=new Type$$module$build$src$core$registry(\"renderer\");Type$$module$build$src$core$registry.TOOLBOX=new Type$$module$build$src$core$registry(\"toolbox\");Type$$module$build$src$core$registry.THEME=new Type$$module$build$src$core$registry(\"theme\");Type$$module$build$src$core$registry.TOOLBOX_ITEM=new Type$$module$build$src$core$registry(\"toolboxItem\");Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX=new Type$$module$build$src$core$registry(\"flyoutsVerticalToolbox\");\nType$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX=new Type$$module$build$src$core$registry(\"flyoutsHorizontalToolbox\");Type$$module$build$src$core$registry.METRICS_MANAGER=new Type$$module$build$src$core$registry(\"metricsManager\");Type$$module$build$src$core$registry.BLOCK_DRAGGER=new Type$$module$build$src$core$registry(\"blockDragger\");Type$$module$build$src$core$registry.SERIALIZER=new Type$$module$build$src$core$registry(\"serializer\");Type$$module$build$src$core$registry.ICON=new Type$$module$build$src$core$registry(\"icon\");\nType$$module$build$src$core$registry.PASTER=new Type$$module$build$src$core$registry(\"paster\");var module$build$src$core$registry={DEFAULT:DEFAULT$$module$build$src$core$registry,TEST_ONLY:TEST_ONLY$$module$build$src$core$registry};module$build$src$core$registry.Type=Type$$module$build$src$core$registry;module$build$src$core$registry.getAllItems=getAllItems$$module$build$src$core$registry;module$build$src$core$registry.getClass=getClass$$module$build$src$core$registry;\nmodule$build$src$core$registry.getClassFromOptions=getClassFromOptions$$module$build$src$core$registry;module$build$src$core$registry.getObject=getObject$$module$build$src$core$registry;module$build$src$core$registry.hasItem=hasItem$$module$build$src$core$registry;module$build$src$core$registry.register=register$$module$build$src$core$registry;module$build$src$core$registry.unregister=unregister$$module$build$src$core$registry;var Blocks$$module$build$src$core$blocks=Object.create(null),module$build$src$core$blocks={Blocks:Blocks$$module$build$src$core$blocks};var WorkspaceDB_$$module$build$src$core$common=Object.create(null),mainWorkspace$$module$build$src$core$common,selected$$module$build$src$core$common=null,parentContainer$$module$build$src$core$common,draggingConnections$$module$build$src$core$common=[],TEST_ONLY$$module$build$src$core$common={defineBlocksWithJsonArrayInternal:defineBlocksWithJsonArrayInternal$$module$build$src$core$common},module$build$src$core$common={TEST_ONLY:TEST_ONLY$$module$build$src$core$common};\nmodule$build$src$core$common.createBlockDefinitionsFromJsonArray=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common;module$build$src$core$common.defineBlocks=$.defineBlocks$$module$build$src$core$common;module$build$src$core$common.defineBlocksWithJsonArray=defineBlocksWithJsonArray$$module$build$src$core$common;module$build$src$core$common.draggingConnections=draggingConnections$$module$build$src$core$common;module$build$src$core$common.getAllWorkspaces=getAllWorkspaces$$module$build$src$core$common;\nmodule$build$src$core$common.getBlockTypeCounts=getBlockTypeCounts$$module$build$src$core$common;module$build$src$core$common.getMainWorkspace=getMainWorkspace$$module$build$src$core$common;module$build$src$core$common.getParentContainer=getParentContainer$$module$build$src$core$common;module$build$src$core$common.getSelected=getSelected$$module$build$src$core$common;module$build$src$core$common.getWorkspaceById=getWorkspaceById$$module$build$src$core$common;\nmodule$build$src$core$common.registerWorkspace=registerWorkspace$$module$build$src$core$common;module$build$src$core$common.setMainWorkspace=setMainWorkspace$$module$build$src$core$common;module$build$src$core$common.setParentContainer=setParentContainer$$module$build$src$core$common;module$build$src$core$common.setSelected=setSelected$$module$build$src$core$common;module$build$src$core$common.svgResize=svgResize$$module$build$src$core$common;module$build$src$core$common.unregisterWorkpace=unregisterWorkpace$$module$build$src$core$common;var soup$$module$build$src$core$utils$idgenerator=\"!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",internal$$module$build$src$core$utils$idgenerator={genUid:()=>{const a=soup$$module$build$src$core$utils$idgenerator.length,b=[];for(let c=0;20>c;c++)b[c]=soup$$module$build$src$core$utils$idgenerator.charAt(Math.random()*a);return b.join(\"\")}},TEST_ONLY$$module$build$src$core$utils$idgenerator=internal$$module$build$src$core$utils$idgenerator,nextId$$module$build$src$core$utils$idgenerator=\n0,module$build$src$core$utils$idgenerator={TEST_ONLY:internal$$module$build$src$core$utils$idgenerator};module$build$src$core$utils$idgenerator.genUid=genUid$$module$build$src$core$utils$idgenerator;module$build$src$core$utils$idgenerator.getNextUniqueId=getNextUniqueId$$module$build$src$core$utils$idgenerator;var group$$module$build$src$core$events$utils,recordUndo$$module$build$src$core$events$utils,disabled$$module$build$src$core$events$utils,BLOCK_CREATE$$module$build$src$core$events$utils,BLOCK_DELETE$$module$build$src$core$events$utils,BLOCK_CHANGE$$module$build$src$core$events$utils,BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils,BLOCK_MOVE$$module$build$src$core$events$utils,VAR_CREATE$$module$build$src$core$events$utils,VAR_DELETE$$module$build$src$core$events$utils,VAR_RENAME$$module$build$src$core$events$utils,\nUI$$module$build$src$core$events$utils,BLOCK_DRAG$$module$build$src$core$events$utils,SELECTED$$module$build$src$core$events$utils,CLICK$$module$build$src$core$events$utils,MARKER_MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN$$module$build$src$core$events$utils,TRASHCAN_OPEN$$module$build$src$core$events$utils,TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils,THEME_CHANGE$$module$build$src$core$events$utils,VIEWPORT_CHANGE$$module$build$src$core$events$utils,COMMENT_CREATE$$module$build$src$core$events$utils,\nCOMMENT_DELETE$$module$build$src$core$events$utils,COMMENT_CHANGE$$module$build$src$core$events$utils,COMMENT_MOVE$$module$build$src$core$events$utils,FINISHED_LOADING$$module$build$src$core$events$utils,BUMP_EVENTS$$module$build$src$core$events$utils,FIRE_QUEUE$$module$build$src$core$events$utils,TEST_ONLY$$module$build$src$core$events$utils,module$build$src$core$events$utils;group$$module$build$src$core$events$utils=\"\";recordUndo$$module$build$src$core$events$utils=!0;\ndisabled$$module$build$src$core$events$utils=0;$.CREATE$$module$build$src$core$events$utils=\"create\";BLOCK_CREATE$$module$build$src$core$events$utils=$.CREATE$$module$build$src$core$events$utils;$.DELETE$$module$build$src$core$events$utils=\"delete\";BLOCK_DELETE$$module$build$src$core$events$utils=$.DELETE$$module$build$src$core$events$utils;$.CHANGE$$module$build$src$core$events$utils=\"change\";BLOCK_CHANGE$$module$build$src$core$events$utils=$.CHANGE$$module$build$src$core$events$utils;\nBLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils=\"block_field_intermediate_change\";$.MOVE$$module$build$src$core$events$utils=\"move\";BLOCK_MOVE$$module$build$src$core$events$utils=$.MOVE$$module$build$src$core$events$utils;VAR_CREATE$$module$build$src$core$events$utils=\"var_create\";VAR_DELETE$$module$build$src$core$events$utils=\"var_delete\";VAR_RENAME$$module$build$src$core$events$utils=\"var_rename\";UI$$module$build$src$core$events$utils=\"ui\";\nBLOCK_DRAG$$module$build$src$core$events$utils=\"drag\";SELECTED$$module$build$src$core$events$utils=\"selected\";CLICK$$module$build$src$core$events$utils=\"click\";MARKER_MOVE$$module$build$src$core$events$utils=\"marker_move\";BUBBLE_OPEN$$module$build$src$core$events$utils=\"bubble_open\";TRASHCAN_OPEN$$module$build$src$core$events$utils=\"trashcan_open\";TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils=\"toolbox_item_select\";THEME_CHANGE$$module$build$src$core$events$utils=\"theme_change\";\nVIEWPORT_CHANGE$$module$build$src$core$events$utils=\"viewport_change\";COMMENT_CREATE$$module$build$src$core$events$utils=\"comment_create\";COMMENT_DELETE$$module$build$src$core$events$utils=\"comment_delete\";COMMENT_CHANGE$$module$build$src$core$events$utils=\"comment_change\";COMMENT_MOVE$$module$build$src$core$events$utils=\"comment_move\";FINISHED_LOADING$$module$build$src$core$events$utils=\"finished_loading\";\nBUMP_EVENTS$$module$build$src$core$events$utils=[$.CREATE$$module$build$src$core$events$utils,$.MOVE$$module$build$src$core$events$utils,COMMENT_CREATE$$module$build$src$core$events$utils,COMMENT_MOVE$$module$build$src$core$events$utils];FIRE_QUEUE$$module$build$src$core$events$utils=[];\nTEST_ONLY$$module$build$src$core$events$utils={FIRE_QUEUE:FIRE_QUEUE$$module$build$src$core$events$utils,fireNow:fireNow$$module$build$src$core$events$utils,fireInternal:fireInternal$$module$build$src$core$events$utils,setGroupInternal:setGroupInternal$$module$build$src$core$events$utils};\nmodule$build$src$core$events$utils={BLOCK_CHANGE:$.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:$.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:$.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:BLOCK_DRAG$$module$build$src$core$events$utils,BLOCK_FIELD_INTERMEDIATE_CHANGE:BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils,BLOCK_MOVE:$.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:BUBBLE_OPEN$$module$build$src$core$events$utils,BUMP_EVENTS:BUMP_EVENTS$$module$build$src$core$events$utils,\nCHANGE:$.CHANGE$$module$build$src$core$events$utils,CLICK:CLICK$$module$build$src$core$events$utils,COMMENT_CHANGE:COMMENT_CHANGE$$module$build$src$core$events$utils,COMMENT_CREATE:COMMENT_CREATE$$module$build$src$core$events$utils,COMMENT_DELETE:COMMENT_DELETE$$module$build$src$core$events$utils,COMMENT_MOVE:COMMENT_MOVE$$module$build$src$core$events$utils,CREATE:$.CREATE$$module$build$src$core$events$utils,DELETE:$.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:FINISHED_LOADING$$module$build$src$core$events$utils,\nMARKER_MOVE:MARKER_MOVE$$module$build$src$core$events$utils,MOVE:$.MOVE$$module$build$src$core$events$utils,SELECTED:SELECTED$$module$build$src$core$events$utils,TEST_ONLY:TEST_ONLY$$module$build$src$core$events$utils,THEME_CHANGE:THEME_CHANGE$$module$build$src$core$events$utils,TOOLBOX_ITEM_SELECT:TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils,TRASHCAN_OPEN:TRASHCAN_OPEN$$module$build$src$core$events$utils,UI:UI$$module$build$src$core$events$utils,VAR_CREATE:VAR_CREATE$$module$build$src$core$events$utils,\nVAR_DELETE:VAR_DELETE$$module$build$src$core$events$utils,VAR_RENAME:VAR_RENAME$$module$build$src$core$events$utils,VIEWPORT_CHANGE:VIEWPORT_CHANGE$$module$build$src$core$events$utils};module$build$src$core$events$utils.clearPendingUndo=clearPendingUndo$$module$build$src$core$events$utils;module$build$src$core$events$utils.disable=$.disable$$module$build$src$core$events$utils;module$build$src$core$events$utils.disableOrphans=disableOrphans$$module$build$src$core$events$utils;\nmodule$build$src$core$events$utils.enable=$.enable$$module$build$src$core$events$utils;module$build$src$core$events$utils.filter=filter$$module$build$src$core$events$utils;module$build$src$core$events$utils.fire=fire$$module$build$src$core$events$utils;module$build$src$core$events$utils.fromJson=fromJson$$module$build$src$core$events$utils;module$build$src$core$events$utils.get=get$$module$build$src$core$events$utils;module$build$src$core$events$utils.getDescendantIds=getDescendantIds$$module$build$src$core$events$utils;\nmodule$build$src$core$events$utils.getGroup=$.getGroup$$module$build$src$core$events$utils;module$build$src$core$events$utils.getRecordUndo=getRecordUndo$$module$build$src$core$events$utils;module$build$src$core$events$utils.isEnabled=isEnabled$$module$build$src$core$events$utils;module$build$src$core$events$utils.setGroup=$.setGroup$$module$build$src$core$events$utils;module$build$src$core$events$utils.setRecordUndo=setRecordUndo$$module$build$src$core$events$utils;var Abstract$$module$build$src$core$events$events_abstract=class{constructor(){this.workspaceId=void 0;this.isUiEvent=!1;this.type=\"\";this.group=$.getGroup$$module$build$src$core$events$utils();this.recordUndo=getRecordUndo$$module$build$src$core$events$utils()}toJson(){return{type:this.type,group:this.group}}static fromJson(a,b,c){c.isBlank=!1;c.group=a.group||\"\";c.workspaceId=b.id;return c}isNull(){return!1}run(a){}getEventWorkspace_(){let a;this.workspaceId&&(a=getWorkspaceById$$module$build$src$core$common(this.workspaceId));\nif(!a)throw Error(\"Workspace is null. Event must have been generated from real Blockly events.\");return a}},module$build$src$core$events$events_abstract={};module$build$src$core$events$events_abstract.Abstract=Abstract$$module$build$src$core$events$events_abstract;var UiBase$$module$build$src$core$events$events_ui_base=class extends Abstract$$module$build$src$core$events$events_abstract{constructor(a){super();this.recordUndo=!1;this.isUiEvent=!0;this.isBlank=\"undefined\"===typeof a;this.workspaceId=a?a:\"\"}},module$build$src$core$events$events_ui_base={};module$build$src$core$events$events_ui_base.UiBase=UiBase$$module$build$src$core$events$events_ui_base;var Click$$module$build$src$core$events$events_click=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c){b=a?a.workspace.id:b;null===b&&(b=void 0);super(b);this.type=CLICK$$module$build$src$core$events$utils;this.blockId=a?a.id:void 0;this.targetType=c}toJson(){const a=super.toJson();if(!this.targetType)throw Error(\"The click target type is undefined. Either pass a block to the constructor, or call fromJson\");a.targetType=this.targetType;a.blockId=this.blockId;return a}static fromJson(a,\nb,c){b=super.fromJson(a,b,null!=c?c:new Click$$module$build$src$core$events$events_click);b.targetType=a.targetType;b.blockId=a.blockId;return b}},ClickTarget$$module$build$src$core$events$events_click;(function(a){a.BLOCK=\"block\";a.WORKSPACE=\"workspace\";a.ZOOM_CONTROLS=\"zoom_controls\"})(ClickTarget$$module$build$src$core$events$events_click||(ClickTarget$$module$build$src$core$events$events_click={}));\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,CLICK$$module$build$src$core$events$utils,Click$$module$build$src$core$events$events_click);var module$build$src$core$events$events_click={};module$build$src$core$events$events_click.Click=Click$$module$build$src$core$events$events_click;module$build$src$core$events$events_click.ClickTarget=ClickTarget$$module$build$src$core$events$events_click;var LONGPRESS$$module$build$src$core$touch=750,TOUCH_ENABLED$$module$build$src$core$touch=\"ontouchstart\"in globalThis||!!(globalThis.document&&document.documentElement&&\"ontouchstart\"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),touchIdentifier_$$module$build$src$core$touch=null,TOUCH_MAP$$module$build$src$core$touch={mousedown:[\"pointerdown\"],mouseenter:[\"pointerenter\"],mouseleave:[\"pointerleave\"],mousemove:[\"pointermove\"],\nmouseout:[\"pointerout\"],mouseover:[\"pointerover\"],mouseup:[\"pointerup\",\"pointercancel\"],touchend:[\"pointerup\"],touchcancel:[\"pointercancel\"]},longPid_$$module$build$src$core$touch=0,module$build$src$core$touch={TOUCH_ENABLED:TOUCH_ENABLED$$module$build$src$core$touch,TOUCH_MAP:TOUCH_MAP$$module$build$src$core$touch};module$build$src$core$touch.checkTouchIdentifier=checkTouchIdentifier$$module$build$src$core$touch;module$build$src$core$touch.clearTouchIdentifier=clearTouchIdentifier$$module$build$src$core$touch;\nmodule$build$src$core$touch.getTouchIdentifierFromEvent=getTouchIdentifierFromEvent$$module$build$src$core$touch;module$build$src$core$touch.longStart=longStart$$module$build$src$core$touch;module$build$src$core$touch.longStop=longStop$$module$build$src$core$touch;module$build$src$core$touch.shouldHandleEvent=shouldHandleEvent$$module$build$src$core$touch;var rawUserAgent$$module$build$src$core$utils$useragent,isJavaFx$$module$build$src$core$utils$useragent,isWebKit$$module$build$src$core$utils$useragent,isGecko$$module$build$src$core$utils$useragent,isAndroid$$module$build$src$core$utils$useragent,isIPad$$module$build$src$core$utils$useragent,isIPhone$$module$build$src$core$utils$useragent,isMac$$module$build$src$core$utils$useragent,isTablet$$module$build$src$core$utils$useragent,isMobile$$module$build$src$core$utils$useragent;\n(function(a){function b(d){return-1!==c.indexOf(d.toUpperCase())}rawUserAgent$$module$build$src$core$utils$useragent=a;const c=rawUserAgent$$module$build$src$core$utils$useragent.toUpperCase();isJavaFx$$module$build$src$core$utils$useragent=b(\"JavaFX\");isWebKit$$module$build$src$core$utils$useragent=b(\"WebKit\");isGecko$$module$build$src$core$utils$useragent=b(\"Gecko\")&&!isWebKit$$module$build$src$core$utils$useragent;isAndroid$$module$build$src$core$utils$useragent=b(\"Android\");a=globalThis.navigator&&\nglobalThis.navigator.maxTouchPoints;isIPad$$module$build$src$core$utils$useragent=b(\"iPad\")||b(\"Macintosh\")&&0<a;isIPhone$$module$build$src$core$utils$useragent=b(\"iPhone\")&&!isIPad$$module$build$src$core$utils$useragent;isMac$$module$build$src$core$utils$useragent=b(\"Macintosh\");isTablet$$module$build$src$core$utils$useragent=isIPad$$module$build$src$core$utils$useragent||isAndroid$$module$build$src$core$utils$useragent&&!b(\"Mobile\")||b(\"Silk\");isMobile$$module$build$src$core$utils$useragent=!isTablet$$module$build$src$core$utils$useragent&&\n(isIPhone$$module$build$src$core$utils$useragent||isAndroid$$module$build$src$core$utils$useragent)})(globalThis.navigator&&globalThis.navigator.userAgent||\"\");\nvar raw$$module$build$src$core$utils$useragent=rawUserAgent$$module$build$src$core$utils$useragent,JavaFx$$module$build$src$core$utils$useragent=isJavaFx$$module$build$src$core$utils$useragent,GECKO$$module$build$src$core$utils$useragent=isGecko$$module$build$src$core$utils$useragent,ANDROID$$module$build$src$core$utils$useragent=isAndroid$$module$build$src$core$utils$useragent,IPAD$$module$build$src$core$utils$useragent=isIPad$$module$build$src$core$utils$useragent,IPHONE$$module$build$src$core$utils$useragent=\nisIPhone$$module$build$src$core$utils$useragent,MAC$$module$build$src$core$utils$useragent=isMac$$module$build$src$core$utils$useragent,MOBILE$$module$build$src$core$utils$useragent=isMobile$$module$build$src$core$utils$useragent,module$build$src$core$utils$useragent={ANDROID:ANDROID$$module$build$src$core$utils$useragent,GECKO:GECKO$$module$build$src$core$utils$useragent,IPAD:IPAD$$module$build$src$core$utils$useragent,IPHONE:IPHONE$$module$build$src$core$utils$useragent,JavaFx:JavaFx$$module$build$src$core$utils$useragent,\nMAC:MAC$$module$build$src$core$utils$useragent,MOBILE:MOBILE$$module$build$src$core$utils$useragent,raw:raw$$module$build$src$core$utils$useragent};var LINE_MODE_MULTIPLIER$$module$build$src$core$browser_events=40,PAGE_MODE_MULTIPLIER$$module$build$src$core$browser_events=125,module$build$src$core$browser_events={};module$build$src$core$browser_events.bind=bind$$module$build$src$core$browser_events;module$build$src$core$browser_events.conditionalBind=conditionalBind$$module$build$src$core$browser_events;module$build$src$core$browser_events.getScrollDeltaPixels=getScrollDeltaPixels$$module$build$src$core$browser_events;\nmodule$build$src$core$browser_events.isRightButton=isRightButton$$module$build$src$core$browser_events;module$build$src$core$browser_events.isTargetInput=isTargetInput$$module$build$src$core$browser_events;module$build$src$core$browser_events.mouseToSvg=mouseToSvg$$module$build$src$core$browser_events;module$build$src$core$browser_events.unbind=unbind$$module$build$src$core$browser_events;var module$build$src$core$utils$array={};module$build$src$core$utils$array.removeElem=removeElem$$module$build$src$core$utils$array;var Capability$$module$build$src$core$component_manager=class{constructor(a){this.name_=a}toString(){return this.name_}};Capability$$module$build$src$core$component_manager.POSITIONABLE=new Capability$$module$build$src$core$component_manager(\"positionable\");Capability$$module$build$src$core$component_manager.DRAG_TARGET=new Capability$$module$build$src$core$component_manager(\"drag_target\");Capability$$module$build$src$core$component_manager.DELETE_AREA=new Capability$$module$build$src$core$component_manager(\"delete_area\");\nCapability$$module$build$src$core$component_manager.AUTOHIDEABLE=new Capability$$module$build$src$core$component_manager(\"autohideable\");\nvar ComponentManager$$module$build$src$core$component_manager=class{constructor(){this.componentData=new Map;this.capabilityToComponentIds=new Map}addComponent(a,b){const c=a.component.id;if(!b&&this.componentData.has(c)){var d;throw Error('Plugin \"'+c+'\" with capabilities \"'+(null==(d=this.componentData.get(c))?void 0:d.capabilities)+'\" already added.');}this.componentData.set(c,a);b=[];for(d=0;d<a.capabilities.length;d++){const e=String(a.capabilities[d]).toLowerCase();b.push(e);if(this.capabilityToComponentIds.has(e)){let f;\nnull==(f=this.capabilityToComponentIds.get(e))||f.push(c)}else this.capabilityToComponentIds.set(e,[c])}this.componentData.get(c).capabilities=b}removeComponent(a){const b=this.componentData.get(a);if(b){for(let c=0;c<b.capabilities.length;c++){const d=String(b.capabilities[c]).toLowerCase();removeElem$$module$build$src$core$utils$array(this.capabilityToComponentIds.get(d),a)}this.componentData.delete(a)}}addCapability(a,b){if(!this.getComponent(a))throw Error('Cannot add capability, \"'+b+'\". Plugin \"'+\na+'\" has not been added to the ComponentManager');if(this.hasCapability(a,b))console.warn('Plugin \"'+a+'already has capability \"'+b+'\"');else{b=`${b}`.toLowerCase();var c;null==(c=this.componentData.get(a))||c.capabilities.push(b);var d;null==(d=this.capabilityToComponentIds.get(b))||d.push(a)}}removeCapability(a,b){if(!this.getComponent(a))throw Error('Cannot remove capability, \"'+b+'\". Plugin \"'+a+'\" has not been added to the ComponentManager');this.hasCapability(a,b)?(b=`${b}`.toLowerCase(),removeElem$$module$build$src$core$utils$array(this.componentData.get(a).capabilities,\nb),removeElem$$module$build$src$core$utils$array(this.capabilityToComponentIds.get(b),a)):console.warn('Plugin \"'+a+\"doesn't have capability \\\"\"+b+'\" to remove')}hasCapability(a,b){b=`${b}`.toLowerCase();return this.componentData.has(a)&&-1!==this.componentData.get(a).capabilities.indexOf(b)}getComponent(a){let b;return null==(b=this.componentData.get(a))?void 0:b.component}getComponents(a,b){a=`${a}`.toLowerCase();a=this.capabilityToComponentIds.get(a);if(!a)return[];const c=[];if(b){const d=[];\na.forEach(e=>{d.push(this.componentData.get(e))});d.sort(function(e,f){return e.weight-f.weight});d.forEach(function(e){c.push(e.component)})}else a.forEach(d=>{c.push(this.componentData.get(d).component)});return c}};ComponentManager$$module$build$src$core$component_manager.Capability=Capability$$module$build$src$core$component_manager;var module$build$src$core$component_manager={};module$build$src$core$component_manager.ComponentManager=ComponentManager$$module$build$src$core$component_manager;var injected$$module$build$src$core$css=!1,content$$module$build$src$core$css='\\n.blocklySvg {\\n  background-color: #fff;\\n  outline: none;\\n  overflow: hidden;  /* IE overflows by default. */\\n  position: absolute;\\n  display: block;\\n}\\n\\n.blocklyWidgetDiv {\\n  display: none;\\n  position: absolute;\\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\\n}\\n\\n.injectionDiv {\\n  height: 100%;\\n  position: relative;\\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\\n  touch-action: none;\\n}\\n\\n.blocklyNonSelectable {\\n  user-select: none;\\n  -ms-user-select: none;\\n  -webkit-user-select: none;\\n}\\n\\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\\n  transition: transform .5s;\\n}\\n\\n.blocklyTooltipDiv {\\n  background-color: #ffffc7;\\n  border: 1px solid #ddc;\\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\\n  color: #000;\\n  display: none;\\n  font: 9pt sans-serif;\\n  opacity: .9;\\n  padding: 2px;\\n  position: absolute;\\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\\n}\\n\\n.blocklyDropDownDiv {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1000;\\n  display: none;\\n  border: 1px solid;\\n  border-color: #dadce0;\\n  background-color: #fff;\\n  border-radius: 2px;\\n  padding: 4px;\\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\\n}\\n\\n.blocklyDropDownDiv.blocklyFocused {\\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\\n}\\n\\n.blocklyDropDownContent {\\n  max-height: 300px;  /* @todo: spec for maximum height. */\\n  overflow: auto;\\n  overflow-x: hidden;\\n  position: relative;\\n}\\n\\n.blocklyDropDownArrow {\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 16px;\\n  height: 16px;\\n  z-index: -1;\\n  background-color: inherit;\\n  border-color: inherit;\\n}\\n\\n.blocklyDropDownButton {\\n  display: inline-block;\\n  float: left;\\n  padding: 0;\\n  margin: 4px;\\n  border-radius: 4px;\\n  outline: none;\\n  border: 1px solid;\\n  transition: box-shadow .1s;\\n  cursor: pointer;\\n}\\n\\n.blocklyArrowTop {\\n  border-top: 1px solid;\\n  border-left: 1px solid;\\n  border-top-left-radius: 4px;\\n  border-color: inherit;\\n}\\n\\n.blocklyArrowBottom {\\n  border-bottom: 1px solid;\\n  border-right: 1px solid;\\n  border-bottom-right-radius: 4px;\\n  border-color: inherit;\\n}\\n\\n.blocklyResizeSE {\\n  cursor: se-resize;\\n  fill: #aaa;\\n}\\n\\n.blocklyResizeSW {\\n  cursor: sw-resize;\\n  fill: #aaa;\\n}\\n\\n.blocklyResizeLine {\\n  stroke: #515A5A;\\n  stroke-width: 1;\\n}\\n\\n.blocklyHighlightedConnectionPath {\\n  fill: none;\\n  stroke: #fc3;\\n  stroke-width: 4px;\\n}\\n\\n.blocklyPathLight {\\n  fill: none;\\n  stroke-linecap: round;\\n  stroke-width: 1;\\n}\\n\\n.blocklySelected>.blocklyPathLight {\\n  display: none;\\n}\\n\\n.blocklyDraggable {\\n  cursor: grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.blocklyDragging {\\n  cursor: grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\\n  /* Changes cursor on mouse down. Not effective in Firefox because of\\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\\n.blocklyDraggable:active {\\n  cursor: grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\\n.blocklyDragging.blocklyDraggingDelete {\\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\\n}\\n\\n.blocklyDragging>.blocklyPath,\\n.blocklyDragging>.blocklyPathLight {\\n  fill-opacity: .8;\\n  stroke-opacity: .8;\\n}\\n\\n.blocklyDragging>.blocklyPathDark {\\n  display: none;\\n}\\n\\n.blocklyDisabled>.blocklyPath {\\n  fill-opacity: .5;\\n  stroke-opacity: .5;\\n}\\n\\n.blocklyDisabled>.blocklyPathLight,\\n.blocklyDisabled>.blocklyPathDark {\\n  display: none;\\n}\\n\\n.blocklyInsertionMarker>.blocklyPath,\\n.blocklyInsertionMarker>.blocklyPathLight,\\n.blocklyInsertionMarker>.blocklyPathDark {\\n  fill-opacity: .2;\\n  stroke: none;\\n}\\n\\n.blocklyMultilineText {\\n  font-family: monospace;\\n}\\n\\n.blocklyNonEditableText>text {\\n  pointer-events: none;\\n}\\n\\n.blocklyFlyout {\\n  position: absolute;\\n  z-index: 20;\\n}\\n\\n.blocklyText text {\\n  cursor: default;\\n}\\n\\n/*\\n  Don\\'t allow users to select text.  It gets annoying when trying to\\n  drag a block and selected text moves instead.\\n*/\\n.blocklySvg text {\\n  user-select: none;\\n  -ms-user-select: none;\\n  -webkit-user-select: none;\\n  cursor: inherit;\\n}\\n\\n.blocklyHidden {\\n  display: none;\\n}\\n\\n.blocklyFieldDropdown:not(.blocklyHidden) {\\n  display: block;\\n}\\n\\n.blocklyIconGroup {\\n  cursor: default;\\n}\\n\\n.blocklyIconGroup:not(:hover),\\n.blocklyIconGroupReadonly {\\n  opacity: .6;\\n}\\n\\n.blocklyIconShape {\\n  fill: #00f;\\n  stroke: #fff;\\n  stroke-width: 1px;\\n}\\n\\n.blocklyIconSymbol {\\n  fill: #fff;\\n}\\n\\n.blocklyMinimalBody {\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.blocklyHtmlInput {\\n  border: none;\\n  border-radius: 4px;\\n  height: 100%;\\n  margin: 0;\\n  outline: none;\\n  padding: 0;\\n  width: 100%;\\n  text-align: center;\\n  display: block;\\n  box-sizing: border-box;\\n}\\n\\n/* Remove the increase and decrease arrows on the field number editor */\\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\\n  -webkit-appearance: none;\\n  margin: 0;\\n}\\n\\ninput[type=number] {\\n  -moz-appearance: textfield;\\n}\\n\\n.blocklyMainBackground {\\n  stroke-width: 1;\\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\\n}\\n\\n.blocklyMutatorBackground {\\n  fill: #fff;\\n  stroke: #ddd;\\n  stroke-width: 1;\\n}\\n\\n.blocklyFlyoutBackground {\\n  fill: #ddd;\\n  fill-opacity: .8;\\n}\\n\\n.blocklyMainWorkspaceScrollbar {\\n  z-index: 20;\\n}\\n\\n.blocklyFlyoutScrollbar {\\n  z-index: 30;\\n}\\n\\n.blocklyScrollbarHorizontal,\\n.blocklyScrollbarVertical {\\n  position: absolute;\\n  outline: none;\\n}\\n\\n.blocklyScrollbarBackground {\\n  opacity: 0;\\n}\\n\\n.blocklyScrollbarHandle {\\n  fill: #ccc;\\n}\\n\\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\\n.blocklyScrollbarHandle:hover {\\n  fill: #bbb;\\n}\\n\\n/* Darken flyout scrollbars due to being on a grey background. */\\n/* By contrast, workspace scrollbars are on a white background. */\\n.blocklyFlyout .blocklyScrollbarHandle {\\n  fill: #bbb;\\n}\\n\\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\\n.blocklyFlyout .blocklyScrollbarHandle:hover {\\n  fill: #aaa;\\n}\\n\\n.blocklyInvalidInput {\\n  background: #faa;\\n}\\n\\n.blocklyVerticalMarker {\\n  stroke-width: 3px;\\n  fill: rgba(255,255,255,.5);\\n  pointer-events: none;\\n}\\n\\n.blocklyComputeCanvas {\\n  position: absolute;\\n  width: 0;\\n  height: 0;\\n}\\n\\n.blocklyNoPointerEvents {\\n  pointer-events: none;\\n}\\n\\n.blocklyContextMenu {\\n  border-radius: 4px;\\n  max-height: 100%;\\n}\\n\\n.blocklyDropdownMenu {\\n  border-radius: 2px;\\n  padding: 0 !important;\\n}\\n\\n.blocklyDropdownMenu .blocklyMenuItem {\\n  /* 28px on the left for icon or checkbox. */\\n  padding-left: 28px;\\n}\\n\\n/* BiDi override for the resting state. */\\n.blocklyDropdownMenu .blocklyMenuItemRtl {\\n  /* Flip left/right padding for BiDi. */\\n  padding-left: 5px;\\n  padding-right: 28px;\\n}\\n\\n.blocklyWidgetDiv .blocklyMenu {\\n  background: #fff;\\n  border: 1px solid transparent;\\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\\n  font: normal 13px Arial, sans-serif;\\n  margin: 0;\\n  outline: none;\\n  padding: 4px 0;\\n  position: absolute;\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n  max-height: 100%;\\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\\n}\\n\\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\\n}\\n\\n.blocklyDropDownDiv .blocklyMenu {\\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\\n  font: normal 13px \"Helvetica Neue\", Helvetica, sans-serif;\\n  outline: none;\\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\\n}\\n\\n/* State: resting. */\\n.blocklyMenuItem {\\n  border: none;\\n  color: #000;\\n  cursor: pointer;\\n  list-style: none;\\n  margin: 0;\\n  /* 7em on the right for shortcut. */\\n  min-width: 7em;\\n  padding: 6px 15px;\\n  white-space: nowrap;\\n}\\n\\n/* State: disabled. */\\n.blocklyMenuItemDisabled {\\n  color: #ccc;\\n  cursor: inherit;\\n}\\n\\n/* State: hover. */\\n.blocklyMenuItemHighlight {\\n  background-color: rgba(0,0,0,.1);\\n}\\n\\n/* State: selected/checked. */\\n.blocklyMenuItemCheckbox {\\n  height: 16px;\\n  position: absolute;\\n  width: 16px;\\n}\\n\\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\\n  float: left;\\n  margin-left: -24px;\\n  position: static;  /* Scroll with the menu. */\\n}\\n\\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\\n  float: right;\\n  margin-right: -24px;\\n}\\n\\n.blocklyBlockDragSurface {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  overflow: visible !important;\\n  z-index: 80;\\n  pointer-events: none;\\n}\\n',\nmodule$build$src$core$css={};module$build$src$core$css.inject=inject$$module$build$src$core$css;module$build$src$core$css.register=register$$module$build$src$core$css;var Coordinate$$module$build$src$core$utils$coordinate=class{constructor(a,b){this.x=a;this.y=b}clone(){return new Coordinate$$module$build$src$core$utils$coordinate(this.x,this.y)}scale(a){this.x*=a;this.y*=a;return this}translate(a,b){this.x+=a;this.y+=b;return this}static equals(a,b){return a===b?!0:a&&b?a.x===b.x&&a.y===b.y:!1}static distance(a,b){const c=a.x-b.x;a=a.y-b.y;return Math.sqrt(c*c+a*a)}static magnitude(a){return Math.sqrt(a.x*a.x+a.y*a.y)}static difference(a,b){return new Coordinate$$module$build$src$core$utils$coordinate(a.x-\nb.x,a.y-b.y)}static sum(a,b){return new Coordinate$$module$build$src$core$utils$coordinate(a.x+b.x,a.y+b.y)}},module$build$src$core$utils$coordinate={};module$build$src$core$utils$coordinate.Coordinate=Coordinate$$module$build$src$core$utils$coordinate;var module$build$src$core$utils$deprecation={};module$build$src$core$utils$deprecation.warn=warn$$module$build$src$core$utils$deprecation;var SVG_NS$$module$build$src$core$utils$dom=\"http://www.w3.org/2000/svg\",HTML_NS$$module$build$src$core$utils$dom=\"http://www.w3.org/1999/xhtml\",XLINK_NS$$module$build$src$core$utils$dom=\"http://www.w3.org/1999/xlink\",NodeType$$module$build$src$core$utils$dom;(function(a){a[a.ELEMENT_NODE=1]=\"ELEMENT_NODE\";a[a.TEXT_NODE=3]=\"TEXT_NODE\";a[a.COMMENT_NODE=8]=\"COMMENT_NODE\"})(NodeType$$module$build$src$core$utils$dom||(NodeType$$module$build$src$core$utils$dom={}));\nvar cacheWidths$$module$build$src$core$utils$dom=null,cacheReference$$module$build$src$core$utils$dom=0,canvasContext$$module$build$src$core$utils$dom=null,module$build$src$core$utils$dom={HTML_NS:HTML_NS$$module$build$src$core$utils$dom};module$build$src$core$utils$dom.NodeType=NodeType$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.SVG_NS=SVG_NS$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.XLINK_NS=XLINK_NS$$module$build$src$core$utils$dom;\nmodule$build$src$core$utils$dom.addClass=addClass$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.containsNode=containsNode$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.createSvgElement=createSvgElement$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.getFastTextWidth=getFastTextWidth$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.getFastTextWidthWithSizeString=getFastTextWidthWithSizeString$$module$build$src$core$utils$dom;\nmodule$build$src$core$utils$dom.getTextWidth=getTextWidth$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.hasClass=hasClass$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.insertAfter=insertAfter$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.measureFontMetrics=measureFontMetrics$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.removeClass=removeClass$$module$build$src$core$utils$dom;\nmodule$build$src$core$utils$dom.removeClasses=removeClasses$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.removeNode=removeNode$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.setCssTransform=setCssTransform$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.startTextWidthCache=startTextWidthCache$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.stopTextWidthCache=stopTextWidthCache$$module$build$src$core$utils$dom;var Svg$$module$build$src$core$utils$svg=class{constructor(a){this.tagName=a}toString(){return this.tagName}};Svg$$module$build$src$core$utils$svg.ANIMATE=new Svg$$module$build$src$core$utils$svg(\"animate\");Svg$$module$build$src$core$utils$svg.CIRCLE=new Svg$$module$build$src$core$utils$svg(\"circle\");Svg$$module$build$src$core$utils$svg.CLIPPATH=new Svg$$module$build$src$core$utils$svg(\"clipPath\");Svg$$module$build$src$core$utils$svg.DEFS=new Svg$$module$build$src$core$utils$svg(\"defs\");\nSvg$$module$build$src$core$utils$svg.FECOMPOSITE=new Svg$$module$build$src$core$utils$svg(\"feComposite\");Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER=new Svg$$module$build$src$core$utils$svg(\"feComponentTransfer\");Svg$$module$build$src$core$utils$svg.FEFLOOD=new Svg$$module$build$src$core$utils$svg(\"feFlood\");Svg$$module$build$src$core$utils$svg.FEFUNCA=new Svg$$module$build$src$core$utils$svg(\"feFuncA\");Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR=new Svg$$module$build$src$core$utils$svg(\"feGaussianBlur\");\nSvg$$module$build$src$core$utils$svg.FEPOINTLIGHT=new Svg$$module$build$src$core$utils$svg(\"fePointLight\");Svg$$module$build$src$core$utils$svg.FESPECULARLIGHTING=new Svg$$module$build$src$core$utils$svg(\"feSpecularLighting\");Svg$$module$build$src$core$utils$svg.FILTER=new Svg$$module$build$src$core$utils$svg(\"filter\");Svg$$module$build$src$core$utils$svg.FOREIGNOBJECT=new Svg$$module$build$src$core$utils$svg(\"foreignObject\");Svg$$module$build$src$core$utils$svg.G=new Svg$$module$build$src$core$utils$svg(\"g\");\nSvg$$module$build$src$core$utils$svg.IMAGE=new Svg$$module$build$src$core$utils$svg(\"image\");Svg$$module$build$src$core$utils$svg.LINE=new Svg$$module$build$src$core$utils$svg(\"line\");Svg$$module$build$src$core$utils$svg.PATH=new Svg$$module$build$src$core$utils$svg(\"path\");Svg$$module$build$src$core$utils$svg.PATTERN=new Svg$$module$build$src$core$utils$svg(\"pattern\");Svg$$module$build$src$core$utils$svg.POLYGON=new Svg$$module$build$src$core$utils$svg(\"polygon\");\nSvg$$module$build$src$core$utils$svg.RECT=new Svg$$module$build$src$core$utils$svg(\"rect\");Svg$$module$build$src$core$utils$svg.SVG=new Svg$$module$build$src$core$utils$svg(\"svg\");Svg$$module$build$src$core$utils$svg.TEXT=new Svg$$module$build$src$core$utils$svg(\"text\");Svg$$module$build$src$core$utils$svg.TSPAN=new Svg$$module$build$src$core$utils$svg(\"tspan\");var module$build$src$core$utils$svg={};module$build$src$core$utils$svg.Svg=Svg$$module$build$src$core$utils$svg;var Rect$$module$build$src$core$utils$rect=class{constructor(a,b,c,d){this.top=a;this.bottom=b;this.left=c;this.right=d}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(a,b){return a>=this.left&&a<=this.right&&b>=this.top&&b<=this.bottom}intersects(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top)}},module$build$src$core$utils$rect={};module$build$src$core$utils$rect.Rect=Rect$$module$build$src$core$utils$rect;var Size$$module$build$src$core$utils$size=class{constructor(a,b){this.width=a;this.height=b}static equals(a,b){return a===b?!0:a&&b?a.width===b.width&&a.height===b.height:!1}},module$build$src$core$utils$size={};module$build$src$core$utils$size.Size=Size$$module$build$src$core$utils$size;var TEST_ONLY$$module$build$src$core$utils$style={getSizeInternal:getSizeInternal$$module$build$src$core$utils$style},module$build$src$core$utils$style={TEST_ONLY:TEST_ONLY$$module$build$src$core$utils$style};module$build$src$core$utils$style.getBorderBox=getBorderBox$$module$build$src$core$utils$style;module$build$src$core$utils$style.getComputedStyle=getComputedStyle$$module$build$src$core$utils$style;module$build$src$core$utils$style.getContainerOffsetToScrollInto=getContainerOffsetToScrollInto$$module$build$src$core$utils$style;\nmodule$build$src$core$utils$style.getPageOffset=getPageOffset$$module$build$src$core$utils$style;module$build$src$core$utils$style.getSize=getSize$$module$build$src$core$utils$style;module$build$src$core$utils$style.getViewportPageOffset=getViewportPageOffset$$module$build$src$core$utils$style;module$build$src$core$utils$style.scrollIntoContainerView=scrollIntoContainerView$$module$build$src$core$utils$style;var XY_REGEX$$module$build$src$core$utils$svg_math=/translate\\(\\s*([-+\\d.e]+)([ ,]\\s*([-+\\d.e]+)\\s*)?/,XY_STYLE_REGEX$$module$build$src$core$utils$svg_math=/transform:\\s*translate(?:3d)?\\(\\s*([-+\\d.e]+)\\s*px([ ,]\\s*([-+\\d.e]+)\\s*px)?/,TEST_ONLY$$module$build$src$core$utils$svg_math={XY_REGEX:XY_REGEX$$module$build$src$core$utils$svg_math,XY_STYLE_REGEX:XY_STYLE_REGEX$$module$build$src$core$utils$svg_math},module$build$src$core$utils$svg_math={TEST_ONLY:TEST_ONLY$$module$build$src$core$utils$svg_math};\nmodule$build$src$core$utils$svg_math.getDocumentScroll=getDocumentScroll$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getInjectionDivXY=getInjectionDivXY$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getRelativeXY=getRelativeXY$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getViewportBBox=getViewportBBox$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.screenToWsCoordinates=screenToWsCoordinates$$module$build$src$core$utils$svg_math;\nmodule$build$src$core$utils$svg_math.wsToScreenCoordinates=wsToScreenCoordinates$$module$build$src$core$utils$svg_math;var Scrollbar$$module$build$src$core$scrollbar=class{constructor(a,b,c,d,e){this.workspace=a;this.horizontal=b;this.oldHostMetrics=null;this.ratio=1;this.origin=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0;this.containerVisible=this.isHandleVisible=!0;this.position=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null;this.pair=\nc||!1;this.margin=void 0!==e?e:Scrollbar$$module$build$src$core$scrollbar.DEFAULT_SCROLLBAR_MARGIN;a=\"blocklyScrollbar\"+(this.horizontal?\"Horizontal\":\"Vertical\");d&&(a+=\" \"+d);this.outerSvg=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{\"class\":a});d=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{},this.outerSvg);this.svgBackground=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,\n{\"class\":\"blocklyScrollbarBackground\"},d);a=Math.floor((Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness-5)/2);this.svgHandle=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyScrollbarHandle\",rx:a,ry:a},d);this.workspace.getThemeManager().subscribe(this.svgHandle,\"scrollbarColour\",\"fill\");this.workspace.getThemeManager().subscribe(this.svgHandle,\"scrollbarOpacity\",\"fill-opacity\");insertAfter$$module$build$src$core$utils$dom(this.outerSvg,\nthis.workspace.getParentSvg());this.setInitialThickness();b?(this.lengthAttribute_=\"width\",this.positionAttribute_=\"x\"):(this.lengthAttribute_=\"height\",this.positionAttribute_=\"y\");this.onMouseDownBarWrapper_=conditionalBind$$module$build$src$core$browser_events(this.svgBackground,\"pointerdown\",this,this.onMouseDownBar);this.onMouseDownHandleWrapper_=conditionalBind$$module$build$src$core$browser_events(this.svgHandle,\"pointerdown\",this,this.onMouseDownHandle)}setInitialThickness(){const a=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness;\nthis.horizontal?(this.svgBackground.setAttribute(\"height\",String(a)),this.outerSvg.setAttribute(\"height\",String(a)),this.svgHandle.setAttribute(\"height\",String(a-5)),this.svgHandle.setAttribute(\"y\",\"2.5\")):(this.svgBackground.setAttribute(\"width\",String(a)),this.outerSvg.setAttribute(\"width\",String(a)),this.svgHandle.setAttribute(\"width\",String(a-5)),this.svgHandle.setAttribute(\"x\",\"2.5\"))}dispose(){this.cleanUp();unbind$$module$build$src$core$browser_events(this.onMouseDownBarWrapper_);unbind$$module$build$src$core$browser_events(this.onMouseDownHandleWrapper_);\nremoveNode$$module$build$src$core$utils$dom(this.outerSvg);this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(a){return a=0>=a||isNaN(a)?0:Math.min(a,this.scrollbarLength)}setHandleLength(a){this.handleLength=a;this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(a){return a=0>=a||isNaN(a)?0:Math.min(a,this.scrollbarLength-this.handleLength)}setHandlePosition(a){this.handlePosition=a;this.svgHandle.setAttribute(this.positionAttribute_,\nString(this.handlePosition))}setScrollbarLength(a){this.scrollbarLength=a;this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength));this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(a,b){this.position.x=a;this.position.y=b;setCssTransform$$module$build$src$core$utils$dom(this.outerSvg,\"translate(\"+(this.position.x+this.origin.x)+\"px,\"+(this.position.y+this.origin.y)+\"px)\")}resize(a){if(!a&&(a=this.workspace.getMetrics(),!a))return;\nthis.oldHostMetrics&&Scrollbar$$module$build$src$core$scrollbar.metricsAreEquivalent(a,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(a):this.resizeVertical(a),this.oldHostMetrics=a,this.updateMetrics())}requiresViewResize(a){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==a.viewWidth||this.oldHostMetrics.viewHeight!==a.viewHeight||this.oldHostMetrics.absoluteLeft!==a.absoluteLeft||this.oldHostMetrics.absoluteTop!==a.absoluteTop:!0}resizeHorizontal(a){this.requiresViewResize(a)?\nthis.resizeViewHorizontal(a):this.resizeContentHorizontal(a)}resizeViewHorizontal(a){var b=a.viewWidth-2*this.margin;this.pair&&(b-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness);this.setScrollbarLength(Math.max(0,b));b=a.absoluteLeft+this.margin;this.pair&&this.workspace.RTL&&(b+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness);this.setPosition(b,a.absoluteTop+a.viewHeight-Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness-this.margin);this.resizeContentHorizontal(a)}resizeContentHorizontal(a){if(a.viewWidth>=\na.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var b=this.scrollbarLength*a.viewWidth/a.scrollWidth;b=this.constrainHandleLength(b);this.setHandleLength(b);b=a.scrollWidth-a.viewWidth;var c=this.scrollbarLength-this.handleLength;a=(a.viewLeft-a.scrollLeft)/b*c;a=this.constrainHandlePosition(a);this.setHandlePosition(a);this.ratio=c/b}}resizeVertical(a){this.requiresViewResize(a)?this.resizeViewVertical(a):\nthis.resizeContentVertical(a)}resizeViewVertical(a){let b=a.viewHeight-2*this.margin;this.pair&&(b-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness);this.setScrollbarLength(Math.max(0,b));this.setPosition(this.workspace.RTL?a.absoluteLeft+this.margin:a.absoluteLeft+a.viewWidth-Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness-this.margin,a.absoluteTop+this.margin);this.resizeContentVertical(a)}resizeContentVertical(a){if(a.viewHeight>=a.scrollHeight)this.setHandleLength(this.scrollbarLength),\nthis.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var b=this.scrollbarLength*a.viewHeight/a.scrollHeight;b=this.constrainHandleLength(b);this.setHandleLength(b);b=a.scrollHeight-a.viewHeight;var c=this.scrollbarLength-this.handleLength;a=(a.viewTop-a.scrollTop)/b*c;a=this.constrainHandlePosition(a);this.setHandlePosition(a);this.ratio=c/b}}isVisible(){return this.isHandleVisible}setContainerVisible(a){const b=a!==this.containerVisible;this.containerVisible=\na;b&&this.updateDisplay_()}setVisible(a){if(this.pair)throw Error(\"Unable to toggle visibility of paired scrollbars.\");this.setVisibleInternal(a)}setVisibleInternal(a){const b=a!==this.isVisible();this.isHandleVisible=a;b&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute(\"display\",\"block\"):this.outerSvg.setAttribute(\"display\",\"none\")}onMouseDownBar(a){this.workspace.markFocused();clearTouchIdentifier$$module$build$src$core$touch();this.cleanUp();\nif(isRightButton$$module$build$src$core$browser_events(a))a.stopPropagation();else{var b=mouseToSvg$$module$build$src$core$browser_events(a,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());b=this.horizontal?b.x:b.y;var c=getInjectionDivXY$$module$build$src$core$utils$svg_math(this.svgHandle);c=this.horizontal?c.x:c.y;var d=this.handlePosition,e=.95*this.handleLength;b<=c?d-=e:b>=c+this.handleLength&&(d+=e);this.setHandlePosition(this.constrainHandlePosition(d));this.updateMetrics();\na.stopPropagation();a.preventDefault()}}onMouseDownHandle(a){this.workspace.markFocused();this.cleanUp();isRightButton$$module$build$src$core$browser_events(a)?a.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?a.clientX:a.clientY,this.onMouseUpWrapper_=conditionalBind$$module$build$src$core$browser_events(document,\"pointerup\",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=conditionalBind$$module$build$src$core$browser_events(document,\"pointermove\",\nthis,this.onMouseMoveHandle),a.stopPropagation(),a.preventDefault())}onMouseMoveHandle(a){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?a.clientX:a.clientY)-this.startDragMouse)));this.updateMetrics()}onMouseUpHandle(){clearTouchIdentifier$$module$build$src$core$touch();this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0);this.onMouseUpWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null);this.onMouseMoveWrapper_&&\n(unbind$$module$build$src$core$browser_events(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let a=this.handlePosition/(this.scrollbarLength-this.handleLength);isNaN(a)&&(a=0);return a}updateMetrics(){const a=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:a}):this.workspace.setMetrics({y:a})}set(a,b){this.setHandlePosition(this.constrainHandlePosition(a*this.ratio));(b||void 0===b)&&this.updateMetrics()}setOrigin(a,b){this.origin=new Coordinate$$module$build$src$core$utils$coordinate(a,\nb)}static metricsAreEquivalent(a,b){return a.viewWidth===b.viewWidth&&a.viewHeight===b.viewHeight&&a.viewLeft===b.viewLeft&&a.viewTop===b.viewTop&&a.absoluteTop===b.absoluteTop&&a.absoluteLeft===b.absoluteLeft&&a.scrollWidth===b.scrollWidth&&a.scrollHeight===b.scrollHeight&&a.scrollLeft===b.scrollLeft&&a.scrollTop===b.scrollTop}};Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness=TOUCH_ENABLED$$module$build$src$core$touch?25:15;\nScrollbar$$module$build$src$core$scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5;var module$build$src$core$scrollbar={};module$build$src$core$scrollbar.Scrollbar=Scrollbar$$module$build$src$core$scrollbar;var domParser$$module$build$src$core$utils$xml={parseFromString:function(){throw Error(\"DOMParser was not found in the global scope and was not properly injected using injectDependencies\");}},xmlSerializer$$module$build$src$core$utils$xml={serializeToString:function(){throw Error(\"XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies\");}},{document:document$$module$build$src$core$utils$xml,DOMParser:DOMParser$$module$build$src$core$utils$xml,XMLSerializer:XMLSerializer$$module$build$src$core$utils$xml}=\nglobalThis;DOMParser$$module$build$src$core$utils$xml&&(domParser$$module$build$src$core$utils$xml=new DOMParser$$module$build$src$core$utils$xml);XMLSerializer$$module$build$src$core$utils$xml&&(xmlSerializer$$module$build$src$core$utils$xml=new XMLSerializer$$module$build$src$core$utils$xml);\nvar NAME_SPACE$$module$build$src$core$utils$xml=\"https://developers.google.com/blockly/xml\",INVALID_CONTROL_CHARS$$module$build$src$core$utils$xml=/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g,module$build$src$core$utils$xml={NAME_SPACE:NAME_SPACE$$module$build$src$core$utils$xml};module$build$src$core$utils$xml.createElement=$.createElement$$module$build$src$core$utils$xml;module$build$src$core$utils$xml.createTextNode=$.createTextNode$$module$build$src$core$utils$xml;\nmodule$build$src$core$utils$xml.domToText=domToText$$module$build$src$core$utils$xml;module$build$src$core$utils$xml.injectDependencies=injectDependencies$$module$build$src$core$utils$xml;module$build$src$core$utils$xml.textToDom=$.textToDom$$module$build$src$core$utils$xml;var CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox=\"categoryToolbox\",FLYOUT_TOOLBOX_KIND$$module$build$src$core$utils$toolbox=\"flyoutToolbox\",Position$$module$build$src$core$utils$toolbox;(function(a){a[a.TOP=0]=\"TOP\";a[a.BOTTOM=1]=\"BOTTOM\";a[a.LEFT=2]=\"LEFT\";a[a.RIGHT=3]=\"RIGHT\"})(Position$$module$build$src$core$utils$toolbox||(Position$$module$build$src$core$utils$toolbox={}));\nvar TEST_ONLY$$module$build$src$core$utils$toolbox={hasCategoriesInternal:hasCategoriesInternal$$module$build$src$core$utils$toolbox},module$build$src$core$utils$toolbox={};module$build$src$core$utils$toolbox.Position=Position$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.TEST_ONLY=TEST_ONLY$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.convertFlyoutDefToJsonArray=convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox;\nmodule$build$src$core$utils$toolbox.convertToolboxDefToJson=convertToolboxDefToJson$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.hasCategories=hasCategories$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.isCategoryCollapsible=isCategoryCollapsible$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.parseToolboxTree=parseToolboxTree$$module$build$src$core$utils$toolbox;var verticalPosition$$module$build$src$core$positionable_helpers;(function(a){a[a.TOP=0]=\"TOP\";a[a.BOTTOM=1]=\"BOTTOM\"})(verticalPosition$$module$build$src$core$positionable_helpers||(verticalPosition$$module$build$src$core$positionable_helpers={}));var horizontalPosition$$module$build$src$core$positionable_helpers;(function(a){a[a.LEFT=0]=\"LEFT\";a[a.RIGHT=1]=\"RIGHT\"})(horizontalPosition$$module$build$src$core$positionable_helpers||(horizontalPosition$$module$build$src$core$positionable_helpers={}));\nvar bumpDirection$$module$build$src$core$positionable_helpers;(function(a){a[a.UP=0]=\"UP\";a[a.DOWN=1]=\"DOWN\"})(bumpDirection$$module$build$src$core$positionable_helpers||(bumpDirection$$module$build$src$core$positionable_helpers={}));var module$build$src$core$positionable_helpers={};module$build$src$core$positionable_helpers.bumpDirection=bumpDirection$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.bumpPositionRect=bumpPositionRect$$module$build$src$core$positionable_helpers;\nmodule$build$src$core$positionable_helpers.getCornerOppositeToolbox=getCornerOppositeToolbox$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.getStartPositionRect=getStartPositionRect$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.horizontalPosition=horizontalPosition$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.verticalPosition=verticalPosition$$module$build$src$core$positionable_helpers;var SPRITE$$module$build$src$core$sprites={width:96,height:124,url:\"sprites.png\"},module$build$src$core$sprites={SPRITE:SPRITE$$module$build$src$core$sprites};var ZoomControls$$module$build$src$core$zoom_controls=class{constructor(a){this.workspace=a;this.id=\"zoomControls\";this.boundEvents=[];this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null;this.HEIGHT=this.WIDTH=32;this.SMALL_SPACING=2;this.LARGE_SPACING=11;this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20;this.svgGroup=null;this.top=this.left=0;this.initialized=!1}createDom(){this.svgGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{});const a=String(Math.random()).substring(2);\nthis.createZoomOutSvg(a);this.createZoomInSvg(a);this.workspace.isMovable()&&this.createZoomResetSvg(a);return this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.POSITIONABLE]});this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent(\"zoomControls\");this.svgGroup&&removeNode$$module$build$src$core$utils$dom(this.svgGroup);for(const a of this.boundEvents)unbind$$module$build$src$core$browser_events(a);\nthis.boundEvents.length=0}getBoundingRectangle(){let a=this.SMALL_SPACING+2*this.HEIGHT;this.zoomResetGroup&&(a+=this.LARGE_SPACING+this.HEIGHT);return new Rect$$module$build$src$core$utils$rect(this.top,this.top+a,this.left,this.left+this.WIDTH)}position(a,b){if(this.initialized){var c=getCornerOppositeToolbox$$module$build$src$core$positionable_helpers(this.workspace,a),d=this.SMALL_SPACING+2*this.HEIGHT;this.zoomResetGroup&&(d+=this.LARGE_SPACING+this.HEIGHT);a=getStartPositionRect$$module$build$src$core$positionable_helpers(c,\nnew Size$$module$build$src$core$utils$size(this.WIDTH,d),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,a,this.workspace);c=c.vertical;b=bumpPositionRect$$module$build$src$core$positionable_helpers(a,this.MARGIN_VERTICAL,c===verticalPosition$$module$build$src$core$positionable_helpers.TOP?bumpDirection$$module$build$src$core$positionable_helpers.DOWN:bumpDirection$$module$build$src$core$positionable_helpers.UP,b);if(c===verticalPosition$$module$build$src$core$positionable_helpers.TOP){var e=this.SMALL_SPACING+\nthis.HEIGHT,f;null==(f=this.zoomInGroup)||f.setAttribute(\"transform\",\"translate(0, \"+e+\")\");this.zoomResetGroup&&this.zoomResetGroup.setAttribute(\"transform\",\"translate(0, \"+(e+this.LARGE_SPACING+this.HEIGHT)+\")\")}else{f=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let h;null==(h=this.zoomInGroup)||h.setAttribute(\"transform\",\"translate(0, \"+f+\")\");f=f+this.SMALL_SPACING+this.HEIGHT;null==(e=this.zoomOutGroup)||e.setAttribute(\"transform\",\"translate(0, \"+f+\")\")}this.top=b.top;this.left=b.left;\nvar g;null==(g=this.svgGroup)||g.setAttribute(\"transform\",\"translate(\"+this.left+\",\"+this.top+\")\")}}createZoomOutSvg(a){this.zoomOutGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyZoom blocklyZoomOut\"},this.svgGroup);const b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:\"blocklyZoomoutClipPath\"+a},this.zoomOutGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,\n{width:32,height:32},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,height:SPRITE$$module$build$src$core$sprites.height,x:-64,y:-92,\"clip-path\":\"url(#blocklyZoomoutClipPath\"+a+\")\"},this.zoomOutGroup).setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(this.zoomOutGroup,\n\"pointerdown\",null,this.zoom.bind(this,-1)))}createZoomInSvg(a){this.zoomInGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyZoom blocklyZoomIn\"},this.svgGroup);const b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:\"blocklyZoominClipPath\"+a},this.zoomInGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:32,height:32},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,\n{width:SPRITE$$module$build$src$core$sprites.width,height:SPRITE$$module$build$src$core$sprites.height,x:-32,y:-92,\"clip-path\":\"url(#blocklyZoominClipPath\"+a+\")\"},this.zoomInGroup).setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(this.zoomInGroup,\"pointerdown\",null,this.zoom.bind(this,1)))}zoom(a,b){this.workspace.markFocused();\nthis.workspace.zoomCenter(a);this.fireZoomEvent();clearTouchIdentifier$$module$build$src$core$touch();b.stopPropagation();b.preventDefault()}createZoomResetSvg(a){this.zoomResetGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyZoom blocklyZoomReset\"},this.svgGroup);const b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:\"blocklyZoomresetClipPath\"+a},this.zoomResetGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,\n{width:32,height:32},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,height:SPRITE$$module$build$src$core$sprites.height,y:-92,\"clip-path\":\"url(#blocklyZoomresetClipPath\"+a+\")\"},this.zoomResetGroup).setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(this.zoomResetGroup,\n\"pointerdown\",null,this.resetZoom.bind(this)))}resetZoom(a){this.workspace.markFocused();const b=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition();this.workspace.zoomCenter(b);this.workspace.scrollCenter();setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500);this.fireZoomEvent();clearTouchIdentifier$$module$build$src$core$touch();a.stopPropagation();a.preventDefault()}fireZoomEvent(){const a=\nnew (get$$module$build$src$core$events$utils(CLICK$$module$build$src$core$events$utils))(null,this.workspace.id,\"zoom_controls\");fire$$module$build$src$core$events$utils(a)}};register$$module$build$src$core$css(\"\\n.blocklyZoom>image, .blocklyZoom>svg>image {\\n  opacity: .4;\\n}\\n\\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\\n  opacity: .6;\\n}\\n\\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\\n  opacity: .8;\\n}\\n\");var module$build$src$core$zoom_controls={};\nmodule$build$src$core$zoom_controls.ZoomControls=ZoomControls$$module$build$src$core$zoom_controls;var IconType$$module$build$src$core$icons$icon_types=class{constructor(a){this.name=a}toString(){return this.name}equals(a){return this.name===a.toString()}};IconType$$module$build$src$core$icons$icon_types.MUTATOR=new IconType$$module$build$src$core$icons$icon_types(\"mutator\");IconType$$module$build$src$core$icons$icon_types.WARNING=new IconType$$module$build$src$core$icons$icon_types(\"warning\");IconType$$module$build$src$core$icons$icon_types.COMMENT=new IconType$$module$build$src$core$icons$icon_types(\"comment\");\nvar module$build$src$core$icons$icon_types={};module$build$src$core$icons$icon_types.IconType=IconType$$module$build$src$core$icons$icon_types;(function(a){a[a.VALUE=1]=\"VALUE\";a[a.STATEMENT=3]=\"STATEMENT\";a[a.DUMMY=5]=\"DUMMY\";a[a.CUSTOM=6]=\"CUSTOM\";a[a.END_ROW=7]=\"END_ROW\"})($.inputTypes$$module$build$src$core$inputs$input_types||($.inputTypes$$module$build$src$core$inputs$input_types={}));var module$build$src$core$inputs$input_types={};module$build$src$core$inputs$input_types.inputTypes=$.inputTypes$$module$build$src$core$inputs$input_types;var alertImplementation$$module$build$src$core$dialog=function(a,b){window.alert(a);b&&b()},confirmImplementation$$module$build$src$core$dialog=function(a,b){b(window.confirm(a))},promptImplementation$$module$build$src$core$dialog=function(a,b,c){c(window.prompt(a,b))},TEST_ONLY$$module$build$src$core$dialog={confirmInternal:confirmInternal$$module$build$src$core$dialog},module$build$src$core$dialog={TEST_ONLY:TEST_ONLY$$module$build$src$core$dialog};module$build$src$core$dialog.alert=alert$$module$build$src$core$dialog;\nmodule$build$src$core$dialog.confirm=confirm$$module$build$src$core$dialog;module$build$src$core$dialog.prompt=prompt$$module$build$src$core$dialog;module$build$src$core$dialog.setAlert=setAlert$$module$build$src$core$dialog;module$build$src$core$dialog.setConfirm=setConfirm$$module$build$src$core$dialog;module$build$src$core$dialog.setPrompt=setPrompt$$module$build$src$core$dialog;var module$build$src$core$interfaces$i_variable_backed_parameter_model={};module$build$src$core$interfaces$i_variable_backed_parameter_model.isVariableBackedParameterModel=isVariableBackedParameterModel$$module$build$src$core$interfaces$i_variable_backed_parameter_model;var setLocale$$module$build$src$core$msg,module$build$src$core$msg;$.Msg$$module$build$src$core$msg=Object.create(null);setLocale$$module$build$src$core$msg=function(a){Object.keys(a).forEach(function(b){$.Msg$$module$build$src$core$msg[b]=a[b]})};module$build$src$core$msg={Msg:$.Msg$$module$build$src$core$msg,setLocale:setLocale$$module$build$src$core$msg};var module$build$src$core$interfaces$i_legacy_procedure_blocks={};module$build$src$core$interfaces$i_legacy_procedure_blocks.isLegacyProcedureCallBlock=isLegacyProcedureCallBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks;module$build$src$core$interfaces$i_legacy_procedure_blocks.isLegacyProcedureDefBlock=isLegacyProcedureDefBlock$$module$build$src$core$interfaces$i_legacy_procedure_blocks;var VarBase$$module$build$src$core$events$events_var_base=class extends Abstract$$module$build$src$core$events$events_abstract{constructor(a){super();this.isBlank=\"undefined\"===typeof a;a&&(this.varId=a.getId(),this.workspaceId=a.workspace.id)}toJson(){const a=super.toJson();if(!this.varId)throw Error(\"The var ID is undefined. Either pass a variable to the constructor, or call fromJson\");a.varId=this.varId;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new VarBase$$module$build$src$core$events$events_var_base);\nb.varId=a.varId;return b}},module$build$src$core$events$events_var_base={};module$build$src$core$events$events_var_base.VarBase=VarBase$$module$build$src$core$events$events_var_base;var VarCreate$$module$build$src$core$events$events_var_create=class extends VarBase$$module$build$src$core$events$events_var_base{constructor(a){super(a);this.type=VAR_CREATE$$module$build$src$core$events$utils;a&&(this.varType=a.type,this.varName=a.name)}toJson(){const a=super.toJson();if(void 0===this.varType)throw Error(\"The var type is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.varName)throw Error(\"The var name is undefined. Either pass a variable to the constructor, or call fromJson\");\na.varType=this.varType;a.varName=this.varName;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new VarCreate$$module$build$src$core$events$events_var_create);b.varType=a.varType;b.varName=a.varName;return b}run(a){const b=this.getEventWorkspace_();if(!this.varId)throw Error(\"The var ID is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.varName)throw Error(\"The var name is undefined. Either pass a variable to the constructor, or call fromJson\");a?b.createVariable(this.varName,\nthis.varType,this.varId):b.deleteVariableById(this.varId)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VAR_CREATE$$module$build$src$core$events$utils,VarCreate$$module$build$src$core$events$events_var_create);var module$build$src$core$events$events_var_create={};module$build$src$core$events$events_var_create.VarCreate=VarCreate$$module$build$src$core$events$events_var_create;var VariableModel$$module$build$src$core$variable_model=class{constructor(a,b,c,d){this.workspace=a;this.name=b;this.type=c||\"\";this.id_=d||genUid$$module$build$src$core$utils$idgenerator()}getId(){return this.id_}static compareByName(a,b){return a.name.localeCompare(b.name,void 0,{sensitivity:\"base\"})}},module$build$src$core$variable_model={};module$build$src$core$variable_model.VariableModel=VariableModel$$module$build$src$core$variable_model;var CATEGORY_NAME$$module$build$src$core$variables=\"VARIABLE\",VAR_LETTER_OPTIONS$$module$build$src$core$variables=\"ijkmnopqrstuvwxyzabcdefgh\",TEST_ONLY$$module$build$src$core$variables={generateUniqueNameInternal:generateUniqueNameInternal$$module$build$src$core$variables},module$build$src$core$variables={CATEGORY_NAME:CATEGORY_NAME$$module$build$src$core$variables,TEST_ONLY:TEST_ONLY$$module$build$src$core$variables,VAR_LETTER_OPTIONS:VAR_LETTER_OPTIONS$$module$build$src$core$variables};\nmodule$build$src$core$variables.allDeveloperVariables=$.allDeveloperVariables$$module$build$src$core$variables;module$build$src$core$variables.allUsedVarModels=$.allUsedVarModels$$module$build$src$core$variables;module$build$src$core$variables.createVariableButtonHandler=createVariableButtonHandler$$module$build$src$core$variables;module$build$src$core$variables.flyoutCategory=flyoutCategory$$module$build$src$core$variables;module$build$src$core$variables.flyoutCategoryBlocks=flyoutCategoryBlocks$$module$build$src$core$variables;\nmodule$build$src$core$variables.generateUniqueName=generateUniqueName$$module$build$src$core$variables;module$build$src$core$variables.generateUniqueNameFromOptions=generateUniqueNameFromOptions$$module$build$src$core$variables;module$build$src$core$variables.generateVariableFieldDom=generateVariableFieldDom$$module$build$src$core$variables;module$build$src$core$variables.getAddedVariables=getAddedVariables$$module$build$src$core$variables;\nmodule$build$src$core$variables.getOrCreateVariablePackage=$.getOrCreateVariablePackage$$module$build$src$core$variables;module$build$src$core$variables.getVariable=$.getVariable$$module$build$src$core$variables;module$build$src$core$variables.nameUsedWithAnyType=nameUsedWithAnyType$$module$build$src$core$variables;module$build$src$core$variables.nameUsedWithConflictingParam=nameUsedWithConflictingParam$$module$build$src$core$variables;module$build$src$core$variables.promptName=promptName$$module$build$src$core$variables;\nmodule$build$src$core$variables.renameVariable=$.renameVariable$$module$build$src$core$variables;var WorkspaceComment$$module$build$src$core$workspace_comment=class{constructor(a,b,c,d,e){this.workspace=a;this.editable=this.movable=this.deletable=!0;this.disposed_=!1;this.isComment=!0;this.id=e&&!a.getCommentById(e)?e:genUid$$module$build$src$core$utils$idgenerator();a.addTopComment(this);this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.height_=c;this.width_=d;this.RTL=a.RTL;this.content_=b;WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(this)}dispose(){this.disposed_||\n(isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(COMMENT_DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(a){this.height_=a}getWidth(){return this.width_}setWidth(a){this.width_=a}getRelativeToSurfaceXY(){return new Coordinate$$module$build$src$core$utils$coordinate(this.xy_.x,this.xy_.y)}moveBy(a,b){const c=new (get$$module$build$src$core$events$utils(COMMENT_MOVE$$module$build$src$core$events$utils))(this);\nthis.xy_.translate(a,b);c.recordNew();fire$$module$build$src$core$events$utils(c)}isDeletable(){return this.deletable&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(a){this.deletable=a}isMovable(){return this.movable&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(a){this.movable=a}isEditable(){return this.editable&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(a){this.editable=a}getContent(){return this.content_}setContent(a){this.content_!==a&&(fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(COMMENT_CHANGE$$module$build$src$core$events$utils))(this,\nthis.content_,a)),this.content_=a)}toXmlWithXY(a){a=this.toXml(a);a.setAttribute(\"x\",String(Math.round(this.xy_.x)));a.setAttribute(\"y\",String(Math.round(this.xy_.y)));a.setAttribute(\"h\",String(this.height_));a.setAttribute(\"w\",String(this.width_));return a}toXml(a){const b=$.createElement$$module$build$src$core$utils$xml(\"comment\");a||(b.id=this.id);b.textContent=this.getContent();return b}static fireCreateEvent(a){if(isEnabled$$module$build$src$core$events$utils()){const b=$.getGroup$$module$build$src$core$events$utils();\nb||$.setGroup$$module$build$src$core$events$utils(!0);try{fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(COMMENT_CREATE$$module$build$src$core$events$utils))(a))}finally{$.setGroup$$module$build$src$core$events$utils(b)}}}static fromXml(a,b){var c=WorkspaceComment$$module$build$src$core$workspace_comment.parseAttributes(a);b=new WorkspaceComment$$module$build$src$core$workspace_comment(b,c.content,c.h,c.w,c.id);c=a.getAttribute(\"x\");a=a.getAttribute(\"y\");c=c?\nparseInt(c,10):NaN;a=a?parseInt(a,10):NaN;isNaN(c)||isNaN(a)||b.moveBy(c,a);WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(b);return b}static parseAttributes(a){const b=a.getAttribute(\"h\"),c=a.getAttribute(\"w\"),d=a.getAttribute(\"x\"),e=a.getAttribute(\"y\"),f=a.getAttribute(\"id\");if(!f)throw Error(\"No ID present in XML comment definition.\");let g;return{id:f,h:b?parseInt(b):100,w:c?parseInt(c):100,x:d?parseInt(d):NaN,y:e?parseInt(e):NaN,content:null!=(g=a.textContent)?g:\"\"}}},\nmodule$build$src$core$workspace_comment={};module$build$src$core$workspace_comment.WorkspaceComment=WorkspaceComment$$module$build$src$core$workspace_comment;var Selected$$module$build$src$core$events$events_selected=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c){super(c);this.type=SELECTED$$module$build$src$core$events$utils;this.oldElementId=null!=a?a:void 0;this.newElementId=null!=b?b:void 0}toJson(){const a=super.toJson();a.oldElementId=this.oldElementId;a.newElementId=this.newElementId;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new Selected$$module$build$src$core$events$events_selected);b.oldElementId=\na.oldElementId;b.newElementId=a.newElementId;return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,SELECTED$$module$build$src$core$events$utils,Selected$$module$build$src$core$events$events_selected);var module$build$src$core$events$events_selected={};module$build$src$core$events$events_selected.Selected=Selected$$module$build$src$core$events$events_selected;var module$build$src$core$clipboard$registry={};module$build$src$core$clipboard$registry.register=register$$module$build$src$core$clipboard$registry;module$build$src$core$clipboard$registry.unregister=unregister$$module$build$src$core$clipboard$registry;var WorkspaceCommentPaster$$module$build$src$core$clipboard$workspace_comment_paster=class{paste(a,b,c){const d=a.commentState;if(c)d.setAttribute(\"x\",`${c.x}`),d.setAttribute(\"y\",`${c.y}`);else{var e;c=parseInt(null!=(e=d.getAttribute(\"x\"))?e:\"0\")+50;let f;e=parseInt(null!=(f=d.getAttribute(\"y\"))?f:\"0\")+50;d.setAttribute(\"x\",`${c}`);d.setAttribute(\"y\",`${e}`)}return WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.fromXmlRendered(a.commentState,b)}};\nWorkspaceCommentPaster$$module$build$src$core$clipboard$workspace_comment_paster.TYPE=\"workspace-comment\";register$$module$build$src$core$clipboard$registry(WorkspaceCommentPaster$$module$build$src$core$clipboard$workspace_comment_paster.TYPE,new WorkspaceCommentPaster$$module$build$src$core$clipboard$workspace_comment_paster);var module$build$src$core$clipboard$workspace_comment_paster={};module$build$src$core$clipboard$workspace_comment_paster.WorkspaceCommentPaster=WorkspaceCommentPaster$$module$build$src$core$clipboard$workspace_comment_paster;var RESIZE_SIZE$$module$build$src$core$workspace_comment_svg=8,BORDER_RADIUS$$module$build$src$core$workspace_comment_svg=3,TEXTAREA_OFFSET$$module$build$src$core$workspace_comment_svg=2,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg=class extends WorkspaceComment$$module$build$src$core$workspace_comment{constructor(a,b,c,d,e){super(a,b,c,d,e);this.onMouseMoveWrapper=this.onMouseUpWrapper=null;this.eventsInit=!1;this.deleteIconBorder=this.deleteGroup=this.resizeGroup=this.foreignObject=\nthis.svgHandleTarget=this.svgRectTarget=this.textarea=null;this.rendered=this.autoLayout=this.focused=!1;this.svgGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyComment\"});this.workspace=a;this.svgRect_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyCommentRect\",x:0,y:0,rx:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg,ry:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg});\nthis.svgGroup.appendChild(this.svgRect_);this.render()}dispose(){this.disposed_||(getSelected$$module$build$src$core$common()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(COMMENT_DELETE$$module$build$src$core$events$utils))(this)),removeNode$$module$build$src$core$utils$dom(this.svgGroup),$.disable$$module$build$src$core$events$utils(),super.dispose(),\n$.enable$$module$build$src$core$events$utils())}initSvg(a){if(!this.workspace.rendered)throw TypeError(\"Workspace is headless.\");this.workspace.options.readOnly||this.eventsInit||(conditionalBind$$module$build$src$core$browser_events(this.svgRectTarget,\"pointerdown\",this,this.pathMouseDown),conditionalBind$$module$build$src$core$browser_events(this.svgHandleTarget,\"pointerdown\",this,this.pathMouseDown));this.eventsInit=!0;this.updateMovable();this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot());\n!a&&this.textarea&&this.textarea.select()}pathMouseDown(a){const b=this.workspace.getGesture(a);b&&b.handleBubbleStart(a,this)}showContextMenu(a){throw Error(\"The implementation of showContextMenu should be monkey-patched in by blockly.ts\");}select(){if(getSelected$$module$build$src$core$common()!==this){var a=null;if(getSelected$$module$build$src$core$common()){a=getSelected$$module$build$src$core$common().id;$.disable$$module$build$src$core$events$utils();try{getSelected$$module$build$src$core$common().unselect()}finally{$.enable$$module$build$src$core$events$utils()}}a=\nnew (get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(a,this.id,this.workspace.id);fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(this);this.addSelect()}}unselect(){if(getSelected$$module$build$src$core$common()===this){var a=new (get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(this.id,null,this.workspace.id);fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(null);\nthis.removeSelect();this.blurFocus()}}addSelect(){addClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklySelected\");this.setFocus()}removeSelect(){addClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklySelected\");this.blurFocus()}addFocus(){addClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklyFocused\")}removeFocus(){removeClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklyFocused\")}getRelativeToSurfaceXY(){const a=this.workspace.getLayerManager();if(!a)throw Error(\"Cannot calculate position because the workspace has not been appended\");\nlet b=0,c=0,d=this.getSvgRoot();if(d){do{const e=getRelativeXY$$module$build$src$core$utils$svg_math(d);b+=e.x;c+=e.y;d=d.parentNode}while(d&&!a.hasLayer(d)&&null!==d)}return this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(b,c)}moveBy(a,b){const c=new (get$$module$build$src$core$events$utils(COMMENT_MOVE$$module$build$src$core$events$utils))(this),d=this.getRelativeToSurfaceXY();this.translate(d.x+a,d.y+b);this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(d.x+a,d.y+b);\nc.recordNew();fire$$module$build$src$core$events$utils(c);this.workspace.resizeContents()}translate(a,b){this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(a,b);this.getSvgRoot().setAttribute(\"transform\",\"translate(\"+a+\",\"+b+\")\")}moveDuringDrag(a){a=`translate(${a.x}, ${a.y})`;this.getSvgRoot().setAttribute(\"transform\",a)}moveTo(a,b){this.translate(a,b)}clearTransformAttributes(){this.getSvgRoot().removeAttribute(\"transform\")}getBoundingRectangle(){var a=this.getRelativeToSurfaceXY();\nconst b=this.getHeightWidth(),c=a.y,d=a.y+b.height;let e;this.RTL?(e=a.x-b.width,a=a.x):(e=a.x,a=a.x+b.width);return new Rect$$module$build$src$core$utils$rect(c,d,e,a)}updateMovable(){this.isMovable()?addClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklyDraggable\"):removeClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklyDraggable\")}setMovable(a){super.setMovable(a);this.updateMovable()}setEditable(a){super.setEditable(a);this.textarea&&(this.textarea.readOnly=!a)}setDragging(a){a?\naddClass$$module$build$src$core$utils$dom(this.getSvgRoot(),\"blocklyDragging\"):removeClass$$module$build$src$core$utils$dom(this.getSvgRoot(),\"blocklyDragging\")}getSvgRoot(){return this.svgGroup}getContent(){return this.textarea?this.textarea.value:this.content_}setContent(a){super.setContent(a);this.textarea&&(this.textarea.value=a)}setDeleteStyle(a){a?addClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklyDraggingDelete\"):removeClass$$module$build$src$core$utils$dom(this.svgGroup,\"blocklyDraggingDelete\")}setAutoLayout(a){}toXmlWithXY(a){let b=\n0;this.workspace.RTL&&(b=this.workspace.getWidth());a=this.toXml(a);const c=this.getRelativeToSurfaceXY();a.setAttribute(\"x\",String(Math.round(this.workspace.RTL?b-c.x:c.x)));a.setAttribute(\"y\",String(Math.round(c.y)));a.setAttribute(\"h\",String(this.getHeight()));a.setAttribute(\"w\",String(this.getWidth()));return a}toCopyData(){return{paster:WorkspaceCommentPaster$$module$build$src$core$clipboard$workspace_comment_paster.TYPE,commentState:this.toXmlWithXY()}}getHeightWidth(){return{width:this.getWidth(),\nheight:this.getHeight()}}render(){if(!this.rendered){var a=this.getHeightWidth(),b=this.createEditor();this.svgGroup.appendChild(b);this.svgHandleTarget=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyCommentHandleTarget\",x:0,y:0});this.svgGroup.appendChild(this.svgHandleTarget);this.svgRectTarget=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyCommentTarget\",x:0,y:0,rx:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg,\nry:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg});this.svgGroup.appendChild(this.svgRectTarget);this.addResizeDom();this.isDeletable()&&this.addDeleteDom();this.setSize(a.width,a.height);this.textarea.value=this.content_;this.rendered=!0;this.resizeGroup&&conditionalBind$$module$build$src$core$browser_events(this.resizeGroup,\"pointerdown\",this,this.resizeMouseDown);this.isDeletable()&&(conditionalBind$$module$build$src$core$browser_events(this.deleteGroup,\"pointerdown\",this,this.deleteMouseDown),\nconditionalBind$$module$build$src$core$browser_events(this.deleteGroup,\"pointerout\",this,this.deleteMouseOut),conditionalBind$$module$build$src$core$browser_events(this.deleteGroup,\"pointerup\",this,this.deleteMouseUp))}}createEditor(){this.foreignObject=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FOREIGNOBJECT,{x:0,y:WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET,\"class\":\"blocklyCommentForeignObject\"});const a=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,\n\"body\");a.setAttribute(\"xmlns\",HTML_NS$$module$build$src$core$utils$dom);a.className=\"blocklyMinimalBody\";const b=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,\"textarea\");b.className=\"blocklyCommentTextarea\";b.setAttribute(\"dir\",this.RTL?\"RTL\":\"LTR\");b.readOnly=!this.isEditable();a.appendChild(b);this.textarea=b;this.foreignObject.appendChild(a);conditionalBind$$module$build$src$core$browser_events(b,\"wheel\",this,function(c){c.stopPropagation()});conditionalBind$$module$build$src$core$browser_events(b,\n\"change\",this,function(c){this.setContent(b.value)});return this.foreignObject}addResizeDom(){this.resizeGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":this.RTL?\"blocklyResizeSW\":\"blocklyResizeSE\"},this.svgGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.POLYGON,{points:`0,${RESIZE_SIZE$$module$build$src$core$workspace_comment_svg} ${RESIZE_SIZE$$module$build$src$core$workspace_comment_svg},${RESIZE_SIZE$$module$build$src$core$workspace_comment_svg} ${RESIZE_SIZE$$module$build$src$core$workspace_comment_svg},0`},\nthis.resizeGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{\"class\":\"blocklyResizeLine\",x1:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3,y1:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,x2:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,y2:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3},this.resizeGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{\"class\":\"blocklyResizeLine\",\nx1:2*RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3,y1:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,x2:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,y2:2*RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3},this.resizeGroup)}addDeleteDom(){this.deleteGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyCommentDeleteIcon\"},this.svgGroup);this.deleteIconBorder=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,\n{\"class\":\"blocklyDeleteIconShape\",r:\"7\",cx:\"7.5\",cy:\"7.5\"},this.deleteGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:\"5\",y1:\"10\",x2:\"10\",y2:\"5\",stroke:\"#fff\",\"stroke-width\":\"2\"},this.deleteGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:\"5\",y1:\"5\",x2:\"10\",y2:\"10\",stroke:\"#fff\",\"stroke-width\":\"2\"},this.deleteGroup)}resizeMouseDown(a){this.unbindDragEvents();isRightButton$$module$build$src$core$browser_events(a)||\n(this.workspace.startDrag(a,new Coordinate$$module$build$src$core$utils$coordinate(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper=conditionalBind$$module$build$src$core$browser_events(document,\"pointerup\",this,this.resizeMouseUp),this.onMouseMoveWrapper=conditionalBind$$module$build$src$core$browser_events(document,\"pointermove\",this,this.resizeMouseMove),this.workspace.hideChaff());a.stopPropagation()}deleteMouseDown(a){this.deleteIconBorder&&addClass$$module$build$src$core$utils$dom(this.deleteIconBorder,\n\"blocklyDeleteIconHighlighted\");a.stopPropagation()}deleteMouseOut(a){this.deleteIconBorder&&removeClass$$module$build$src$core$utils$dom(this.deleteIconBorder,\"blocklyDeleteIconHighlighted\")}deleteMouseUp(a){this.dispose();a.stopPropagation()}unbindDragEvents(){this.onMouseUpWrapper&&(unbind$$module$build$src$core$browser_events(this.onMouseUpWrapper),this.onMouseUpWrapper=null);this.onMouseMoveWrapper&&(unbind$$module$build$src$core$browser_events(this.onMouseMoveWrapper),this.onMouseMoveWrapper=\nnull)}resizeMouseUp(a){clearTouchIdentifier$$module$build$src$core$touch();this.unbindDragEvents()}resizeMouseMove(a){this.autoLayout=!1;a=this.workspace.moveDrag(a);this.setSize(this.RTL?-a.x:a.x,a.y)}resizeComment(){const a=this.getHeightWidth(),b=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET,c=2*TEXTAREA_OFFSET$$module$build$src$core$workspace_comment_svg;let d;null==(d=this.foreignObject)||d.setAttribute(\"width\",String(a.width));let e;null==(e=this.foreignObject)||\ne.setAttribute(\"height\",String(a.height-b));if(this.RTL){let f;null==(f=this.foreignObject)||f.setAttribute(\"x\",String(-a.width))}this.textarea&&(this.textarea.style.width=a.width-c+\"px\",this.textarea.style.height=a.height-c-b+\"px\")}setSize(a,b){a=Math.max(a,45);b=Math.max(b,20+WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET);this.width_=a;this.height_=b;this.svgRect_.setAttribute(\"width\",`${a}`);this.svgRect_.setAttribute(\"height\",`${b}`);let c;null==(c=this.svgRectTarget)||\nc.setAttribute(\"width\",`${a}`);let d;null==(d=this.svgRectTarget)||d.setAttribute(\"height\",`${b}`);let e;null==(e=this.svgHandleTarget)||e.setAttribute(\"width\",`${a}`);let f;null==(f=this.svgHandleTarget)||f.setAttribute(\"height\",String(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET));if(this.RTL){this.svgRect_.setAttribute(\"transform\",\"scale(-1 1)\");let g;null==(g=this.svgRectTarget)||g.setAttribute(\"transform\",\"scale(-1 1)\")}if(this.resizeGroup)if(this.RTL){this.resizeGroup.setAttribute(\"transform\",\n\"translate(\"+(-a+RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+\",\"+(b-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+\") scale(-1 1)\");let g;null==(g=this.deleteGroup)||g.setAttribute(\"transform\",\"translate(\"+(-a+RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+\",\"+-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg+\") scale(-1 1)\")}else{this.resizeGroup.setAttribute(\"transform\",\"translate(\"+(a-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+\",\"+(b-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+\n\")\");let g;null==(g=this.deleteGroup)||g.setAttribute(\"transform\",\"translate(\"+(a-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+\",\"+-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg+\")\")}this.resizeComment()}setFocus(){this.focused=!0;setTimeout(()=>{this.disposed_||(this.textarea.focus(),this.addFocus(),this.svgRectTarget&&addClass$$module$build$src$core$utils$dom(this.svgRectTarget,\"blocklyCommentTargetFocused\"),this.svgHandleTarget&&addClass$$module$build$src$core$utils$dom(this.svgHandleTarget,\n\"blocklyCommentHandleTargetFocused\"))},0)}blurFocus(){this.focused=!1;setTimeout(()=>{this.disposed_||(this.textarea.blur(),this.removeFocus(),this.svgRectTarget&&removeClass$$module$build$src$core$utils$dom(this.svgRectTarget,\"blocklyCommentTargetFocused\"),this.svgHandleTarget&&removeClass$$module$build$src$core$utils$dom(this.svgHandleTarget,\"blocklyCommentHandleTargetFocused\"))},0)}static fromXmlRendered(a,b,c){$.disable$$module$build$src$core$events$utils();let d;try{const e=WorkspaceComment$$module$build$src$core$workspace_comment.parseAttributes(a);\nd=new WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg(b,e.content,e.h,e.w,e.id);b.rendered&&(d.initSvg(!0),d.render());if(!isNaN(e.x)&&!isNaN(e.y))if(b.RTL){const f=c||b.getWidth();d.moveBy(f-e.x,e.y)}else d.moveBy(e.x,e.y)}finally{$.enable$$module$build$src$core$events$utils()}WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(d);return d}};WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.DEFAULT_SIZE=100;\nWorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET=10;register$$module$build$src$core$css(\"\\n.blocklyCommentForeignObject {\\n  position: relative;\\n  z-index: 0;\\n}\\n\\n.blocklyCommentRect {\\n  fill: #E7DE8E;\\n  stroke: #bcA903;\\n  stroke-width: 1px;\\n}\\n\\n.blocklyCommentTarget {\\n  fill: transparent;\\n  stroke: #bcA903;\\n}\\n\\n.blocklyCommentTargetFocused {\\n  fill: none;\\n}\\n\\n.blocklyCommentHandleTarget {\\n  fill: none;\\n}\\n\\n.blocklyCommentHandleTargetFocused {\\n  fill: transparent;\\n}\\n\\n.blocklyFocused>.blocklyCommentRect {\\n  fill: #B9B272;\\n  stroke: #B9B272;\\n}\\n\\n.blocklySelected>.blocklyCommentTarget {\\n  stroke: #fc3;\\n  stroke-width: 3px;\\n}\\n\\n.blocklyCommentDeleteIcon {\\n  cursor: pointer;\\n  fill: #000;\\n  display: none;\\n}\\n\\n.blocklySelected > .blocklyCommentDeleteIcon {\\n  display: block;\\n}\\n\\n.blocklyDeleteIconShape {\\n  fill: #000;\\n  stroke: #000;\\n  stroke-width: 1px;\\n}\\n\\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\\n  stroke: #fc3;\\n}\\n\");\nvar module$build$src$core$workspace_comment_svg={};module$build$src$core$workspace_comment_svg.WorkspaceCommentSvg=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg;var rootBlocks$$module$build$src$core$render_management=new Set,dirtyBlocks$$module$build$src$core$render_management=new WeakSet,afterRendersPromise$$module$build$src$core$render_management=null,afterRendersResolver$$module$build$src$core$render_management=null,animationRequestId$$module$build$src$core$render_management=0,module$build$src$core$render_management={};module$build$src$core$render_management.finishQueuedRenders=finishQueuedRenders$$module$build$src$core$render_management;\nmodule$build$src$core$render_management.queueRender=queueRender$$module$build$src$core$render_management;module$build$src$core$render_management.triggerQueuedRenders=triggerQueuedRenders$$module$build$src$core$render_management;var module$build$src$core$xml={};module$build$src$core$xml.appendDomToWorkspace=appendDomToWorkspace$$module$build$src$core$xml;module$build$src$core$xml.blockToDom=blockToDom$$module$build$src$core$xml;module$build$src$core$xml.blockToDomWithXY=blockToDomWithXY$$module$build$src$core$xml;module$build$src$core$xml.clearWorkspaceAndLoadFromXml=clearWorkspaceAndLoadFromXml$$module$build$src$core$xml;module$build$src$core$xml.deleteNext=deleteNext$$module$build$src$core$xml;\nmodule$build$src$core$xml.domToBlock=$.domToBlock$$module$build$src$core$xml;module$build$src$core$xml.domToBlockInternal=domToBlockInternal$$module$build$src$core$xml;module$build$src$core$xml.domToPrettyText=domToPrettyText$$module$build$src$core$xml;module$build$src$core$xml.domToText=domToText$$module$build$src$core$xml;module$build$src$core$xml.domToVariables=domToVariables$$module$build$src$core$xml;module$build$src$core$xml.domToWorkspace=$.domToWorkspace$$module$build$src$core$xml;\nmodule$build$src$core$xml.variablesToDom=variablesToDom$$module$build$src$core$xml;module$build$src$core$xml.workspaceToDom=workspaceToDom$$module$build$src$core$xml;var module$build$src$core$interfaces$i_serializable={};module$build$src$core$interfaces$i_serializable.isSerializable=isSerializable$$module$build$src$core$interfaces$i_serializable;var DeserializationError$$module$build$src$core$serialization$exceptions=class extends Error{},MissingBlockType$$module$build$src$core$serialization$exceptions=class extends DeserializationError$$module$build$src$core$serialization$exceptions{constructor(a){super(\"Expected to find a 'type' property, defining the block type\");this.state=a}},MissingConnection$$module$build$src$core$serialization$exceptions=class extends DeserializationError$$module$build$src$core$serialization$exceptions{constructor(a,\nb,c){super(`The block ${b.toDevString()} is missing a(n) ${a}\nconnection`);this.block=b;this.state=c}},BadConnectionCheck$$module$build$src$core$serialization$exceptions=class extends DeserializationError$$module$build$src$core$serialization$exceptions{constructor(a,b,c,d){super(`The block ${c.toDevString()} could not connect its\n${b} to its parent, because: ${a}`);this.childBlock=c;this.childState=d}},RealChildOfShadow$$module$build$src$core$serialization$exceptions=class extends DeserializationError$$module$build$src$core$serialization$exceptions{constructor(a){super(\"Encountered a real block which is defined as a child of a shadow\\nblock. It is an invariant of Blockly that shadow blocks only have shadow\\nchildren\");this.state=a}},UnregisteredIcon$$module$build$src$core$serialization$exceptions=class extends DeserializationError$$module$build$src$core$serialization$exceptions{constructor(a,\nb,c){super(`Cannot add an icon of type '${a}' to the block `+`${b.toDevString()}, because there is no icon registered with `+`type '${a}'. Make sure that all of your icons have been `+\"registered.\");this.block=b;this.state=c}},module$build$src$core$serialization$exceptions={};module$build$src$core$serialization$exceptions.BadConnectionCheck=BadConnectionCheck$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.DeserializationError=DeserializationError$$module$build$src$core$serialization$exceptions;\nmodule$build$src$core$serialization$exceptions.MissingBlockType=MissingBlockType$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.MissingConnection=MissingConnection$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.RealChildOfShadow=RealChildOfShadow$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.UnregisteredIcon=UnregisteredIcon$$module$build$src$core$serialization$exceptions;var VARIABLES$$module$build$src$core$serialization$priorities=100,PROCEDURES$$module$build$src$core$serialization$priorities=75,BLOCKS$$module$build$src$core$serialization$priorities=50,module$build$src$core$serialization$priorities={BLOCKS:BLOCKS$$module$build$src$core$serialization$priorities,PROCEDURES:PROCEDURES$$module$build$src$core$serialization$priorities,VARIABLES:VARIABLES$$module$build$src$core$serialization$priorities};var module$build$src$core$serialization$registry={};module$build$src$core$serialization$registry.register=register$$module$build$src$core$serialization$registry;module$build$src$core$serialization$registry.unregister=unregister$$module$build$src$core$serialization$registry;var saveBlock$$module$build$src$core$serialization$blocks=save$$module$build$src$core$serialization$blocks,BlockSerializer$$module$build$src$core$serialization$blocks=class{constructor(){this.priority=BLOCKS$$module$build$src$core$serialization$priorities}save(a){const b=[];for(const c of a.getTopBlocks(!1))(a=save$$module$build$src$core$serialization$blocks(c,{addCoordinates:!0,doFullSerialization:!1}))&&b.push(a);return b.length?{languageVersion:0,blocks:b}:null}load(a,b){a=a.blocks;for(const c of a)append$$module$build$src$core$serialization$blocks(c,\nb,{recordUndo:getRecordUndo$$module$build$src$core$events$utils()})}clear(a){for(const b of a.getTopBlocks(!1))b.dispose(!1)}};register$$module$build$src$core$serialization$registry(\"blocks\",new BlockSerializer$$module$build$src$core$serialization$blocks);var module$build$src$core$serialization$blocks={};module$build$src$core$serialization$blocks.BlockSerializer=BlockSerializer$$module$build$src$core$serialization$blocks;module$build$src$core$serialization$blocks.append=append$$module$build$src$core$serialization$blocks;\nmodule$build$src$core$serialization$blocks.appendInternal=appendInternal$$module$build$src$core$serialization$blocks;module$build$src$core$serialization$blocks.save=save$$module$build$src$core$serialization$blocks;var BlockBase$$module$build$src$core$events$events_block_base=class extends Abstract$$module$build$src$core$events$events_abstract{constructor(a){super();this.isBlank=!a;a&&(this.blockId=a.id,this.workspaceId=a.workspace.id)}toJson(){const a=super.toJson();if(!this.blockId)throw Error(\"The block ID is undefined. Either pass a block to the constructor, or call fromJson\");a.blockId=this.blockId;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockBase$$module$build$src$core$events$events_block_base);\nb.blockId=a.blockId;return b}},module$build$src$core$events$events_block_base={};module$build$src$core$events$events_block_base.BlockBase=BlockBase$$module$build$src$core$events$events_block_base;var BlockCreate$$module$build$src$core$events$events_block_create=class extends BlockBase$$module$build$src$core$events$events_block_base{constructor(a){super(a);this.type=$.CREATE$$module$build$src$core$events$utils;a&&(a.isShadow()&&(this.recordUndo=!1),this.xml=blockToDomWithXY$$module$build$src$core$xml(a),this.ids=getDescendantIds$$module$build$src$core$events$utils(a),this.json=save$$module$build$src$core$serialization$blocks(a,{addCoordinates:!0}))}toJson(){const a=super.toJson();if(!this.xml)throw Error(\"The block XML is undefined. Either pass a block to the constructor, or call fromJson\");\nif(!this.ids)throw Error(\"The block IDs are undefined. Either pass a block to the constructor, or call fromJson\");if(!this.json)throw Error(\"The block JSON is undefined. Either pass a block to the constructor, or call fromJson\");a.xml=domToText$$module$build$src$core$xml(this.xml);a.ids=this.ids;a.json=this.json;this.recordUndo||(a.recordUndo=this.recordUndo);return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockCreate$$module$build$src$core$events$events_block_create);b.xml=$.textToDom$$module$build$src$core$utils$xml(a.xml);\nb.ids=a.ids;b.json=a.json;void 0!==a.recordUndo&&(b.recordUndo=a.recordUndo);return b}run(a){const b=this.getEventWorkspace_();if(!this.json)throw Error(\"The block JSON is undefined. Either pass a block to the constructor, or call fromJson\");if(!this.ids)throw Error(\"The block IDs are undefined. Either pass a block to the constructor, or call fromJson\");if(!allShadowBlocks$$module$build$src$core$events$events_block_create(b,this.ids))if(a)append$$module$build$src$core$serialization$blocks(this.json,\nb);else for(a=0;a<this.ids.length;a++){const c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn(\"Can't uncreate non-existent block: \"+c)}}},allShadowBlocks$$module$build$src$core$events$events_block_create=function(a,b){return b.map(c=>a.getBlockById(c)).filter(c=>c&&c.isShadow()).length===b.length};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,$.CREATE$$module$build$src$core$events$utils,BlockCreate$$module$build$src$core$events$events_block_create);\nvar module$build$src$core$events$events_block_create={};module$build$src$core$events$events_block_create.BlockCreate=BlockCreate$$module$build$src$core$events$events_block_create;var ThemeChange$$module$build$src$core$events$events_theme_change=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b){super(b);this.type=THEME_CHANGE$$module$build$src$core$events$utils;this.themeName=a}toJson(){const a=super.toJson();if(!this.themeName)throw Error(\"The theme name is undefined. Either pass a theme name to the constructor, or call fromJson\");a.themeName=this.themeName;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new ThemeChange$$module$build$src$core$events$events_theme_change);\nb.themeName=a.themeName;return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,THEME_CHANGE$$module$build$src$core$events$utils,ThemeChange$$module$build$src$core$events$events_theme_change);var module$build$src$core$events$events_theme_change={};module$build$src$core$events$events_theme_change.ThemeChange=ThemeChange$$module$build$src$core$events$events_theme_change;var ViewportChange$$module$build$src$core$events$events_viewport=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c,d,e){super(d);this.type=VIEWPORT_CHANGE$$module$build$src$core$events$utils;this.viewTop=a;this.viewLeft=b;this.scale=c;this.oldScale=e}toJson(){const a=super.toJson();if(void 0===this.viewTop)throw Error(\"The view top is undefined. Either pass a value to the constructor, or call fromJson\");if(void 0===this.viewLeft)throw Error(\"The view left is undefined. Either pass a value to the constructor, or call fromJson\");\nif(void 0===this.scale)throw Error(\"The scale is undefined. Either pass a value to the constructor, or call fromJson\");if(void 0===this.oldScale)throw Error(\"The old scale is undefined. Either pass a value to the constructor, or call fromJson\");a.viewTop=this.viewTop;a.viewLeft=this.viewLeft;a.scale=this.scale;a.oldScale=this.oldScale;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new ViewportChange$$module$build$src$core$events$events_viewport);b.viewTop=a.viewTop;b.viewLeft=a.viewLeft;\nb.scale=a.scale;b.oldScale=a.oldScale;return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VIEWPORT_CHANGE$$module$build$src$core$events$utils,ViewportChange$$module$build$src$core$events$events_viewport);var module$build$src$core$events$events_viewport={};module$build$src$core$events$events_viewport.ViewportChange=ViewportChange$$module$build$src$core$events$events_viewport;var DEFAULT_SNAP_RADIUS$$module$build$src$core$config,module$build$src$core$config;DEFAULT_SNAP_RADIUS$$module$build$src$core$config=28;$.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:DEFAULT_SNAP_RADIUS$$module$build$src$core$config,connectingSnapRadius:DEFAULT_SNAP_RADIUS$$module$build$src$core$config,currentConnectionPreference:8,bumpDelay:250};module$build$src$core$config={config:$.config$$module$build$src$core$config};var ConnectionType$$module$build$src$core$connection_type;(function(a){a[a.INPUT_VALUE=1]=\"INPUT_VALUE\";a[a.OUTPUT_VALUE=2]=\"OUTPUT_VALUE\";a[a.NEXT_STATEMENT=3]=\"NEXT_STATEMENT\";a[a.PREVIOUS_STATEMENT=4]=\"PREVIOUS_STATEMENT\"})(ConnectionType$$module$build$src$core$connection_type||(ConnectionType$$module$build$src$core$connection_type={}));var module$build$src$core$connection_type={};module$build$src$core$connection_type.ConnectionType=ConnectionType$$module$build$src$core$connection_type;var ConnectionDB$$module$build$src$core$connection_db=class{constructor(a){this.connectionChecker=a;this.connections=[]}addConnection(a,b){b=this.calculateIndexForYPos(b);this.connections.splice(b,0,a)}findIndexOfConnection(a,b){if(!this.connections.length)return-1;const c=this.calculateIndexForYPos(b);if(c>=this.connections.length)return-1;b=a.y;let d=c;for(;0<=d&&this.connections[d].y===b;){if(this.connections[d]===a)return d;d--}for(d=c;d<this.connections.length&&this.connections[d].y===b;){if(this.connections[d]===\na)return d;d++}return-1}calculateIndexForYPos(a){if(!this.connections.length)return 0;let b=0,c=this.connections.length;for(;b<c;){const d=Math.floor((b+c)/2);if(this.connections[d].y<a)b=d+1;else if(this.connections[d].y>a)c=d;else{b=d;break}}return b}removeConnection(a,b){a=this.findIndexOfConnection(a,b);if(-1===a)throw Error(\"Unable to find connection in connectionDB.\");this.connections.splice(a,1)}getNeighbours(a,b){function c(l){const m=e-d[l].x,n=f-d[l].y;Math.sqrt(m*m+n*n)<=b&&k.push(d[l]);\nreturn n<b}const d=this.connections,e=a.x,f=a.y;a=0;let g=d.length-2,h=g;for(;a<h;)d[h].y<f?a=h:g=h,h=Math.floor((a+g)/2);const k=[];g=a=h;if(d.length){for(;0<=a&&c(a);)a--;do g++;while(g<d.length&&c(g))}return k}isInYRange(a,b,c){return Math.abs(this.connections[a].y-b)<=c}searchForClosest(a,b,c){if(!this.connections.length)return{connection:null,radius:b};const d=a.y,e=a.x;a.x=e+c.x;a.y=d+c.y;var f=this.calculateIndexForYPos(a.y);c=null;let g=b,h,k=f-1;for(;0<=k&&this.isInYRange(k,a.y,b);)h=this.connections[k],\nthis.connectionChecker.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),k--;for(;f<this.connections.length&&this.isInYRange(f,a.y,b);)h=this.connections[f],this.connectionChecker.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),f++;a.x=e;a.y=d;return{connection:c,radius:g}}static init(a){const b=[];b[ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE]=new ConnectionDB$$module$build$src$core$connection_db(a);b[ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE]=new ConnectionDB$$module$build$src$core$connection_db(a);\nb[ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT]=new ConnectionDB$$module$build$src$core$connection_db(a);b[ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT]=new ConnectionDB$$module$build$src$core$connection_db(a);return b}},module$build$src$core$connection_db={};module$build$src$core$connection_db.ConnectionDB=ConnectionDB$$module$build$src$core$connection_db;var BlockPaster$$module$build$src$core$clipboard$block_paster=class{paste(a,b,c){if(!b.isCapacityAvailable(a.typeCounts))return null;c&&(a.blockState.x=c.x,a.blockState.y=c.y);$.disable$$module$build$src$core$events$utils();let d;try{d=append$$module$build$src$core$serialization$blocks(a.blockState,b),moveBlockToNotConflict$$module$build$src$core$clipboard$block_paster(d)}finally{$.enable$$module$build$src$core$events$utils()}if(!d)return d;isEnabled$$module$build$src$core$events$utils()&&!d.isShadow()&&\nfire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(d));d.select();return d}};BlockPaster$$module$build$src$core$clipboard$block_paster.TYPE=\"block\";register$$module$build$src$core$clipboard$registry(BlockPaster$$module$build$src$core$clipboard$block_paster.TYPE,new BlockPaster$$module$build$src$core$clipboard$block_paster);var module$build$src$core$clipboard$block_paster={};\nmodule$build$src$core$clipboard$block_paster.BlockPaster=BlockPaster$$module$build$src$core$clipboard$block_paster;module$build$src$core$clipboard$block_paster.moveBlockToNotConflict=moveBlockToNotConflict$$module$build$src$core$clipboard$block_paster;var stashedCopyData$$module$build$src$core$clipboard=null,stashedWorkspace$$module$build$src$core$clipboard=null,TEST_ONLY$$module$build$src$core$clipboard={duplicateInternal:duplicateInternal$$module$build$src$core$clipboard,copyInternal:copyInternal$$module$build$src$core$clipboard},module$build$src$core$clipboard={};module$build$src$core$clipboard.BlockPaster=BlockPaster$$module$build$src$core$clipboard$block_paster;module$build$src$core$clipboard.TEST_ONLY=TEST_ONLY$$module$build$src$core$clipboard;\nmodule$build$src$core$clipboard.copy=copy$$module$build$src$core$clipboard;module$build$src$core$clipboard.duplicate=duplicate$$module$build$src$core$clipboard;module$build$src$core$clipboard.paste=paste$$module$build$src$core$clipboard;module$build$src$core$clipboard.registry=module$build$src$core$clipboard$registry;var ARIA_PREFIX$$module$build$src$core$utils$aria=\"aria-\",ROLE_ATTRIBUTE$$module$build$src$core$utils$aria=\"role\",Role$$module$build$src$core$utils$aria;(function(a){a.GRID=\"grid\";a.GRIDCELL=\"gridcell\";a.GROUP=\"group\";a.LISTBOX=\"listbox\";a.MENU=\"menu\";a.MENUITEM=\"menuitem\";a.MENUITEMCHECKBOX=\"menuitemcheckbox\";a.OPTION=\"option\";a.PRESENTATION=\"presentation\";a.ROW=\"row\";a.TREE=\"tree\";a.TREEITEM=\"treeitem\"})(Role$$module$build$src$core$utils$aria||(Role$$module$build$src$core$utils$aria={}));var State$$module$build$src$core$utils$aria;\n(function(a){a.ACTIVEDESCENDANT=\"activedescendant\";a.COLCOUNT=\"colcount\";a.DISABLED=\"disabled\";a.EXPANDED=\"expanded\";a.INVALID=\"invalid\";a.LABEL=\"label\";a.LABELLEDBY=\"labelledby\";a.LEVEL=\"level\";a.ORIENTATION=\"orientation\";a.POSINSET=\"posinset\";a.ROWCOUNT=\"rowcount\";a.SELECTED=\"selected\";a.SETSIZE=\"setsize\";a.VALUEMAX=\"valuemax\";a.VALUEMIN=\"valuemin\"})(State$$module$build$src$core$utils$aria||(State$$module$build$src$core$utils$aria={}));var module$build$src$core$utils$aria={};\nmodule$build$src$core$utils$aria.Role=Role$$module$build$src$core$utils$aria;module$build$src$core$utils$aria.State=State$$module$build$src$core$utils$aria;module$build$src$core$utils$aria.setRole=setRole$$module$build$src$core$utils$aria;module$build$src$core$utils$aria.setState=setState$$module$build$src$core$utils$aria;var Menu$$module$build$src$core$menu=class{constructor(){this.menuItems=[];this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(a){this.menuItems.push(a)}render(a){const b=document.createElement(\"div\");b.className=\"blocklyMenu goog-menu blocklyNonSelectable\";b.tabIndex=0;this.roleName&&setRole$$module$build$src$core$utils$aria(b,this.roleName);this.element=b;for(let c=\n0,d;d=this.menuItems[c];c++)b.appendChild(d.createDom());this.mouseOverHandler=conditionalBind$$module$build$src$core$browser_events(b,\"pointerover\",this,this.handleMouseOver,!0);this.clickHandler=conditionalBind$$module$build$src$core$browser_events(b,\"pointerup\",this,this.handleClick,!0);this.mouseEnterHandler=conditionalBind$$module$build$src$core$browser_events(b,\"pointerenter\",this,this.handleMouseEnter,!0);this.mouseLeaveHandler=conditionalBind$$module$build$src$core$browser_events(b,\"pointerleave\",\nthis,this.handleMouseLeave,!0);this.onKeyDownHandler=conditionalBind$$module$build$src$core$browser_events(b,\"keydown\",this,this.handleKeyEvent);a.appendChild(b);return b}getElement(){return this.element}focus(){const a=this.getElement();a&&(a.focus({preventScroll:!0}),addClass$$module$build$src$core$utils$dom(a,\"blocklyFocused\"))}blur(){const a=this.getElement();a&&(a.blur(),removeClass$$module$build$src$core$utils$dom(a,\"blocklyFocused\"))}setRole(a){this.roleName=a}dispose(){this.mouseOverHandler&&\n(unbind$$module$build$src$core$browser_events(this.mouseOverHandler),this.mouseOverHandler=null);this.clickHandler&&(unbind$$module$build$src$core$browser_events(this.clickHandler),this.clickHandler=null);this.mouseEnterHandler&&(unbind$$module$build$src$core$browser_events(this.mouseEnterHandler),this.mouseEnterHandler=null);this.mouseLeaveHandler&&(unbind$$module$build$src$core$browser_events(this.mouseLeaveHandler),this.mouseLeaveHandler=null);this.onKeyDownHandler&&(unbind$$module$build$src$core$browser_events(this.onKeyDownHandler),\nthis.onKeyDownHandler=null);for(let a=0,b;b=this.menuItems[a];a++)b.dispose();this.element=null}getMenuItem(a){const b=this.getElement();for(;a&&a!==b;){if(a.classList.contains(\"blocklyMenuItem\"))for(let c=0,d;d=this.menuItems[c];c++)if(d.getElement()===a)return d;a=a.parentElement}return null}setHighlighted(a){var b=this.highlightedItem;b&&(b.setHighlighted(!1),this.highlightedItem=null);a&&(a.setHighlighted(!0),this.highlightedItem=a,b=this.getElement(),scrollIntoContainerView$$module$build$src$core$utils$style(a.getElement(),\nb),setState$$module$build$src$core$utils$aria(b,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,a.getId()))}highlightNext(){const a=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(a,1)}highlightPrevious(){const a=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>a?this.menuItems.length:a,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(a,\nb){a+=b;let c;for(;c=this.menuItems[a];){if(c.isEnabled()){this.setHighlighted(c);break}a+=b}}handleMouseOver(a){(a=this.getMenuItem(a.target))&&(a.isEnabled()?this.highlightedItem!==a&&this.setHighlighted(a):this.setHighlighted(null))}handleClick(a){const b=this.openingCoords;this.openingCoords=null;if(b&&\"number\"===typeof a.clientX){const c=new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY);if(1>Coordinate$$module$build$src$core$utils$coordinate.distance(b,c))return}(a=\nthis.getMenuItem(a.target))&&a.performAction()}handleMouseEnter(a){this.focus()}handleMouseLeave(a){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(a){if(this.menuItems.length&&!(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)){var b=this.highlightedItem;switch(a.key){case \"Enter\":case \" \":b&&b.performAction();break;case \"ArrowUp\":this.highlightPrevious();break;case \"ArrowDown\":this.highlightNext();break;case \"PageUp\":case \"Home\":this.highlightFirst();break;case \"PageDown\":case \"End\":this.highlightLast();\nbreak;default:return}a.preventDefault();a.stopPropagation()}}getSize(){const a=this.getElement(),b=getSize$$module$build$src$core$utils$style(a);b.height=a.scrollHeight;return b}},module$build$src$core$menu={};module$build$src$core$menu.Menu=Menu$$module$build$src$core$menu;var MenuItem$$module$build$src$core$menuitem=class{constructor(a,b){this.content=a;this.opt_value=b;this.enabled=!0;this.element=null;this.rightToLeft=!1;this.roleName=null;this.highlight=this.checked=this.checkable=!1;this.actionHandler=null}createDom(){const a=document.createElement(\"div\");a.id=getNextUniqueId$$module$build$src$core$utils$idgenerator();this.element=a;a.className=\"blocklyMenuItem goog-menuitem \"+(this.enabled?\"\":\"blocklyMenuItemDisabled goog-menuitem-disabled \")+(this.checked?\"blocklyMenuItemSelected goog-option-selected \":\n\"\")+(this.highlight?\"blocklyMenuItemHighlight goog-menuitem-highlight \":\"\")+(this.rightToLeft?\"blocklyMenuItemRtl goog-menuitem-rtl \":\"\");const b=document.createElement(\"div\");b.className=\"blocklyMenuItemContent goog-menuitem-content\";if(this.checkable){var c=document.createElement(\"div\");c.className=\"blocklyMenuItemCheckbox goog-menuitem-checkbox\";b.appendChild(c)}c=this.content;\"string\"===typeof this.content&&(c=document.createTextNode(this.content));b.appendChild(c);a.appendChild(b);this.roleName&&\nsetRole$$module$build$src$core$utils$aria(a,this.roleName);setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.SELECTED,this.checkable&&this.checked||!1);setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.DISABLED,!this.enabled);return a}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let a;return null!=(a=this.opt_value)?a:null}setRightToLeft(a){this.rightToLeft=a}setRole(a){this.roleName=\na}setCheckable(a){this.checkable=a}setChecked(a){this.checked=a}setHighlighted(a){this.highlight=a;const b=this.getElement();b&&this.isEnabled()&&(a?(addClass$$module$build$src$core$utils$dom(b,\"blocklyMenuItemHighlight\"),addClass$$module$build$src$core$utils$dom(b,\"goog-menuitem-highlight\")):(removeClass$$module$build$src$core$utils$dom(b,\"blocklyMenuItemHighlight\"),removeClass$$module$build$src$core$utils$dom(b,\"goog-menuitem-highlight\")))}isEnabled(){return this.enabled}setEnabled(a){this.enabled=\na}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(a,b){this.actionHandler=a.bind(b)}},module$build$src$core$menuitem={};module$build$src$core$menuitem.MenuItem=MenuItem$$module$build$src$core$menuitem;var owner$$module$build$src$core$widgetdiv=null,dispose$$module$build$src$core$widgetdiv=null,containerClassName$$module$build$src$core$widgetdiv=\"blocklyWidgetDiv\",rendererClassName$$module$build$src$core$widgetdiv=\"\",themeClassName$$module$build$src$core$widgetdiv=\"\",containerDiv$$module$build$src$core$widgetdiv,module$build$src$core$widgetdiv={};module$build$src$core$widgetdiv.createDom=createDom$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.getDiv=getDiv$$module$build$src$core$widgetdiv;\nmodule$build$src$core$widgetdiv.hide=hide$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.hideIfOwner=hideIfOwner$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.isVisible=isVisible$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.positionWithAnchor=positionWithAnchor$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.repositionForWindowResize=repositionForWindowResize$$module$build$src$core$widgetdiv;\nmodule$build$src$core$widgetdiv.show=show$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.testOnly_setDiv=testOnly_setDiv$$module$build$src$core$widgetdiv;var currentBlock$$module$build$src$core$contextmenu=null,dummyOwner$$module$build$src$core$contextmenu={},menu_$$module$build$src$core$contextmenu=null,module$build$src$core$contextmenu={};module$build$src$core$contextmenu.callbackFactory=$.callbackFactory$$module$build$src$core$contextmenu;module$build$src$core$contextmenu.commentDeleteOption=commentDeleteOption$$module$build$src$core$contextmenu;module$build$src$core$contextmenu.commentDuplicateOption=commentDuplicateOption$$module$build$src$core$contextmenu;\nmodule$build$src$core$contextmenu.dispose=dispose$$module$build$src$core$contextmenu;module$build$src$core$contextmenu.getCurrentBlock=getCurrentBlock$$module$build$src$core$contextmenu;module$build$src$core$contextmenu.hide=hide$$module$build$src$core$contextmenu;module$build$src$core$contextmenu.setCurrentBlock=setCurrentBlock$$module$build$src$core$contextmenu;module$build$src$core$contextmenu.show=show$$module$build$src$core$contextmenu;\nmodule$build$src$core$contextmenu.workspaceCommentOption=workspaceCommentOption$$module$build$src$core$contextmenu;var ContextMenuRegistry$$module$build$src$core$contextmenu_registry=class{constructor(){this.registry_=new Map;this.reset()}reset(){this.registry_.clear()}register(a){if(this.registry_.has(a.id))throw Error('Menu item with ID \"'+a.id+'\" is already registered.');this.registry_.set(a.id,a)}unregister(a){if(!this.registry_.has(a))throw Error('Menu item with ID \"'+a+'\" not found.');this.registry_.delete(a)}getItem(a){let b;return null!=(b=this.registry_.get(a))?b:null}getContextMenuOptions(a,b){const c=\n[];for(const e of this.registry_.values())if(a===e.scopeType){var d=e.preconditionFn(b);\"hidden\"!==d&&(d={text:\"function\"===typeof e.displayText?e.displayText(b):e.displayText,enabled:\"enabled\"===d,callback:e.callback,scope:b,weight:e.weight},c.push(d))}c.sort(function(e,f){return e.weight-f.weight});return c}};\n(function(a){var b=a.ScopeType||(a.ScopeType={});b.BLOCK=\"block\";b.WORKSPACE=\"workspace\";a.registry=new a})(ContextMenuRegistry$$module$build$src$core$contextmenu_registry||(ContextMenuRegistry$$module$build$src$core$contextmenu_registry={}));var ScopeType$$module$build$src$core$contextmenu_registry=ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType,module$build$src$core$contextmenu_registry={};module$build$src$core$contextmenu_registry.ContextMenuRegistry=ContextMenuRegistry$$module$build$src$core$contextmenu_registry;\nmodule$build$src$core$contextmenu_registry.ScopeType=ScopeType$$module$build$src$core$contextmenu_registry;var module$build$src$core$utils$math={};module$build$src$core$utils$math.clamp=clamp$$module$build$src$core$utils$math;module$build$src$core$utils$math.toDegrees=toDegrees$$module$build$src$core$utils$math;module$build$src$core$utils$math.toRadians=toRadians$$module$build$src$core$utils$math;var ARROW_SIZE$$module$build$src$core$dropdowndiv=16,BORDER_SIZE$$module$build$src$core$dropdowndiv=1,ARROW_HORIZONTAL_PADDING$$module$build$src$core$dropdowndiv=12,PADDING_Y$$module$build$src$core$dropdowndiv=16,ANIMATION_TIME$$module$build$src$core$dropdowndiv=.25,animateOutTimer$$module$build$src$core$dropdowndiv=null,onHide$$module$build$src$core$dropdowndiv=null,renderedClassName$$module$build$src$core$dropdowndiv=\"\",themeClassName$$module$build$src$core$dropdowndiv=\"\",div$$module$build$src$core$dropdowndiv,\ncontent$$module$build$src$core$dropdowndiv,arrow$$module$build$src$core$dropdowndiv,boundsElement$$module$build$src$core$dropdowndiv=null,owner$$module$build$src$core$dropdowndiv=null,positionToField$$module$build$src$core$dropdowndiv=null,internal$$module$build$src$core$dropdowndiv={getBoundsInfo:function(){const a=getPageOffset$$module$build$src$core$utils$style(boundsElement$$module$build$src$core$dropdowndiv),b=getSize$$module$build$src$core$utils$style(boundsElement$$module$build$src$core$dropdowndiv);\nreturn{left:a.x,right:a.x+b.width,top:a.y,bottom:a.y+b.height,width:b.width,height:b.height}},getPositionMetrics:function(a,b,c,d){const e=internal$$module$build$src$core$dropdowndiv.getBoundsInfo(),f=getSize$$module$build$src$core$utils$style(div$$module$build$src$core$dropdowndiv);return b+f.height<e.bottom?getPositionBelowMetrics$$module$build$src$core$dropdowndiv(a,b,e,f):d-f.height>e.top?getPositionAboveMetrics$$module$build$src$core$dropdowndiv(c,d,e,f):b+f.height<document.documentElement.clientHeight?\ngetPositionBelowMetrics$$module$build$src$core$dropdowndiv(a,b,e,f):d-f.height>document.documentElement.clientTop?getPositionAboveMetrics$$module$build$src$core$dropdowndiv(c,d,e,f):getPositionTopOfPageMetrics$$module$build$src$core$dropdowndiv(a,e,f)}},TEST_ONLY$$module$build$src$core$dropdowndiv=internal$$module$build$src$core$dropdowndiv,module$build$src$core$dropdowndiv={ANIMATION_TIME:ANIMATION_TIME$$module$build$src$core$dropdowndiv,ARROW_HORIZONTAL_PADDING:ARROW_HORIZONTAL_PADDING$$module$build$src$core$dropdowndiv,\nARROW_SIZE:ARROW_SIZE$$module$build$src$core$dropdowndiv,BORDER_SIZE:BORDER_SIZE$$module$build$src$core$dropdowndiv,PADDING_Y:PADDING_Y$$module$build$src$core$dropdowndiv,TEST_ONLY:internal$$module$build$src$core$dropdowndiv};module$build$src$core$dropdowndiv.clearContent=clearContent$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.createDom=createDom$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.getContentDiv=getContentDiv$$module$build$src$core$dropdowndiv;\nmodule$build$src$core$dropdowndiv.getOwner=getOwner$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.getPositionX=getPositionX$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.hide=hide$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.hideIfOwner=hideIfOwner$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.hideWithoutAnimation=hideWithoutAnimation$$module$build$src$core$dropdowndiv;\nmodule$build$src$core$dropdowndiv.isVisible=isVisible$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.repositionForWindowResize=repositionForWindowResize$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.setBoundsElement=setBoundsElement$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.setColour=setColour$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.show=show$$module$build$src$core$dropdowndiv;\nmodule$build$src$core$dropdowndiv.showPositionedByBlock=showPositionedByBlock$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.showPositionedByField=showPositionedByField$$module$build$src$core$dropdowndiv;var disconnectPid$$module$build$src$core$block_animations=null,wobblingBlock$$module$build$src$core$block_animations=null,module$build$src$core$block_animations={};module$build$src$core$block_animations.connectionUiEffect=connectionUiEffect$$module$build$src$core$block_animations;module$build$src$core$block_animations.disconnectUiEffect=disconnectUiEffect$$module$build$src$core$block_animations;module$build$src$core$block_animations.disconnectUiStop=disconnectUiStop$$module$build$src$core$block_animations;\nmodule$build$src$core$block_animations.disposeUiEffect=disposeUiEffect$$module$build$src$core$block_animations;var BLOCK$$module$build$src$core$layers=50,BUBBLE$$module$build$src$core$layers=100,module$build$src$core$layers={BLOCK:BLOCK$$module$build$src$core$layers,BUBBLE:BUBBLE$$module$build$src$core$layers};var BubbleDragger$$module$build$src$core$bubble_dragger=class{constructor(a,b){this.bubble=a;this.workspace=b;this.dragTarget_=null;this.wouldDeleteBubble_=!1;this.startXY_=this.bubble.getRelativeToSurfaceXY()}startBubbleDrag(){$.getGroup$$module$build$src$core$events$utils()||$.setGroup$$module$build$src$core$events$utils(!0);this.workspace.setResizesEnabled(!1);this.bubble.setAutoLayout&&this.bubble.setAutoLayout(!1);let a;null==(a=this.workspace.getLayerManager())||a.moveToDragLayer(this.bubble);\nthis.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(a,b){b=this.pixelsToWorkspaceUnits_(b);b=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,b);this.bubble.moveDuringDrag(b);b=this.dragTarget_;this.dragTarget_=this.workspace.getDragTarget(a);a=this.wouldDeleteBubble_;this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_);a!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_();this.dragTarget_!==b&&(b&&b.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble));\nthis.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(a){return a&&this.workspace.getComponentManager().hasCapability(a.id,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA)?a.wouldDelete(this.bubble,!1):!1}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(a,b){this.dragBubble(a,b);this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?a=this.startXY_:(a=this.pixelsToWorkspaceUnits_(b),a=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,\na));this.bubble.moveTo(a.x,a.y);if(this.dragTarget_)this.dragTarget_.onDrop(this.bubble);if(this.wouldDeleteBubble_)this.fireMoveEvent_(),this.bubble.dispose();else{if(this.bubble.setDragging){this.bubble.setDragging(!1);let c;null==(c=this.workspace.getLayerManager())||c.moveOffDragLayer(this.bubble,BUBBLE$$module$build$src$core$layers)}this.fireMoveEvent_()}this.workspace.setResizesEnabled(!0);$.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent_(){if(this.bubble instanceof WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg){const a=\nnew (get$$module$build$src$core$events$utils(COMMENT_MOVE$$module$build$src$core$events$utils))(this.bubble);a.setOldCoordinate(this.startXY_);a.recordNew();fire$$module$build$src$core$events$utils(a)}}pixelsToWorkspaceUnits_(a){a=new Coordinate$$module$build$src$core$utils$coordinate(a.x/this.workspace.scale,a.y/this.workspace.scale);this.workspace.isMutator&&a.scale(1/this.workspace.options.parentWorkspace.scale);return a}},module$build$src$core$bubble_dragger={};\nmodule$build$src$core$bubble_dragger.BubbleDragger=BubbleDragger$$module$build$src$core$bubble_dragger;var COLLAPSE_CHARS$$module$build$src$core$internal_constants=30,DRAG_STACK$$module$build$src$core$internal_constants=!0,OPPOSITE_TYPE$$module$build$src$core$internal_constants=[];OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE]=ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE;OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE]=ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE;\nOPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT]=ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT;OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT]=ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT;\nvar RENAME_VARIABLE_ID$$module$build$src$core$internal_constants=\"RENAME_VARIABLE_ID\",DELETE_VARIABLE_ID$$module$build$src$core$internal_constants=\"DELETE_VARIABLE_ID\",module$build$src$core$internal_constants={COLLAPSE_CHARS:COLLAPSE_CHARS$$module$build$src$core$internal_constants,DELETE_VARIABLE_ID:DELETE_VARIABLE_ID$$module$build$src$core$internal_constants,DRAG_STACK:DRAG_STACK$$module$build$src$core$internal_constants,OPPOSITE_TYPE:OPPOSITE_TYPE$$module$build$src$core$internal_constants,RENAME_VARIABLE_ID:RENAME_VARIABLE_ID$$module$build$src$core$internal_constants};var module$build$src$core$utils$string={};module$build$src$core$utils$string.commonWordPrefix=commonWordPrefix$$module$build$src$core$utils$string;module$build$src$core$utils$string.commonWordSuffix=commonWordSuffix$$module$build$src$core$utils$string;module$build$src$core$utils$string.isNumber=$.isNumber$$module$build$src$core$utils$string;module$build$src$core$utils$string.shortestStringLength=shortestStringLength$$module$build$src$core$utils$string;\nmodule$build$src$core$utils$string.startsWith=startsWith$$module$build$src$core$utils$string;module$build$src$core$utils$string.wrap=$.wrap$$module$build$src$core$utils$string;var customTooltip$$module$build$src$core$tooltip=void 0,visible$$module$build$src$core$tooltip=!1,blocked$$module$build$src$core$tooltip=!1,LIMIT$$module$build$src$core$tooltip=50,mouseOutPid$$module$build$src$core$tooltip=0,showPid$$module$build$src$core$tooltip=0,lastX$$module$build$src$core$tooltip=0,lastY$$module$build$src$core$tooltip=0,element$$module$build$src$core$tooltip=null,poisonedElement$$module$build$src$core$tooltip=null,OFFSET_X$$module$build$src$core$tooltip=0,OFFSET_Y$$module$build$src$core$tooltip=\n10,RADIUS_OK$$module$build$src$core$tooltip=10,HOVER_MS$$module$build$src$core$tooltip=750,MARGINS$$module$build$src$core$tooltip=5,containerDiv$$module$build$src$core$tooltip=null,module$build$src$core$tooltip={HOVER_MS:HOVER_MS$$module$build$src$core$tooltip,LIMIT:LIMIT$$module$build$src$core$tooltip,MARGINS:MARGINS$$module$build$src$core$tooltip,OFFSET_X:OFFSET_X$$module$build$src$core$tooltip,OFFSET_Y:OFFSET_Y$$module$build$src$core$tooltip,RADIUS_OK:RADIUS_OK$$module$build$src$core$tooltip};\nmodule$build$src$core$tooltip.bindMouseEvents=bindMouseEvents$$module$build$src$core$tooltip;module$build$src$core$tooltip.block=block$$module$build$src$core$tooltip;module$build$src$core$tooltip.createDom=createDom$$module$build$src$core$tooltip;module$build$src$core$tooltip.dispose=dispose$$module$build$src$core$tooltip;module$build$src$core$tooltip.getCustomTooltip=getCustomTooltip$$module$build$src$core$tooltip;module$build$src$core$tooltip.getDiv=getDiv$$module$build$src$core$tooltip;\nmodule$build$src$core$tooltip.getTooltipOfObject=getTooltipOfObject$$module$build$src$core$tooltip;module$build$src$core$tooltip.hide=hide$$module$build$src$core$tooltip;module$build$src$core$tooltip.isVisible=isVisible$$module$build$src$core$tooltip;module$build$src$core$tooltip.setCustomTooltip=setCustomTooltip$$module$build$src$core$tooltip;module$build$src$core$tooltip.unbindMouseEvents=unbindMouseEvents$$module$build$src$core$tooltip;module$build$src$core$tooltip.unblock=unblock$$module$build$src$core$tooltip;var WorkspaceDragger$$module$build$src$core$workspace_dragger=class{constructor(a){this.workspace=a;this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally();this.verticalScrollEnabled_=this.workspace.isMovableVertically();this.startScrollXY_=new Coordinate$$module$build$src$core$utils$coordinate(a.scrollX,a.scrollY)}dispose(){this.workspace=null}startDrag(){getSelected$$module$build$src$core$common()&&getSelected$$module$build$src$core$common().unselect()}endDrag(a){this.drag(a)}drag(a){a=\nCoordinate$$module$build$src$core$utils$coordinate.sum(this.startScrollXY_,a);if(this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(a.x,a.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(a.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,a.y);else throw new TypeError(\"Invalid state.\");}},module$build$src$core$workspace_dragger={};module$build$src$core$workspace_dragger.WorkspaceDragger=WorkspaceDragger$$module$build$src$core$workspace_dragger;var ZOOM_IN_MULTIPLIER$$module$build$src$core$gesture=5,ZOOM_OUT_MULTIPLIER$$module$build$src$core$gesture=6,Gesture$$module$build$src$core$gesture=class{constructor(a,b){this.creatorWorkspace=b;this.mouseDownXY=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.startWorkspace_=this.targetBlock=this.startBlock=this.startIcon=this.startField=this.startBubble=null;this.hasExceededDragRadius=!1;this.boundEvents=[];this.flyout=this.workspaceDragger=this.blockDragger=this.bubbleDragger=null;\nthis.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1;this.cachedPoints=new Map;this.startDistance=this.previousScale=0;this.currentDropdownOwner=this.isPinchZoomEnabled=null;this.mostRecentEvent=a;this.currentDragDeltaXY=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.healStack=!DRAG_STACK$$module$build$src$core$internal_constants}dispose(){clearTouchIdentifier$$module$build$src$core$touch();unblock$$module$build$src$core$tooltip();this.creatorWorkspace.clearGesture();\nfor(const a of this.boundEvents)unbind$$module$build$src$core$browser_events(a);this.boundEvents.length=0;this.blockDragger&&this.blockDragger.dispose();this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(a){const b=new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY);this.updateDragDelta(b)&&(this.updateIsDragging(),longStop$$module$build$src$core$touch());this.mostRecentEvent=a}updateDragDelta(a){this.currentDragDeltaXY=Coordinate$$module$build$src$core$utils$coordinate.difference(a,\nthis.mouseDownXY);return this.hasExceededDragRadius?!1:this.hasExceededDragRadius=Coordinate$$module$build$src$core$utils$coordinate.magnitude(this.currentDragDeltaXY)>(this.flyout?$.config$$module$build$src$core$config.flyoutDragRadius:$.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let a;if(!this.targetBlock||null==(a=this.flyout)||!a.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(\"Cannot update dragging from the flyout because the ' +\\n          'flyout's target workspace is undefined\");\nreturn!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),$.getGroup$$module$build$src$core$events$utils()||$.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),this.targetBlock.select(),!0):!1}updateIsDraggingBubble(){if(!this.startBubble)return!1;this.startDraggingBubble();return!0}updateIsDraggingBlock(){if(!this.targetBlock)return!1;\nif(this.flyout){if(this.updateIsDraggingFromFlyout())return this.startDraggingBlock(),!0}else if(this.targetBlock.isMovable())return this.startDraggingBlock(),!0;return!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error(\"Cannot update dragging the workspace because the start workspace is undefined\");if(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())this.workspaceDragger=new WorkspaceDragger$$module$build$src$core$workspace_dragger(this.startWorkspace_),\nthis.workspaceDragger.startDrag()}updateIsDragging(){if(this.calledUpdateIsDragging)throw Error(\"updateIsDragging_ should only be called once per gesture.\");this.calledUpdateIsDragging=!0;this.updateIsDraggingBubble()||this.updateIsDraggingBlock()||this.updateIsDraggingWorkspace()}startDraggingBlock(){this.blockDragger=new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock,this.startWorkspace_);\nthis.blockDragger.startDrag(this.currentDragDeltaXY,this.healStack);this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY)}startDraggingBubble(){if(!this.startBubble)throw Error(\"Cannot update dragging the bubble because the start bubble is undefined\");if(!this.startWorkspace_)throw Error(\"Cannot update dragging the bubble because the start workspace is undefined\");this.bubbleDragger=new BubbleDragger$$module$build$src$core$bubble_dragger(this.startBubble,this.startWorkspace_);this.bubbleDragger.startBubbleDrag();\nthis.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY)}doStart(a){if(!this.startWorkspace_)throw Error(\"Cannot start the touch gesture becauase the start workspace is undefined\");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch;isTargetInput$$module$build$src$core$browser_events(a)?this.cancel():(this.gestureHasStarted=!0,disconnectUiStop$$module$build$src$core$block_animations(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),\nthis.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=getOwner$$module$build$src$core$dropdowndiv(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=a,block$$module$build$src$core$tooltip(),this.targetBlock&&this.targetBlock.select(),isRightButton$$module$build$src$core$browser_events(a)?this.handleRightClick(a):(\"pointerdown\"===a.type.toLowerCase()&&\"mouse\"!==a.pointerType&&longStart$$module$build$src$core$touch(a,\nthis),this.mouseDownXY=new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY),this.healStack=a.altKey||a.ctrlKey||a.metaKey,this.bindMouseEvents(a),this.isEnding_||this.handleTouchStart(a)))}bindMouseEvents(a){this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(document,\"pointerdown\",null,this.handleStart.bind(this),!0));this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(document,\"pointermove\",null,this.handleMove.bind(this),!0));\nthis.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(document,\"pointerup\",null,this.handleUp.bind(this),!0));a.preventDefault();a.stopPropagation()}handleStart(a){this.isDragging()||(this.handleTouchStart(a),this.isMultiTouch()&&longStop$$module$build$src$core$touch())}handleMove(a){this.isDragging()&&shouldHandleEvent$$module$build$src$core$touch(a)||!this.isMultiTouch()?(this.updateFromEvent(a),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.blockDragger?\nthis.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY):this.bubbleDragger&&this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY),a.preventDefault(),a.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(a),longStop$$module$build$src$core$touch())}handleUp(a){this.isDragging()||this.handleTouchEnd(a);if(!this.isMultiTouch()||this.isDragging()){if(!shouldHandleEvent$$module$build$src$core$touch(a))return;this.updateFromEvent(a);longStop$$module$build$src$core$touch();\nif(this.isEnding_){console.log(\"Trying to end a gesture recursively.\");return}this.isEnding_=!0;this.bubbleDragger?this.bubbleDragger.endBubbleDrag(a,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(a,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()?this.doBubbleClick():this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&\nthis.doWorkspaceClick(a)}a.preventDefault();a.stopPropagation();this.dispose()}handleTouchStart(a){var b=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);this.cachedPoints.set(b,this.getTouchPoint(a));var c=Array.from(this.cachedPoints.keys());2===c.length&&(b=this.cachedPoints.get(c[0]),c=this.cachedPoints.get(c[1]),this.startDistance=Coordinate$$module$build$src$core$utils$coordinate.distance(b,c),this.isMultiTouch_=!0,a.preventDefault())}handleTouchMove(a){const b=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);\nthis.cachedPoints.set(b,this.getTouchPoint(a));this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(a):this.handleMove(a)}handlePinch(a){var b=Array.from(this.cachedPoints.keys()),c=this.cachedPoints.get(b[0]);b=this.cachedPoints.get(b[1]);c=Coordinate$$module$build$src$core$utils$coordinate.distance(c,b)/this.startDistance;if(0<this.previousScale&&Infinity>this.previousScale){b=c-this.previousScale;b=0<b?b*ZOOM_IN_MULTIPLIER$$module$build$src$core$gesture:b*ZOOM_OUT_MULTIPLIER$$module$build$src$core$gesture;\nif(!this.startWorkspace_)throw Error(\"Cannot handle a pinch because the start workspace is undefined\");const d=this.startWorkspace_,e=mouseToSvg$$module$build$src$core$browser_events(a,d.getParentSvg(),d.getInverseScreenCTM());d.zoom(e.x,e.y,b)}this.previousScale=c;a.preventDefault()}handleTouchEnd(a){a=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);this.cachedPoints.has(a)&&this.cachedPoints.delete(a);2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(a){return this.startWorkspace_?\nnew Coordinate$$module$build$src$core$utils$coordinate(a.pageX,a.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(longStop$$module$build$src$core$touch(),this.bubbleDragger?this.bubbleDragger.endBubbleDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(a){this.targetBlock?\n(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(a)):this.startBubble?this.startBubble.showContextMenu(a):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(a));a.preventDefault();a.stopPropagation();this.dispose()}handleWsStart(a,b){if(this.gestureHasStarted)throw Error(\"Tried to call gesture.handleWsStart, but the gesture had already been started.\");this.setStartWorkspace(b);this.mostRecentEvent=\na;this.doStart(a)}fireWorkspaceClick(a){fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(CLICK$$module$build$src$core$events$utils))(null,a.id,\"workspace\"))}handleFlyoutStart(a,b){if(this.gestureHasStarted)throw Error(\"Tried to call gesture.handleFlyoutStart, but the gesture had already been started.\");this.setStartFlyout(b);this.handleWsStart(a,b.getWorkspace())}handleBlockStart(a,b){if(this.gestureHasStarted)throw Error(\"Tried to call gesture.handleBlockStart, but the gesture had already been started.\");\nthis.setStartBlock(b);this.mostRecentEvent=a}handleBubbleStart(a,b){if(this.gestureHasStarted)throw Error(\"Tried to call gesture.handleBubbleStart, but the gesture had already been started.\");this.setStartBubble(b);this.mostRecentEvent=a}doBubbleClick(){this.startBubble instanceof WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg&&(this.startBubble.setFocus(),this.startBubble.select())}doFieldClick(){if(!this.startField)throw Error(\"Cannot do a field click because the start field is undefined\");\nthis.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent);this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error(\"Cannot do an icon click because the start icon is undefined\");this.bringBlockToFront();this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error(\"Cannot do a block click because the target block is undefined\");this.targetBlock.isEnabled()&&($.getGroup$$module$build$src$core$events$utils()||\n$.setGroup$$module$build$src$core$events$utils(!0),this.flyout.createBlock(this.targetBlock).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error(\"Cannot do a block click because the start workspace is undefined\");const a=new (get$$module$build$src$core$events$utils(CLICK$$module$build$src$core$events$utils))(this.startBlock,this.startWorkspace_.id,\"block\");fire$$module$build$src$core$events$utils(a)}this.bringBlockToFront();$.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(a){a=\nthis.creatorWorkspace;getSelected$$module$build$src$core$common()&&getSelected$$module$build$src$core$common().unselect();this.fireWorkspaceClick(this.startWorkspace_||a)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(a){if(this.gestureHasStarted)throw Error(\"Tried to call gesture.setStartField, but the gesture had already been started.\");this.startField||(this.startField=a)}setStartIcon(a){if(this.gestureHasStarted)throw Error(\"Tried to call gesture.setStartIcon, but the gesture had already been started.\");\nthis.startIcon||(this.startIcon=a)}setStartBubble(a){this.startBubble||(this.startBubble=a)}setStartBlock(a){this.startBlock||this.startBubble||(this.startBlock=a,a.isInFlyout&&a!==a.getRootBlock()?this.setTargetBlock(a.getRootBlock()):this.setTargetBlock(a))}setTargetBlock(a){a.isShadow()?this.setTargetBlock(a.getParent()):this.targetBlock=a}setStartWorkspace(a){this.startWorkspace_||(this.startWorkspace_=a)}setStartFlyout(a){this.flyout||(this.flyout=a)}isBubbleClick(){return!!this.startBubble&&\n!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return this.startField?this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose)):!1}isIconClick(){if(!this.startIcon)return!1;const a=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&\na}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}isDragging(){return!!this.workspaceDragger||!!this.blockDragger||!!this.bubbleDragger}hasStarted(){return this.gestureHasStarted}getInsertionMarkers(){return this.blockDragger?this.blockDragger.getInsertionMarkers():[]}getCurrentDragger(){let a,b;return null!=(b=null!=(a=this.blockDragger)?a:this.workspaceDragger)?b:this.bubbleDragger}static inProgress(){const a=getAllWorkspaces$$module$build$src$core$common();\nfor(let b=0,c;c=a[b];b++)if(c.currentGesture_)return!0;return!1}},module$build$src$core$gesture={};module$build$src$core$gesture.Gesture=Gesture$$module$build$src$core$gesture;var Grid$$module$build$src$core$grid=class{constructor(a,b){this.pattern=a;let c;this.spacing=null!=(c=b.spacing)?c:0;let d;this.length=null!=(d=b.length)?d:1;this.line2=(this.line1=a.firstChild)&&this.line1.nextSibling;let e;this.snapToGrid=null!=(e=b.snap)?e:!1}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(a){var b=this.spacing*a;this.pattern.setAttribute(\"width\",`${b}`);this.pattern.setAttribute(\"height\",`${b}`);b=Math.floor(this.spacing/\n2)+.5;let c=b-this.length/2,d=b+this.length/2;b*=a;c*=a;d*=a;this.setLineAttributes(this.line1,a,c,d,b,b);this.setLineAttributes(this.line2,a,b,b,c,d)}setLineAttributes(a,b,c,d,e,f){a&&(a.setAttribute(\"stroke-width\",`${b}`),a.setAttribute(\"x1\",`${c}`),a.setAttribute(\"y1\",`${e}`),a.setAttribute(\"x2\",`${d}`),a.setAttribute(\"y2\",`${f}`))}moveTo(a,b){this.pattern.setAttribute(\"x\",`${a}`);this.pattern.setAttribute(\"y\",`${b}`)}static createDom(a,b,c){a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATTERN,\n{id:\"blocklyGridPattern\"+a,patternUnits:\"userSpaceOnUse\"},c);let d,e;if(0<(null!=(d=b.length)?d:1)&&0<(null!=(e=b.spacing)?e:0)){createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{stroke:b.colour},a);let f;null!=(f=b.length)&&f&&createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{stroke:b.colour},a)}else createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{},a);return a}},module$build$src$core$grid=\n{};module$build$src$core$grid.Grid=Grid$$module$build$src$core$grid;var MarkerManager$$module$build$src$core$marker_manager=class{constructor(a){this.workspace=a;this.cursorSvg_=this.cursor_=null;this.markers=new Map;this.markerSvg_=null}registerMarker(a,b){this.markers.has(a)&&this.unregisterMarker(a);b.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,b));this.setMarkerSvg(b.getDrawer().createDom());this.markers.set(a,b)}unregisterMarker(a){const b=this.markers.get(a);if(b)b.dispose(),this.markers.delete(a);else throw Error(\"Marker with ID \"+\na+\" does not exist. Can only unregister markers that exist.\");}getCursor(){return this.cursor_}getMarker(a){return this.markers.get(a)||null}setCursor(a){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose();if(this.cursor_=a)a=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(a),this.setCursorSvg(this.cursor_.getDrawer().createDom())}setCursorSvg(a){a?(this.workspace.getBlockCanvas().appendChild(a),this.cursorSvg_=a):this.cursorSvg_=\nnull}setMarkerSvg(a){a?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(a,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(a)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const a=Object.keys(this.markers);for(let b=0,c;c=a[b];b++)this.unregisterMarker(c);this.markers.clear();this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};\nMarkerManager$$module$build$src$core$marker_manager.LOCAL_MARKER=\"local_marker_1\";var module$build$src$core$marker_manager={};module$build$src$core$marker_manager.MarkerManager=MarkerManager$$module$build$src$core$marker_manager;var module$build$src$core$utils$object={};module$build$src$core$utils$object.deepMerge=deepMerge$$module$build$src$core$utils$object;var Theme$$module$build$src$core$theme=class{constructor(a,b,c,d){this.name=a;this.startHats=!1;this.blockStyles=b||Object.create(null);this.categoryStyles=c||Object.create(null);this.componentStyles=d||Object.create(null);this.fontStyle=Object.create(null);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.THEME,a,this,!0)}getClassName(){return this.name+\"-theme\"}setBlockStyle(a,b){this.blockStyles[a]=b}setCategoryStyle(a,b){this.categoryStyles[a]=b}getComponentStyle(a){a=\nthis.componentStyles[a];if(!a)return null;if(\"string\"===typeof a){const b=this.getComponentStyle(a);if(b)return b}return`${a}`}setComponentStyle(a,b){this.componentStyles[a]=b}setFontStyle(a){this.fontStyle=a}setStartHats(a){this.startHats=a}static defineTheme(a,b){a=a.toLowerCase();const c=new Theme$$module$build$src$core$theme(a);let d=b.base;if(d){if(\"string\"===typeof d){let e;d=null!=(e=getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.THEME,d))?e:void 0}d instanceof\nTheme$$module$build$src$core$theme&&(deepMerge$$module$build$src$core$utils$object(c,d),c.name=a)}deepMerge$$module$build$src$core$utils$object(c.blockStyles,b.blockStyles);deepMerge$$module$build$src$core$utils$object(c.categoryStyles,b.categoryStyles);deepMerge$$module$build$src$core$utils$object(c.componentStyles,b.componentStyles);deepMerge$$module$build$src$core$utils$object(c.fontStyle,b.fontStyle);null!==b.startHats&&(c.startHats=b.startHats);return c}},module$build$src$core$theme={};\nmodule$build$src$core$theme.Theme=Theme$$module$build$src$core$theme;var defaultBlockStyles$$module$build$src$core$theme$classic={colour_blocks:{colourPrimary:\"20\"},list_blocks:{colourPrimary:\"260\"},logic_blocks:{colourPrimary:\"210\"},loop_blocks:{colourPrimary:\"120\"},math_blocks:{colourPrimary:\"230\"},procedure_blocks:{colourPrimary:\"290\"},text_blocks:{colourPrimary:\"160\"},variable_blocks:{colourPrimary:\"330\"},variable_dynamic_blocks:{colourPrimary:\"310\"},hat_blocks:{colourPrimary:\"330\",hat:\"cap\"}},categoryStyles$$module$build$src$core$theme$classic={colour_category:{colour:\"20\"},\nlist_category:{colour:\"260\"},logic_category:{colour:\"210\"},loop_category:{colour:\"120\"},math_category:{colour:\"230\"},procedure_category:{colour:\"290\"},text_category:{colour:\"160\"},variable_category:{colour:\"330\"},variable_dynamic_category:{colour:\"310\"}},Classic$$module$build$src$core$theme$classic=new Theme$$module$build$src$core$theme(\"classic\",defaultBlockStyles$$module$build$src$core$theme$classic,categoryStyles$$module$build$src$core$theme$classic),module$build$src$core$theme$classic={Classic:Classic$$module$build$src$core$theme$classic};var Options$$module$build$src$core$options=class{constructor(a){this.gridPattern=null;this.getMetrics=this.setMetrics=void 0;let b=null,c=!1;var d=!1,e=!1,f=!1,g=!1,h=!1;const k=!!a.readOnly;if(!k){var l;b=convertToolboxDefToJson$$module$build$src$core$utils$toolbox(null!=(l=a.toolbox)?l:null);c=hasCategories$$module$build$src$core$utils$toolbox(b);d=a.trashcan;d=void 0===d?c:d;e=a.collapse;e=void 0===e?c:e;f=a.comments;f=void 0===f?c:f;g=a.disable;g=void 0===g?c:g;h=a.sounds;h=void 0===h?!0:h}l=\na.maxTrashcanContents;d?void 0===l&&(l=32):l=0;const m=!!a.rtl;let n=a.horizontalLayout;void 0===n&&(n=!1);var p=\"end\"!==a.toolboxPosition;p=n?p?Position$$module$build$src$core$utils$toolbox.TOP:Position$$module$build$src$core$utils$toolbox.BOTTOM:p===m?Position$$module$build$src$core$utils$toolbox.RIGHT:Position$$module$build$src$core$utils$toolbox.LEFT;let q=a.css;void 0===q&&(q=!0);let r=\"https://blockly-demo.appspot.com/static/media/\";a.media?r=a.media.endsWith(\"/\")?a.media:a.media+\"/\":\"path\"in\na&&(warn$$module$build$src$core$utils$deprecation(\"path\",\"Nov 2014\",\"Jul 2023\",\"media\"),r=a.path+\"media/\");const u=a.oneBasedIndex,y=a.renderer||\"geras\",z=a.plugins||{};let t=a.modalInputs;void 0===t&&(t=!0);this.RTL=m;this.oneBasedIndex=void 0===u?!0:u;this.collapse=e;this.comments=f;this.disable=g;this.readOnly=k;this.maxBlocks=a.maxBlocks||Infinity;let v;this.maxInstances=null!=(v=a.maxInstances)?v:null;this.modalInputs=t;this.pathToMedia=r;this.hasCategories=c;this.moveOptions=Options$$module$build$src$core$options.parseMoveOptions_(a,\nc);this.hasScrollbars=!!this.moveOptions.scrollbars;this.hasTrashcan=d;this.maxTrashcanContents=l;this.hasSounds=h;this.hasCss=q;this.horizontalLayout=n;this.languageTree=b;this.gridOptions=Options$$module$build$src$core$options.parseGridOptions_(a);this.zoomOptions=Options$$module$build$src$core$options.parseZoomOptions_(a);this.toolboxPosition=p;this.theme=Options$$module$build$src$core$options.parseThemeOptions_(a);this.renderer=y;let w;this.rendererOverrides=null!=(w=a.rendererOverrides)?w:null;\nlet x;this.parentWorkspace=null!=(x=a.parentWorkspace)?x:null;this.plugins=z}static parseMoveOptions_(a,b){const c=a.move||{},d={};void 0===c.scrollbars&&void 0===a.scrollbars?d.scrollbars=b:\"object\"===typeof c.scrollbars?(d.scrollbars={horizontal:!!c.scrollbars.horizontal,vertical:!!c.scrollbars.vertical},d.scrollbars.horizontal&&d.scrollbars.vertical?d.scrollbars=!0:d.scrollbars.horizontal||d.scrollbars.vertical||(d.scrollbars=!1)):d.scrollbars=!!c.scrollbars||!!a.scrollbars;d.wheel=d.scrollbars&&\nvoid 0!==c.wheel?!!c.wheel:\"object\"===typeof d.scrollbars;d.drag=d.scrollbars?void 0===c.drag?!0:!!c.drag:!1;return d}static parseZoomOptions_(a){a=a.zoom||{};const b={};b.controls=void 0===a.controls?!1:!!a.controls;b.wheel=void 0===a.wheel?!1:!!a.wheel;b.startScale=void 0===a.startScale?1:Number(a.startScale);b.maxScale=void 0===a.maxScale?3:Number(a.maxScale);b.minScale=void 0===a.minScale?.3:Number(a.minScale);b.scaleSpeed=void 0===a.scaleSpeed?1.2:Number(a.scaleSpeed);b.pinch=void 0===a.pinch?\nb.wheel||b.controls:!!a.pinch;return b}static parseGridOptions_(a){a=a.grid||{};const b={};b.spacing=Number(a.spacing)||0;b.colour=a.colour||\"#888\";b.length=void 0===a.length?1:Number(a.length);b.snap=0<b.spacing&&!!a.snap;return b}static parseThemeOptions_(a){a=a.theme||Classic$$module$build$src$core$theme$classic;return\"string\"===typeof a?getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.THEME,a):a instanceof Theme$$module$build$src$core$theme?a:Theme$$module$build$src$core$theme.defineTheme(a.name||\n\"builtin\"+getNextUniqueId$$module$build$src$core$utils$idgenerator(),a)}},module$build$src$core$options={};module$build$src$core$options.Options=Options$$module$build$src$core$options;var module$build$src$core$interfaces$i_has_bubble={};module$build$src$core$interfaces$i_has_bubble.hasBubble=hasBubble$$module$build$src$core$interfaces$i_has_bubble;var BlockChange$$module$build$src$core$events$events_block_change=class extends BlockBase$$module$build$src$core$events$events_block_base{constructor(a,b,c,d,e){super(a);this.type=$.CHANGE$$module$build$src$core$events$utils;a&&(this.element=b,this.name=c||void 0,this.oldValue=d,this.newValue=e)}toJson(){const a=super.toJson();if(!this.element)throw Error(\"The changed element is undefined. Either pass an element to the constructor, or call fromJson\");a.element=this.element;a.name=this.name;a.oldValue=\nthis.oldValue;a.newValue=this.newValue;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockChange$$module$build$src$core$events$events_block_change);b.element=a.element;b.name=a.name;b.oldValue=a.oldValue;b.newValue=a.newValue;return b}isNull(){return this.oldValue===this.newValue}run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error(\"The block ID is undefined. Either pass a block to the constructor, or call fromJson\");b=b.getBlockById(this.blockId);if(!b)throw Error(\"The associated block is undefined. Either pass a block to the constructor, or call fromJson\");\nvar c=b.getIcon(IconType$$module$build$src$core$icons$icon_types.MUTATOR);c&&hasBubble$$module$build$src$core$interfaces$i_has_bubble(c)&&c.bubbleIsVisible()&&c.setBubbleVisible(!1);a=a?this.newValue:this.oldValue;switch(this.element){case \"field\":(b=b.getField(this.name))?b.setValue(a):console.warn(\"Can't set non-existent field: \"+this.name);break;case \"comment\":b.setCommentText(a||null);break;case \"collapsed\":b.setCollapsed(!!a);break;case \"disabled\":b.setEnabled(!a);break;case \"inline\":b.setInputsInline(!!a);\nbreak;case \"mutation\":c=BlockChange$$module$build$src$core$events$events_block_change.getExtraBlockState_(b);b.loadExtraState?b.loadExtraState(JSON.parse(a||\"{}\")):b.domToMutation&&b.domToMutation($.textToDom$$module$build$src$core$utils$xml(a||\"<mutation/>\"));fire$$module$build$src$core$events$utils(new BlockChange$$module$build$src$core$events$events_block_change(b,\"mutation\",null,c,a));break;default:console.warn(\"Unknown change type: \"+this.element)}}static getExtraBlockState_(a){return a.saveExtraState?\n(a=a.saveExtraState(!0))?JSON.stringify(a):\"\":a.mutationToDom?(a=a.mutationToDom())?domToText$$module$build$src$core$xml(a):\"\":\"\"}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,$.CHANGE$$module$build$src$core$events$utils,BlockChange$$module$build$src$core$events$events_block_change);var module$build$src$core$events$events_block_change={};module$build$src$core$events$events_block_change.BlockChange=BlockChange$$module$build$src$core$events$events_block_change;var hsvSaturation$$module$build$src$core$utils$colour=.45,hsvValue$$module$build$src$core$utils$colour=.65,names$$module$build$src$core$utils$colour={aqua:\"#00ffff\",black:\"#000000\",blue:\"#0000ff\",fuchsia:\"#ff00ff\",gray:\"#808080\",green:\"#008000\",lime:\"#00ff00\",maroon:\"#800000\",navy:\"#000080\",olive:\"#808000\",purple:\"#800080\",red:\"#ff0000\",silver:\"#c0c0c0\",teal:\"#008080\",white:\"#ffffff\",yellow:\"#ffff00\"},module$build$src$core$utils$colour={};module$build$src$core$utils$colour.blend=blend$$module$build$src$core$utils$colour;\nmodule$build$src$core$utils$colour.getHsvSaturation=getHsvSaturation$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.getHsvValue=getHsvValue$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.hexToRgb=hexToRgb$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.hsvToHex=hsvToHex$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.hueToHex=hueToHex$$module$build$src$core$utils$colour;\nmodule$build$src$core$utils$colour.names=names$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.parse=parse$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.rgbToHex=rgbToHex$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.setHsvSaturation=setHsvSaturation$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.setHsvValue=setHsvValue$$module$build$src$core$utils$colour;var module$build$src$core$utils$parsing={};module$build$src$core$utils$parsing.checkMessageReferences=checkMessageReferences$$module$build$src$core$utils$parsing;module$build$src$core$utils$parsing.parseBlockColour=parseBlockColour$$module$build$src$core$utils$parsing;module$build$src$core$utils$parsing.replaceMessageReferences=replaceMessageReferences$$module$build$src$core$utils$parsing;module$build$src$core$utils$parsing.tokenizeInterpolation=tokenizeInterpolation$$module$build$src$core$utils$parsing;var Field$$module$build$src$core$field=class{constructor(a,b,c){this.DEFAULT_VALUE=null;this.name=void 0;this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null;this.disposed=!1;this.maxDisplayLength=50;this.sourceBlock_=null;this.enabled_=this.visible_=this.isDirty_=!0;this.suffixField=this.prefixField=this.clickTarget_=null;this.EDITABLE=!0;this.SERIALIZABLE=!1;this.CURSOR=\"\";\nthis.value_=\"DEFAULT_VALUE\"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE;this.size_=new Size$$module$build$src$core$utils$size(0,0);a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){a.tooltip&&this.setTooltip(replaceMessageReferences$$module$build$src$core$utils$parsing(a.tooltip))}setSourceBlock(a){if(this.sourceBlock_)throw Error(\"Field already bound to a block\");this.sourceBlock_=a}getConstants(){!this.constants_&&\nthis.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants());return this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{}),this.isVisible()||(this.fieldGroup_.style.display=\"none\"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),\nthis.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_();this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,\"class\":\"blocklyFieldRect\"},\nthis.fieldGroup_)}createTextElement_(){this.textElement_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{\"class\":\"blocklyText\"},this.fieldGroup_);this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute(\"dominant-baseline\",\"central\");this.textContent_=document.createTextNode(\"\");this.textElement_.appendChild(this.textContent_)}bindEvents_(){const a=this.getClickTarget_();if(!a)throw Error(\"A click target has not been set.\");bindMouseEvents$$module$build$src$core$tooltip(a);\nthis.mouseDownWrapper_=conditionalBind$$module$build$src$core$browser_events(a,\"pointerdown\",this,this.onMouseDown_)}fromXml(a){this.setValue(a.textContent)}toXml(a){a.textContent=this.getValue();return a}saveState(a){a=this.saveLegacyState(Field$$module$build$src$core$field);return null!==a?a:this.getValue()}loadState(a){this.loadLegacyState(Field$$module$build$src$core$field,a)||this.setValue(a)}saveLegacyState(a){return a.prototype.saveState===this.saveState&&a.prototype.toXml!==this.toXml?(a=\n$.createElement$$module$build$src$core$utils$xml(\"field\"),a.setAttribute(\"name\",this.name||\"\"),domToText$$module$build$src$core$utils$xml(this.toXml(a)).replace(' xmlns=\"https://developers.google.com/blockly/xml\"',\"\")):null}loadLegacyState(a,b){return a.prototype.loadState===this.loadState&&a.prototype.fromXml!==this.fromXml?(this.fromXml($.textToDom$$module$build$src$core$utils$xml(b)),!0):!1}dispose(){hideIfOwner$$module$build$src$core$dropdowndiv(this);hideIfOwner$$module$build$src$core$widgetdiv(this);\nlet a;(null==(a=this.getSourceBlock())?0:a.isDeadOrDying())||removeNode$$module$build$src$core$utils$dom(this.fieldGroup_);this.disposed=!0}updateEditable(){const a=this.fieldGroup_,b=this.getSourceBlock();this.EDITABLE&&a&&b&&(this.enabled_&&b.isEditable()?(addClass$$module$build$src$core$utils$dom(a,\"blocklyEditableText\"),removeClass$$module$build$src$core$utils$dom(a,\"blocklyNonEditableText\"),a.style.cursor=this.CURSOR):(addClass$$module$build$src$core$utils$dom(a,\"blocklyNonEditableText\"),removeClass$$module$build$src$core$utils$dom(a,\n\"blocklyEditableText\"),a.style.cursor=\"\"))}setEnabled(a){this.enabled_=a;this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Field$$module$build$src$core$field.prototype.showEditor_}isClickableInFlyout(a){return!a}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let a=!1;this.name&&(this.SERIALIZABLE?a=!0:this.EDITABLE&&\n(console.warn(\"Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization.\"),a=!0));return a}isVisible(){return this.visible_}setVisible(a){if(this.visible_!==a){this.visible_=a;var b=this.fieldGroup_;b&&(b.style.display=a?\"block\":\"none\")}}setValidator(a){this.validator_=a}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);\nreturn this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_());this.updateSize_()}showEditor(a){this.isClickable()&&this.showEditor_(a)}showEditor_(a){}repositionForWindowResize(){return!1}updateSize_(a){const b=\nthis.getConstants();a=void 0!==a?a:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let c=2*a,d=b.FIELD_TEXT_HEIGHT,e=0;this.textElement_&&(e=getFastTextWidth$$module$build$src$core$utils$dom(this.textElement_,b.FIELD_TEXT_FONTSIZE,b.FIELD_TEXT_FONTWEIGHT,b.FIELD_TEXT_FONTFAMILY),c+=e);this.isFullBlockField()||(d=Math.max(d,b.FIELD_BORDER_RECT_HEIGHT));this.size_.height=d;this.size_.width=c;this.positionTextElement_(a,e);this.positionBorderRect_()}positionTextElement_(a,b){if(this.textElement_){var c=\nthis.getConstants(),d=this.size_.height/2,e;this.textElement_.setAttribute(\"x\",String((null==(e=this.getSourceBlock())?0:e.RTL)?this.size_.width-b-a:a));this.textElement_.setAttribute(\"y\",String(c.FIELD_TEXT_BASELINE_CENTER?d:d-c.FIELD_TEXT_HEIGHT/2+c.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute(\"width\",String(this.size_.width)),this.borderRect_.setAttribute(\"height\",String(this.size_.height)),this.borderRect_.setAttribute(\"rx\",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),\nthis.borderRect_.setAttribute(\"ry\",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){if(!this.isVisible())return new Size$$module$build$src$core$utils$size(0,0);this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(this.render_(),0!==this.size_.width&&console.warn(\"Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.\"));return this.size_}getScaledBBox(){let a;var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;\nif(this.isFullBlockField()){var c=this.sourceBlock_.getHeightWidth();const d=b.workspace.scale;a=this.getAbsoluteXY_();b=(c.width+1)*d;c=(c.height+1)*d;GECKO$$module$build$src$core$utils$useragent?(a.x+=1.5*d,a.y+=1.5*d):(a.x-=.5*d,a.y-=.5*d)}else c=this.borderRect_.getBoundingClientRect(),a=getPageOffset$$module$build$src$core$utils$style(this.borderRect_),b=c.width,c=c.height;return new Rect$$module$build$src$core$utils$rect(a.y,a.y+c,a.x,a.x+b)}onLocationChange(a){}getDisplayText_(){let a=this.getText();\nif(!a)return Field$$module$build$src$core$field.NBSP;a.length>this.maxDisplayLength&&(a=a.substring(0,this.maxDisplayLength-2)+\"\\u2026\");a=a.replace(/\\s/g,Field$$module$build$src$core$field.NBSP);this.sourceBlock_&&this.sourceBlock_.RTL&&(a+=\"\\u200f\");return a}getText(){const a=this.getText_();return null!==a?String(a):String(this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0;this.constants_=null}forceRerender(){this.isDirty_=!0;this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.queueRender(),\nthis.sourceBlock_.bumpNeighbours())}setValue(a,b=!0){if(null!==a){var c=this.doClassValidation_(a);a=this.processValidation_(a,c);if(!(a instanceof Error)){var d;c=null==(d=this.getValidator())?void 0:d.call(this,a);d=this.processValidation_(a,c);d instanceof Error||(a=this.sourceBlock_,a&&a.disposed||(c=this.getValue(),c===d?this.doValueUpdate_(d):(this.doValueUpdate_(d),b&&a&&isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(a,\n\"field\",this.name||null,c,d)),this.isDirty_&&this.forceRerender())))}}}processValidation_(a,b){return null===b?(this.doValueInvalid_(a),this.isDirty_&&this.forceRerender(),Error()):void 0===b?a:b}getValue(){return this.value_}doClassValidation_(a){return null===a||void 0===a?null:a}doValueUpdate_(a){this.value_=a;this.isDirty_=!0}doValueInvalid_(a){}onMouseDown_(a){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(a=this.sourceBlock_.workspace.getGesture(a))&&a.setStartField(this)}setTooltip(a){a||\n\"\"===a||(a=this.sourceBlock_);const b=this.getClickTarget_();b?b.tooltip=a:this.tooltip_=a}getTooltip(){const a=this.getClickTarget_();return a?getTooltipOfObject$$module$build$src$core$tooltip(a):getTooltipOfObject$$module$build$src$core$tooltip({tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return getPageOffset$$module$build$src$core$utils$style(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let a=\nnull;const b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;const c=b.inputList;for(let d=0;d<b.inputList.length;d++){const e=c[d],f=e.fieldRow;for(let g=0;g<f.length;g++)if(f[g]===this){a=e;break}}return a}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(a){return!1}setCursorSvg(a){if(a){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(a);this.cursorSvg_=a}else this.cursorSvg_=null}setMarkerSvg(a){if(a){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);\nthis.fieldGroup_.appendChild(a);this.markerSvg_=a}else this.markerSvg_=null}updateMarkers_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;a=a.workspace;a.keyboardAccessibilityMode&&this.cursorSvg_&&a.getCursor().draw();a.keyboardAccessibilityMode&&this.markerSvg_&&a.getMarker(MarkerManager$$module$build$src$core$marker_manager.LOCAL_MARKER).draw()}};Field$$module$build$src$core$field.NBSP=\"\\u00a0\";Field$$module$build$src$core$field.SKIP_SETUP=Symbol(\"SKIP_SETUP\");\nvar UnattachedFieldError$$module$build$src$core$field=class extends Error{constructor(){super(\"The field has not yet been attached to its input. Call appendField to attach it.\")}},module$build$src$core$field={};module$build$src$core$field.Field=Field$$module$build$src$core$field;module$build$src$core$field.UnattachedFieldError=UnattachedFieldError$$module$build$src$core$field;$.Names$$module$build$src$core$names=class{constructor(a,b){this.db=new Map;this.dbReverse=new Set;this.variableMap=null;this.variablePrefix=b||\"\";this.reservedWords=new Set(a?a.split(\",\"):[])}reset(){this.db.clear();this.dbReverse.clear();this.variableMap=null}setVariableMap(a){this.variableMap=a}getNameForUserVariable(a){return this.variableMap?(a=this.variableMap.getVariableById(a))?a.name:null:(console.warn(\"Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());\"),\nnull)}populateVariables(a){a=$.allUsedVarModels$$module$build$src$core$variables(a);for(let b=0;b<a.length;b++)this.getName(a[b].getId(),$.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(a){throw Error(\"The implementation of populateProcedures should be monkey-patched in by blockly.ts\");}getName(a,b){let c=a;b===$.NameType$$module$build$src$core$names.VARIABLE&&(a=this.getNameForUserVariable(a))&&(c=a);a=c.toLowerCase();const d=b===$.NameType$$module$build$src$core$names.VARIABLE||\nb===$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:\"\";this.db.has(b)||this.db.set(b,new Map);const e=this.db.get(b);if(e.has(a))return d+e.get(a);b=this.getDistinctName(c,b);e.set(a,b.substr(d.length));return b}getUserNames(a){let b;return(a=null==(b=this.db.get(a))?void 0:b.keys())?Array.from(a):[]}getDistinctName(a,b){a=this.safeName(a);let c=null,d,e;for(;this.dbReverse.has(a+(null!=(d=c)?d:\"\"))||this.reservedWords.has(a+(null!=(e=c)?e:\"\"));)c=c?c+1:2;let f;a+=null!=\n(f=c)?f:\"\";this.dbReverse.add(a);return(b===$.NameType$$module$build$src$core$names.VARIABLE||b===$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:\"\")+a}safeName(a){a?(a=encodeURI(a.replace(/ /g,\"_\")).replace(/[^\\w]/g,\"_\"),-1!==\"0123456789\".indexOf(a[0])&&(a=\"my_\"+a)):a=$.Msg$$module$build$src$core$msg.UNNAMED_KEY||\"unnamed\";return a}static equals(a,b){return a.toLowerCase()===b.toLowerCase()}};\n(function(a){a=a.NameType||(a.NameType={});a.DEVELOPER_VARIABLE=\"DEVELOPER_VARIABLE\";a.VARIABLE=\"VARIABLE\";a.PROCEDURE=\"PROCEDURE\"})($.Names$$module$build$src$core$names||($.Names$$module$build$src$core$names={}));$.NameType$$module$build$src$core$names=$.Names$$module$build$src$core$names.NameType;$.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE;var module$build$src$core$names={NameType:$.NameType$$module$build$src$core$names};\nmodule$build$src$core$names.Names=$.Names$$module$build$src$core$names;var module$build$src$core$interfaces$i_procedure_block={};module$build$src$core$interfaces$i_procedure_block.isProcedureBlock=isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block;var module$build$src$core$interfaces$i_observable={};module$build$src$core$interfaces$i_observable.isObservable=isObservable$$module$build$src$core$interfaces$i_observable;var ObservableProcedureMap$$module$build$src$core$observable_procedure_map=class extends Map{constructor(){super()}set(a,b){if(this.get(a)===b)return this;super.set(a,b);isObservable$$module$build$src$core$interfaces$i_observable(b)&&b.startPublishing();return this}delete(a){const b=this.get(a);a=super.delete(a);if(!a)return a;isObservable$$module$build$src$core$interfaces$i_observable(b)&&b.stopPublishing();return a}clear(){if(this.size)for(const a of this.keys())this.delete(a)}add(a){return this.set(a.getId(),\na)}getProcedures(){return[...this.values()]}},module$build$src$core$observable_procedure_map={};module$build$src$core$observable_procedure_map.ObservableProcedureMap=ObservableProcedureMap$$module$build$src$core$observable_procedure_map;var Icon$$module$build$src$core$icons$icon=class{constructor(a){this.sourceBlock=a;this.offsetInBlock=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.workspaceLocation=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.svgRoot=null;this.tooltip=a}getType(){throw Error(\"Icons must implement getType\");}initView(a){if(!this.svgRoot){var b=this.sourceBlock;this.svgRoot=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyIconGroup\"});\nb.getSvgRoot().appendChild(this.svgRoot);this.updateSvgRootOffset();conditionalBind$$module$build$src$core$browser_events(this.svgRoot,\"pointerdown\",this,a);this.svgRoot.tooltip=this;bindMouseEvents$$module$build$src$core$tooltip(this.svgRoot)}}dispose(){unbindMouseEvents$$module$build$src$core$tooltip(this.svgRoot);removeNode$$module$build$src$core$utils$dom(this.svgRoot)}getWeight(){return-1}getSize(){return new Size$$module$build$src$core$utils$size(0,0)}setTooltip(a){this.tooltip=null!=a?a:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&\n(this.sourceBlock.isCollapsed()?this.svgRoot.style.display=\"none\":this.svgRoot.style.display=\"block\",hasBubble$$module$build$src$core$interfaces$i_has_bubble(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display=\"none\")}isShownWhenCollapsed(){return!1}setOffsetInBlock(a){this.offsetInBlock=a;this.updateSvgRootOffset()}updateSvgRootOffset(){let a;null==(a=this.svgRoot)||a.setAttribute(\"transform\",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(a){this.workspaceLocation=\nCoordinate$$module$build$src$core$utils$coordinate.sum(a,this.offsetInBlock)}onClick(){}isClickableInFlyout(a){return!0}setVisible(a){warn$$module$build$src$core$utils$deprecation(\"setVisible\",\"v10\",\"v11\",\"setBubbleVisible\");hasBubble$$module$build$src$core$interfaces$i_has_bubble(this)&&this.setBubbleVisible(a)}},module$build$src$core$icons$icon={};module$build$src$core$icons$icon.Icon=Icon$$module$build$src$core$icons$icon;var TEST_ONLY$$module$build$src$core$field_registry={fromJsonInternal:fromJsonInternal$$module$build$src$core$field_registry},module$build$src$core$field_registry={TEST_ONLY:TEST_ONLY$$module$build$src$core$field_registry};module$build$src$core$field_registry.fromJson=$.fromJson$$module$build$src$core$field_registry;module$build$src$core$field_registry.register=register$$module$build$src$core$field_registry;module$build$src$core$field_registry.unregister=unregister$$module$build$src$core$field_registry;var FieldDropdown$$module$build$src$core$field_dropdown=class extends Field$$module$build$src$core$field{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null;this.SERIALIZABLE=!0;this.CURSOR=\"default\";this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(Array.isArray(a)?(validateOptions$$module$build$src$core$field_dropdown(a),\na=trimOptions$$module$build$src$core$field_dropdown(a),this.menuGenerator_=a.options,this.prefixField=a.prefix||null,this.suffixField=a.suffix||null):this.menuGenerator_=a,this.selectedOption=this.getOptions(!1)[0],c&&this.configure_(c),this.setValue(this.selectedOption[1]),b&&this.setValidator(b))}fromXml(a){this.isOptionListDynamic()&&this.getOptions(!1);this.setValue(a.textContent)}loadState(a){this.loadLegacyState(FieldDropdown$$module$build$src$core$field_dropdown,a)||(this.isOptionListDynamic()&&\nthis.getOptions(!1),this.setValue(a))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot();this.createTextElement_();this.imageElement=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{},this.fieldGroup_);this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_();this.borderRect_&&addClass$$module$build$src$core$utils$dom(this.borderRect_,\"blocklyDropdownRect\")}shouldAddBorderRect_(){let a;\nreturn!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null==(a=this.getSourceBlock())?0:a.isShadow())}createTextArrow_(){this.arrow=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TSPAN,{},this.textElement_);let a;this.arrow.appendChild(document.createTextNode((null==(a=this.getSourceBlock())?0:a.RTL)?FieldDropdown$$module$build$src$core$field_dropdown.ARROW_CHAR+\" \":\" \"+FieldDropdown$$module$build$src$core$field_dropdown.ARROW_CHAR));\nlet b;(null==(b=this.getSourceBlock())?0:b.RTL)?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+\"px\",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+\"px\"},this.fieldGroup_);this.svgArrow.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",\nthis.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;this.dropdownCreate();this.menu_.openingCoords=a&&\"number\"===typeof a.clientX?new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY):null;clearContent$$module$build$src$core$dropdowndiv();a=this.menu_.render(getContentDiv$$module$build$src$core$dropdowndiv());addClass$$module$build$src$core$utils$dom(a,\"blocklyDropdownMenu\");\nthis.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(b=b.getColour(),setColour$$module$build$src$core$dropdowndiv(b,this.sourceBlock_.style.colourTertiary));showPositionedByField$$module$build$src$core$dropdowndiv(this,this.dropdownDispose_.bind(this));this.menu_.focus();this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),scrollIntoContainerView$$module$build$src$core$utils$style(this.selectedMenuItem.getElement(),getContentDiv$$module$build$src$core$dropdowndiv(),!0));this.applyColour()}dropdownCreate(){const a=\nthis.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;const b=new Menu$$module$build$src$core$menu;b.setRole(Role$$module$build$src$core$utils$aria.LISTBOX);this.menu_=b;const c=this.getOptions(!1);this.selectedMenuItem=null;for(let e=0;e<c.length;e++){const [f,g]=c[e];if(\"object\"===typeof f){var d=new Image(f.width,f.height);d.src=f.src;d.alt=f.alt||\"\"}else d=f;d=new MenuItem$$module$build$src$core$menuitem(d,g);d.setRole(Role$$module$build$src$core$utils$aria.OPTION);\nd.setRightToLeft(a.RTL);d.setCheckable(!0);b.addChild(d);d.setChecked(g===this.value_);g===this.value_&&(this.selectedMenuItem=d);d.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose();this.selectedMenuItem=this.menu_=null;this.applyColour()}handleMenuActionEvent(a){hideIfOwner$$module$build$src$core$dropdowndiv(this,!0);this.onItemSelected_(this.menu_,a)}onItemSelected_(a,b){this.setValue(b.getValue())}isOptionListDynamic(){return\"function\"===typeof this.menuGenerator_}getOptions(a){if(!this.menuGenerator_)throw TypeError(\"A menu generator was never defined.\");\nif(Array.isArray(this.menuGenerator_))return this.menuGenerator_;if(a&&this.generatedOptions)return this.generatedOptions;this.generatedOptions=this.menuGenerator_();validateOptions$$module$build$src$core$field_dropdown(this.generatedOptions);return this.generatedOptions}doClassValidation_(a){return this.getOptions(!0).some(b=>b[1]===a)?a:(this.sourceBlock_&&console.warn(\"Cannot set the dropdown's value to an unavailable option. Block type: \"+this.sourceBlock_.type+\", Field name: \"+this.name+\", Value: \"+\na),null)}doValueUpdate_(a){super.doValueUpdate_(a);a=this.getOptions(!0);for(let b=0,c;c=a[b];b++)c[1]===this.value_&&(this.selectedOption=c)}applyColour(){const a=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute(\"stroke\",a.colourTertiary),this.menu_?this.borderRect_.setAttribute(\"fill\",a.colourTertiary):this.borderRect_.setAttribute(\"fill\",\"transparent\"));this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=a.colourSecondary:this.arrow.style.fill=\na.colourPrimary)}render_(){this.getTextContent().nodeValue=\"\";this.imageElement.style.display=\"none\";const a=this.selectedOption&&this.selectedOption[0];a&&\"object\"===typeof a?this.renderSelectedImage(a):this.renderSelectedText();this.positionBorderRect_()}renderSelectedImage(a){const b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;this.imageElement.style.display=\"\";this.imageElement.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",a.src);\nthis.imageElement.setAttribute(\"height\",String(a.height));this.imageElement.setAttribute(\"width\",String(a.width));const c=Number(a.height);a=Number(a.width);var d=!!this.borderRect_;const e=Math.max(d?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,c+IMAGE_Y_PADDING$$module$build$src$core$field_dropdown);d=d?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let f;f=this.svgArrow?this.positionSVGArrow(a+d,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):getFastTextWidth$$module$build$src$core$utils$dom(this.arrow,\nthis.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=a+f+2*d;this.size_.height=e;let g=0;b.RTL?this.imageElement.setAttribute(\"x\",`${d+f}`):(g=a+f,this.getTextElement().setAttribute(\"text-anchor\",\"end\"),this.imageElement.setAttribute(\"x\",`${d}`));this.imageElement.setAttribute(\"y\",String(e/2-c/2));this.positionTextElement_(g+d,a+f)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var a=\nthis.getTextElement();addClass$$module$build$src$core$utils$dom(a,\"blocklyDropdownText\");a.setAttribute(\"text-anchor\",\"start\");var b=!!this.borderRect_;a=Math.max(b?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const c=getFastTextWidth$$module$build$src$core$utils$dom(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);b=b?this.getConstants().FIELD_BORDER_RECT_X_PADDING:\n0;let d=0;this.svgArrow&&(d=this.positionSVGArrow(c+b,a/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2));this.size_.width=c+d+2*b;this.size_.height=a;this.positionTextElement_(b,c)}positionSVGArrow(a,b){if(!this.svgArrow)return 0;const c=this.getSourceBlock();if(!c)throw new UnattachedFieldError$$module$build$src$core$field;const d=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,e=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,f=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;\nthis.svgArrow.setAttribute(\"transform\",\"translate(\"+(c.RTL?d:a+e)+\",\"+b+\")\");return f+e}getText_(){if(!this.selectedOption)return null;const a=this.selectedOption[0];return\"object\"===typeof a?a.alt:a}static fromJson(a){if(!a.options)throw Error(\"options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.\");return new this(a.options,void 0,a)}};\nFieldDropdown$$module$build$src$core$field_dropdown.CHECKMARK_OVERHANG=25;FieldDropdown$$module$build$src$core$field_dropdown.MAX_MENU_HEIGHT_VH=.45;FieldDropdown$$module$build$src$core$field_dropdown.ARROW_CHAR=\"\\u25be\";var IMAGE_Y_OFFSET$$module$build$src$core$field_dropdown=5,IMAGE_Y_PADDING$$module$build$src$core$field_dropdown=2*IMAGE_Y_OFFSET$$module$build$src$core$field_dropdown;register$$module$build$src$core$field_registry(\"field_dropdown\",FieldDropdown$$module$build$src$core$field_dropdown);\nvar module$build$src$core$field_dropdown={};module$build$src$core$field_dropdown.FieldDropdown=FieldDropdown$$module$build$src$core$field_dropdown;var _a$$module$build$src$core$bubbles$bubble,Bubble$$module$build$src$core$bubbles$bubble=class{constructor(a,b,c){this.workspace=a;this.anchor=b;this.ownerRect=c;this.size=new Size$$module$build$src$core$utils$size(0,0);this.colour=\"#ffffff\";this.disposed=!1;this.relativeLeft=this.relativeTop=0;this.svgRoot=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{},a.getBubbleCanvas());a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,\n{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot);this.tail=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{},a);this.background=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyDraggable\",x:0,y:0,rx:_a$$module$build$src$core$bubbles$bubble.BORDER_WIDTH,ry:_a$$module$build$src$core$bubbles$bubble.BORDER_WIDTH},a);this.contentContainer=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,\n{},this.svgRoot);conditionalBind$$module$build$src$core$browser_events(this.background,\"pointerdown\",this,this.onMouseDown)}dispose(){removeNode$$module$build$src$core$utils$dom(this.svgRoot);this.disposed=!0}setAnchorLocation(a,b=!1){this.anchor=a;b?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor();this.renderTail()}setPositionRelativeToAnchor(a,b){this.relativeLeft=a;this.relativeTop=b;this.positionRelativeToAnchor();this.renderTail()}getSize(){return this.size}setSize(a,b=!1){a.width=\nMath.max(a.width,_a$$module$build$src$core$bubbles$bubble.MIN_SIZE);a.height=Math.max(a.height,_a$$module$build$src$core$bubbles$bubble.MIN_SIZE);this.size=a;this.background.setAttribute(\"width\",`${a.width}`);this.background.setAttribute(\"height\",`${a.height}`);b?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor();this.renderTail()}getColour(){return this.colour}setColour(a){this.colour=a;this.tail.setAttribute(\"fill\",a);this.background.setAttribute(\"fill\",a)}onMouseDown(a){let b;\nnull==(b=this.workspace.getGesture(a))||b.handleBubbleStart(a,this)}positionRelativeToAnchor(){let a=this.anchor.x;a=this.workspace.RTL?a-(this.relativeLeft+this.size.width):a+this.relativeLeft;this.moveTo(a,this.relativeTop+this.anchor.y)}moveTo(a,b){this.svgRoot.setAttribute(\"transform\",`translate(${a}, ${b})`)}positionByRect(a=new Rect$$module$build$src$core$utils$rect(0,0,0,0)){var b=this.workspace.getMetricsManager().getViewMetrics(!0),c=this.getOptimalRelativeLeft(b),d=this.getOptimalRelativeTop(b);\nconst e={x:c,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},f={x:-this.size.width-30,y:d};d={x:a.getWidth(),y:d};var g={x:c,y:a.getHeight()};c=a.getWidth()<a.getHeight()?d:g;a=a.getWidth()<a.getHeight()?g:d;d=this.getOverlap(e,b);g=this.getOverlap(f,b);const h=this.getOverlap(c,b);b=this.getOverlap(a,b);b=Math.max(d,g,h,b);d===b?(this.relativeLeft=e.x,this.relativeTop=e.y):g===b?(this.relativeLeft=f.x,this.relativeTop=f.y):h===b?(this.relativeLeft=c.x,this.relativeTop=\nc.y):(this.relativeLeft=a.x,this.relativeTop=a.y);this.positionRelativeToAnchor()}getOverlap(a,b){var c=this.workspace.RTL?this.anchor.x-a.x-this.size.width:a.x+this.anchor.x;a=a.y+this.anchor.y;return Math.max(0,Math.min(1,(Math.min(c+this.size.width,b.left+b.width)-Math.max(c,b.left))*(Math.min(a+this.size.height,b.top+b.height)-Math.max(a,b.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(a){let b=-this.size.width/4;if(this.size.width>a.width)return b;a=this.getWorkspaceViewRect(a);\nif(this.workspace.RTL){var c=this.anchor.x-b;c-this.size.width<a.left?b=-(a.left-this.anchor.x+this.size.width):c>a.right&&(b=-(a.right-this.anchor.x))}else{c=b+this.anchor.x;const d=c+this.size.width;c<a.left?b=a.left-this.anchor.x:d>a.right&&(b=a.right-this.anchor.x-this.size.width)}return b}getOptimalRelativeTop(a){let b=-this.size.height/4;if(this.size.height>a.height)return b;const c=this.anchor.y+b,d=c+this.size.height;a=this.getWorkspaceViewRect(a);c<a.top?b=a.top-this.anchor.y:d>a.bottom&&\n(b=a.bottom-this.anchor.y-this.size.height);return b}getWorkspaceViewRect(a){const b=a.top;let c=a.top+a.height,d=a.left;a=a.left+a.width;c-=this.getScrollbarThickness();this.workspace.RTL?d-=this.getScrollbarThickness():a-=this.getScrollbarThickness();return new Rect$$module$build$src$core$utils$rect(b,c,d,a)}getScrollbarThickness(){return Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness/this.workspace.scale}renderTail(){const a=[];var b=this.size.width/2,c=this.size.height/2,d=-this.relativeLeft,\ne=-this.relativeTop;if(b===d&&c===e)a.push(\"M \"+b+\",\"+c);else{e-=c;d-=b;this.workspace.RTL&&(d*=-1);var f=Math.sqrt(e*e+d*d),g=Math.acos(d/f);0>e&&(g=2*Math.PI-g);var h=g+Math.PI/2;h>2*Math.PI&&(h-=2*Math.PI);var k=Math.sin(h);const m=Math.cos(h);let n=(this.size.width+this.size.height)/_a$$module$build$src$core$bubbles$bubble.TAIL_THICKNESS;n=Math.min(n,this.size.width,this.size.height)/4;h=1-_a$$module$build$src$core$bubbles$bubble.ANCHOR_RADIUS/f;d=b+h*d;e=c+h*e;h=b+n*m;const p=c+n*k;b-=n*m;c-=\nn*k;k=toRadians$$module$build$src$core$utils$math(this.workspace.RTL?-_a$$module$build$src$core$bubbles$bubble.TAIL_ANGLE:_a$$module$build$src$core$bubbles$bubble.TAIL_ANGLE);k=g+k;k>2*Math.PI&&(k-=2*Math.PI);g=Math.sin(k)*f/_a$$module$build$src$core$bubbles$bubble.TAIL_BEND;f=Math.cos(k)*f/_a$$module$build$src$core$bubbles$bubble.TAIL_BEND;a.push(\"M\"+h+\",\"+p);a.push(\"C\"+(h+f)+\",\"+(p+g)+\" \"+d+\",\"+e+\" \"+d+\",\"+e);a.push(\"C\"+d+\",\"+e+\" \"+(b+f)+\",\"+(c+g)+\" \"+b+\",\"+c)}a.push(\"z\");let l;null==(l=this.tail)||\nl.setAttribute(\"d\",a.join(\" \"))}bringToFront(){let a;const b=null==(a=this.svgRoot)?void 0:a.parentNode;return this.svgRoot&&(null==b?void 0:b.lastChild)!==this.svgRoot?(null==b||b.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new Coordinate$$module$build$src$core$utils$coordinate(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(a){this.moveTo(a.x,a.y);\nthis.relativeLeft=this.workspace.RTL?this.anchor.x-a.x-this.size.width:a.x-this.anchor.x;this.relativeTop=a.y-this.anchor.y;this.renderTail()}setDragging(a){}setDeleteStyle(a){}isDeletable(){return!1}showContextMenu(a){}};_a$$module$build$src$core$bubbles$bubble=Bubble$$module$build$src$core$bubbles$bubble;Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH=6;Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER=2*_a$$module$build$src$core$bubbles$bubble.BORDER_WIDTH;\nBubble$$module$build$src$core$bubbles$bubble.MIN_SIZE=_a$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER;Bubble$$module$build$src$core$bubbles$bubble.TAIL_THICKNESS=1;Bubble$$module$build$src$core$bubbles$bubble.TAIL_ANGLE=20;Bubble$$module$build$src$core$bubbles$bubble.TAIL_BEND=4;Bubble$$module$build$src$core$bubbles$bubble.ANCHOR_RADIUS=8;var module$build$src$core$bubbles$bubble={};module$build$src$core$bubbles$bubble.Bubble=Bubble$$module$build$src$core$bubbles$bubble;var MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble=class extends Bubble$$module$build$src$core$bubbles$bubble{constructor(a,b,c,d){super(b,c,d);this.workspace=b;this.anchor=c;this.ownerRect=d;this.autoLayout=!0;b=new Options$$module$build$src$core$options(a);this.validateWorkspaceOptions(b);this.svgDialog=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{x:Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH,y:Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH},\nthis.contentContainer);a.parentWorkspace=this.workspace;this.miniWorkspace=this.newWorkspaceSvg(new Options$$module$build$src$core$options(a));this.miniWorkspace.internalIsMutator=!0;a=this.miniWorkspace.createDom(\"blocklyMutatorBackground\");this.svgDialog.appendChild(a);b.languageTree&&(a.insertBefore(this.miniWorkspace.addFlyout(Svg$$module$build$src$core$utils$svg.G),this.miniWorkspace.getCanvas()),a=this.miniWorkspace.getFlyout(),null==a||a.init(this.miniWorkspace),null==a||a.show(b.languageTree));\nthis.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let e,f;null==(e=this.miniWorkspace.getFlyout())||null==(f=e.getWorkspace())||f.addChangeListener(this.onWorkspaceChange.bind(this));this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose();super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(a){this.miniWorkspace.addChangeListener(a)}validateWorkspaceOptions(a){if(a.hasCategories)throw Error(\"The miniworkspace bubble does not support toolboxes with categories\");\nif(a.hasTrashcan)throw Error(\"The miniworkspace bubble does not support trashcans\");if(a.zoomOptions.controls||a.zoomOptions.wheel||a.zoomOptions.pinch)throw Error(\"The miniworkspace bubble does not support zooming\");if(a.moveOptions.scrollbars||a.moveOptions.wheel||a.moveOptions.drag)throw Error(\"The miniworkspace bubble does not scrolling/moving the workspace\");if(a.horizontalLayout)throw Error(\"The miniworkspace bubble does not support horizontal layouts\");}onWorkspaceChange(){this.bumpBlocksIntoBounds();\nthis.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const a of this.miniWorkspace.getTopBlocks(!1)){const b=a.getRelativeToSurfaceXY();20>b.y&&a.moveBy(0,20-b.y);if(a.RTL){let c=-20;const d=this.miniWorkspace.getFlyout();d&&(c-=d.getWidth());b.x>c&&a.moveBy(c-b.x,0)}else 20>b.x&&a.moveBy(20-b.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var a=this.getSize(),b=this.calculateWorkspaceSize();Math.abs(a.width-b.width)<MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.MINIMUM_VIEW_CHANGE&&\nMath.abs(a.height-b.height)<MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute(\"width\",`${b.width}px`),this.svgDialog.setAttribute(\"height\",`${b.height}px`),this.miniWorkspace.setCachedParentSvgSize(b.width,b.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute(\"transform\",`translate(${b.width}, 0)`),this.setSize(new Size$$module$build$src$core$utils$size(b.width+Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER,\nb.height+Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var a=this.miniWorkspace.getCanvas().getBBox();let b=a.width+MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.MARGIN;a=a.height+MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.MARGIN;const c=this.miniWorkspace.getFlyout();if(c){const d=c.getWorkspace().getMetricsManager().getScrollMetrics();\na=Math.max(a,d.height+20);b+=c.getWidth()}return new Size$$module$build$src$core$utils$size(b,a)}updateBlockStyles(){for(var a of this.miniWorkspace.getAllBlocks(!1))a.setStyle(a.getStyleName());let b;if(a=null==(b=this.miniWorkspace.getFlyout())?void 0:b.getWorkspace())for(const c of a.getAllBlocks(!1))c.setStyle(c.getStyleName())}moveDuringDrag(a){super.moveDuringDrag(a);this.autoLayout=!1}moveTo(a,b){super.moveTo(a,b);this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(a){throw Error(\"The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts\");\n}};MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.MINIMUM_VIEW_CHANGE=10;MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.MARGIN=3*Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER;var module$build$src$core$bubbles$mini_workspace_bubble={};module$build$src$core$bubbles$mini_workspace_bubble.MiniWorkspaceBubble=MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble;var SIZE$$module$build$src$core$icons$mutator_icon,WORKSPACE_MARGIN$$module$build$src$core$icons$mutator_icon;SIZE$$module$build$src$core$icons$mutator_icon=17;WORKSPACE_MARGIN$$module$build$src$core$icons$mutator_icon=16;\n$.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Icon$$module$build$src$core$icons$icon{constructor(a,b){super(b);this.flyoutBlockTypes=a;this.sourceBlock=b;this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return $.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(a){this.svgRoot||(super.initView(a),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyIconShape\",\nrx:\"4\",ry:\"4\",height:\"16\",width:\"16\"},this.svgRoot),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyIconSymbol\",d:\"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z\"},\nthis.svgRoot),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{\"class\":\"blocklyIconShape\",r:\"2.7\",cx:\"8\",cy:\"8\"},this.svgRoot),addClass$$module$build$src$core$utils$dom(this.svgRoot,\"blockly-icon-mutator\"))}dispose(){super.dispose();let a;null==(a=this.miniWorkspaceBubble)||a.dispose()}getWeight(){return $.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Size$$module$build$src$core$utils$size(SIZE$$module$build$src$core$icons$mutator_icon,\nSIZE$$module$build$src$core$icons$mutator_icon)}applyColour(){super.applyColour();let a;null==(a=this.miniWorkspaceBubble)||a.setColour(this.sourceBlock.style.colourPrimary);let b;null==(b=this.miniWorkspaceBubble)||b.updateBlockStyles()}updateCollapsed(){super.updateCollapsed();this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(a){super.onLocationChange(a);let b;null==(b=this.miniWorkspaceBubble)||b.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick();this.sourceBlock.isEditable()&&\nthis.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(a){if(this.bubbleIsVisible()!==a){if(a){this.miniWorkspaceBubble=new MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble(this.getMiniWorkspaceConfig(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect());this.applyColour();this.createRootBlock();this.addSaveConnectionsListener();let b;null==(b=this.miniWorkspaceBubble)||\nb.addWorkspaceChangeListener(this.createMiniWorkspaceChangeListener())}else{let b;null==(b=this.miniWorkspaceBubble)||b.dispose();this.miniWorkspaceBubble=null;this.saveConnectionsListener&&this.sourceBlock.workspace.removeChangeListener(this.saveConnectionsListener);this.saveConnectionsListener=null}fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(BUBBLE_OPEN$$module$build$src$core$events$utils))(this.sourceBlock,a,\"mutator\"))}}getMiniWorkspaceConfig(){let a;\nconst b={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(a=this.sourceBlock.workspace.options.rendererOverrides)?a:void 0};this.flyoutBlockTypes.length&&(b.toolbox={kind:\"flyoutToolbox\",contents:this.flyoutBlockTypes.map(c=>({kind:\"block\",type:c}))});return b}getAnchorLocation(){const a=SIZE$$module$build$src$core$icons$mutator_icon/2;return Coordinate$$module$build$src$core$utils$coordinate.sum(this.workspaceLocation,\nnew Coordinate$$module$build$src$core$utils$coordinate(a,a))}getBubbleOwnerRect(){const a=this.sourceBlock.getSvgRoot().getBBox();return new Rect$$module$build$src$core$utils$rect(a.y,a.y+a.height,a.x,a.x+a.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error(\"Blocks with mutator icons must include a decompose method\");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var a of this.rootBlock.getDescendants(!1))a.queueRender();this.rootBlock.setMovable(!1);\nthis.rootBlock.setDeletable(!1);let b,c,d,e;a=null!=(e=null==(b=this.miniWorkspaceBubble)?void 0:null==(c=b.getWorkspace())?void 0:null==(d=c.getFlyout())?void 0:d.getWidth())?e:0;this.rootBlock.moveBy(this.rootBlock.RTL?-(a+WORKSPACE_MARGIN$$module$build$src$core$icons$mutator_icon):WORKSPACE_MARGIN$$module$build$src$core$icons$mutator_icon,WORKSPACE_MARGIN$$module$build$src$core$icons$mutator_icon)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=\n()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return a=>{$.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(a)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null;this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(a){return a.isUiEvent||\na.type===$.CREATE$$module$build$src$core$events$utils||a.type===$.CHANGE$$module$build$src$core$events$utils&&\"disabled\"===a.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error(\"Blocks with mutator icons must include a compose method\");var a=$.getGroup$$module$build$src$core$events$utils();a||$.setGroup$$module$build$src$core$events$utils(!0);var b=BlockChange$$module$build$src$core$events$events_block_change.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);\nvar c=BlockChange$$module$build$src$core$events$events_block_change.getExtraBlockState_(this.sourceBlock);b!==c&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,\"mutation\",null,b,c));$.setGroup$$module$build$src$core$events$utils(a)}}getWorkspace(){let a;return null==(a=this.miniWorkspaceBubble)?void 0:a.getWorkspace()}static reconnect(a,b,c){warn$$module$build$src$core$utils$deprecation(\"MutatorIcon.reconnect\",\n\"v10\",\"v11\",\"connection.reconnect\");return a?a.reconnect(b,c):!1}static findParentWs(a){warn$$module$build$src$core$utils$deprecation(\"MutatorIcon.findParentWs\",\"v10\",\"v11\",\"workspace.getRootWorkspace\");return a.getRootWorkspace()}};$.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=IconType$$module$build$src$core$icons$icon_types.MUTATOR;$.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1;var module$build$src$core$icons$mutator_icon={};\nmodule$build$src$core$icons$mutator_icon.MutatorIcon=$.MutatorIcon$$module$build$src$core$icons$mutator_icon;var allExtensions$$module$build$src$core$extensions=Object.create(null),TEST_ONLY$$module$build$src$core$extensions={allExtensions:allExtensions$$module$build$src$core$extensions};$.register$$module$build$src$core$extensions(\"parent_tooltip_when_inline\",extensionParentTooltip$$module$build$src$core$extensions);var module$build$src$core$extensions={TEST_ONLY:TEST_ONLY$$module$build$src$core$extensions};module$build$src$core$extensions.apply=apply$$module$build$src$core$extensions;\nmodule$build$src$core$extensions.buildTooltipForDropdown=$.buildTooltipForDropdown$$module$build$src$core$extensions;module$build$src$core$extensions.buildTooltipWithFieldText=$.buildTooltipWithFieldText$$module$build$src$core$extensions;module$build$src$core$extensions.isRegistered=isRegistered$$module$build$src$core$extensions;module$build$src$core$extensions.register=$.register$$module$build$src$core$extensions;module$build$src$core$extensions.registerMixin=$.registerMixin$$module$build$src$core$extensions;\nmodule$build$src$core$extensions.registerMutator=$.registerMutator$$module$build$src$core$extensions;module$build$src$core$extensions.runAfterPageLoad=runAfterPageLoad$$module$build$src$core$extensions;module$build$src$core$extensions.unregister=unregister$$module$build$src$core$extensions;var KeyCodes$$module$build$src$core$utils$keycodes;\n(function(a){a[a.WIN_KEY_FF_LINUX=0]=\"WIN_KEY_FF_LINUX\";a[a.MAC_ENTER=3]=\"MAC_ENTER\";a[a.BACKSPACE=8]=\"BACKSPACE\";a[a.TAB=9]=\"TAB\";a[a.NUM_CENTER=12]=\"NUM_CENTER\";a[a.ENTER=13]=\"ENTER\";a[a.SHIFT=16]=\"SHIFT\";a[a.CTRL=17]=\"CTRL\";a[a.ALT=18]=\"ALT\";a[a.PAUSE=19]=\"PAUSE\";a[a.CAPS_LOCK=20]=\"CAPS_LOCK\";a[a.ESC=27]=\"ESC\";a[a.SPACE=32]=\"SPACE\";a[a.PAGE_UP=33]=\"PAGE_UP\";a[a.PAGE_DOWN=34]=\"PAGE_DOWN\";a[a.END=35]=\"END\";a[a.HOME=36]=\"HOME\";a[a.LEFT=37]=\"LEFT\";a[a.UP=38]=\"UP\";a[a.RIGHT=39]=\"RIGHT\";a[a.DOWN=40]=\n\"DOWN\";a[a.PLUS_SIGN=43]=\"PLUS_SIGN\";a[a.PRINT_SCREEN=44]=\"PRINT_SCREEN\";a[a.INSERT=45]=\"INSERT\";a[a.DELETE=46]=\"DELETE\";a[a.ZERO=48]=\"ZERO\";a[a.ONE=49]=\"ONE\";a[a.TWO=50]=\"TWO\";a[a.THREE=51]=\"THREE\";a[a.FOUR=52]=\"FOUR\";a[a.FIVE=53]=\"FIVE\";a[a.SIX=54]=\"SIX\";a[a.SEVEN=55]=\"SEVEN\";a[a.EIGHT=56]=\"EIGHT\";a[a.NINE=57]=\"NINE\";a[a.FF_SEMICOLON=59]=\"FF_SEMICOLON\";a[a.FF_EQUALS=61]=\"FF_EQUALS\";a[a.FF_DASH=173]=\"FF_DASH\";a[a.FF_HASH=163]=\"FF_HASH\";a[a.QUESTION_MARK=63]=\"QUESTION_MARK\";a[a.AT_SIGN=64]=\"AT_SIGN\";\na[a.A=65]=\"A\";a[a.B=66]=\"B\";a[a.C=67]=\"C\";a[a.D=68]=\"D\";a[a.E=69]=\"E\";a[a.F=70]=\"F\";a[a.G=71]=\"G\";a[a.H=72]=\"H\";a[a.I=73]=\"I\";a[a.J=74]=\"J\";a[a.K=75]=\"K\";a[a.L=76]=\"L\";a[a.M=77]=\"M\";a[a.N=78]=\"N\";a[a.O=79]=\"O\";a[a.P=80]=\"P\";a[a.Q=81]=\"Q\";a[a.R=82]=\"R\";a[a.S=83]=\"S\";a[a.T=84]=\"T\";a[a.U=85]=\"U\";a[a.V=86]=\"V\";a[a.W=87]=\"W\";a[a.X=88]=\"X\";a[a.Y=89]=\"Y\";a[a.Z=90]=\"Z\";a[a.META=91]=\"META\";a[a.WIN_KEY_RIGHT=92]=\"WIN_KEY_RIGHT\";a[a.CONTEXT_MENU=93]=\"CONTEXT_MENU\";a[a.NUM_ZERO=96]=\"NUM_ZERO\";a[a.NUM_ONE=97]=\n\"NUM_ONE\";a[a.NUM_TWO=98]=\"NUM_TWO\";a[a.NUM_THREE=99]=\"NUM_THREE\";a[a.NUM_FOUR=100]=\"NUM_FOUR\";a[a.NUM_FIVE=101]=\"NUM_FIVE\";a[a.NUM_SIX=102]=\"NUM_SIX\";a[a.NUM_SEVEN=103]=\"NUM_SEVEN\";a[a.NUM_EIGHT=104]=\"NUM_EIGHT\";a[a.NUM_NINE=105]=\"NUM_NINE\";a[a.NUM_MULTIPLY=106]=\"NUM_MULTIPLY\";a[a.NUM_PLUS=107]=\"NUM_PLUS\";a[a.NUM_MINUS=109]=\"NUM_MINUS\";a[a.NUM_PERIOD=110]=\"NUM_PERIOD\";a[a.NUM_DIVISION=111]=\"NUM_DIVISION\";a[a.F1=112]=\"F1\";a[a.F2=113]=\"F2\";a[a.F3=114]=\"F3\";a[a.F4=115]=\"F4\";a[a.F5=116]=\"F5\";a[a.F6=\n117]=\"F6\";a[a.F7=118]=\"F7\";a[a.F8=119]=\"F8\";a[a.F9=120]=\"F9\";a[a.F10=121]=\"F10\";a[a.F11=122]=\"F11\";a[a.F12=123]=\"F12\";a[a.NUMLOCK=144]=\"NUMLOCK\";a[a.SCROLL_LOCK=145]=\"SCROLL_LOCK\";a[a.FIRST_MEDIA_KEY=166]=\"FIRST_MEDIA_KEY\";a[a.LAST_MEDIA_KEY=183]=\"LAST_MEDIA_KEY\";a[a.SEMICOLON=186]=\"SEMICOLON\";a[a.DASH=189]=\"DASH\";a[a.EQUALS=187]=\"EQUALS\";a[a.COMMA=188]=\"COMMA\";a[a.PERIOD=190]=\"PERIOD\";a[a.SLASH=191]=\"SLASH\";a[a.APOSTROPHE=192]=\"APOSTROPHE\";a[a.TILDE=192]=\"TILDE\";a[a.SINGLE_QUOTE=222]=\"SINGLE_QUOTE\";\na[a.OPEN_SQUARE_BRACKET=219]=\"OPEN_SQUARE_BRACKET\";a[a.BACKSLASH=220]=\"BACKSLASH\";a[a.CLOSE_SQUARE_BRACKET=221]=\"CLOSE_SQUARE_BRACKET\";a[a.WIN_KEY=224]=\"WIN_KEY\";a[a.MAC_FF_META=224]=\"MAC_FF_META\";a[a.MAC_WK_CMD_LEFT=91]=\"MAC_WK_CMD_LEFT\";a[a.MAC_WK_CMD_RIGHT=93]=\"MAC_WK_CMD_RIGHT\";a[a.WIN_IME=229]=\"WIN_IME\";a[a.VK_NONAME=252]=\"VK_NONAME\";a[a.PHANTOM=255]=\"PHANTOM\"})(KeyCodes$$module$build$src$core$utils$keycodes||(KeyCodes$$module$build$src$core$utils$keycodes={}));\nvar module$build$src$core$utils$keycodes={};module$build$src$core$utils$keycodes.KeyCodes=KeyCodes$$module$build$src$core$utils$keycodes;var module$build$src$core$utils$svg_paths={};module$build$src$core$utils$svg_paths.arc=arc$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.curve=curve$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.line=line$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.lineOnAxis=lineOnAxis$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.lineTo=lineTo$$module$build$src$core$utils$svg_paths;\nmodule$build$src$core$utils$svg_paths.moveBy=moveBy$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.moveTo=moveTo$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.point=point$$module$build$src$core$utils$svg_paths;var module$build$src$core$utils={};module$build$src$core$utils.Coordinate=Coordinate$$module$build$src$core$utils$coordinate;module$build$src$core$utils.KeyCodes=KeyCodes$$module$build$src$core$utils$keycodes;module$build$src$core$utils.Rect=Rect$$module$build$src$core$utils$rect;module$build$src$core$utils.Size=Size$$module$build$src$core$utils$size;module$build$src$core$utils.Svg=Svg$$module$build$src$core$utils$svg;module$build$src$core$utils.aria=module$build$src$core$utils$aria;\nmodule$build$src$core$utils.array=module$build$src$core$utils$array;module$build$src$core$utils.browserEvents=module$build$src$core$browser_events;module$build$src$core$utils.colour=module$build$src$core$utils$colour;module$build$src$core$utils.deprecation=module$build$src$core$utils$deprecation;module$build$src$core$utils.dom=module$build$src$core$utils$dom;module$build$src$core$utils.extensions=module$build$src$core$extensions;module$build$src$core$utils.idGenerator=module$build$src$core$utils$idgenerator;\nmodule$build$src$core$utils.math=module$build$src$core$utils$math;module$build$src$core$utils.object=module$build$src$core$utils$object;module$build$src$core$utils.parsing=module$build$src$core$utils$parsing;module$build$src$core$utils.string=module$build$src$core$utils$string;module$build$src$core$utils.style=module$build$src$core$utils$style;module$build$src$core$utils.svgMath=module$build$src$core$utils$svg_math;module$build$src$core$utils.svgPaths=module$build$src$core$utils$svg_paths;\nmodule$build$src$core$utils.toolbox=module$build$src$core$utils$toolbox;module$build$src$core$utils.userAgent=module$build$src$core$utils$useragent;module$build$src$core$utils.xml=module$build$src$core$utils$xml;var module$build$src$core$icons$registry={};module$build$src$core$icons$registry.register=register$$module$build$src$core$icons$registry;module$build$src$core$icons$registry.unregister=unregister$$module$build$src$core$icons$registry;var TextBubble$$module$build$src$core$bubbles$text_bubble=class extends Bubble$$module$build$src$core$bubbles$bubble{constructor(a,b,c,d){super(b,c,d);this.text=a;this.workspace=b;this.anchor=c;this.ownerRect=d;this.paragraph=this.stringToSvg(a,this.contentContainer);this.updateBubbleSize()}getText(){return this.text}setText(a){this.text=a;removeNode$$module$build$src$core$utils$dom(this.paragraph);this.paragraph=this.stringToSvg(a,this.contentContainer);this.updateBubbleSize()}stringToSvg(a,b){b=\nthis.createParagraph(b);a=this.createSpans(b,a);this.workspace.RTL&&this.rightAlignSpans(b.getBBox().width,a);return b}createParagraph(a){return createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{\"class\":\"blocklyText blocklyBubbleText blocklyNoPointerEvents\",y:Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH},a)}createSpans(a,b){return b.split(\"\\n\").map(c=>{const d=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TSPAN,\n{dy:\"1em\",x:Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH},a);c=document.createTextNode(c);d.appendChild(c);return d})}rightAlignSpans(a,b){for(const c of b)c.setAttribute(\"text-anchor\",\"end\"),c.setAttribute(\"x\",`${a+Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH}`)}updateBubbleSize(){const a=this.paragraph.getBBox();this.setSize(new Size$$module$build$src$core$utils$size(a.width+2*Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH,a.height+2*Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH),\n!0)}},module$build$src$core$bubbles$text_bubble={};module$build$src$core$bubbles$text_bubble.TextBubble=TextBubble$$module$build$src$core$bubbles$text_bubble;var TextInputBubble$$module$build$src$core$bubbles$textinput_bubble=class extends Bubble$$module$build$src$core$bubbles$bubble{constructor(a,b,c){super(a,b,c);this.workspace=a;this.anchor=b;this.ownerRect=c;this.resizePointerMoveListener=this.resizePointerUpListener=null;this.textChangeListeners=[];this.sizeChangeListeners=[];this.text=\"\";this.DEFAULT_SIZE=new Size$$module$build$src$core$utils$size(160+Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER,80+Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER);\nthis.MIN_SIZE=new Size$$module$build$src$core$utils$size(45+Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER,20+Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER);({inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer));this.resizeGroup=this.createResizeHandle(this.svgRoot);this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(a){this.text=a;this.textArea.value=a;this.onTextChange()}addTextChangeListener(a){this.textChangeListeners.push(a)}addSizeChangeListener(a){this.sizeChangeListeners.push(a)}createEditor(a){a=\ncreateSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FOREIGNOBJECT,{x:Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH,y:Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH},a);const b=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,\"body\");b.setAttribute(\"xmlns\",HTML_NS$$module$build$src$core$utils$dom);b.className=\"blocklyMinimalBody\";const c=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,\"textarea\");c.className=\n\"blocklyCommentTextarea\";c.setAttribute(\"dir\",this.workspace.RTL?\"RTL\":\"LTR\");b.appendChild(c);a.appendChild(b);this.bindTextAreaEvents(c);setTimeout(()=>{c.focus()},0);return{inputRoot:a,textArea:c}}bindTextAreaEvents(a){conditionalBind$$module$build$src$core$browser_events(a,\"wheel\",this,b=>{b.stopPropagation()});conditionalBind$$module$build$src$core$browser_events(a,\"focus\",this,this.onStartEdit,!0);conditionalBind$$module$build$src$core$browser_events(a,\"change\",this,this.onTextChange)}createResizeHandle(a){a=\ncreateSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":this.workspace.RTL?\"blocklyResizeSW\":\"blocklyResizeSE\"},a);const b=2*Bubble$$module$build$src$core$bubbles$bubble.BORDER_WIDTH;createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.POLYGON,{points:`0,${b} ${b},${b} ${b},0`},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{\"class\":\"blocklyResizeLine\",x1:b/3,y1:b-1,x2:b-1,y2:b/\n3},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{\"class\":\"blocklyResizeLine\",x1:2*b/3,y1:b-1,x2:b-1,y2:2*b/3},a);conditionalBind$$module$build$src$core$browser_events(a,\"pointerdown\",this,this.onResizePointerDown);return a}setSize(a,b=!1){a.width=Math.max(a.width,this.MIN_SIZE.width);a.height=Math.max(a.height,this.MIN_SIZE.height);const c=a.width-Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER,d=a.height-Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER;\nthis.inputRoot.setAttribute(\"width\",`${c}`);this.inputRoot.setAttribute(\"height\",`${d}`);this.textArea.style.width=`${c-4}px`;this.textArea.style.height=`${d-4}px`;this.workspace.RTL?this.resizeGroup.setAttribute(\"transform\",`translate(${Bubble$$module$build$src$core$bubbles$bubble.DOUBLE_BORDER}, ${d}) scale(-1 1)`):this.resizeGroup.setAttribute(\"transform\",`translate(${c}, ${d})`);super.setSize(a,b);this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(a){this.bringToFront();\nisRightButton$$module$build$src$core$browser_events(a)||(this.workspace.startDrag(a,new Coordinate$$module$build$src$core$utils$coordinate(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=conditionalBind$$module$build$src$core$browser_events(document,\"pointerup\",this,this.onResizePointerUp),this.resizePointerMoveListener=conditionalBind$$module$build$src$core$browser_events(document,\"pointermove\",this,this.onResizePointerMove),this.workspace.hideChaff());\na.stopPropagation()}onResizePointerUp(a){clearTouchIdentifier$$module$build$src$core$touch();this.resizePointerUpListener&&(unbind$$module$build$src$core$browser_events(this.resizePointerUpListener),this.resizePointerUpListener=null);this.resizePointerMoveListener&&(unbind$$module$build$src$core$browser_events(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(a){a=this.workspace.moveDrag(a);this.setSize(new Size$$module$build$src$core$utils$size(this.workspace.RTL?\n-a.x:a.x,a.y),!1);this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const a of this.textChangeListeners)a()}onSizeChange(){for(const a of this.sizeChangeListeners)a()}};register$$module$build$src$core$css(\"\\n.blocklyCommentTextarea {\\n  background-color: #fef49c;\\n  border: 0;\\n  display: block;\\n  margin: 0;\\n  outline: 0;\\n  padding: 3px;\\n  resize: none;\\n  text-overflow: hidden;\\n}\\n\");\nvar module$build$src$core$bubbles$textinput_bubble={};module$build$src$core$bubbles$textinput_bubble.TextInputBubble=TextInputBubble$$module$build$src$core$bubbles$textinput_bubble;var SIZE$$module$build$src$core$icons$comment_icon=17,DEFAULT_BUBBLE_WIDTH$$module$build$src$core$icons$comment_icon=160,DEFAULT_BUBBLE_HEIGHT$$module$build$src$core$icons$comment_icon=80,CommentIcon$$module$build$src$core$icons$comment_icon=class extends Icon$$module$build$src$core$icons$icon{constructor(a){super(a);this.sourceBlock=a;this.textBubble=this.textInputBubble=null;this.text=\"\";this.bubbleSize=new Size$$module$build$src$core$utils$size(DEFAULT_BUBBLE_WIDTH$$module$build$src$core$icons$comment_icon,\nDEFAULT_BUBBLE_HEIGHT$$module$build$src$core$icons$comment_icon);this.bubbleVisiblity=!1}getType(){return CommentIcon$$module$build$src$core$icons$comment_icon.TYPE}initView(a){this.svgRoot||(super.initView(a),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{\"class\":\"blocklyIconShape\",r:\"8\",cx:\"8\",cy:\"8\"},this.svgRoot),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyIconSymbol\",d:\"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z\"},\nthis.svgRoot),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyIconSymbol\",x:\"6.8\",y:\"10.78\",height:\"2\",width:\"2\"},this.svgRoot),addClass$$module$build$src$core$utils$dom(this.svgRoot,\"blockly-icon-comment\"))}dispose(){super.dispose();let a;null==(a=this.textInputBubble)||a.dispose();let b;null==(b=this.textBubble)||b.dispose()}getWeight(){return CommentIcon$$module$build$src$core$icons$comment_icon.WEIGHT}getSize(){return new Size$$module$build$src$core$utils$size(SIZE$$module$build$src$core$icons$comment_icon,\nSIZE$$module$build$src$core$icons$comment_icon)}applyColour(){super.applyColour();const a=this.sourceBlock.style.colourPrimary;let b;null==(b=this.textInputBubble)||b.setColour(a);let c;null==(c=this.textBubble)||c.setColour(a)}updateEditable(){super.updateEditable();this.bubbleIsVisible()&&(this.setBubbleVisible(!1),this.setBubbleVisible(!0))}onLocationChange(a){super.onLocationChange(a);a=this.getAnchorLocation();let b;null==(b=this.textInputBubble)||b.setAnchorLocation(a);let c;null==(c=this.textBubble)||\nc.setAnchorLocation(a)}setText(a){const b=this.text;fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,\"comment\",null,b,a));this.text=a;let c;null==(c=this.textInputBubble)||c.setText(this.text);let d;null==(d=this.textBubble)||d.setText(this.text)}getText(){return this.text}setBubbleSize(a){this.bubbleSize=a;let b;null==(b=this.textInputBubble)||b.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?\n{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(a){let b;this.text=null!=(b=a.text)?b:\"\";let c,d;this.bubbleSize=new Size$$module$build$src$core$utils$size(null!=(c=a.width)?c:DEFAULT_BUBBLE_WIDTH$$module$build$src$core$icons$comment_icon,null!=(d=a.height)?d:DEFAULT_BUBBLE_HEIGHT$$module$build$src$core$icons$comment_icon);let e;this.bubbleVisiblity=null!=(e=a.pinned)?e:!1;setTimeout(()=>this.setBubbleVisible(this.bubbleVisiblity),\n1)}onClick(){super.onClick();this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var a=this.textInputBubble.getText();this.text!==a&&(fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,\"comment\",null,this.text,a)),this.text=a)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(a){if(!a||\n!this.textBubble&&!this.textInputBubble)if(a||this.textBubble||this.textInputBubble)this.bubbleVisiblity=a,this.sourceBlock.rendered&&!this.sourceBlock.isInFlyout&&(a?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(BUBBLE_OPEN$$module$build$src$core$events$utils))(this.sourceBlock,a,\"comment\")))}showEditableBubble(){this.textInputBubble=\nnew TextInputBubble$$module$build$src$core$bubbles$textinput_bubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect());this.textInputBubble.setText(this.getText());this.textInputBubble.setSize(this.bubbleSize,!0);this.textInputBubble.addTextChangeListener(()=>this.onTextChange());this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.textBubble=new TextBubble$$module$build$src$core$bubbles$text_bubble(this.getText(),this.sourceBlock.workspace,\nthis.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let a;null==(a=this.textInputBubble)||a.dispose();this.textInputBubble=null;let b;null==(b=this.textBubble)||b.dispose();this.textBubble=null}getAnchorLocation(){const a=SIZE$$module$build$src$core$icons$comment_icon/2;return Coordinate$$module$build$src$core$utils$coordinate.sum(this.workspaceLocation,new Coordinate$$module$build$src$core$utils$coordinate(a,a))}getBubbleOwnerRect(){const a=this.sourceBlock.getSvgRoot().getBBox();return new Rect$$module$build$src$core$utils$rect(a.y,\na.y+a.height,a.x,a.x+a.width)}};CommentIcon$$module$build$src$core$icons$comment_icon.TYPE=IconType$$module$build$src$core$icons$icon_types.COMMENT;CommentIcon$$module$build$src$core$icons$comment_icon.WEIGHT=3;register$$module$build$src$core$icons$registry(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE,CommentIcon$$module$build$src$core$icons$comment_icon);var module$build$src$core$icons$comment_icon={};module$build$src$core$icons$comment_icon.CommentIcon=CommentIcon$$module$build$src$core$icons$comment_icon;var SIZE$$module$build$src$core$icons$warning_icon=17,WarningIcon$$module$build$src$core$icons$warning_icon=class extends Icon$$module$build$src$core$icons$icon{constructor(a){super(a);this.sourceBlock=a;this.textMap=new Map;this.textBubble=null}getType(){return WarningIcon$$module$build$src$core$icons$warning_icon.TYPE}initView(a){this.svgRoot||(super.initView(a),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyIconShape\",d:\"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z\"},\nthis.svgRoot),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyIconSymbol\",d:\"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z\"},this.svgRoot),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyIconSymbol\",x:\"7\",y:\"11\",height:\"2\",width:\"2\"},this.svgRoot),addClass$$module$build$src$core$utils$dom(this.svgRoot,\"blockly-icon-warning\"))}dispose(){super.dispose();let a;null==(a=this.textBubble)||\na.dispose()}getWeight(){return WarningIcon$$module$build$src$core$icons$warning_icon.WEIGHT}getSize(){return new Size$$module$build$src$core$utils$size(SIZE$$module$build$src$core$icons$warning_icon,SIZE$$module$build$src$core$icons$warning_icon)}applyColour(){super.applyColour();let a;null==(a=this.textBubble)||a.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(a){super.onLocationChange(a);let b;null==(b=this.textBubble)||b.setAnchorLocation(this.getAnchorLocation())}addMessage(a,\nb){if(this.textMap.get(b)===a)return this;a?this.textMap.set(b,a):this.textMap.delete(b);let c;null==(c=this.textBubble)||c.setText(this.getText());return this}getText(){return[...this.textMap.values()].join(\"\\n\")}onClick(){super.onClick();this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(a){if(this.bubbleIsVisible()!==a){if(a)this.textBubble=new TextBubble$$module$build$src$core$bubbles$text_bubble(this.getText(),\nthis.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour();else{let b;null==(b=this.textBubble)||b.dispose();this.textBubble=null}fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(BUBBLE_OPEN$$module$build$src$core$events$utils))(this.sourceBlock,a,\"warning\"))}}getAnchorLocation(){const a=SIZE$$module$build$src$core$icons$warning_icon/2;return Coordinate$$module$build$src$core$utils$coordinate.sum(this.workspaceLocation,new Coordinate$$module$build$src$core$utils$coordinate(a,\na))}getBubbleOwnerRect(){const a=this.sourceBlock.getSvgRoot().getBBox();return new Rect$$module$build$src$core$utils$rect(a.y,a.y+a.height,a.x,a.x+a.width)}};WarningIcon$$module$build$src$core$icons$warning_icon.TYPE=IconType$$module$build$src$core$icons$icon_types.WARNING;WarningIcon$$module$build$src$core$icons$warning_icon.WEIGHT=2;var module$build$src$core$icons$warning_icon={};module$build$src$core$icons$warning_icon.WarningIcon=WarningIcon$$module$build$src$core$icons$warning_icon;var DuplicateIconType$$module$build$src$core$icons$exceptions=class extends Error{constructor(a){super(`Tried to append an icon of type ${a.getType()} when an icon of `+\"that type already exists on the block. Use getIcon to access the existing icon.\");this.icon=a}},module$build$src$core$icons$exceptions={};module$build$src$core$icons$exceptions.DuplicateIconType=DuplicateIconType$$module$build$src$core$icons$exceptions;var module$build$src$core$icons={};module$build$src$core$icons.CommentIcon=CommentIcon$$module$build$src$core$icons$comment_icon;module$build$src$core$icons.Icon=Icon$$module$build$src$core$icons$icon;module$build$src$core$icons.IconType=IconType$$module$build$src$core$icons$icon_types;module$build$src$core$icons.MutatorIcon=$.MutatorIcon$$module$build$src$core$icons$mutator_icon;module$build$src$core$icons.WarningIcon=WarningIcon$$module$build$src$core$icons$warning_icon;\nmodule$build$src$core$icons.exceptions=module$build$src$core$icons$exceptions;module$build$src$core$icons.registry=module$build$src$core$icons$registry;var CATEGORY_NAME$$module$build$src$core$procedures,module$build$src$core$procedures;CATEGORY_NAME$$module$build$src$core$procedures=\"PROCEDURE\";$.DEFAULT_ARG$$module$build$src$core$procedures=\"x\";module$build$src$core$procedures={CATEGORY_NAME:CATEGORY_NAME$$module$build$src$core$procedures,DEFAULT_ARG:$.DEFAULT_ARG$$module$build$src$core$procedures};module$build$src$core$procedures.ObservableProcedureMap=ObservableProcedureMap$$module$build$src$core$observable_procedure_map;\nmodule$build$src$core$procedures.allProcedures=allProcedures$$module$build$src$core$procedures;module$build$src$core$procedures.findLegalName=$.findLegalName$$module$build$src$core$procedures;module$build$src$core$procedures.flyoutCategory=flyoutCategory$$module$build$src$core$procedures;module$build$src$core$procedures.getCallers=getCallers$$module$build$src$core$procedures;module$build$src$core$procedures.getDefinition=$.getDefinition$$module$build$src$core$procedures;\nmodule$build$src$core$procedures.isNameUsed=isNameUsed$$module$build$src$core$procedures;module$build$src$core$procedures.isProcedureBlock=isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block;module$build$src$core$procedures.mutateCallers=$.mutateCallers$$module$build$src$core$procedures;module$build$src$core$procedures.mutatorOpenListener=mutatorOpenListener$$module$build$src$core$procedures;module$build$src$core$procedures.rename=$.rename$$module$build$src$core$procedures;var TypesContainer$$module$build$src$core$renderers$measurables$types=class{constructor(){this.NONE=0;this.FIELD=1;this.HAT=2;this.ICON=4;this.SPACER=8;this.BETWEEN_ROW_SPACER=16;this.IN_ROW_SPACER=32;this.EXTERNAL_VALUE_INPUT=64;this.INPUT=128;this.INLINE_INPUT=256;this.STATEMENT_INPUT=512;this.CONNECTION=1024;this.PREVIOUS_CONNECTION=2048;this.NEXT_CONNECTION=4096;this.OUTPUT_CONNECTION=8192;this.CORNER=16384;this.LEFT_SQUARE_CORNER=32768;this.LEFT_ROUND_CORNER=65536;this.RIGHT_SQUARE_CORNER=131072;\nthis.RIGHT_ROUND_CORNER=262144;this.JAGGED_EDGE=524288;this.ROW=1048576;this.TOP_ROW=2097152;this.BOTTOM_ROW=4194304;this.INPUT_ROW=8388608;this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER;this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER;this.nextTypeValue_=16777216}getType(a){Object.prototype.hasOwnProperty.call(this,a)||(this[a]=this.nextTypeValue_,this.nextTypeValue_<<=1);return this[a]}isField(a){return a.type&this.FIELD}isHat(a){return a.type&this.HAT}isIcon(a){return a.type&\nthis.ICON}isSpacer(a){return a.type&this.SPACER}isInRowSpacer(a){return a.type&this.IN_ROW_SPACER}isInput(a){return a.type&this.INPUT}isExternalInput(a){return a.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(a){return a.type&this.INLINE_INPUT}isStatementInput(a){return a.type&this.STATEMENT_INPUT}isPreviousConnection(a){return a.type&this.PREVIOUS_CONNECTION}isNextConnection(a){return a.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(a){return a.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(a){return a.type&\nthis.LEFT_ROUND_CORNER}isRightRoundedCorner(a){return a.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(a){return a.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(a){return a.type&this.RIGHT_SQUARE_CORNER}isCorner(a){return a.type&this.CORNER}isJaggedEdge(a){return a.type&this.JAGGED_EDGE}isRow(a){return a.type&this.ROW}isBetweenRowSpacer(a){return a.type&this.BETWEEN_ROW_SPACER}isTopRow(a){return a.type&this.TOP_ROW}isBottomRow(a){return a.type&this.BOTTOM_ROW}isTopOrBottomRow(a){return a.type&\n(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(a){return a.type&this.INPUT_ROW}},Types$$module$build$src$core$renderers$measurables$types=new TypesContainer$$module$build$src$core$renderers$measurables$types,module$build$src$core$renderers$measurables$types={Types:Types$$module$build$src$core$renderers$measurables$types};var Measurable$$module$build$src$core$renderers$measurables$base=class{constructor(a){this.centerline=this.xPos=this.height=this.width=0;this.constants_=a;this.type=Types$$module$build$src$core$renderers$measurables$types.NONE;this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},module$build$src$core$renderers$measurables$base={};module$build$src$core$renderers$measurables$base.Measurable=Measurable$$module$build$src$core$renderers$measurables$base;var Row$$module$build$src$core$renderers$measurables$row=class{constructor(a){this.elements=[];this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0;this.hasStatement=this.hasExternalInput=!1;this.statementEdge=0;this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1;this.align=null;this.constants_=a;this.type=Types$$module$build$src$core$renderers$measurables$types.ROW;this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let a=\nthis.elements.length-1;0<=a;a--){const b=this.elements[a];if(Types$$module$build$src$core$renderers$measurables$types.isInput(b))return b}return null}measure(){throw Error(\"Unexpected attempt to measure a base Row.\");}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let a=0;a<this.elements.length;a++){const b=this.elements[a];if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return b}return null}getLastSpacer(){for(let a=this.elements.length-\n1;0<=a;a--){const b=this.elements[a];if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return b}return null}},module$build$src$core$renderers$measurables$row={};module$build$src$core$renderers$measurables$row.Row=Row$$module$build$src$core$renderers$measurables$row;var BottomRow$$module$build$src$core$renderers$measurables$bottom_row=class extends Row$$module$build$src$core$renderers$measurables$row{constructor(a){super(a);this.hasNextConnection=!1;this.connection=null;this.baseline=this.descenderHeight=0;this.type|=Types$$module$build$src$core$renderers$measurables$types.BOTTOM_ROW}hasLeftSquareCorner(a){return!!a.outputConnection||!!a.getNextBlock()}hasRightSquareCorner(a){return!0}measure(){let a=0,b=0,c=0;for(let d=0;d<this.elements.length;d++){const e=\nthis.elements[d];b+=e.width;Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)||(Types$$module$build$src$core$renderers$measurables$types.isNextConnection(e)?c=Math.max(c,e.height):a=Math.max(a,e.height))}this.width=Math.max(this.minWidth,b);this.height=Math.max(this.minHeight,a)+c;this.descenderHeight=c;this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},module$build$src$core$renderers$measurables$bottom_row={};\nmodule$build$src$core$renderers$measurables$bottom_row.BottomRow=BottomRow$$module$build$src$core$renderers$measurables$bottom_row;var Connection$$module$build$src$core$renderers$measurables$connection=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a,b){super(a);this.connectionModel=b;this.shape=this.constants_.shapeFor(b);this.isDynamicShape=\"isDynamic\"in this.shape&&this.shape.isDynamic;this.type|=Types$$module$build$src$core$renderers$measurables$types.CONNECTION}},module$build$src$core$renderers$measurables$connection={};\nmodule$build$src$core$renderers$measurables$connection.Connection=Connection$$module$build$src$core$renderers$measurables$connection;var InputConnection$$module$build$src$core$renderers$measurables$input_connection=class extends Connection$$module$build$src$core$renderers$measurables$connection{constructor(a,b){super(a,b.connection);this.input=b;this.connectionOffsetY=this.connectionOffsetX=0;this.type|=Types$$module$build$src$core$renderers$measurables$types.INPUT;this.align=b.align;(this.connectedBlock=b.connection&&b.connection.targetBlock()?b.connection.targetBlock():null)?(a=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=\na.width,this.connectedBlockHeight=a.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},module$build$src$core$renderers$measurables$input_connection={};module$build$src$core$renderers$measurables$input_connection.InputConnection=InputConnection$$module$build$src$core$renderers$measurables$input_connection;var ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input=class extends InputConnection$$module$build$src$core$renderers$measurables$input_connection{constructor(a,b){super(a,b);this.height=0;this.type|=Types$$module$build$src$core$renderers$measurables$types.EXTERNAL_VALUE_INPUT;this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height;this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING;\nthis.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP;this.connectionHeight=this.shape.height;this.connectionWidth=this.shape.width}},module$build$src$core$renderers$measurables$external_value_input={};module$build$src$core$renderers$measurables$external_value_input.ExternalValueInput=ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input;var Field$$module$build$src$core$renderers$measurables$field=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a,b,c){super(a);this.field=b;this.parentInput=c;this.isEditable=b.EDITABLE;this.flipRtl=b.getFlipRtl();this.type|=Types$$module$build$src$core$renderers$measurables$types.FIELD;a=this.field.getSize();this.height=a.height;this.width=a.width}},module$build$src$core$renderers$measurables$field={};module$build$src$core$renderers$measurables$field.Field=Field$$module$build$src$core$renderers$measurables$field;var Hat$$module$build$src$core$renderers$measurables$hat=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a){super(a);this.type|=Types$$module$build$src$core$renderers$measurables$types.HAT;this.height=this.constants_.START_HAT.height;this.width=this.constants_.START_HAT.width;this.ascenderHeight=this.height}},module$build$src$core$renderers$measurables$hat={};module$build$src$core$renderers$measurables$hat.Hat=Hat$$module$build$src$core$renderers$measurables$hat;var Icon$$module$build$src$core$renderers$measurables$icon=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a,b){super(a);this.icon=b;this.flipRtl=!1;this.isVisible=hasBubble$$module$build$src$core$interfaces$i_has_bubble(b)&&b.bubbleIsVisible();this.type|=Types$$module$build$src$core$renderers$measurables$types.ICON;a=b.getSize();this.height=a.height;this.width=a.width}},module$build$src$core$renderers$measurables$icon={};\nmodule$build$src$core$renderers$measurables$icon.Icon=Icon$$module$build$src$core$renderers$measurables$icon;var InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a,b){super(a);this.type=this.type|Types$$module$build$src$core$renderers$measurables$types.SPACER|Types$$module$build$src$core$renderers$measurables$types.IN_ROW_SPACER;this.width=b;this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},module$build$src$core$renderers$measurables$in_row_spacer={};\nmodule$build$src$core$renderers$measurables$in_row_spacer.InRowSpacer=InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer;var InlineInput$$module$build$src$core$renderers$measurables$inline_input=class extends InputConnection$$module$build$src$core$renderers$measurables$input_connection{constructor(a,b){super(a,b);this.type|=Types$$module$build$src$core$renderers$measurables$types.INLINE_INPUT;this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING);this.connectionHeight=\nthis.isDynamicShape?this.shape.height(this.height):this.shape.height;this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width;this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1));this.connectionOffsetY=\"connectionOffsetY\"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP;this.connectionOffsetX=\"connectionOffsetX\"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},module$build$src$core$renderers$measurables$inline_input=\n{};module$build$src$core$renderers$measurables$inline_input.InlineInput=InlineInput$$module$build$src$core$renderers$measurables$inline_input;var StatementInput$$module$build$src$core$renderers$measurables$statement_input=class extends InputConnection$$module$build$src$core$renderers$measurables$input_connection{constructor(a,b){super(a,b);this.type|=Types$$module$build$src$core$renderers$measurables$types.STATEMENT_INPUT;this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},\nmodule$build$src$core$renderers$measurables$statement_input={};module$build$src$core$renderers$measurables$statement_input.StatementInput=StatementInput$$module$build$src$core$renderers$measurables$statement_input;var InputRow$$module$build$src$core$renderers$measurables$input_row=class extends Row$$module$build$src$core$renderers$measurables$row{constructor(a){super(a);this.connectedBlockWidths=0;this.type|=Types$$module$build$src$core$renderers$measurables$types.INPUT_ROW}measure(){this.width=this.minWidth;this.height=this.minHeight;let a=0;for(let b=0;b<this.elements.length;b++){const c=this.elements[b];this.width+=c.width;Types$$module$build$src$core$renderers$measurables$types.isInput(c)&&c instanceof\nInputConnection$$module$build$src$core$renderers$measurables$input_connection&&(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(c)&&c instanceof StatementInput$$module$build$src$core$renderers$measurables$statement_input?a+=c.connectedBlockWidth:Types$$module$build$src$core$renderers$measurables$types.isExternalInput(c)&&c instanceof ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input&&0!==c.connectedBlockWidth&&(a+=c.connectedBlockWidth-\nc.connectionWidth));Types$$module$build$src$core$renderers$measurables$types.isSpacer(c)||(this.height=Math.max(this.height,c.height))}this.connectedBlockWidths=a;this.widthWithConnectedBlocks=this.width+a}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},module$build$src$core$renderers$measurables$input_row={};module$build$src$core$renderers$measurables$input_row.InputRow=InputRow$$module$build$src$core$renderers$measurables$input_row;var JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a){super(a);this.type|=Types$$module$build$src$core$renderers$measurables$types.JAGGED_EDGE;this.height=this.constants_.JAGGED_TEETH.height;this.width=this.constants_.JAGGED_TEETH.width}},module$build$src$core$renderers$measurables$jagged_edge={};module$build$src$core$renderers$measurables$jagged_edge.JaggedEdge=JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge;var NextConnection$$module$build$src$core$renderers$measurables$next_connection=class extends Connection$$module$build$src$core$renderers$measurables$connection{constructor(a,b){super(a,b);this.type|=Types$$module$build$src$core$renderers$measurables$types.NEXT_CONNECTION;this.height=this.shape.height;this.width=this.shape.width}},module$build$src$core$renderers$measurables$next_connection={};module$build$src$core$renderers$measurables$next_connection.NextConnection=NextConnection$$module$build$src$core$renderers$measurables$next_connection;var OutputConnection$$module$build$src$core$renderers$measurables$output_connection=class extends Connection$$module$build$src$core$renderers$measurables$connection{constructor(a,b){super(a,b);this.connectionOffsetX=0;this.type|=Types$$module$build$src$core$renderers$measurables$types.OUTPUT_CONNECTION;this.height=this.isDynamicShape?0:this.shape.height;this.startX=this.width=this.isDynamicShape?0:this.shape.width;this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},module$build$src$core$renderers$measurables$output_connection=\n{};module$build$src$core$renderers$measurables$output_connection.OutputConnection=OutputConnection$$module$build$src$core$renderers$measurables$output_connection;var PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection=class extends Connection$$module$build$src$core$renderers$measurables$connection{constructor(a,b){super(a,b);this.type|=Types$$module$build$src$core$renderers$measurables$types.PREVIOUS_CONNECTION;this.height=this.shape.height;this.width=this.shape.width}},module$build$src$core$renderers$measurables$previous_connection={};module$build$src$core$renderers$measurables$previous_connection.PreviousConnection=PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection;var RoundCorner$$module$build$src$core$renderers$measurables$round_corner=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a,b){super(a);this.type=(b&&\"left\"!==b?Types$$module$build$src$core$renderers$measurables$types.RIGHT_ROUND_CORNER:Types$$module$build$src$core$renderers$measurables$types.LEFT_ROUND_CORNER)|Types$$module$build$src$core$renderers$measurables$types.CORNER;this.width=this.constants_.CORNER_RADIUS;this.height=this.constants_.CORNER_RADIUS/2}},\nmodule$build$src$core$renderers$measurables$round_corner={};module$build$src$core$renderers$measurables$round_corner.RoundCorner=RoundCorner$$module$build$src$core$renderers$measurables$round_corner;var SpacerRow$$module$build$src$core$renderers$measurables$spacer_row=class extends Row$$module$build$src$core$renderers$measurables$row{constructor(a,b,c){super(a);this.height=b;this.width=c;this.precedesStatement=this.followsStatement=!1;this.widthWithConnectedBlocks=0;this.type=this.type|Types$$module$build$src$core$renderers$measurables$types.SPACER|Types$$module$build$src$core$renderers$measurables$types.BETWEEN_ROW_SPACER;this.elements=[new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,\nc)]}measure(){}},module$build$src$core$renderers$measurables$spacer_row={};module$build$src$core$renderers$measurables$spacer_row.SpacerRow=SpacerRow$$module$build$src$core$renderers$measurables$spacer_row;var SquareCorner$$module$build$src$core$renderers$measurables$square_corner=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a,b){super(a);this.type=(b&&\"left\"!==b?Types$$module$build$src$core$renderers$measurables$types.RIGHT_SQUARE_CORNER:Types$$module$build$src$core$renderers$measurables$types.LEFT_SQUARE_CORNER)|Types$$module$build$src$core$renderers$measurables$types.CORNER;this.width=this.height=this.constants_.NO_PADDING}},module$build$src$core$renderers$measurables$square_corner=\n{};module$build$src$core$renderers$measurables$square_corner.SquareCorner=SquareCorner$$module$build$src$core$renderers$measurables$square_corner;var TopRow$$module$build$src$core$renderers$measurables$top_row=class extends Row$$module$build$src$core$renderers$measurables$row{constructor(a){super(a);this.ascenderHeight=this.capline=0;this.hasPreviousConnection=!1;this.connection=null;this.type|=Types$$module$build$src$core$renderers$measurables$types.TOP_ROW}hasLeftSquareCorner(a){const b=(a.hat?\"cap\"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection,c=a.getPreviousBlock();return!!a.outputConnection||b||(c?\nc.getNextBlock()===a:!1)}hasRightSquareCorner(a){return!0}measure(){let a=0,b=0,c=0;for(let d=0;d<this.elements.length;d++){const e=this.elements[d];b+=e.width;Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)||(Types$$module$build$src$core$renderers$measurables$types.isHat(e)&&e instanceof Hat$$module$build$src$core$renderers$measurables$hat?c=Math.max(c,e.ascenderHeight):a=Math.max(a,e.height))}this.width=Math.max(this.minWidth,b);this.height=Math.max(this.minHeight,a)+c;this.capline=\nthis.ascenderHeight=c;this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},module$build$src$core$renderers$measurables$top_row={};module$build$src$core$renderers$measurables$top_row.TopRow=TopRow$$module$build$src$core$renderers$measurables$top_row;var ConstantProvider$$module$build$src$core$renderers$common$constants=class{constructor(){this.NO_PADDING=0;this.SMALL_PADDING=3;this.MEDIUM_PADDING=5;this.MEDIUM_LARGE_PADDING=8;this.LARGE_PADDING=10;this.TAB_HEIGHT=15;this.TAB_OFFSET_FROM_TOP=5;this.TAB_VERTICAL_OVERLAP=2.5;this.TAB_WIDTH=8;this.NOTCH_WIDTH=15;this.NOTCH_HEIGHT=4;this.MIN_BLOCK_WIDTH=12;this.EMPTY_BLOCK_SPACER_HEIGHT=16;this.CORNER_RADIUS=8;this.NOTCH_OFFSET_LEFT=15;this.STATEMENT_BOTTOM_SPACER=0;this.STATEMENT_INPUT_PADDING_LEFT=\n20;this.BETWEEN_STATEMENT_PADDING_Y=4;this.ADD_START_HATS=!1;this.START_HAT_HEIGHT=15;this.START_HAT_WIDTH=100;this.SPACER_DEFAULT_HEIGHT=15;this.MIN_BLOCK_HEIGHT=24;this.EMPTY_INLINE_INPUT_PADDING=14.5;this.EXTERNAL_VALUE_INPUT_PADDING=2;this.JAGGED_TEETH_HEIGHT=12;this.JAGGED_TEETH_WIDTH=6;this.FIELD_TEXT_FONTSIZE=11;this.FIELD_TEXT_FONTWEIGHT=\"normal\";this.FIELD_TEXT_FONTFAMILY=\"sans-serif\";this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1;this.FIELD_BORDER_RECT_RADIUS=4;this.FIELD_BORDER_RECT_HEIGHT=\n16;this.FIELD_BORDER_RECT_X_PADDING=5;this.FIELD_BORDER_RECT_Y_PADDING=3;this.FIELD_BORDER_RECT_COLOUR=\"#fff\";this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1;this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12;this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1;this.FIELD_COLOUR_DEFAULT_WIDTH=26;this.defs=null;this.embossFilterId=\"\";this.embossFilter=null;this.disabledPatternId=\"\";this.disabledPattern=null;this.debugFilterId=\"\";this.cssNode=\nthis.debugFilter=null;this.CURSOR_COLOUR=\"#cc0a0a\";this.MARKER_COLOUR=\"#4286f4\";this.CURSOR_WS_WIDTH=100;this.WS_CURSOR_HEIGHT=5;this.CURSOR_STACK_PADDING=10;this.CURSOR_BLOCK_PADDING=2;this.CURSOR_STROKE_WIDTH=4;this.FULL_BLOCK_FIELDS=!1;this.INSERTION_MARKER_COLOUR=\"#000000\";this.INSERTION_MARKER_OPACITY=.2;this.SHAPES={PUZZLE:1,NOTCH:2};this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING;this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT;this.STATEMENT_INPUT_NOTCH_OFFSET=\nthis.NOTCH_OFFSET_LEFT;this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING;this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING;this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING;this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING;this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11;this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT;this.START_POINT=moveBy$$module$build$src$core$utils$svg_paths(0,0);this.FIELD_TEXT_BASELINE_CENTER=!0;this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT;\nthis.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING;this.FIELD_DROPDOWN_SVG_ARROW_DATAURI=\"data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=\";\nthis.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT;this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3;this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth();this.NOTCH=this.makeNotch();this.START_HAT=this.makeStartHat();this.PUZZLE_TAB=this.makePuzzleTab();this.INSIDE_CORNERS=this.makeInsideCorners();this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(a){this.blockStyles=Object.create(null);const b=a.blockStyles;for(const c in b)this.blockStyles[c]=\nthis.validatedBlockStyle_(b[c]);this.setDynamicProperties_(a)}setDynamicProperties_(a){this.setFontConstants_(a);this.setComponentConstants_(a);this.ADD_START_HATS=void 0!==a.startHats?a.startHats:this.ADD_START_HATS}setFontConstants_(a){a.fontStyle&&a.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=a.fontStyle.family);a.fontStyle&&a.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=a.fontStyle.weight);a.fontStyle&&a.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=a.fontStyle.size);a=measureFontMetrics$$module$build$src$core$utils$dom(\"Hg\",\nthis.FIELD_TEXT_FONTSIZE+\"pt\",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY);this.FIELD_TEXT_HEIGHT=a.height;this.FIELD_TEXT_BASELINE=a.baseline}setComponentConstants_(a){this.CURSOR_COLOUR=a.getComponentStyle(\"cursorColour\")||this.CURSOR_COLOUR;this.MARKER_COLOUR=a.getComponentStyle(\"markerColour\")||this.MARKER_COLOUR;this.INSERTION_MARKER_COLOUR=a.getComponentStyle(\"insertionMarkerColour\")||this.INSERTION_MARKER_COLOUR;this.INSERTION_MARKER_OPACITY=Number(a.getComponentStyle(\"insertionMarkerOpacity\"))||\nthis.INSERTION_MARKER_OPACITY}getBlockStyleForColour(a){const b=\"auto_\"+a;this.blockStyles[b]||(this.blockStyles[b]=this.createBlockStyle_(a));return{style:this.blockStyles[b],name:b}}getBlockStyle(a){return this.blockStyles[a||\"\"]||(a&&0===a.indexOf(\"auto_\")?this.getBlockStyleForColour(a.substring(5)).style:this.createBlockStyle_(\"#000000\"))}createBlockStyle_(a){return this.validatedBlockStyle_({colourPrimary:a})}validatedBlockStyle_(a){const b={};a&&Object.assign(b,a);a=parseBlockColour$$module$build$src$core$utils$parsing(b.colourPrimary||\n\"#000\");b.colourPrimary=a.hex;b.colourSecondary=b.colourSecondary?parseBlockColour$$module$build$src$core$utils$parsing(b.colourSecondary).hex:this.generateSecondaryColour_(b.colourPrimary);b.colourTertiary=b.colourTertiary?parseBlockColour$$module$build$src$core$utils$parsing(b.colourTertiary).hex:this.generateTertiaryColour_(b.colourPrimary);b.hat=b.hat||\"\";return b}generateSecondaryColour_(a){return blend$$module$build$src$core$utils$colour(\"#fff\",a,.6)||a}generateTertiaryColour_(a){return blend$$module$build$src$core$utils$colour(\"#fff\",\na,.3)||a}dispose(){this.embossFilter&&removeNode$$module$build$src$core$utils$dom(this.embossFilter);this.disabledPattern&&removeNode$$module$build$src$core$utils$dom(this.disabledPattern);this.debugFilter&&removeNode$$module$build$src$core$utils$dom(this.debugFilter);this.cssNode=null}makeJaggedTeeth(){const a=this.JAGGED_TEETH_HEIGHT,b=this.JAGGED_TEETH_WIDTH,c=line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(b,a/4),point$$module$build$src$core$utils$svg_paths(2*\n-b,a/2),point$$module$build$src$core$utils$svg_paths(b,a/4)]);return{height:a,width:b,path:c}}makeStartHat(){const a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH,c=curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(30,-a),point$$module$build$src$core$utils$svg_paths(70,-a),point$$module$build$src$core$utils$svg_paths(b,0)]);return{height:a,width:b,path:c}}makePuzzleTab(){function a(f){f=f?-1:1;const g=-f;var h=c/2;const k=h+2.5,l=h+.5,m=point$$module$build$src$core$utils$svg_paths(-b,\nf*h);h=point$$module$build$src$core$utils$svg_paths(b,f*h);return curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(0,f*k),point$$module$build$src$core$utils$svg_paths(-b,g*l),m])+curve$$module$build$src$core$utils$svg_paths(\"s\",[point$$module$build$src$core$utils$svg_paths(b,2.5*g),h])}const b=this.TAB_WIDTH,c=this.TAB_HEIGHT,d=a(!0),e=a(!1);return{type:this.SHAPES.PUZZLE,width:b,height:c,pathDown:e,pathUp:d}}makeNotch(){function a(g){return line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(g*\nd,c),point$$module$build$src$core$utils$svg_paths(3*g,0),point$$module$build$src$core$utils$svg_paths(g*d,-c)])}const b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=(b-3)/2,e=a(1),f=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:e,pathRight:f}}makeInsideCorners(){const a=this.CORNER_RADIUS,b=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a,point$$module$build$src$core$utils$svg_paths(-a,a)),c=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a,point$$module$build$src$core$utils$svg_paths(a,\na));return{width:a,height:a,pathTop:b,pathBottom:c}}makeOutsideCorners(){const a=this.CORNER_RADIUS,b=moveBy$$module$build$src$core$utils$svg_paths(0,a)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a,point$$module$build$src$core$utils$svg_paths(a,-a)),c=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a,point$$module$build$src$core$utils$svg_paths(a,a)),d=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a,point$$module$build$src$core$utils$svg_paths(-a,-a)),e=arc$$module$build$src$core$utils$svg_paths(\"a\",\n\"0 0,1\",a,point$$module$build$src$core$utils$svg_paths(-a,a));return{topLeft:b,topRight:c,bottomRight:e,bottomLeft:d,rightHeight:a}}shapeFor(a){switch(a.type){case ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE:case ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE:return this.PUZZLE_TAB;case ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT:case ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT:return this.NOTCH;default:throw Error(\"Unknown connection type\");\n}}createDom(a,b,c){this.injectCSS_(b,c);this.defs=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.DEFS,{},a);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,{id:\"blocklyEmbossFilter\"+this.randomIdentifier},this.defs);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR,{\"in\":\"SourceAlpha\",stdDeviation:1,result:\"blur\"},a);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FESPECULARLIGHTING,\n{\"in\":\"blur\",surfaceScale:1,specularConstant:.5,specularExponent:10,\"lighting-color\":\"white\",result:\"specOut\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEPOINTLIGHT,{x:-5E3,y:-1E4,z:2E4},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{\"in\":\"specOut\",in2:\"SourceAlpha\",operator:\"in\",result:\"specOut\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,\n{\"in\":\"SourceGraphic\",in2:\"specOut\",operator:\"arithmetic\",k1:0,k2:1,k3:1,k4:0},a);this.embossFilterId=a.id;this.embossFilter=a;a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATTERN,{id:\"blocklyDisabledPattern\"+this.randomIdentifier,patternUnits:\"userSpaceOnUse\",width:10,height:10},this.defs);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:10,height:10,fill:\"#aaa\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,\n{d:\"M 0 0 L 10 10 M 10 0 L 0 10\",stroke:\"#cc0\"},a);this.disabledPatternId=a.id;this.disabledPattern=a;this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,{id:\"blocklyDebugFilter\"+this.randomIdentifier,height:\"160%\",width:\"180%\",y:\"-30%\",x:\"-40%\"},this.defs),b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER,{result:\"outBlur\"},\na);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFUNCA,{type:\"table\",tableValues:\"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFLOOD,{\"flood-color\":\"#ff0000\",\"flood-opacity\":.5,result:\"outColor\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{\"in\":\"outColor\",in2:\"outBlur\",operator:\"in\",result:\"outGlow\"},a);this.debugFilterId=\na.id;this.debugFilter=a}}injectCSS_(a,b){b=this.getCSS_(b);a=\"blockly-renderer-style-\"+a;this.cssNode=document.getElementById(a);const c=b.join(\"\\n\");this.cssNode?this.cssNode.firstChild.textContent=c:(b=document.createElement(\"style\"),b.id=a,a=document.createTextNode(c),b.appendChild(a),document.head.insertBefore(b,document.head.firstChild),this.cssNode=b)}getCSS_(a){return[`${a} .blocklyText, `,`${a} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} `+`${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,\n\"}\",`${a} .blocklyText {`,\"fill: #fff;\",\"}\",`${a} .blocklyNonEditableText>rect,`,`${a} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\"fill-opacity: .6;\",\"stroke: none;\",\"}\",`${a} .blocklyNonEditableText>text,`,`${a} .blocklyEditableText>text {`,\"fill: #000;\",\"}\",`${a} .blocklyFlyoutLabelText {`,\"fill: #000;\",\"}\",`${a} .blocklyText.blocklyBubbleText {`,\"fill: #000;\",\"}\",`${a} .blocklyEditableText:not(.editing):hover>rect {`,\"stroke: #fff;\",\"stroke-width: 2;\",\"}\",`${a} .blocklyHtmlInput {`,\n`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\"}\",`${a} .blocklySelected>.blocklyPath {`,\"stroke: #fc3;\",\"stroke-width: 3px;\",\"}\",`${a} .blocklyHighlightedConnectionPath {`,\"stroke: #fc3;\",\"}\",`${a} .blocklyReplaceable .blocklyPath {`,\"fill-opacity: .5;\",\"}\",`${a} .blocklyReplaceable .blocklyPathLight,`,`${a} .blocklyReplaceable .blocklyPathDark {`,\"display: none;\",\"}\",`${a} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n\"stroke: none;\",\"}\"]}},module$build$src$core$renderers$common$constants={};module$build$src$core$renderers$common$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$common$constants;module$build$src$core$renderers$common$constants.isDynamicShape=isDynamicShape$$module$build$src$core$renderers$common$constants;var Drawer$$module$build$src$core$renderers$common$drawer=class{constructor(a,b){this.inlinePath_=this.outlinePath_=\"\";this.block_=a;this.info_=b;this.topLeft_=a.getRelativeToSurfaceXY();this.constants_=b.getRenderer().getConstants()}draw(){this.drawOutline_();this.drawInternals_();this.block_.pathObject.setPath(this.outlinePath_+\"\\n\"+this.inlinePath_);this.info_.RTL&&this.block_.pathObject.flipRTL();this.recordSizeOnBlock_()}hideHiddenIcons_(){warn$$module$build$src$core$utils$deprecation(\"hideHiddenIcons_\",\n\"v10\",\"v11\")}recordSizeOnBlock_(){this.block_.height=this.info_.height;this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let a=1;a<this.info_.rows.length-1;a++){const b=this.info_.rows[a];b.hasJaggedEdge?this.drawJaggedEdge_(b):b.hasStatement?this.drawStatementInput_(b):b.hasExternalInput?this.drawValueInput_(b):this.drawRightSideRow_(b)}this.drawBottom_();this.drawLeft_()}drawTop_(){const a=this.info_.topRow,b=a.elements;this.positionPreviousConnection_();this.outlinePath_+=\nmoveBy$$module$build$src$core$utils$svg_paths(a.xPos,this.info_.startY);for(let c=0,d;d=b[c];c++)Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Types$$module$build$src$core$renderers$measurables$types.isRightRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(d)&&d instanceof Connection$$module$build$src$core$renderers$measurables$connection?\nthis.outlinePath_+=d.shape.pathLeft:Types$$module$build$src$core$renderers$measurables$types.isHat(d)?this.outlinePath_+=this.constants_.START_HAT.path:Types$$module$build$src$core$renderers$measurables$types.isSpacer(d)&&(this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",d.width));this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a.height)}drawJaggedEdge_(a){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",\na.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(a){const b=a.getLastInput();this.positionExternalValueConnection_(a);const c=isDynamicShape$$module$build$src$core$renderers$common$constants(b.shape)?b.shape.pathDown(b.height):b.shape.pathDown;this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",b.xPos+b.width)+c+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a.height-b.connectionHeight)}drawStatementInput_(a){var b=a.getLastInput();if(b){var c=b.xPos+b.notchOffset+\nb.shape.width;b=b.shape.pathRight+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",-(b.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var d=a.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",c)+b+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",d)+this.constants_.INSIDE_CORNERS.pathBottom+lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",a.xPos+a.width);this.positionStatementInputConnection_(a)}}drawRightSideRow_(a){this.outlinePath_+=\nlineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.yPos+a.height)}drawBottom_(){const a=this.info_.bottomRow,b=a.elements;this.positionNextConnection_();let c=0,d=\"\";for(let e=b.length-1,f;f=b[e];e--)Types$$module$build$src$core$renderers$measurables$types.isNextConnection(f)&&f instanceof Connection$$module$build$src$core$renderers$measurables$connection?d+=f.shape.pathRight:Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(f)?d+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",\na.xPos):Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(f)?d+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Types$$module$build$src$core$renderers$measurables$types.isRightRoundedCorner(f)?(d+=this.constants_.OUTSIDE_CORNERS.bottomRight,c=this.constants_.OUTSIDE_CORNERS.rightHeight):Types$$module$build$src$core$renderers$measurables$types.isSpacer(f)&&(d+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",-1*f.width));this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",\na.baseline-c);this.outlinePath_+=d}drawLeft_(){var a=this.info_.outputConnection;this.positionOutputConnection_();if(a){const b=a.connectionOffsetY+a.height;a=isDynamicShape$$module$build$src$core$renderers$common$constants(a.shape)?a.shape.pathUp(a.height):a.shape.pathUp;this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",b)+a}this.outlinePath_+=\"z\"}drawInternals_(){for(let a=0,b;b=this.info_.rows[a];a++)for(let c=0,d;d=b.elements[c];c++)Types$$module$build$src$core$renderers$measurables$types.isInlineInput(d)?\nthis.drawInlineInput_(d):(Types$$module$build$src$core$renderers$measurables$types.isIcon(d)||Types$$module$build$src$core$renderers$measurables$types.isField(d))&&this.layoutField_(d)}layoutField_(a){const b=a.centerline-a.height/2;let c=a.xPos;var d=\"\";this.info_.RTL&&(c=-(c+a.width),a.flipRtl&&(c+=a.width,d=\"scale(-1 1)\"));Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?(d=a.icon,d.setOffsetInBlock(new Coordinate$$module$build$src$core$utils$coordinate(c,b)),this.info_.isInsertionMarker&&\nd.hideForInsertionMarker()):(a=a.field.getSvgRoot(),a.setAttribute(\"transform\",\"translate(\"+c+\",\"+b+\")\"+d),this.info_.isInsertionMarker&&a.setAttribute(\"display\",\"none\"))}drawInlineInput_(a){const b=a.width,c=a.height,d=a.connectionOffsetY,e=a.connectionHeight+d;this.inlinePath_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+a.connectionWidth,a.centerline-c/2)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",d)+a.shape.pathDown+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",c-e)+\nlineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",b-a.connectionWidth)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",-c)+\"z\";this.positionInlineInputConnection_(a)}positionInlineInputConnection_(a){const b=a.centerline-a.height/2;if(a.connectionModel){let c=a.xPos+a.connectionWidth+a.connectionOffsetX;this.info_.RTL&&(c*=-1);a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY)}}positionStatementInputConnection_(a){const b=a.getLastInput();if(null==b?0:b.connectionModel){let c=a.xPos+\na.statementEdge+b.notchOffset;this.info_.RTL&&(c*=-1);b.connectionModel.setOffsetInBlock(c,a.yPos)}}positionExternalValueConnection_(a){const b=a.getLastInput();if(b&&b.connectionModel){let c=a.xPos+a.width;this.info_.RTL&&(c*=-1);b.connectionModel.setOffsetInBlock(c,a.yPos)}}positionPreviousConnection_(){const a=this.info_.topRow;if(a.connection){const b=a.xPos+a.notchOffset;a.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-b:b,0)}}positionNextConnection_(){const a=this.info_.bottomRow;\nif(a.connection){const b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock(this.info_.RTL?-c:c,a.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const a=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-a:a,this.info_.outputConnection.connectionOffsetY)}}},module$build$src$core$renderers$common$drawer={};module$build$src$core$renderers$common$drawer.Drawer=Drawer$$module$build$src$core$renderers$common$drawer;(function(a){a[a.LEFT=-1]=\"LEFT\";a[a.CENTRE=0]=\"CENTRE\";a[a.RIGHT=1]=\"RIGHT\"})($.Align$$module$build$src$core$inputs$align||($.Align$$module$build$src$core$inputs$align={}));var module$build$src$core$inputs$align={};module$build$src$core$inputs$align.Align=$.Align$$module$build$src$core$inputs$align;var FieldLabel$$module$build$src$core$field_label=class extends Field$$module$build$src$core$field{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.class=null;this.EDITABLE=!1;this.maxDisplayLength=Infinity;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c?this.configure_(c):this.class=b||null,this.setValue(a))}configure_(a){super.configure_(a);a.class&&(this.class=a.class)}initView(){this.createTextElement_();this.class&&addClass$$module$build$src$core$utils$dom(this.getTextElement(),\nthis.class)}doClassValidation_(a){return null===a||void 0===a?null:`${a}`}setClass(a){this.textElement_&&(this.class&&removeClass$$module$build$src$core$utils$dom(this.textElement_,this.class),a&&addClass$$module$build$src$core$utils$dom(this.textElement_,a));this.class=a}static fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a)}};register$$module$build$src$core$field_registry(\"field_label\",FieldLabel$$module$build$src$core$field_label);\nFieldLabel$$module$build$src$core$field_label.prototype.DEFAULT_VALUE=\"\";var module$build$src$core$field_label={};module$build$src$core$field_label.FieldLabel=FieldLabel$$module$build$src$core$field_label;var Input$$module$build$src$core$inputs$input=class{constructor(a,b){this.name=a;this.sourceBlock=b;this.fieldRow=[];this.align=$.Align$$module$build$src$core$inputs$input.LEFT;this.visible=!0;this.type=$.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM;this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(a,b){this.insertFieldAt(this.fieldRow.length,a,b);return this}insertFieldAt(a,b,c){if(0>a||a>this.fieldRow.length)throw Error(\"index \"+a+\" out of bounds.\");if(!(b||\n\"\"===b&&c))return a;\"string\"===typeof b&&(b=$.fromJson$$module$build$src$core$field_registry({type:\"field_label\",text:b}));b.setSourceBlock(this.sourceBlock);this.sourceBlock.rendered&&(b.init(),b.applyColour());b.name=c;b.setVisible(this.isVisible());b.prefixField&&(a=this.insertFieldAt(a,b.prefixField));this.fieldRow.splice(a,0,b);a++;b.suffixField&&(a=this.insertFieldAt(a,b.suffixField));this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours());return a}removeField(a,\nb){for(let c=0,d;d=this.fieldRow[c];c++)if(d.name===a)return d.dispose(),this.fieldRow.splice(c,1),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),!0;if(b)return!1;throw Error('Field \"'+a+'\" not found.');}isVisible(){return this.visible}setVisible(a){let b=[];if(this.visible===a)return b;this.visible=a;for(let d=0,e;e=this.fieldRow[d];d++)e.setVisible(a);if(this.connection){var c=this.connection;a?b=c.startTrackingAll():c.stopTrackingAll();if(c=c.targetBlock())c.getSvgRoot().style.display=\na?\"block\":\"none\"}return b}markDirty(){for(let a=0,b;b=this.fieldRow[a];a++)b.markDirty()}setCheck(a){if(!this.connection)throw Error(\"This input does not have a connection.\");this.connection.setCheck(a);return this}setAlign(a){this.align=a;this.sourceBlock.rendered&&this.sourceBlock.queueRender();return this}setShadowDom(a){if(!this.connection)throw Error(\"This input does not have a connection.\");this.connection.setShadowDom(a);return this}getShadowDom(){if(!this.connection)throw Error(\"This input does not have a connection.\");\nreturn this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let a=0;a<this.fieldRow.length;a++)this.fieldRow[a].init()}dispose(){for(let a=0,b;b=this.fieldRow[a];a++)b.dispose();this.connection&&this.connection.dispose()}makeConnection(a){return this.sourceBlock.makeConnection_(a)}},module$build$src$core$inputs$input;\n(function(a){a=a.Align||(a.Align={});a[a.LEFT=-1]=\"LEFT\";a[a.CENTRE=0]=\"CENTRE\";a[a.RIGHT=1]=\"RIGHT\"})(Input$$module$build$src$core$inputs$input||(Input$$module$build$src$core$inputs$input={}));$.Align$$module$build$src$core$inputs$input=Input$$module$build$src$core$inputs$input.Align;module$build$src$core$inputs$input={Align:$.Align$$module$build$src$core$inputs$input};module$build$src$core$inputs$input.Input=Input$$module$build$src$core$inputs$input;var DummyInput$$module$build$src$core$inputs$dummy_input=class extends Input$$module$build$src$core$inputs$input{constructor(a,b){super(a,b);this.name=a;this.type=$.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},module$build$src$core$inputs$dummy_input={};module$build$src$core$inputs$dummy_input.DummyInput=DummyInput$$module$build$src$core$inputs$dummy_input;var EndRowInput$$module$build$src$core$inputs$end_row_input=class extends Input$$module$build$src$core$inputs$input{constructor(a,b){super(a,b);this.name=a;this.type=$.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},module$build$src$core$inputs$end_row_input={};module$build$src$core$inputs$end_row_input.EndRowInput=EndRowInput$$module$build$src$core$inputs$end_row_input;var StatementInput$$module$build$src$core$inputs$statement_input=class extends Input$$module$build$src$core$inputs$input{constructor(a,b){if(!a)throw Error(\"Statement inputs must have a non-empty name\");super(a,b);this.name=a;this.type=$.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT;this.connection=this.makeConnection(ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT)}},module$build$src$core$inputs$statement_input={};\nmodule$build$src$core$inputs$statement_input.StatementInput=StatementInput$$module$build$src$core$inputs$statement_input;var module$build$src$core$inputs$value_input;$.ValueInput$$module$build$src$core$inputs$value_input=class extends Input$$module$build$src$core$inputs$input{constructor(a,b){if(!a)throw Error(\"Value inputs must have a non-empty name\");super(a,b);this.name=a;this.type=$.inputTypes$$module$build$src$core$inputs$input_types.VALUE;this.connection=this.makeConnection(ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE)}};module$build$src$core$inputs$value_input={};\nmodule$build$src$core$inputs$value_input.ValueInput=$.ValueInput$$module$build$src$core$inputs$value_input;var RenderInfo$$module$build$src$core$renderers$common$info=class{constructor(a,b){this.statementEdge=this.width=this.widthWithChildren=this.height=0;this.rows=[];this.inputRows=[];this.startY=this.startX=0;this.renderer_=a;this.block_=b;this.constants_=this.renderer_.getConstants();this.outputConnection=b.outputConnection?new OutputConnection$$module$build$src$core$renderers$measurables$output_connection(this.constants_,b.outputConnection):null;this.isInline=b.getInputsInline()&&!b.isCollapsed();\nthis.isCollapsed=b.isCollapsed();this.isInsertionMarker=b.isInsertionMarker();this.RTL=b.RTL;this.topRow=new TopRow$$module$build$src$core$renderers$measurables$top_row(this.constants_);this.bottomRow=new BottomRow$$module$build$src$core$renderers$measurables$bottom_row(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_();this.addElemSpacing_();this.addRowSpacing_();this.computeBounds_();this.alignRowElements_();this.finalize_()}createRows_(){this.populateTopRow_();this.rows.push(this.topRow);\nlet a=new InputRow$$module$build$src$core$renderers$measurables$input_row(this.constants_);this.inputRows.push(a);var b=this.block_.getIcons();for(let c=0,d;d=b[c];c++){const e=new Icon$$module$build$src$core$renderers$measurables$icon(this.constants_,d);this.isCollapsed&&!d.isShownWhenCollapsed()||a.elements.push(e)}b=void 0;for(let c=0,d;d=this.block_.inputList[c];c++)if(d.isVisible()){this.shouldStartNewRow_(d,b)&&(this.rows.push(a),a=new InputRow$$module$build$src$core$renderers$measurables$input_row(this.constants_),\nthis.inputRows.push(a));for(let e=0,f;f=d.fieldRow[e];e++)a.elements.push(new Field$$module$build$src$core$renderers$measurables$field(this.constants_,f,d));this.addInput_(d,a);b=d}this.isCollapsed&&(a.hasJaggedEdge=!0,a.elements.push(new JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge(this.constants_)));(a.elements.length||a.hasDummyInput)&&this.rows.push(a);this.populateBottomRow_();this.rows.push(this.bottomRow)}populateTopRow_(){var a=!!this.block_.previousConnection;const b=\n(this.block_.hat?\"cap\"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!a;let c=this.topRow.hasLeftSquareCorner(this.block_)?SquareCorner$$module$build$src$core$renderers$measurables$square_corner:RoundCorner$$module$build$src$core$renderers$measurables$round_corner;this.topRow.elements.push(new c(this.constants_));b?(a=new Hat$$module$build$src$core$renderers$measurables$hat(this.constants_),this.topRow.elements.push(a),this.topRow.capline=a.ascenderHeight):a&&(this.topRow.hasPreviousConnection=\n!0,this.topRow.connection=new PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection));this.block_.inputList.length&&this.block_.inputList[0]instanceof StatementInput$$module$build$src$core$inputs$statement_input&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT;c=\nthis.topRow.hasRightSquareCorner(this.block_)?SquareCorner$$module$build$src$core$renderers$measurables$square_corner:RoundCorner$$module$build$src$core$renderers$measurables$round_corner;this.topRow.elements.push(new c(this.constants_,\"right\"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection;this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof StatementInput$$module$build$src$core$inputs$statement_input?\nthis.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT;this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new SquareCorner$$module$build$src$core$renderers$measurables$square_corner(this.constants_)):this.bottomRow.elements.push(new RoundCorner$$module$build$src$core$renderers$measurables$round_corner(this.constants_));this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new NextConnection$$module$build$src$core$renderers$measurables$next_connection(this.constants_,\nthis.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection));this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new SquareCorner$$module$build$src$core$renderers$measurables$square_corner(this.constants_,\"right\")):this.bottomRow.elements.push(new RoundCorner$$module$build$src$core$renderers$measurables$round_corner(this.constants_,\"right\"))}addInput_(a,b){if(this.isInline&&a instanceof $.ValueInput$$module$build$src$core$inputs$value_input)b.elements.push(new InlineInput$$module$build$src$core$renderers$measurables$inline_input(this.constants_,\na)),b.hasInlineInput=!0;else if(a instanceof StatementInput$$module$build$src$core$inputs$statement_input)b.elements.push(new StatementInput$$module$build$src$core$renderers$measurables$statement_input(this.constants_,a)),b.hasStatement=!0;else if(a instanceof $.ValueInput$$module$build$src$core$inputs$value_input)b.elements.push(new ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input(this.constants_,a)),b.hasExternalInput=!0;else if(a instanceof DummyInput$$module$build$src$core$inputs$dummy_input||\na instanceof EndRowInput$$module$build$src$core$inputs$end_row_input)b.minHeight=Math.max(b.minHeight,a.getSourceBlock()&&a.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0;null===b.align&&(b.align=a.align)}shouldStartNewRow_(a,b){return b?b instanceof EndRowInput$$module$build$src$core$inputs$end_row_input||a instanceof StatementInput$$module$build$src$core$inputs$statement_input||b instanceof StatementInput$$module$build$src$core$inputs$statement_input?\n!0:a instanceof $.ValueInput$$module$build$src$core$inputs$value_input||a instanceof DummyInput$$module$build$src$core$inputs$dummy_input||b instanceof $.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let a=0,b;b=this.rows[a];a++){const c=b.elements;b.elements=[];b.startsWithElemSpacer()&&b.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,this.getInRowSpacing_(null,c[0])));if(c.length){for(let d=\n0;d<c.length-1;d++){b.elements.push(c[d]);const e=this.getInRowSpacing_(c[d],c[d+1]);b.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,e))}b.elements.push(c[c.length-1]);b.endsWithElemSpacer()&&b.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,this.getInRowSpacing_(c[c.length-1],null)))}}}getInRowSpacing_(a,b){if(!a&&b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\nif(a&&Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b){if(Types$$module$build$src$core$renderers$measurables$types.isExternalInput(a))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(a))return this.constants_.NO_PADDING}return a&&Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&\nb&&(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))?b.notchOffset:a&&Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b&&(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let a=\n0,b=0,c=0;for(let e=0,f;f=this.rows[e];e++){f.measure();b=Math.max(b,f.width);if(f.hasStatement){var d=f.getLastInput();let g,h;d=f.width-(null!=(h=null==(g=d)?void 0:g.width)?h:0);a=Math.max(a,d)}c=Math.max(c,f.widthWithConnectedBlocks)}this.statementEdge=a;this.width=b;for(let e=0,f;f=this.rows[e];e++)f.hasStatement&&(f.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(b,c);this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=\nthis.outputConnection.width)}alignRowElements_(){for(let b=0,c;c=this.rows[b];b++)if(c.hasStatement)this.alignStatementRow_(c);else{var a=c.width;a=this.getDesiredRowWidth_(c)-a;0<a&&this.addAlignmentPadding_(c,a);Types$$module$build$src$core$renderers$measurables$types.isTopOrBottomRow(c)&&(c.widthWithConnectedBlocks=c.width)}}getDesiredRowWidth_(a){return this.width-this.startX}addAlignmentPadding_(a,b){const c=a.getFirstSpacer(),d=a.getLastSpacer();if(a.hasExternalInput||a.hasStatement)a.widthWithConnectedBlocks+=\nb;if(a.align===$.Align$$module$build$src$core$inputs$align.LEFT&&d)d.width+=b;else if(a.align===$.Align$$module$build$src$core$inputs$align.CENTRE&&c&&d)c.width+=b/2,d.width+=b/2;else if(a.align===$.Align$$module$build$src$core$inputs$align.RIGHT&&c)c.width+=b;else if(d)d.width+=b;else return;a.width+=b}alignStatementRow_(a){const b=a.getLastInput();if(b){var c=a.width-b.width,d=this.statementEdge;c=d-c;0<c&&this.addAlignmentPadding_(a,c);c=a.width;d=this.getDesiredRowWidth_(a);b.width+=d-c;b.height=\nMath.max(b.height,a.height);a.width+=d-c;a.widthWithConnectedBlocks=Math.max(a.width,this.statementEdge+a.connectedBlockWidths)}}addRowSpacing_(){const a=this.rows;this.rows=[];for(let b=0;b<a.length;b++)this.rows.push(a[b]),b!==a.length-1&&this.rows.push(this.makeSpacerRow_(a[b],a[b+1]))}makeSpacerRow_(a,b){var c=this.getSpacerRowHeight_(a,b);const d=this.getSpacerRowWidth_(a,b);c=new SpacerRow$$module$build$src$core$renderers$measurables$spacer_row(this.constants_,c,d);a.hasStatement&&(c.followsStatement=\n!0);b.hasStatement&&(c.precedesStatement=!0);return c}getSpacerRowWidth_(a,b){return this.width-this.startX}getSpacerRowHeight_(a,b){return this.constants_.MEDIUM_PADDING}getElemCenterline_(a,b){return Types$$module$build$src$core$renderers$measurables$types.isSpacer(b)?a.yPos+b.height/2:Types$$module$build$src$core$renderers$measurables$types.isBottomRow(a)?(a=a.yPos+a.height-a.descenderHeight,Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b)?a+b.height/2:a-b.height/2):\nTypes$$module$build$src$core$renderers$measurables$types.isTopRow(a)?Types$$module$build$src$core$renderers$measurables$types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2:a.yPos+a.height/2}recordElemPositions_(a){let b=a.xPos;for(let c=0,d;d=a.elements[c];c++)Types$$module$build$src$core$renderers$measurables$types.isSpacer(d)&&(d.height=a.height),d.xPos=b,d.centerline=this.getElemCenterline_(a,d),b+=d.width}finalize_(){let a=0,b=0;for(let c=0,d;d=this.rows[c];c++)d.yPos=b,d.xPos=this.startX,\nb+=d.height,a=Math.max(a,d.widthWithConnectedBlocks),this.recordElemPositions_(d);if(this.outputConnection&&this.block_.nextConnection){const c=this.block_.nextConnection.targetBlock();c&&(a=Math.max(a,c.getHeightWidth().width))}this.widthWithChildren=a+this.startX;this.height=b;this.startY=this.topRow.capline;this.bottomRow.baseline=b-this.bottomRow.descenderHeight}},module$build$src$core$renderers$common$info={};module$build$src$core$renderers$common$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$common$info;var ASTNode$$module$build$src$core$keyboard_nav$ast_node=class{constructor(a,b,c){this.wsCoordinate=null;if(!b)throw Error(\"Cannot create a node without a location.\");this.type=a;this.isConnectionLocation=ASTNode$$module$build$src$core$keyboard_nav$ast_node.isConnectionType(a);this.location=b;this.processParams(c||null)}processParams(a){a&&a.wsCoordinate&&(this.wsCoordinate=a.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var a=\nthis.location.getParentInput();const b=a.getSourceBlock();a=b.inputList.indexOf(a);for(a+=1;a<b.inputList.length;a++){const c=b.inputList[a],d=c.fieldRow;for(let e=0;e<d.length;e++){const f=d[e];if(f.isClickable()||ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(f)}if(c.connection)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(c)}return null}findNextForField(){var a=this.location,\nb=a.getParentInput();const c=a.getSourceBlock();if(!c)throw Error(\"The current AST location is not associated with a block\");var d=c.inputList.indexOf(b);for(a=b.fieldRow.indexOf(a)+1;d<c.inputList.length;d++){b=c.inputList[d];const e=b.fieldRow;for(;a<e.length;){if(e[a].isClickable()||ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(e[a]);a++}a=0;if(b.connection)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(b)}return null}findPrevForInput(){const a=\nthis.location.getParentInput(),b=a.getSourceBlock();for(var c=b.inputList.indexOf(a);0<=c;c--){var d=b.inputList[c];if(d.connection&&d!==a)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(d);d=d.fieldRow;for(let e=d.length-1;0<=e;e--){const f=d[e];if(f.isClickable()||ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(f)}}return null}findPrevForField(){var a=this.location;const b=\na.getParentInput(),c=a.getSourceBlock();if(!c)throw Error(\"The current AST location is not associated with a block\");var d=c.inputList.indexOf(b);for(a=b.fieldRow.indexOf(a)-1;0<=d;d--){var e=c.inputList[d];if(e.connection&&e!==b)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(e);for(e=e.fieldRow;-1<a;){if(e[a].isClickable()||ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(e[a]);\na--}0<=d-1&&(a=c.inputList[d-1].fieldRow.length-1)}return null}navigateBetweenStacks(a){var b=this.getLocation();if(b.getSourceBlock){var c=b.getSourceBlock();c&&(b=c)}if(!b||b.isDeadOrDying())return null;c=b.getRootBlock();b=c.workspace.getTopBlocks(!0);for(let d=0;d<b.length;d++)if(c.id===b[d].id)return a=d+(a?1:-1),-1===a||a===b.length?null:ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(b[a]);throw Error(\"Couldn't find \"+(a?\"next\":\"previous\")+\" stack?!\");}findTopASTNodeForBlock(a){const b=\ngetParentConnection$$module$build$src$core$keyboard_nav$ast_node(a);return b?ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(b):ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(a)}getOutAstNodeForBlock(a){if(!a)return null;a=a.getTopStackBlock();const b=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(a);return b&&b.targetConnection&&b.targetConnection.getParentInput()?ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(b.targetConnection.getParentInput()):\nASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(a)}findFirstFieldOrInput(a){a=a.inputList;for(let b=0;b<a.length;b++){const c=a[b],d=c.fieldRow;for(let e=0;e<d.length;e++){const f=d[e];if(f.isClickable()||ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(f)}if(c.connection)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(c)}return null}getSourceBlock(){return this.getType()===\nASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK?this.getLocation():this.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK?this.getLocation():this.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:return this.navigateBetweenStacks(!0);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT:return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location.getSourceBlock());\ncase ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:return this.findNextForField();case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return this.findNextForInput();case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:const a=this.location.nextConnection;if(!a)break;return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(a);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location.getSourceBlock());\ncase ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(this.location.targetConnection)}return null}in(){switch(this.type){case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE:const a=this.location.getTopBlocks(!0);if(0<a.length)return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(a[0]);break;case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:return this.findTopASTNodeForBlock(this.location);\ncase ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:return this.findFirstFieldOrInput(this.location);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:return this.navigateBetweenStacks(!1);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:return this.findPrevForField();\ncase ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return this.findPrevForInput();case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:var a=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(this.location);if(!a)break;return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(a);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:if((a=this.location.targetConnection)&&!a.getParentInput())return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(a);\nbreak;case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location.getSourceBlock())}return null}out(){switch(this.type){case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:var a=this.location,b=a.getRelativeToSurfaceXY();b=new Coordinate$$module$build$src$core$utils$coordinate(b.x,b.y+ASTNode$$module$build$src$core$keyboard_nav$ast_node.DEFAULT_OFFSET_Y);return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createWorkspaceNode(a.workspace,\nb);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT:return a=this.location,(b=a.targetConnection)?ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(b):ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(a.getSourceBlock());case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:a=this.location.getSourceBlock();if(!a)throw Error(\"The current AST location is not associated with a block\");return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(a);\ncase ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location.getSourceBlock());case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:return this.getOutAstNodeForBlock(this.location.getSourceBlock());case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(a){switch(a){case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:case ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT:return!0}return!1}static createFieldNode(a){return a?\nnew ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD,a):null}static createConnectionNode(a){if(!a)return null;const b=a.type;return b===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||b===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT&&a.getParentInput()?ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(a.getParentInput()):b===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT?\nnew ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT,a):b===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?new ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT,a):b===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT?new ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS,\na):null}static createInputNode(a){return a&&a.connection?new ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT,a.connection):null}static createBlockNode(a){return a?new ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK,a):null}static createStackNode(a){return a?new ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK,\na):null}static createWorkspaceNode(a,b){return b&&a?new ASTNode$$module$build$src$core$keyboard_nav$ast_node(ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE,a,{wsCoordinate:b}):null}static createTopNode(a){const b=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(a);return b?ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(b):ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(a)}};\nASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS=!1;ASTNode$$module$build$src$core$keyboard_nav$ast_node.DEFAULT_OFFSET_Y=-20;(function(a){a=a.types||(a.types={});a.FIELD=\"field\";a.BLOCK=\"block\";a.INPUT=\"input\";a.OUTPUT=\"output\";a.NEXT=\"next\";a.PREVIOUS=\"previous\";a.STACK=\"stack\";a.WORKSPACE=\"workspace\"})(ASTNode$$module$build$src$core$keyboard_nav$ast_node||(ASTNode$$module$build$src$core$keyboard_nav$ast_node={}));var module$build$src$core$keyboard_nav$ast_node={};\nmodule$build$src$core$keyboard_nav$ast_node.ASTNode=ASTNode$$module$build$src$core$keyboard_nav$ast_node;var MarkerMove$$module$build$src$core$events$events_marker_move=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c,d){let e=a?a.workspace.id:void 0;d&&d.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE&&(e=d.getLocation().id);super(e);this.type=MARKER_MOVE$$module$build$src$core$events$utils;this.blockId=null==a?void 0:a.id;this.oldNode=c||void 0;this.newNode=d;this.isCursor=b}toJson(){const a=super.toJson();if(void 0===this.isCursor)throw Error(\"Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson\");\nif(!this.newNode)throw Error(\"The new node is undefined. Either pass a node to the constructor, or call fromJson\");a.isCursor=this.isCursor;a.blockId=this.blockId;a.oldNode=this.oldNode;a.newNode=this.newNode;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new MarkerMove$$module$build$src$core$events$events_marker_move);b.isCursor=a.isCursor;b.blockId=a.blockId;b.oldNode=a.oldNode;b.newNode=a.newNode;return b}};\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,MARKER_MOVE$$module$build$src$core$events$utils,MarkerMove$$module$build$src$core$events$events_marker_move);var module$build$src$core$events$events_marker_move={};module$build$src$core$events$events_marker_move.MarkerMove=MarkerMove$$module$build$src$core$events$events_marker_move;var CURSOR_CLASS$$module$build$src$core$renderers$common$marker_svg=\"blocklyCursor\",MARKER_CLASS$$module$build$src$core$renderers$common$marker_svg=\"blocklyMarker\",HEIGHT_MULTIPLIER$$module$build$src$core$renderers$common$marker_svg=.75,MarkerSvg$$module$build$src$core$renderers$common$marker_svg=class{constructor(a,b,c){this.workspace=a;this.marker=c;this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null;this.constants_=\nb;a=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=c.colour||a}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return\"cursor\"===this.marker.type}createDom(){const a=this.isCursor()?CURSOR_CLASS$$module$build$src$core$renderers$common$marker_svg:MARKER_CLASS$$module$build$src$core$renderers$common$marker_svg;this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":a});this.createDomInternal_();\nreturn this.svgGroup_}setParent_(a){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),a.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),a.setMarkerSvg(this.getSvgRoot()));this.parent=a}draw(a,b){if(b){this.constants_=this.workspace.getRenderer().getConstants();var c=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||c;this.applyColour_(b);this.showAtLocation_(b);this.fireMarkerEvent(a,b);a=this.currentMarkerSvg.childNodes[0];\nvoid 0!==a&&a.beginElement&&a.beginElement()}else this.hide()}showAtLocation_(a){const b=a.getLocation().type;a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK?this.showWithBlock_(a):a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT?this.showWithOutput_(a):b===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE?this.showWithInput_(a):b===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT?this.showWithNext_(a):\na.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS?this.showWithPrevious_(a):a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD?this.showWithField_(a):a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE?this.showWithCoordinates_(a):a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK&&this.showWithStack_(a)}showWithBlockPrevOutput(a){a=a.getSourceBlock();const b=a.width;var c=a.height,\nd=c*HEIGHT_MULTIPLIER$$module$build$src$core$renderers$common$marker_svg;const e=this.constants_.CURSOR_BLOCK_PADDING;a.previousConnection?(c=this.constants_.shapeFor(a.previousConnection),this.positionPrevious_(b,e,d,c)):a.outputConnection?(d=this.constants_.shapeFor(a.outputConnection),this.positionOutput_(b,c,d)):this.positionBlock_(b,e,d);this.setParent_(a);this.showCurrent_()}showWithBlock_(a){this.showWithBlockPrevOutput(a)}showWithPrevious_(a){this.showWithBlockPrevOutput(a)}showWithOutput_(a){this.showWithBlockPrevOutput(a)}showWithCoordinates_(a){var b=\na.getWsCoordinate();a=b.x;b=b.y;this.workspace.RTL&&(a-=this.constants_.CURSOR_WS_WIDTH);this.positionLine_(a,b,this.constants_.CURSOR_WS_WIDTH);this.setParent_(this.workspace);this.showCurrent_()}showWithField_(a){a=a.getLocation();const b=a.getSize().width,c=a.getSize().height;this.positionRect_(0,0,b,c);this.setParent_(a);this.showCurrent_()}showWithInput_(a){a=a.getLocation();const b=a.getSourceBlock();this.positionInput_(a);this.setParent_(b);this.showCurrent_()}showWithNext_(a){var b=a.getLocation();\na=b.getSourceBlock();let c=0;b=b.getOffsetInBlock().y;const d=a.getHeightWidth().width;this.workspace.RTL&&(c=-d);this.positionLine_(c,b,d);this.setParent_(a);this.showCurrent_()}showWithStack_(a){a=a.getLocation();var b=a.getHeightWidth();const c=b.width+this.constants_.CURSOR_STACK_PADDING;b=b.height+this.constants_.CURSOR_STACK_PADDING;const d=-this.constants_.CURSOR_STACK_PADDING/2,e=-this.constants_.CURSOR_STACK_PADDING/2;let f=d;this.workspace.RTL&&(f=-(c+d));this.positionRect_(f,e,c,b);this.setParent_(a);\nthis.showCurrent_()}showCurrent_(){this.hide();this.currentMarkerSvg&&(this.currentMarkerSvg.style.display=\"\")}positionBlock_(a,b,c){a=moveBy$$module$build$src$core$utils$svg_paths(-b,c)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",-b)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",a+2*b)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",c);if(!this.markerBlock_)throw Error(\"createDom should be called before positioning the marker\");this.markerBlock_.setAttribute(\"d\",a);this.workspace.RTL&&\nthis.flipRtl(this.markerBlock_);this.currentMarkerSvg=this.markerBlock_}positionInput_(a){const b=a.getOffsetInBlock().x,c=a.getOffsetInBlock().y;a=moveTo$$module$build$src$core$utils$svg_paths(0,0)+this.constants_.shapeFor(a).pathDown;this.markerInput_.setAttribute(\"d\",a);this.markerInput_.setAttribute(\"transform\",\"translate(\"+b+\",\"+c+\")\"+(this.workspace.RTL?\" scale(-1 1)\":\"\"));this.currentMarkerSvg=this.markerInput_}positionLine_(a,b,c){if(!this.markerSvgLine_)throw Error(\"createDom should be called before positioning the line\");\nthis.markerSvgLine_.setAttribute(\"x\",`${a}`);this.markerSvgLine_.setAttribute(\"y\",`${b}`);this.markerSvgLine_.setAttribute(\"width\",`${c}`);this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(a,b,c){if(!this.markerBlock_)throw Error(\"createDom should be called before positioning the output\");a=moveBy$$module$build$src$core$utils$svg_paths(a,0)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",-(a-c.width))+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",this.constants_.TAB_OFFSET_FROM_TOP)+\nc.pathDown+lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",b)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",a);this.markerBlock_.setAttribute(\"d\",a);this.workspace.RTL&&this.flipRtl(this.markerBlock_);this.currentMarkerSvg=this.markerBlock_}positionPrevious_(a,b,c,d){if(!this.markerBlock_)throw Error(\"createDom should be called before positioning the previous connection marker\");a=moveBy$$module$build$src$core$utils$svg_paths(-b,c)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",\n-b)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",this.constants_.NOTCH_OFFSET_LEFT)+d.pathLeft+lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",a+2*b)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",c);this.markerBlock_.setAttribute(\"d\",a);this.workspace.RTL&&this.flipRtl(this.markerBlock_);this.currentMarkerSvg=this.markerBlock_}positionRect_(a,b,c,d){if(!this.markerSvgRect_)throw Error(\"createDom should be called before positioning the rect\");this.markerSvgRect_.setAttribute(\"x\",\n`${a}`);this.markerSvgRect_.setAttribute(\"y\",`${b}`);this.markerSvgRect_.setAttribute(\"width\",`${c}`);this.markerSvgRect_.setAttribute(\"height\",`${d}`);this.currentMarkerSvg=this.markerSvgRect_}flipRtl(a){a.setAttribute(\"transform\",\"scale(-1 1)\")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error(\"createDom should be called before hiding the marker\");this.markerSvgLine_.style.display=\"none\";this.markerSvgRect_.style.display=\"none\";this.markerInput_.style.display=\n\"none\";this.markerBlock_.style.display=\"none\"}fireMarkerEvent(a,b){const c=b.getSourceBlock();a=new (get$$module$build$src$core$events$utils(MARKER_MOVE$$module$build$src$core$events$utils))(c,this.isCursor(),a,b);fire$$module$build$src$core$events$utils(a)}getBlinkProperties_(){return{attributeType:\"XML\",attributeName:\"fill\",dur:\"1s\",values:this.colour_+\";transparent;transparent;\",repeatCount:\"indefinite\"}}createDomInternal_(){this.markerSvg_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,\n{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_);this.markerSvgLine_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_);this.markerSvgRect_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyVerticalMarker\",rx:10,ry:10},this.markerSvg_);this.markerInput_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,\n{transform:\"\"},this.markerSvg_);this.markerBlock_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{transform:\"\",fill:\"none\",\"stroke-width\":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_);this.hide();if(this.isCursor()){const a=this.getBlinkProperties_();createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,a,this.markerSvgLine_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,\na,this.markerInput_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,Object.assign({},a,{attributeName:\"stroke\"}),this.markerBlock_)}return this.markerSvg_}applyColour_(a){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error(\"createDom should be called before applying color to the markerj\");this.markerSvgLine_.setAttribute(\"fill\",this.colour_);this.markerSvgRect_.setAttribute(\"stroke\",this.colour_);this.markerInput_.setAttribute(\"fill\",\nthis.colour_);this.markerBlock_.setAttribute(\"stroke\",this.colour_);this.isCursor()&&(a=this.colour_+\";transparent;transparent;\",this.markerSvgLine_.firstElementChild.setAttribute(\"values\",a),this.markerInput_.firstElementChild.setAttribute(\"values\",a),this.markerBlock_.firstElementChild.setAttribute(\"values\",a))}dispose(){this.svgGroup_&&removeNode$$module$build$src$core$utils$dom(this.svgGroup_)}},module$build$src$core$renderers$common$marker_svg={};\nmodule$build$src$core$renderers$common$marker_svg.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$common$marker_svg;var PathObject$$module$build$src$core$renderers$common$path_object=class{constructor(a,b,c){this.markerSvg=this.cursorSvg=null;this.constants=c;this.style=b;this.svgRoot=a;this.svgPath=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyPath\"},this.svgRoot)}setPath(a){this.svgPath.setAttribute(\"d\",a)}flipRTL(){this.svgPath.setAttribute(\"transform\",\"scale(-1 1)\")}setCursorSvg(a){a?(this.svgRoot.appendChild(a),this.cursorSvg=a):this.cursorSvg=\nnull}setMarkerSvg(a){a?(this.cursorSvg?this.svgRoot.insertBefore(a,this.cursorSvg):this.svgRoot.appendChild(a),this.markerSvg=a):this.markerSvg=null}applyColour(a){this.svgPath.setAttribute(\"stroke\",this.style.colourTertiary);this.svgPath.setAttribute(\"fill\",this.style.colourPrimary);this.updateShadow_(a.isShadow());this.updateDisabled_(!a.isEnabled()||a.getInheritedDisabled())}setStyle(a){this.style=a}setClass_(a,b){a&&(b?addClass$$module$build$src$core$utils$dom(this.svgRoot,a):removeClass$$module$build$src$core$utils$dom(this.svgRoot,\na))}updateHighlighted(a){a?this.svgPath.setAttribute(\"filter\",\"url(#\"+this.constants.embossFilterId+\")\"):this.svgPath.setAttribute(\"filter\",\"none\")}updateShadow_(a){a&&(this.svgPath.setAttribute(\"stroke\",\"none\"),this.svgPath.setAttribute(\"fill\",this.style.colourSecondary))}updateDisabled_(a){this.setClass_(\"blocklyDisabled\",a);a&&this.svgPath.setAttribute(\"fill\",\"url(#\"+this.constants.disabledPatternId+\")\")}updateSelected(a){this.setClass_(\"blocklySelected\",a)}updateDraggingDelete(a){this.setClass_(\"blocklyDraggingDelete\",\na)}updateInsertionMarker(a){this.setClass_(\"blocklyInsertionMarker\",a)}updateMovable(a){this.setClass_(\"blocklyDraggable\",a)}updateReplacementFade(a){this.setClass_(\"blocklyReplaceable\",a)}updateShapeForInputHighlight(a,b){}},module$build$src$core$renderers$common$path_object={};module$build$src$core$renderers$common$path_object.PathObject=PathObject$$module$build$src$core$renderers$common$path_object;var Connection$$module$build$src$core$connection=class{constructor(a,b){this.type=b;this.targetConnection=null;this.disposed=!1;this.shadowDom=this.check=null;this.y=this.x=0;this.shadowState=null;this.sourceBlock_=a}connect_(a){const b=ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE,c=this.getSourceBlock();var d=a.getSourceBlock();a.isConnected()&&a.disconnectInternal(!1);let e;if(this.isConnected()){const g=this.stashShadowState(),h=this.targetBlock();h.isShadow()?h.dispose(!1):\n(this.disconnectInternal(),e=h);this.applyShadowState(g)}let f;isEnabled$$module$build$src$core$events$utils()&&(f=new (get$$module$build$src$core$events$utils($.MOVE$$module$build$src$core$events$utils))(d),f.setReason([\"connect\"]));connectReciprocally$$module$build$src$core$connection(this,a);d.setParent(c);f&&(f.recordNew(),fire$$module$build$src$core$events$utils(f));if(e&&(a=this.type===b?e.outputConnection:e.previousConnection))if(d=Connection$$module$build$src$core$connection.getConnectionForOrphanedConnection(d,\na))a.connect(d);else a.onFailedConnect(this)}dispose(){if(this.isConnected()){this.setShadowStateInternal();const a=this.targetBlock();a&&!a.isDeadOrDying()&&a.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||this.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(a){}connect(a){if(this.targetConnection===\na)return!0;if(this.getConnectionChecker().canConnect(this,a,!1)){const b=$.getGroup$$module$build$src$core$events$utils();b||$.setGroup$$module$build$src$core$events$utils(!0);this.isSuperior()?this.connect_(a):a.connect_(this);$.setGroup$$module$build$src$core$events$utils(b)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(a=!0){const {parentConnection:b,childConnection:c}=this.getParentAndChildConnections();if(!b||!c)throw Error(\"Source connection not connected.\");\nconst d=$.getGroup$$module$build$src$core$events$utils();d||$.setGroup$$module$build$src$core$events$utils(!0);let e;isEnabled$$module$build$src$core$events$utils()&&(e=new (get$$module$build$src$core$events$utils($.MOVE$$module$build$src$core$events$utils))(c.getSourceBlock()),e.setReason([\"disconnect\"]));const f=this.targetConnection;f&&(f.targetConnection=null);this.targetConnection=null;a&&c.getSourceBlock().setParent(null);e&&(e.recordNew(),fire$$module$build$src$core$events$utils(e));c.getSourceBlock().isShadow()||\nb.respawnShadow_();$.setGroup$$module$build$src$core$events$utils(d)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(a,b){if(this.getSourceBlock().isDeadOrDying())return!1;var c;b=null==(c=a.getInput(b))?void 0:c.connection;c=this.targetBlock();return c&&c!==a||!b||b.targetConnection===this?\n!1:(b.isConnected()&&b.disconnect(),b.connect(this),!0)}targetBlock(){if(this.isConnected()){let a,b;return null!=(b=null==(a=this.targetConnection)?void 0:a.getSourceBlock())?b:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(a){a?(Array.isArray(a)||(a=[a]),this.check=a,this.onCheckChanged_()):this.check=null;return this}getCheck(){return this.check}setShadowDom(a){this.setShadowStateInternal({shadowDom:a})}getShadowDom(a){return a&&\nthis.targetBlock().isShadow()?blockToDom$$module$build$src$core$xml(this.targetBlock()):this.shadowDom}setShadowState(a){this.setShadowStateInternal({shadowState:a})}getShadowState(a){return a&&this.targetBlock()&&this.targetBlock().isShadow()?save$$module$build$src$core$serialization$blocks(this.targetBlock()):this.shadowState}neighbours(a){return[]}getParentInput(){let a=null;const b=this.sourceBlock_.inputList;for(let c=0;c<b.length;c++)if(b[c].connection===this){a=b[c];break}return a}toString(){const a=\nthis.sourceBlock_;if(!a)return\"Orphan Connection\";if(a.outputConnection===this)var b=\"Output Connection of \";else if(a.previousConnection===this)b=\"Previous Connection of \";else if(a.nextConnection===this)b=\"Next Connection of \";else{b=null;for(let c=0,d;d=a.inputList[c];c++)if(d.connection===this){b=d;break}if(b)b='Input \"'+b.name+'\" connection on ';else return console.warn(\"Connection not actually connected to sourceBlock_\"),\"Orphan Connection\"}return b+a.toDevString()}stashShadowState(){const a=\nthis.getShadowDom(!0),b=this.getShadowState(!0);this.shadowState=this.shadowDom=null;return{shadowDom:a,shadowState:b}}applyShadowState({shadowDom:a,shadowState:b}){this.shadowDom=a;this.shadowState=b}setShadowStateInternal({shadowDom:a=null,shadowState:b=null}={}){this.shadowDom=a;this.shadowState=b;(a=this.targetBlock())?a.isShadow()?(a.dispose(!1),this.getSourceBlock().isDeadOrDying()||(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))):\n(a=this.createShadowBlock(!1),this.serializeShadow(a),a&&a.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))}createShadowBlock(a){var b=this.getSourceBlock();const c=this.getShadowState(),d=this.getShadowDom();if(b.isDeadOrDying()||!c&&!d)return null;if(c)return b=appendInternal$$module$build$src$core$serialization$blocks(c,b.workspace,{parentConnection:a?this:void 0,isShadow:!0,recordUndo:!1});if(d){b=domToBlockInternal$$module$build$src$core$xml(d,\nb.workspace);if(a)if(this.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE){if(!b.outputConnection)throw Error(\"Shadow block is missing an output connection\");if(!this.connect(b.outputConnection))throw Error(\"Could not connect shadow block to connection\");}else if(this.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT){if(!b.previousConnection)throw Error(\"Shadow block is missing previous connection\");if(!this.connect(b.previousConnection))throw Error(\"Could not connect shadow block to connection\");\n}else throw Error(\"Cannot connect a shadow block to a previous/output connection\");return b}return null}serializeShadow(a){a&&(this.shadowDom=blockToDom$$module$build$src$core$xml(a),this.shadowState=save$$module$build$src$core$serialization$blocks(a))}static getConnectionForOrphanedConnection(a,b){if(b.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE)return getConnectionForOrphanedOutput$$module$build$src$core$connection(a,b.getSourceBlock());a=a.lastConnectionInStack(!0);\nconst c=b.getConnectionChecker();return a&&c.canConnect(b,a,!1)?a:null}};Connection$$module$build$src$core$connection.CAN_CONNECT=0;Connection$$module$build$src$core$connection.REASON_SELF_CONNECTION=1;Connection$$module$build$src$core$connection.REASON_WRONG_TYPE=2;Connection$$module$build$src$core$connection.REASON_TARGET_NULL=3;Connection$$module$build$src$core$connection.REASON_CHECKS_FAILED=4;Connection$$module$build$src$core$connection.REASON_DIFFERENT_WORKSPACES=5;\nConnection$$module$build$src$core$connection.REASON_SHADOW_PARENT=6;Connection$$module$build$src$core$connection.REASON_DRAG_CHECKS_FAILED=7;Connection$$module$build$src$core$connection.REASON_PREVIOUS_AND_OUTPUT=8;var module$build$src$core$connection={};module$build$src$core$connection.Connection=Connection$$module$build$src$core$connection;var COLLAPSED_INPUT_NAME$$module$build$src$core$constants=\"_TEMP_COLLAPSED_INPUT\",COLLAPSED_FIELD_NAME$$module$build$src$core$constants=\"_TEMP_COLLAPSED_FIELD\",module$build$src$core$constants={COLLAPSED_FIELD_NAME:COLLAPSED_FIELD_NAME$$module$build$src$core$constants,COLLAPSED_INPUT_NAME:COLLAPSED_INPUT_NAME$$module$build$src$core$constants};var DUPLICATE_BLOCK_ERROR$$module$build$src$core$insertion_marker_manager=\"The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.\",InsertionMarkerManager$$module$build$src$core$insertion_marker_manager=class{constructor(a){this.activeCandidate=this.lastMarker=this.lastOnStack=null;this.wouldDeleteBlock=!1;this.fadedBlock=this.highlightedBlock=this.markerConnection=null;setSelected$$module$build$src$core$common(a);\nthis.topBlock=a;this.workspace=a.workspace;this.firstMarker=this.createMarkerBlock(this.topBlock);this.availableConnections=this.initAvailableConnections();this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0;this.disposeInsertionMarker(this.firstMarker);this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){$.disable$$module$build$src$core$events$utils();\nthis.hidePreview();$.enable$$module$build$src$core$events$utils();var {local:a,closest:b}=this.activeCandidate;a.connect(b);if(this.topBlock.rendered){const c=a.isSuperior()?b:a,d=this.topBlock.getRootBlock();finishQueuedRenders$$module$build$src$core$render_management().then(()=>{connectionUiEffect$$module$build$src$core$block_animations(c.getSourceBlock());setTimeout(()=>{d.bringToFront()},0)})}}}update(a,b){const c=this.getCandidate(a);if((this.wouldDeleteBlock=this.shouldDelete(!!c,b))||this.shouldUpdatePreviews(c,\na))$.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(c),this.maybeShowPreview(c),$.enable$$module$build$src$core$events$utils()}createMarkerBlock(a){var b=a.type;$.disable$$module$build$src$core$events$utils();let c;try{c=this.workspace.newBlock(b);c.setInsertionMarker(!0);if(a.saveExtraState){var d=a.saveExtraState(!0);d&&c.loadExtraState&&c.loadExtraState(d)}else if(a.mutationToDom){const e=a.mutationToDom();e&&c.domToMutation&&c.domToMutation(e)}for(b=0;b<a.inputList.length;b++){const e=\na.inputList[b];if(e.name===COLLAPSED_INPUT_NAME$$module$build$src$core$constants)continue;const f=c.inputList[b];if(!f)throw Error(DUPLICATE_BLOCK_ERROR$$module$build$src$core$insertion_marker_manager.replace(\"%1\",\"an input\"));for(d=0;d<e.fieldRow.length;d++){const g=e.fieldRow[d],h=f.fieldRow[d];if(!h)throw Error(DUPLICATE_BLOCK_ERROR$$module$build$src$core$insertion_marker_manager.replace(\"%1\",\"a field\"));h.setValue(g.getValue())}}for(const e of c.getDescendants(!1))e.setInsertionMarker(!0);c.setCollapsed(a.isCollapsed());\nc.setInputsInline(a.getInputsInline());c.initSvg();c.getSvgRoot().setAttribute(\"visibility\",\"hidden\")}finally{$.enable$$module$build$src$core$events$utils()}return c}initAvailableConnections(){const a=this.topBlock.getConnections_(!1),b=this.topBlock.lastConnectionInStack(!0);b&&b!==this.topBlock.nextConnection&&(a.push(b),this.lastOnStack=b);return a}shouldUpdatePreviews(a,b){if(!a)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const {local:c,closest:d}=this.activeCandidate;if(d===\na.closest&&c===a.local)return!1;const e=c.x+b.x-d.x;b=c.y+b.y-d.y;return a.radius<Math.sqrt(e*e+b*b)-$.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(a){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let b=this.getStartRadius(),c=null;for(let d=0;d<this.availableConnections.length;d++){const e=this.availableConnections[d],f=e.closest(b,a);f.connection&&(c={closest:f.connection,local:e,radius:f.radius},b=f.radius)}return c}getStartRadius(){return this.activeCandidate?\n$.config$$module$build$src$core$config.connectingSnapRadius:$.config$$module$build$src$core$config.snapRadius}shouldDelete(a,b){return b&&this.workspace.getComponentManager().hasCapability(b.id,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA)?b.wouldDelete(this.topBlock,a):!1}maybeShowPreview(a){if(!this.wouldDeleteBlock&&a){var b=a.closest,c;b===(null==(c=this.activeCandidate)?void 0:c.closest)||b.getSourceBlock().isInsertionMarker()?console.log(\"Trying to connect to an insertion marker\"):\n(this.activeCandidate=a,this.showPreview(this.activeCandidate))}}showPreview(a){const b=this.workspace.getRenderer();switch(b.getConnectionPreviewMethod(a.closest,a.local,this.topBlock)){case InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(a);break;case InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(a);break;case InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(a)}b.shouldHighlightConnection(a.closest)&&\na.closest.highlight()}maybeHidePreview(a){if(!a)this.hidePreview();else if(this.activeCandidate){const b=this.activeCandidate.local!==a.local;(this.activeCandidate.closest!==a.closest||b||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let a;const b=null==(a=this.activeCandidate)?void 0:a.closest;b&&b.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(b)&&b.unhighlight();this.hideReplacementFade();this.hideInsertionInputOutline();\nthis.hideInsertionMarker()}showInsertionMarker(a){const {local:b,closest:c}=a;let d=(a=this.lastOnStack&&b===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!d)throw Error(\"Cannot show the insertion marker because there is no insertion marker block\");let e;try{e=d.getMatchingConnection(b.getSourceBlock(),b)}catch(k){a&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),d=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),\nd=this.firstMarker=this.createMarkerBlock(this.topBlock));if(!d)throw Error(\"Cannot show the insertion marker because there is no insertion marker block\");e=d.getMatchingConnection(b.getSourceBlock(),b)}if(!e)throw Error(\"Cannot show the insertion marker because there is no associated connection\");if(e===this.markerConnection)throw Error(\"Made it to showInsertionMarker_ even though the marker isn't changing\");d.queueRender();triggerQueuedRenders$$module$build$src$core$render_management();e.connect(c);\nconst f={x:c.x-e.x,y:c.y-e.y},g=e.getOffsetInBlock().clone(),h=e;finishQueuedRenders$$module$build$src$core$render_management().then(()=>{let k;null==(k=d)||k.positionNearConnection(h,f,g);let l;null==(l=d)||l.getSvgRoot().setAttribute(\"visibility\",\"visible\")});this.markerConnection=e}hideInsertionMarker(){if(this.markerConnection){var a=this.markerConnection,b=a.getSourceBlock(),c=b.outputConnection,d;if((null==(d=b.previousConnection)?0:d.targetConnection)||(null==c?0:c.targetConnection))b.unplug(!0);\nelse{let e;null==(e=a.targetBlock())||e.unplug(!1)}if(a.targetConnection)throw Error(\"markerConnection still connected at the end of disconnectInsertionMarker\");this.markerConnection=null;(a=b.getSvgRoot())&&a.setAttribute(\"visibility\",\"hidden\")}}showInsertionInputOutline(a){a=a.closest;this.highlightedBlock=a.getSourceBlock();this.highlightedBlock.highlightShapeForInput(a,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error(\"Cannot hide the insertion marker outline because there is no active candidate\");\nthis.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1);this.highlightedBlock=null}}showReplacementFade(a){this.fadedBlock=a.closest.targetBlock();if(!this.fadedBlock)throw Error(\"Cannot show the replacement fade because the closest connection does not have a target block\");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const a=[];this.firstMarker&&a.push(this.firstMarker);\nthis.lastMarker&&a.push(this.lastMarker);return a}disposeInsertionMarker(a){if(a){$.disable$$module$build$src$core$events$utils();try{a.dispose()}finally{$.enable$$module$build$src$core$events$utils()}}}};\n(function(a){a=a.PREVIEW_TYPE||(a.PREVIEW_TYPE={});a[a.INSERTION_MARKER=0]=\"INSERTION_MARKER\";a[a.INPUT_OUTLINE=1]=\"INPUT_OUTLINE\";a[a.REPLACEMENT_FADE=2]=\"REPLACEMENT_FADE\"})(InsertionMarkerManager$$module$build$src$core$insertion_marker_manager||(InsertionMarkerManager$$module$build$src$core$insertion_marker_manager={}));\nvar PreviewType$$module$build$src$core$insertion_marker_manager=InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE,module$build$src$core$insertion_marker_manager={};module$build$src$core$insertion_marker_manager.InsertionMarkerManager=InsertionMarkerManager$$module$build$src$core$insertion_marker_manager;module$build$src$core$insertion_marker_manager.PreviewType=PreviewType$$module$build$src$core$insertion_marker_manager;var Renderer$$module$build$src$core$renderers$common$renderer=class{constructor(a){this.overrides=null;this.name=a}getClassName(){return this.name+\"-renderer\"}init(a,b){this.constants_=this.makeConstants_();b&&(this.overrides=b,Object.assign(this.constants_,b));this.constants_.setTheme(a);this.constants_.init()}createDom(a,b){this.constants_.createDom(a,this.name+\"-\"+b.name,\".\"+this.getClassName()+\".\"+b.getClassName())}refreshDom(a,b){const c=this.getConstants();c.dispose();this.constants_=this.makeConstants_();\nthis.overrides&&Object.assign(this.constants_,this.overrides);this.constants_.randomIdentifier=c.randomIdentifier;this.constants_.setTheme(b);this.constants_.init();this.createDom(a,b)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$common$constants}makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$common$info(this,a)}makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$common$drawer(a,\nb)}makeMarkerDrawer(a,b){return new MarkerSvg$$module$build$src$core$renderers$common$marker_svg(a,this.getConstants(),b)}makePathObject(a,b){return new PathObject$$module$build$src$core$renderers$common$path_object(a,b,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(a){return!0}orphanCanConnectAtEnd(a,b,c){return!!Connection$$module$build$src$core$connection.getConnectionForOrphanedConnection(a,c===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?\nb.outputConnection:b.previousConnection)}getConnectionPreviewMethod(a,b,c){return b.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE||b.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT?!a.isConnected()||this.orphanCanConnectAtEnd(c,a.targetBlock(),b.type)?InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INSERTION_MARKER:InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.REPLACEMENT_FADE:\nInsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INSERTION_MARKER}render(a){const b=this.makeRenderInfo_(a);b.measure();this.makeDrawer_(a,b).draw()}},module$build$src$core$renderers$common$renderer={};module$build$src$core$renderers$common$renderer.Renderer=Renderer$$module$build$src$core$renderers$common$renderer;var module$build$src$core$renderers$common$block_rendering={};module$build$src$core$renderers$common$block_rendering.BottomRow=BottomRow$$module$build$src$core$renderers$measurables$bottom_row;module$build$src$core$renderers$common$block_rendering.Connection=Connection$$module$build$src$core$renderers$measurables$connection;module$build$src$core$renderers$common$block_rendering.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$common$constants;\nmodule$build$src$core$renderers$common$block_rendering.Drawer=Drawer$$module$build$src$core$renderers$common$drawer;module$build$src$core$renderers$common$block_rendering.ExternalValueInput=ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input;module$build$src$core$renderers$common$block_rendering.Field=Field$$module$build$src$core$renderers$measurables$field;module$build$src$core$renderers$common$block_rendering.Hat=Hat$$module$build$src$core$renderers$measurables$hat;\nmodule$build$src$core$renderers$common$block_rendering.Icon=Icon$$module$build$src$core$renderers$measurables$icon;module$build$src$core$renderers$common$block_rendering.InRowSpacer=InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer;module$build$src$core$renderers$common$block_rendering.InlineInput=InlineInput$$module$build$src$core$renderers$measurables$inline_input;module$build$src$core$renderers$common$block_rendering.InputConnection=InputConnection$$module$build$src$core$renderers$measurables$input_connection;\nmodule$build$src$core$renderers$common$block_rendering.InputRow=InputRow$$module$build$src$core$renderers$measurables$input_row;module$build$src$core$renderers$common$block_rendering.JaggedEdge=JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge;module$build$src$core$renderers$common$block_rendering.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$common$marker_svg;module$build$src$core$renderers$common$block_rendering.Measurable=Measurable$$module$build$src$core$renderers$measurables$base;\nmodule$build$src$core$renderers$common$block_rendering.NextConnection=NextConnection$$module$build$src$core$renderers$measurables$next_connection;module$build$src$core$renderers$common$block_rendering.OutputConnection=OutputConnection$$module$build$src$core$renderers$measurables$output_connection;module$build$src$core$renderers$common$block_rendering.PathObject=PathObject$$module$build$src$core$renderers$common$path_object;\nmodule$build$src$core$renderers$common$block_rendering.PreviousConnection=PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection;module$build$src$core$renderers$common$block_rendering.RenderInfo=RenderInfo$$module$build$src$core$renderers$common$info;module$build$src$core$renderers$common$block_rendering.Renderer=Renderer$$module$build$src$core$renderers$common$renderer;module$build$src$core$renderers$common$block_rendering.RoundCorner=RoundCorner$$module$build$src$core$renderers$measurables$round_corner;\nmodule$build$src$core$renderers$common$block_rendering.Row=Row$$module$build$src$core$renderers$measurables$row;module$build$src$core$renderers$common$block_rendering.SpacerRow=SpacerRow$$module$build$src$core$renderers$measurables$spacer_row;module$build$src$core$renderers$common$block_rendering.SquareCorner=SquareCorner$$module$build$src$core$renderers$measurables$square_corner;module$build$src$core$renderers$common$block_rendering.StatementInput=StatementInput$$module$build$src$core$renderers$measurables$statement_input;\nmodule$build$src$core$renderers$common$block_rendering.TopRow=TopRow$$module$build$src$core$renderers$measurables$top_row;module$build$src$core$renderers$common$block_rendering.Types=Types$$module$build$src$core$renderers$measurables$types;module$build$src$core$renderers$common$block_rendering.init=init$$module$build$src$core$renderers$common$block_rendering;module$build$src$core$renderers$common$block_rendering.register=register$$module$build$src$core$renderers$common$block_rendering;\nmodule$build$src$core$renderers$common$block_rendering.unregister=unregister$$module$build$src$core$renderers$common$block_rendering;var ThemeManager$$module$build$src$core$theme_manager=class{constructor(a,b){this.workspace=a;this.theme=b;this.subscribedWorkspaces_=[];this.componentDB=new Map}getTheme(){return this.theme}setTheme(a){var b=this.theme;this.theme=a;if(a=this.workspace.getInjectionDiv())b&&(b=b.getClassName())&&removeClass$$module$build$src$core$utils$dom(a,b),(b=this.theme.getClassName())&&addClass$$module$build$src$core$utils$dom(a,b);for(let c=0,d;d=this.subscribedWorkspaces_[c];c++)d.refreshTheme();for(const [c,\nd]of this.componentDB)for(const e of d){a=e.element;b=e.propertyName;const f=this.theme&&this.theme.getComponentStyle(c);a.style.setProperty(b,f||\"\")}for(const c of this.subscribedWorkspaces_)c.hideChaff()}subscribeWorkspace(a){this.subscribedWorkspaces_.push(a)}unsubscribeWorkspace(a){if(!removeElem$$module$build$src$core$utils$array(this.subscribedWorkspaces_,a))throw Error(\"Cannot unsubscribe a workspace that hasn't been subscribed.\");}subscribe(a,b,c){this.componentDB.has(b)||this.componentDB.set(b,\n[]);this.componentDB.get(b).push({element:a,propertyName:c});b=this.theme&&this.theme.getComponentStyle(b);a.style.setProperty(c,b||\"\")}unsubscribe(a){if(a)for(const [b,c]of this.componentDB){for(let d=c.length-1;0<=d;d--)c[d].element===a&&c.splice(d,1);c.length||this.componentDB.delete(b)}}dispose(){this.subscribedWorkspaces_.length=0;this.componentDB.clear()}},module$build$src$core$theme_manager={};module$build$src$core$theme_manager.ThemeManager=ThemeManager$$module$build$src$core$theme_manager;var CATEGORY_NAME$$module$build$src$core$variables_dynamic=\"VARIABLE_DYNAMIC\",onCreateVariableButtonClick_String$$module$build$src$core$variables_dynamic=stringButtonClickHandler$$module$build$src$core$variables_dynamic,onCreateVariableButtonClick_Number$$module$build$src$core$variables_dynamic=numberButtonClickHandler$$module$build$src$core$variables_dynamic,onCreateVariableButtonClick_Colour$$module$build$src$core$variables_dynamic=colourButtonClickHandler$$module$build$src$core$variables_dynamic,\nmodule$build$src$core$variables_dynamic={CATEGORY_NAME:CATEGORY_NAME$$module$build$src$core$variables_dynamic};module$build$src$core$variables_dynamic.flyoutCategory=flyoutCategory$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.flyoutCategoryBlocks=flyoutCategoryBlocks$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.onCreateVariableButtonClick_Colour=colourButtonClickHandler$$module$build$src$core$variables_dynamic;\nmodule$build$src$core$variables_dynamic.onCreateVariableButtonClick_Number=numberButtonClickHandler$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.onCreateVariableButtonClick_String=stringButtonClickHandler$$module$build$src$core$variables_dynamic;var ConnectionChecker$$module$build$src$core$connection_checker=class{canConnect(a,b,c,d){return this.canConnectWithReason(a,b,c,d)===Connection$$module$build$src$core$connection.CAN_CONNECT}canConnectWithReason(a,b,c,d){const e=this.doSafetyChecks(a,b);return e!==Connection$$module$build$src$core$connection.CAN_CONNECT?e:this.doTypeChecks(a,b)?c&&!this.doDragChecks(a,b,d||0)?Connection$$module$build$src$core$connection.REASON_DRAG_CHECKS_FAILED:Connection$$module$build$src$core$connection.CAN_CONNECT:\nConnection$$module$build$src$core$connection.REASON_CHECKS_FAILED}getErrorMessage(a,b,c){switch(a){case Connection$$module$build$src$core$connection.REASON_SELF_CONNECTION:return\"Attempted to connect a block to itself.\";case Connection$$module$build$src$core$connection.REASON_DIFFERENT_WORKSPACES:return\"Blocks not on same workspace.\";case Connection$$module$build$src$core$connection.REASON_WRONG_TYPE:return\"Attempt to connect incompatible types.\";case Connection$$module$build$src$core$connection.REASON_TARGET_NULL:return\"Target connection is null.\";\ncase Connection$$module$build$src$core$connection.REASON_CHECKS_FAILED:return\"Connection checks failed. \"+(b+\" expected \"+b.getCheck()+\", found \"+c.getCheck());case Connection$$module$build$src$core$connection.REASON_SHADOW_PARENT:return\"Connecting non-shadow to shadow block.\";case Connection$$module$build$src$core$connection.REASON_DRAG_CHECKS_FAILED:return\"Drag checks failed.\";case Connection$$module$build$src$core$connection.REASON_PREVIOUS_AND_OUTPUT:return\"Block would have an output and a previous connection.\";\ndefault:return\"Unknown connection failure: this should never happen!\"}}doSafetyChecks(a,b){if(!a||!b)return Connection$$module$build$src$core$connection.REASON_TARGET_NULL;let c,d,e;a.isSuperior()?(c=a.getSourceBlock(),d=b.getSourceBlock(),e=b):(d=a.getSourceBlock(),c=b.getSourceBlock(),e=a,a=b);return c===d?Connection$$module$build$src$core$connection.REASON_SELF_CONNECTION:e.type!==OPPOSITE_TYPE$$module$build$src$core$internal_constants[a.type]?Connection$$module$build$src$core$connection.REASON_WRONG_TYPE:\nc.workspace!==d.workspace?Connection$$module$build$src$core$connection.REASON_DIFFERENT_WORKSPACES:c.isShadow()&&!d.isShadow()?Connection$$module$build$src$core$connection.REASON_SHADOW_PARENT:e.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE&&d.previousConnection&&d.previousConnection.isConnected()||e.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT&&d.outputConnection&&d.outputConnection.isConnected()?Connection$$module$build$src$core$connection.REASON_PREVIOUS_AND_OUTPUT:\nConnection$$module$build$src$core$connection.CAN_CONNECT}doTypeChecks(a,b){a=a.getCheck();b=b.getCheck();if(!a||!b)return!0;for(let c=0;c<a.length;c++)if(-1!==b.indexOf(a[c]))return!0;return!1}doDragChecks(a,b,c){if(a.distanceFrom(b)>c||b.getSourceBlock().isInsertionMarker())return!1;switch(b.type){case ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(a,b);case ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE:if(b.isConnected()&&\n!b.targetBlock().isInsertionMarker()||a.isConnected())return!1;break;case ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow())return!1;break;case ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT:if(b.isConnected()&&!a.getSourceBlock().nextConnection&&!b.targetBlock().isShadow()&&b.targetBlock().nextConnection||b.targetBlock()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow())return!1;\nbreak;default:return!1}return-1!==draggingConnections$$module$build$src$core$common.indexOf(b)?!1:!0}canConnectToPrevious_(a,b){if(a.targetConnection||-1!==draggingConnections$$module$build$src$core$common.indexOf(b))return!1;if(!b.targetConnection)return!0;a=b.targetBlock();return a.isInsertionMarker()?!a.getPreviousBlock():!1}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.CONNECTION_CHECKER,DEFAULT$$module$build$src$core$registry,ConnectionChecker$$module$build$src$core$connection_checker);\nvar module$build$src$core$connection_checker={};module$build$src$core$connection_checker.ConnectionChecker=ConnectionChecker$$module$build$src$core$connection_checker;var VarDelete$$module$build$src$core$events$events_var_delete=class extends VarBase$$module$build$src$core$events$events_var_base{constructor(a){super(a);this.type=VAR_DELETE$$module$build$src$core$events$utils;a&&(this.varType=a.type,this.varName=a.name)}toJson(){const a=super.toJson();if(void 0===this.varType)throw Error(\"The var type is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.varName)throw Error(\"The var name is undefined. Either pass a variable to the constructor, or call fromJson\");\na.varType=this.varType;a.varName=this.varName;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new VarDelete$$module$build$src$core$events$events_var_delete);b.varType=a.varType;b.varName=a.varName;return b}run(a){const b=this.getEventWorkspace_();if(!this.varId)throw Error(\"The var ID is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.varName)throw Error(\"The var name is undefined. Either pass a variable to the constructor, or call fromJson\");a?b.deleteVariableById(this.varId):\nb.createVariable(this.varName,this.varType,this.varId)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VAR_DELETE$$module$build$src$core$events$utils,VarDelete$$module$build$src$core$events$events_var_delete);var module$build$src$core$events$events_var_delete={};module$build$src$core$events$events_var_delete.VarDelete=VarDelete$$module$build$src$core$events$events_var_delete;var VarRename$$module$build$src$core$events$events_var_rename=class extends VarBase$$module$build$src$core$events$events_var_base{constructor(a,b){super(a);this.type=VAR_RENAME$$module$build$src$core$events$utils;a&&(this.oldName=a.name,this.newName=\"undefined\"===typeof b?\"\":b)}toJson(){const a=super.toJson();if(!this.oldName)throw Error(\"The old var name is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.newName)throw Error(\"The new var name is undefined. Either pass a value to the constructor, or call fromJson\");\na.oldName=this.oldName;a.newName=this.newName;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new VarRename$$module$build$src$core$events$events_var_rename);b.oldName=a.oldName;b.newName=a.newName;return b}run(a){const b=this.getEventWorkspace_();if(!this.varId)throw Error(\"The var ID is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.oldName)throw Error(\"The old var name is undefined. Either pass a variable to the constructor, or call fromJson\");if(!this.newName)throw Error(\"The new var name is undefined. Either pass a value to the constructor, or call fromJson\");\na?b.renameVariableById(this.varId,this.newName):b.renameVariableById(this.varId,this.oldName)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VAR_RENAME$$module$build$src$core$events$utils,VarRename$$module$build$src$core$events$events_var_rename);var module$build$src$core$events$events_var_rename={};module$build$src$core$events$events_var_rename.VarRename=VarRename$$module$build$src$core$events$events_var_rename;var VariableMap$$module$build$src$core$variable_map=class{constructor(a){this.workspace=a;this.variableMap=new Map}clear(){for(const a of this.variableMap.values())for(;0<a.length;)this.deleteVariable(a[0]);if(0!==this.variableMap.size)throw Error(\"Non-empty variable map\");}renameVariable(a,b){if(a.name!==b){var c=this.getVariable(b,a.type),d=this.workspace.getAllBlocks(!1),e=$.getGroup$$module$build$src$core$events$utils();e||$.setGroup$$module$build$src$core$events$utils(!0);try{c&&c.getId()!==\na.getId()?this.renameVariableWithConflict_(a,b,c,d):this.renameVariableAndUses_(a,b,d)}finally{$.setGroup$$module$build$src$core$events$utils(e)}}}renameVariableById(a,b){const c=this.getVariableById(a);if(!c)throw Error(\"Tried to rename a variable that didn't exist. ID: \"+a);this.renameVariable(c,b)}renameVariableAndUses_(a,b,c){fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(VAR_RENAME$$module$build$src$core$events$utils))(a,b));a.name=b;for(b=0;b<c.length;b++)c[b].updateVarName(a)}renameVariableWithConflict_(a,\nb,c,d){const e=a.type;b!==c.name&&this.renameVariableAndUses_(c,b,d);for(b=0;b<d.length;b++)d[b].renameVarById(a.getId(),c.getId());fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(VAR_DELETE$$module$build$src$core$events$utils))(a));removeElem$$module$build$src$core$utils$array(this.variableMap.get(e),a)}createVariable(a,b,c){var d=this.getVariable(a,b);if(d){if(c&&d.getId()!==c)throw Error('Variable \"'+a+'\" is already in use and its id is \"'+d.getId()+'\" which conflicts with the passed in id, \"'+\nc+'\".');return d}if(c&&this.getVariableById(c))throw Error('Variable id, \"'+c+'\", is already in use.');d=c||genUid$$module$build$src$core$utils$idgenerator();b=b||\"\";d=new VariableModel$$module$build$src$core$variable_model(this.workspace,a,b,d);a=this.variableMap.get(b)||[];a.push(d);this.variableMap.delete(b);this.variableMap.set(b,a);fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(VAR_CREATE$$module$build$src$core$events$utils))(d));return d}deleteVariable(a){const b=\na.getId(),c=this.variableMap.get(a.type);if(c)for(let d=0;d<c.length;d++)if(c[d].getId()===b){c.splice(d,1);fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(VAR_DELETE$$module$build$src$core$events$utils))(a));0===c.length&&this.variableMap.delete(a.type);break}}deleteVariableById(a){const b=this.getVariableById(a);if(b){var c=b.name;const d=this.getVariableUsesById(a);for(let e=0,f;f=d[e];e++)if(\"procedures_defnoreturn\"===f.type||\"procedures_defreturn\"===f.type){a=\nString(f.getFieldValue(\"NAME\"));c=$.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace(\"%1\",c).replace(\"%2\",a);alert$$module$build$src$core$dialog(c);return}1<d.length?(c=$.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace(\"%1\",String(d.length)).replace(\"%2\",c),confirm$$module$build$src$core$dialog(c,e=>{e&&b&&this.deleteVariableInternal(b,d)})):this.deleteVariableInternal(b,d)}else console.warn(\"Can't delete non-existent variable: \"+a)}deleteVariableInternal(a,\nb){const c=$.getGroup$$module$build$src$core$events$utils();c||$.setGroup$$module$build$src$core$events$utils(!0);try{for(let d=0;d<b.length;d++)b[d].dispose(!0);this.deleteVariable(a)}finally{$.setGroup$$module$build$src$core$events$utils(c)}}getVariable(a,b){if(b=this.variableMap.get(b||\"\"))for(let c=0,d;d=b[c];c++)if($.Names$$module$build$src$core$names.equals(d.name,a))return d;return null}getVariableById(a){for(const b of this.variableMap.values())for(const c of b)if(c.getId()===a)return c;return null}getVariablesOfType(a){return(a=\nthis.variableMap.get(a||\"\"))?a.slice():[]}getVariableTypes(a){const b=new Set(this.variableMap.keys());if(a&&a.getPotentialVariableMap())for(const c of a.getPotentialVariableMap().variableMap.keys())b.add(c);b.has(\"\")||b.add(\"\");return Array.from(b.values())}getAllVariables(){let a=[];for(const b of this.variableMap.values())a=a.concat(b);return a}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(a=>a.name)}getVariableUsesById(a){const b=[],c=this.workspace.getAllBlocks(!1);\nfor(let d=0;d<c.length;d++){const e=c[d].getVarModels();if(e)for(let f=0;f<e.length;f++)e[f].getId()===a&&b.push(c[d])}return b}},module$build$src$core$variable_map={};module$build$src$core$variable_map.VariableMap=VariableMap$$module$build$src$core$variable_map;var Workspace$$module$build$src$core$workspace=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(a){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1;this.MAX_UNDO=1024;this.connectionDBList=[];this.topBlocks=[];this.topComments=[];this.commentDB=new Map;this.listeners=[];this.undoStack_=[];this.redoStack_=[];this.blockDB=new Map;this.typedBlocksDB=new Map;this.procedureMap=new ObservableProcedureMap$$module$build$src$core$observable_procedure_map;\nthis.potentialVariableMap=null;this.id=genUid$$module$build$src$core$utils$idgenerator();registerWorkspace$$module$build$src$core$common(this);this.options=a||new Options$$module$build$src$core$options({});this.RTL=!!this.options.RTL;this.horizontalLayout=!!this.options.horizontalLayout;this.toolboxPosition=this.options.toolboxPosition;this.connectionChecker=new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.CONNECTION_CHECKER,this.options,!0))(this);this.variableMap=\nnew VariableMap$$module$build$src$core$variable_map(this)}dispose(){this.listeners.length=0;this.clear();unregisterWorkpace$$module$build$src$core$common(this)}sortObjects_(a,b){const c=Math.sin(toRadians$$module$build$src$core$utils$math(Workspace$$module$build$src$core$workspace.SCAN_ANGLE))*(this.RTL?-1:1);a=a.getRelativeToSurfaceXY();b=b.getRelativeToSurfaceXY();return a.y+c*a.x-(b.y+c*b.x)}addTopBlock(a){this.topBlocks.push(a)}removeTopBlock(a){if(!removeElem$$module$build$src$core$utils$array(this.topBlocks,\na))throw Error(\"Block not present in workspace's list of top-most blocks.\");}getTopBlocks(a=!1){const b=[].concat(this.topBlocks);a&&1<b.length&&b.sort(this.sortObjects_.bind(this));return b}addTypedBlock(a){this.typedBlocksDB.has(a.type)||this.typedBlocksDB.set(a.type,[]);this.typedBlocksDB.get(a.type).push(a)}removeTypedBlock(a){removeElem$$module$build$src$core$utils$array(this.typedBlocksDB.get(a.type),a);this.typedBlocksDB.get(a.type).length||this.typedBlocksDB.delete(a.type)}getBlocksByType(a,\nb=!1){if(!this.typedBlocksDB.has(a))return[];a=this.typedBlocksDB.get(a).slice(0);b&&a&&1<a.length&&a.sort(this.sortObjects_.bind(this));return a.filter(function(c){return!c.isInsertionMarker()})}addTopComment(a){this.topComments.push(a);this.commentDB.has(a.id)&&console.warn('Overriding an existing comment on this workspace, with id \"'+a.id+'\"');this.commentDB.set(a.id,a)}removeTopComment(a){if(!removeElem$$module$build$src$core$utils$array(this.topComments,a))throw Error(\"Comment not present in workspace's list of top-most comments.\");\nthis.commentDB.delete(a.id)}getTopComments(a=!1){const b=[].concat(this.topComments);a&&1<b.length&&b.sort(this.sortObjects_.bind(this));return b}getAllBlocks(a=!1){if(a){var b=this.getTopBlocks(!0);a=[];for(let c=0;c<b.length;c++)a.push(...b[c].getDescendants(!0))}else for(a=this.getTopBlocks(!1),b=0;b<a.length;b++)a.push(...a[b].getChildren(!1));return a.filter(function(c){return!c.isInsertionMarker()})}clear(){this.isClearing=!0;try{const a=$.getGroup$$module$build$src$core$events$utils();for(a||\n$.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();$.setGroup$$module$build$src$core$events$utils(a);this.variableMap.clear();this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(a,b){this.variableMap.renameVariableById(a,b)}createVariable(a,b,c){return this.variableMap.createVariable(a,b,c)}getVariableUsesById(a){return this.variableMap.getVariableUsesById(a)}deleteVariableById(a){this.variableMap.deleteVariableById(a)}getVariable(a,\nb){return this.variableMap.getVariable(a,b)}getVariableById(a){return this.variableMap.getVariableById(a)}getVariablesOfType(a){return this.variableMap.getVariablesOfType(a)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(a,b){throw Error(\"The implementation of newBlock should be monkey-patched in by blockly.ts\");}remainingCapacity(){return isNaN(this.options.maxBlocks)?\nInfinity:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(a){return this.options.maxInstances?(void 0!==this.options.maxInstances[a]?this.options.maxInstances[a]:Infinity)-this.getBlocksByType(a,!1).length:Infinity}isCapacityAvailable(a){if(!this.hasBlockLimits())return!0;let b=0;for(const c in a){if(a[c]>this.remainingCapacityOfType(c))return!1;b+=a[c]}return b>this.remainingCapacity()?!1:!0}hasBlockLimits(){return Infinity!==this.options.maxBlocks||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(a){var b=\na?this.redoStack_:this.undoStack_,c=a?this.undoStack_:this.redoStack_;const d=b.pop();if(d){for(var e=[d];b.length&&d.group&&d.group===b[b.length-1].group;){const f=b.pop();f&&e.push(f)}for(b=0;b<e.length;b++)c.push(e[b]);e=filter$$module$build$src$core$events$utils(e,a);setRecordUndo$$module$build$src$core$events$utils(!1);try{for(c=0;c<e.length;c++)e[c].run(a)}finally{setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0;this.redoStack_.length=0;clearPendingUndo$$module$build$src$core$events$utils()}addChangeListener(a){this.listeners.push(a);\nreturn a}removeChangeListener(a){removeElem$$module$build$src$core$utils$array(this.listeners,a)}fireChangeListener(a){if(a.recordUndo)for(this.undoStack_.push(a),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let b=0;b<this.listeners.length;b++)(0,this.listeners[b])(a)}getBlockById(a){return this.blockDB.get(a)||null}setBlockById(a,b){this.blockDB.set(a,b)}removeBlockById(a){this.blockDB.delete(a)}getCommentById(a){let b;return null!=\n(b=this.commentDB.get(a))?b:null}allInputsFilled(a){const b=this.getTopBlocks(!1);for(let c=0;c<b.length;c++)if(!b[c].allInputsFilled(a))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new VariableMap$$module$build$src$core$variable_map(this)}getVariableMap(){return this.variableMap}setVariableMap(a){this.variableMap=a}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let a=null;const b=this.options.parentWorkspace;\nthis.isFlyout?b&&b.options&&(a=b.options.parentWorkspace):b&&(a=b);return a}static getById(a){return getWorkspaceById$$module$build$src$core$common(a)}static getAll(){return getAllWorkspaces$$module$build$src$core$common()}};Workspace$$module$build$src$core$workspace.SCAN_ANGLE=3;var module$build$src$core$workspace={};module$build$src$core$workspace.Workspace=Workspace$$module$build$src$core$workspace;var SOUND_LIMIT$$module$build$src$core$workspace_audio=100,WorkspaceAudio$$module$build$src$core$workspace_audio=class{constructor(a){this.parentWorkspace=a;this.sounds=new Map;this.lastSound_=null}dispose(){this.sounds.clear()}load(a,b){if(a.length){try{var c=new globalThis.Audio}catch(e){return}for(let e=0;e<a.length;e++){const f=a[e],g=f.match(/\\.(\\w+)$/);if(g&&c.canPlayType(\"audio/\"+g[1])){var d=new globalThis.Audio(f);break}}d&&this.sounds.set(b,d)}}preload(){for(const a of this.sounds.values()){a.volume=\n.01;const b=a.play();void 0!==b?b.then(a.pause).catch(function(){}):a.pause();if(IPAD$$module$build$src$core$utils$useragent||IPHONE$$module$build$src$core$utils$useragent)break}}play(a,b){var c=this.sounds.get(a);c?(a=new Date,null!==this.lastSound_&&a.getTime()-this.lastSound_.getTime()<SOUND_LIMIT$$module$build$src$core$workspace_audio||(this.lastSound_=a,c=IPAD$$module$build$src$core$utils$useragent||ANDROID$$module$build$src$core$utils$useragent?c:c.cloneNode(),c.volume=void 0===b?1:b,c.play())):\nthis.parentWorkspace&&this.parentWorkspace.getAudioManager().play(a,b)}},module$build$src$core$workspace_audio={};module$build$src$core$workspace_audio.WorkspaceAudio=WorkspaceAudio$$module$build$src$core$workspace_audio;var LayerManager$$module$build$src$core$layer_manager=class{constructor(a){this.workspace=a;this.layers=new Map;if(a=a.getInjectionDiv())this.dragLayer=this.createDragLayer(a);a=this.createLayer(BLOCK$$module$build$src$core$layers);addClass$$module$build$src$core$utils$dom(a,\"blocklyBlockCanvas\");a=this.createLayer(BUBBLE$$module$build$src$core$layers);addClass$$module$build$src$core$utils$dom(a,\"blocklyBubbleCanvas\")}createDragLayer(a){const b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,\n{\"class\":\"blocklyBlockDragSurface\",xmlns:SVG_NS$$module$build$src$core$utils$dom,\"xmlns:html\":HTML_NS$$module$build$src$core$utils$dom,\"xmlns:xlink\":XLINK_NS$$module$build$src$core$utils$dom,version:\"1.1\"});a.append(b);return createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{},b)}translateLayers(a,b){a=`translate(${a.x}, ${a.y}) scale(${b})`;let c;null==(c=this.dragLayer)||c.setAttribute(\"transform\",a);for(const [,d]of this.layers)d.setAttribute(\"transform\",\na)}moveToDragLayer(a){let b;null==(b=this.dragLayer)||b.appendChild(a.getSvgRoot())}moveOffDragLayer(a,b){this.append(a,b)}append(a,b){this.layers.has(b)||this.createLayer(b);let c;null==(c=this.layers.get(b))||c.appendChild(a.getSvgRoot())}createLayer(a){const b=this.workspace.getSvgGroup(),c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{});let d=!1;const e=[...this.layers].sort((f,g)=>f[0]-g[0]);for(const [f,g]of e)if(a<f){b.insertBefore(c,g);d=!0;break}d||\nb.appendChild(c);this.layers.set(a,c);return c}hasLayer(a){return a===this.dragLayer||(new Set(this.layers.values())).has(a)}getBlockLayer(){return this.layers.get(BLOCK$$module$build$src$core$layers)}getBubbleLayer(){return this.layers.get(BUBBLE$$module$build$src$core$layers)}},module$build$src$core$layer_manager={};module$build$src$core$layer_manager.LayerManager=LayerManager$$module$build$src$core$layer_manager;var ZOOM_TO_FIT_MARGIN$$module$build$src$core$workspace_svg=20,WorkspaceSvg$$module$build$src$core$workspace_svg=class extends Workspace$$module$build$src$core$workspace{constructor(a){super(a);this.resizeHandlerWrapper=null;this.resizesEnabled=this.isVisible_=this.rendered=!0;this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0;this.dragDeltaXY=null;this.oldScale=this.scale=1;this.oldLeft=this.oldTop=0;this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=\nthis.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null;this.inverseScreenCTMDirty=!0;this.highlightedBlocks=[];this.toolboxCategoryCallbacks=new Map;this.flyoutButtonCallbacks=new Map;this.cachedParentSvg=null;this.keyboardAccessibilityMode=!1;this.topBoundedElements=[];this.dragTargetAreas=[];this.zoomControls_=this.layerManager=null;this.metricsManager=new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.METRICS_MANAGER,\na,!0))(this);this.getMetrics=a.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager);this.setMetrics=a.setMetrics||WorkspaceSvg$$module$build$src$core$workspace_svg.setTopLevelWorkspaceMetrics_;this.componentManager=new ComponentManager$$module$build$src$core$component_manager;this.connectionDBList=ConnectionDB$$module$build$src$core$connection_db.init(this.connectionChecker);this.audioManager=new WorkspaceAudio$$module$build$src$core$workspace_audio(a.parentWorkspace);this.grid=this.options.gridPattern?\nnew Grid$$module$build$src$core$grid(this.options.gridPattern,a.gridOptions):null;this.markerManager=new MarkerManager$$module$build$src$core$marker_manager(this);module$build$src$core$variables&&flyoutCategory$$module$build$src$core$variables&&this.registerToolboxCategoryCallback(CATEGORY_NAME$$module$build$src$core$variables,flyoutCategory$$module$build$src$core$variables);module$build$src$core$variables_dynamic&&flyoutCategory$$module$build$src$core$variables_dynamic&&this.registerToolboxCategoryCallback(CATEGORY_NAME$$module$build$src$core$variables_dynamic,\nflyoutCategory$$module$build$src$core$variables_dynamic);module$build$src$core$procedures&&flyoutCategory$$module$build$src$core$procedures&&(this.registerToolboxCategoryCallback(CATEGORY_NAME$$module$build$src$core$procedures,flyoutCategory$$module$build$src$core$procedures),this.addChangeListener(mutatorOpenListener$$module$build$src$core$procedures));this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new ThemeManager$$module$build$src$core$theme_manager(this,\nthis.options.theme||Classic$$module$build$src$core$theme$classic);this.themeManager_.subscribeWorkspace(this);let b;this.renderer=init$$module$build$src$core$renderers$common$block_rendering(this.options.renderer||\"geras\",this.getTheme(),null!=(b=this.options.rendererOverrides)?b:void 0);this.cachedParentSvgSize=new Size$$module$build$src$core$utils$size(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(a){this.metricsManager=a;this.getMetrics=\nthis.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(a){this.markerManager.setCursorSvg(a)}setMarkerSvg(a){this.markerManager.setMarkerSvg(a)}getMarker(a){return this.markerManager?this.markerManager.getMarker(a):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(a){a||\n(a=Classic$$module$build$src$core$theme$classic);this.themeManager_.setTheme(a)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme());this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(b){return!!b.getStyleName()}));this.refreshToolboxSelection();this.toolbox_&&this.toolbox_.refreshTheme();this.isVisible()&&this.setVisible(!0);const a=new (get$$module$build$src$core$events$utils(THEME_CHANGE$$module$build$src$core$events$utils))(this.getTheme().name,this.id);\nfire$$module$build$src$core$events$utils(a)}updateBlockStyles_(a){for(let b=0,c;c=a[b];b++){const d=c.getStyleName();d&&c.setStyle(d)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const a=this.getParentSvg().getScreenCTM();a&&(this.inverseScreenCTM=a.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(a){let b=0,c=0,d=1;if(this.getCanvas().contains(a)||this.getBubbleCanvas().contains(a))d=\nthis.scale;do{const e=getRelativeXY$$module$build$src$core$utils$svg_math(a);if(a===this.getCanvas()||a===this.getBubbleCanvas())d=1;b+=e.x*d;c+=e.y*d;a=a.parentNode}while(a&&a!==this.getParentSvg()&&a!==this.getInjectionDiv());return new Coordinate$$module$build$src$core$utils$coordinate(b,c)}getCachedParentSvgSize(){const a=this.cachedParentSvgSize;return new Size$$module$build$src$core$utils$size(a.width,a.height)}getOriginOffsetInPixels(){return getInjectionDivXY$$module$build$src$core$utils$svg_math(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let a=\nthis.svgGroup_;for(;a;){if(-1!==(\" \"+(a.getAttribute(\"class\")||\"\")+\" \").indexOf(\" injectionDiv \")){this.injectionDiv=a;break}a=a.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(a){this.resizeHandlerWrapper=a}createDom(a,b){this.injectionDiv||(this.injectionDiv=null!=b?b:null);this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyWorkspace\"});\na&&(this.svgBackground_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{height:\"100%\",width:\"100%\",\"class\":a},this.svgGroup_),\"blocklyMainBackground\"===a&&this.grid?this.svgBackground_.style.fill=\"url(#\"+this.grid.getPatternId()+\")\":this.themeManager_.subscribe(this.svgBackground_,\"workspaceBackgroundColour\",\"fill\"));this.layerManager=new LayerManager$$module$build$src$core$layer_manager(this);this.svgBlockCanvas_=this.layerManager.getBlockLayer();this.svgBubbleCanvas_=\nthis.layerManager.getBubbleLayer();this.isFlyout||(conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,\"pointerdown\",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener(\"wheel\",this.dummyWheelListener),conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,\"wheel\",this,this.onMouseWheel_));this.options.hasCategories&&(this.toolbox_=new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX,\nthis.options,!0))(this));this.grid&&this.grid.update(this.scale);this.recordDragTargets();(a=getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.CURSOR,this.options))&&this.markerManager.setCursor(new a);this.renderer.createDom(this.svgGroup_,this.getTheme());return this.svgGroup_}dispose(){this.rendered=!1;this.currentGesture_&&this.currentGesture_.cancel();this.svgGroup_&&removeNode$$module$build$src$core$utils$dom(this.svgGroup_);this.toolbox_&&(this.toolbox_.dispose(),\nthis.toolbox_=null);this.flyout&&(this.flyout.dispose(),this.flyout=null);this.trashcan&&(this.trashcan.dispose(),this.trashcan=null);this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null);this.zoomControls_&&this.zoomControls_.dispose();this.audioManager&&this.audioManager.dispose();this.grid&&(this.grid=null);this.renderer.dispose();this.markerManager&&this.markerManager.dispose();super.dispose();this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),\nthis.options.parentWorkspace||this.themeManager_.dispose());this.connectionDBList.length=0;this.toolboxCategoryCallbacks.clear();this.flyoutButtonCallbacks.clear();if(!this.options.parentWorkspace){const a=this.getParentSvg();a&&a.parentNode&&removeNode$$module$build$src$core$utils$dom(a.parentNode)}this.resizeHandlerWrapper&&(unbind$$module$build$src$core$browser_events(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null);this.dummyWheelListener&&(document.body.removeEventListener(\"wheel\",\nthis.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=WorkspaceSvg$$module$build$src$core$workspace_svg.newTrashcan(this);const a=this.trashcan.createDom();this.svgGroup_.insertBefore(a,this.getCanvas())}static newTrashcan(a){throw Error(\"The implementation of newTrashcan should be monkey-patched in by blockly.ts\");}addZoomControls(){this.zoomControls_=new ZoomControls$$module$build$src$core$zoom_controls(this);const a=this.zoomControls_.createDom();this.svgGroup_.appendChild(a)}addFlyout(a){const b=\nnew Options$$module$build$src$core$options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});b.toolboxPosition=this.options.toolboxPosition;this.flyout=this.horizontalLayout?new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(b):new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,\nthis.options,!0))(b);this.flyout.autoClose=!1;this.flyout.getWorkspace().setVisible(!0);return this.flyout.createDom(a)}getFlyout(a){return this.flyout||a?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM();this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position();\nthis.flyout&&this.flyout.position();const a=this.componentManager.getComponents(ComponentManager$$module$build$src$core$component_manager.Capability.POSITIONABLE,!0),b=this.getMetricsManager().getUiMetrics(),c=[];for(let d=0,e;e=a[d];d++){e.position(b,c);const f=e.getBoundingRectangle();f&&c.push(f)}this.scrollbar&&this.scrollbar.resize();this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const a=getDocumentScroll$$module$build$src$core$utils$svg_math();Coordinate$$module$build$src$core$utils$coordinate.equals(this.lastRecordedPageScroll,\na)||(this.lastRecordedPageScroll=a,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(a,b){const c=this.getParentSvg();null!=a&&(this.cachedParentSvgSize.width=a,c.setAttribute(\"data-cached-width\",`${a}`));null!=b&&(this.cachedParentSvgSize.height=b,c.setAttribute(\"data-cached-height\",`${b}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let a=\nthis.svgGroup_;for(;a;){if(\"svg\"===a.tagName){this.cachedParentSvg=a;break}a=a.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(isEnabled$$module$build$src$core$events$utils()){var a=this.scale,b=-this.scrollY,c=-this.scrollX;if(!(a===this.oldScale&&1>Math.abs(b-this.oldTop)&&1>Math.abs(c-this.oldLeft))){var d=new (get$$module$build$src$core$events$utils(VIEWPORT_CHANGE$$module$build$src$core$events$utils))(b,c,a,this.id,this.oldScale);this.oldScale=a;this.oldTop=b;this.oldLeft=\nc;fire$$module$build$src$core$events$utils(d)}}}translate(a,b){let c;null==(c=this.layerManager)||c.translateLayers(new Coordinate$$module$build$src$core$utils$coordinate(a,b),this.scale);let d;null==(d=this.grid)||d.moveTo(a,b);this.maybeFireViewportChangeEvent()}getWidth(){const a=this.getMetrics();return a?a.viewWidth/this.scale:0}setVisible(a){this.isVisible_=a;this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(a),this.getFlyout()&&this.getFlyout().setContainerVisible(a),this.getParentSvg().style.display=\na?\"block\":\"none\",this.toolbox_&&this.toolbox_.setVisible(a),a||this.hideChaff(!0))}render(){var a=this.getAllBlocks(!1);for(var b=a.length-1;0<=b;b--)a[b].queueRender();if(this.currentGesture_)for(a=this.currentGesture_.getInsertionMarkers(),b=0;b<a.length;b++)a[b].queueRender();finishQueuedRenders$$module$build$src$core$render_management().then(()=>void this.markerManager.updateMarkers())}highlightBlock(a,b){if(void 0===b){for(let c=0,d;d=this.highlightedBlocks[c];c++)d.setHighlighted(!1);this.highlightedBlocks.length=\n0}if(a=a?this.getBlockById(a):null)(b=void 0===b||b)?-1===this.highlightedBlocks.indexOf(a)&&this.highlightedBlocks.push(a):removeElem$$module$build$src$core$utils$array(this.highlightedBlocks,a),a.setHighlighted(b)}paste(a){warn$$module$build$src$core$utils$deprecation(\"Blockly.WorkspaceSvg.prototype.paste\",\"v10\",\"v11\",\"Blockly.clipboard.paste\");if(!this.rendered||!a.type&&!a.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const b=$.getGroup$$module$build$src$core$events$utils();\nb||$.setGroup$$module$build$src$core$events$utils(!0);let c;try{c=a.type?this.pasteBlock_(null,a):\"comment\"===a.tagName.toLowerCase()?this.pasteWorkspaceComment_(a):this.pasteBlock_(a,null)}finally{$.setGroup$$module$build$src$core$events$utils(b)}return c}pasteBlock_(a,b){$.disable$$module$build$src$core$events$utils();let c;try{let d=0,e=0;if(a){c=domToBlockInternal$$module$build$src$core$xml(a,this);let f;d=parseInt(null!=(f=a.getAttribute(\"x\"))?f:\"0\");this.RTL&&(d=-d);let g;e=parseInt(null!=(g=\na.getAttribute(\"y\"))?g:\"0\")}else b&&(c=append$$module$build$src$core$serialization$blocks(b,this),d=b.x||10,this.RTL&&(d=this.getWidth()-d),e=b.y||10);if(!isNaN(d)&&!isNaN(e)){let f;do{f=!1;const g=this.getAllBlocks(!1);for(let h=0,k;k=g[h];h++){const l=k.getRelativeToSurfaceXY();if(1>=Math.abs(d-l.x)&&1>=Math.abs(e-l.y)){f=!0;break}}if(!f){const h=c.getConnections_(!1);for(let k=0,l;l=h[k];k++)if(l.closest($.config$$module$build$src$core$config.snapRadius,new Coordinate$$module$build$src$core$utils$coordinate(d,\ne)).connection){f=!0;break}}f&&(d=this.RTL?d-$.config$$module$build$src$core$config.snapRadius:d+$.config$$module$build$src$core$config.snapRadius,e+=2*$.config$$module$build$src$core$config.snapRadius)}while(f);c.moveTo(new Coordinate$$module$build$src$core$utils$coordinate(d,e))}}finally{$.enable$$module$build$src$core$events$utils()}isEnabled$$module$build$src$core$events$utils()&&!c.isShadow()&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(c));\nc.select();return c}pasteWorkspaceComment_(a){$.disable$$module$build$src$core$events$utils();let b;try{b=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.fromXmlRendered(a,this);let c,d=parseInt(null!=(c=a.getAttribute(\"x\"))?c:\"0\"),e,f=parseInt(null!=(e=a.getAttribute(\"y\"))?e:\"0\");isNaN(d)||isNaN(f)||(this.RTL&&(d=-d),b.moveBy(d+50,f+50))}finally{$.enable$$module$build$src$core$events$utils()}isEnabled$$module$build$src$core$events$utils()&&WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(b);\nb.select();return b}refreshToolboxSelection(){const a=this.isFlyout?this.targetWorkspace:this;a&&!a.currentGesture_&&a.toolbox_&&a.toolbox_.getFlyout()&&a.toolbox_.refreshSelection()}renameVariableById(a,b){super.renameVariableById(a,b);this.refreshToolboxSelection()}deleteVariableById(a){super.deleteVariableById(a);this.refreshToolboxSelection()}createVariable(a,b,c){a=super.createVariable(a,b,c);this.refreshToolboxSelection();return a}recordDragTargets(){const a=this.componentManager.getComponents(ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET,\n!0);this.dragTargetAreas=[];for(let b=0,c;c=a[b];b++){const d=c.getClientRect();d&&this.dragTargetAreas.push({component:c,clientRect:d})}}newBlock(a,b){throw Error(\"The implementation of newBlock should be monkey-patched in by blockly.ts\");}getDragTarget(a){for(let b=0,c;c=this.dragTargetAreas[b];b++)if(c.clientRect.contains(a.clientX,a.clientY))return c.component;return null}onMouseDown_(a){const b=this.getGesture(a);b&&b.handleWsStart(a,this)}startDrag(a,b){a=mouseToSvg$$module$build$src$core$browser_events(a,\nthis.getParentSvg(),this.getInverseScreenCTM());a.x/=this.scale;a.y/=this.scale;this.dragDeltaXY=Coordinate$$module$build$src$core$utils$coordinate.difference(b,a)}moveDrag(a){a=mouseToSvg$$module$build$src$core$browser_events(a,this.getParentSvg(),this.getInverseScreenCTM());a.x/=this.scale;a.y/=this.scale;return Coordinate$$module$build$src$core$utils$coordinate.sum(this.dragDeltaXY,a)}isDragging(){return null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&\nthis.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const a=!!this.scrollbar;\nreturn this.isMovable()&&(!a||a&&this.scrollbar.canScrollVertically())}onMouseWheel_(a){if(Gesture$$module$build$src$core$gesture.inProgress())a.preventDefault(),a.stopPropagation();else{var b=this.options.zoomOptions&&this.options.zoomOptions.wheel,c=this.options.moveOptions&&this.options.moveOptions.wheel;if(b||c){var d=getScrollDeltaPixels$$module$build$src$core$browser_events(a);if(MAC$$module$build$src$core$utils$useragent)var e=a.metaKey;b&&(a.ctrlKey||e||!c)?(d=-d.y/50,b=mouseToSvg$$module$build$src$core$browser_events(a,\nthis.getParentSvg(),this.getInverseScreenCTM()),this.zoom(b.x,b.y,d)):(b=this.scrollX-d.x,c=this.scrollY-d.y,a.shiftKey&&!d.x&&(b=this.scrollX-d.y,c=this.scrollY),this.scroll(b,c));a.preventDefault()}}}getBlocksBoundingBox(){const a=this.getTopBoundedElements();if(!a.length)return new Rect$$module$build$src$core$utils$rect(0,0,0,0);const b=a[0].getBoundingRectangle();for(let d=1;d<a.length;d++){var c=a[d];c.isInsertionMarker&&c.isInsertionMarker()||(c=c.getBoundingRectangle(),c.top<b.top&&(b.top=\nc.top),c.bottom>b.bottom&&(b.bottom=c.bottom),c.left<b.left&&(b.left=c.left),c.right>b.right&&(b.right=c.right))}return b}cleanUp(){this.setResizesEnabled(!1);$.setGroup$$module$build$src$core$events$utils(!0);const a=this.getTopBlocks(!0);let b=0;for(let c=0,d;d=a[c];c++){if(!d.isMovable())continue;const e=d.getRelativeToSurfaceXY();d.moveBy(-e.x,b-e.y,[\"cleanup\"]);d.snapToGrid();b=d.getRelativeToSurfaceXY().y+d.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}$.setGroup$$module$build$src$core$events$utils(!1);\nthis.setResizesEnabled(!0)}showContextMenu(a){if(!this.options.readOnly&&!this.isFlyout){var b=ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.getContextMenuOptions(ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(b,a);show$$module$build$src$core$contextmenu(a,b,this.RTL)}}updateToolbox(a){if(a=convertToolboxDefToJson$$module$build$src$core$utils$toolbox(a)){if(!this.options.languageTree)throw Error(\"Existing toolbox is null.  Can't create new toolbox.\");\nif(hasCategories$$module$build$src$core$utils$toolbox(a)){if(!this.toolbox_)throw Error(\"Existing toolbox has no categories.  Can't change mode.\");this.options.languageTree=a;this.toolbox_.render(a)}else{if(!this.flyout)throw Error(\"Existing toolbox has categories.  Can't change mode.\");this.options.languageTree=a;this.flyout.show(a)}}else if(this.options.languageTree)throw Error(\"Can't nullify an existing toolbox.\");}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():\n(setMainWorkspace$$module$build$src$core$common(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(a,b,c){c=Math.pow(this.options.zoomOptions.scaleSpeed,c);const d=this.scale*c;if(this.scale!==d){d>this.options.zoomOptions.maxScale?c=this.options.zoomOptions.maxScale/this.scale:d<this.options.zoomOptions.minScale&&(c=this.options.zoomOptions.minScale/this.scale);var e=this.getCanvas().getCTM(),f=this.getParentSvg().createSVGPoint();f.x=a;f.y=b;f=f.matrixTransform(e.inverse());a=f.x;b=f.y;e=\ne.translate(a*(1-c),b*(1-c)).scale(c);this.scrollX=e.e;this.scrollY=e.f;this.setScale(d)}}zoomCenter(a){var b=this.getMetrics();let c;this.flyout?(c=b.svgWidth?b.svgWidth/2:0,b=b.svgHeight?b.svgHeight/2:0):(c=b.viewWidth/2+b.absoluteLeft,b=b.viewHeight/2+b.absoluteTop);this.zoom(c,b,a)}zoomToFit(){if(this.isMovable()){var a=this.getMetrics(),b=a.viewWidth;a=a.viewHeight;var c=this.getBlocksBoundingBox(),d=2*ZOOM_TO_FIT_MARGIN$$module$build$src$core$workspace_svg,e=c.right-c.left+d;c=c.bottom-c.top+\nd;if(e){this.flyout&&(this.horizontalLayout?(a+=this.flyout.getHeight(),c+=this.flyout.getHeight()/this.scale):(b+=this.flyout.getWidth(),e+=this.flyout.getWidth()/this.scale));b/=e;a/=c;$.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(b,a)),this.scrollCenter()}finally{$.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn(\"Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.\")}beginCanvasTransition(){addClass$$module$build$src$core$utils$dom(this.getCanvas(),\n\"blocklyCanvasTransitioning\");addClass$$module$build$src$core$utils$dom(this.getBubbleCanvas(),\"blocklyCanvasTransitioning\")}endCanvasTransition(){removeClass$$module$build$src$core$utils$dom(this.getCanvas(),\"blocklyCanvasTransitioning\");removeClass$$module$build$src$core$utils$dom(this.getBubbleCanvas(),\"blocklyCanvasTransitioning\")}scrollCenter(){if(this.isMovable()){var a=this.getMetrics(),b=(a.scrollWidth-a.viewWidth)/2,c=(a.scrollHeight-a.viewHeight)/2;b=-b-a.scrollLeft;c=-c-a.scrollTop;this.scroll(b,\nc)}else console.warn(\"Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.\")}centerOnBlock(a,b){if(this.isMovable()){var c=a?this.getBlockById(a):null;if(c){a=c.getRelativeToSurfaceXY();c=b?{height:c.height,width:c.width}:c.getHeightWidth();var d=this.scale;b=(a.x+(this.RTL?-1:1)*c.width/2)*d;a=(a.y+c.height/2)*d;c=this.getMetrics();this.scroll(-(b-c.viewWidth/2),-(a-c.viewHeight/2))}}else console.warn(\"Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.\")}setScale(a){this.options.zoomOptions.maxScale&&\na>this.options.zoomOptions.maxScale?a=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&a<this.options.zoomOptions.minScale&&(a=this.options.zoomOptions.minScale);this.scale=a;this.hideChaff(!1);(a=this.getFlyout(!1))&&a.isVisible()&&(a.reflow(),this.recordDragTargets());this.grid&&this.grid.update(this.scale);a=this.getMetrics();this.scrollX-=a.absoluteLeft;this.scrollY-=a.absoluteTop;a.viewLeft+=a.absoluteLeft;a.viewTop+=a.absoluteTop;this.scroll(this.scrollX,this.scrollY);this.scrollbar&&\n(this.flyout?this.scrollbar.resizeView(a):this.scrollbar.resizeContent(a))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(a,b){this.hideChaff(!0);const c=this.getMetrics();a=Math.min(a,-c.scrollLeft);b=Math.min(b,-c.scrollTop);const d=c.scrollTop+Math.max(0,c.scrollHeight-c.viewHeight);a=Math.max(a,-(c.scrollLeft+Math.max(0,c.scrollWidth-c.viewWidth)));b=Math.max(b,-d);this.scrollX=a;this.scrollY=b;this.scrollbar&&this.scrollbar.set(-(a+c.scrollLeft),\n-(b+c.scrollTop),!1);a+=c.absoluteLeft;b+=c.absoluteTop;this.translate(a,b)}getBlockById(a){return super.getBlockById(a)}getAllBlocks(a=!1){return super.getAllBlocks(a)}getTopBlocks(a=!1){return super.getTopBlocks(a)}addTopBlock(a){this.addTopBoundedElement(a);super.addTopBlock(a)}removeTopBlock(a){this.removeTopBoundedElement(a);super.removeTopBlock(a)}addTopComment(a){this.addTopBoundedElement(a);super.addTopComment(a)}removeTopComment(a){this.removeTopBoundedElement(a);super.removeTopComment(a)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(a){this.topBoundedElements.push(a)}removeTopBoundedElement(a){removeElem$$module$build$src$core$utils$array(this.topBoundedElements,\na)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(a){const b=!this.resizesEnabled&&a;this.resizesEnabled=a;b&&this.resizeContents()}clear(){this.setResizesEnabled(!1);super.clear();this.topBoundedElements=[];this.setResizesEnabled(!0)}registerButtonCallback(a,b){if(\"function\"!==typeof b)throw TypeError(\"Button callbacks must be functions.\");this.flyoutButtonCallbacks.set(a,b)}getButtonCallback(a){let b;return null!=(b=this.flyoutButtonCallbacks.get(a))?b:null}removeButtonCallback(a){this.flyoutButtonCallbacks.delete(a)}registerToolboxCategoryCallback(a,\nb){if(\"function\"!==typeof b)throw TypeError(\"Toolbox category callbacks must be functions.\");this.toolboxCategoryCallbacks.set(a,b)}getToolboxCategoryCallback(a){return this.toolboxCategoryCallbacks.get(a)||null}removeToolboxCategoryCallback(a){this.toolboxCategoryCallbacks.delete(a)}getGesture(a){const b=\"pointerdown\"===a.type,c=this.currentGesture_;return c?b&&c.hasStarted()?(console.warn(\"Tried to start the same gesture twice.\"),c.cancel(),null):c:b?this.currentGesture_=new Gesture$$module$build$src$core$gesture(a,\nthis):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(a=!1){hide$$module$build$src$core$tooltip();hide$$module$build$src$core$widgetdiv();hideWithoutAnimation$$module$build$src$core$dropdowndiv();this.hideComponents(a)}hideComponents(a=!1){this.getComponentManager().getComponents(ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,\n!0).forEach(b=>b.autoHide(a))}static setTopLevelWorkspaceMetrics_(a){const b=this.getMetrics();\"number\"===typeof a.x&&(this.scrollX=-(b.scrollLeft+(b.scrollWidth-b.viewWidth)*a.x));\"number\"===typeof a.y&&(this.scrollY=-(b.scrollTop+(b.scrollHeight-b.viewHeight)*a.y));this.translate(this.scrollX+b.absoluteLeft,this.scrollY+b.absoluteTop)}},module$build$src$core$workspace_svg={};module$build$src$core$workspace_svg.WorkspaceSvg=WorkspaceSvg$$module$build$src$core$workspace_svg;\nmodule$build$src$core$workspace_svg.resizeSvgContents=resizeSvgContents$$module$build$src$core$workspace_svg;var TrashcanOpen$$module$build$src$core$events$events_trashcan_open=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b){super(b);this.type=TRASHCAN_OPEN$$module$build$src$core$events$utils;this.isOpen=a}toJson(){const a=super.toJson();if(void 0===this.isOpen)throw Error(\"Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson\");a.isOpen=this.isOpen;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new TrashcanOpen$$module$build$src$core$events$events_trashcan_open);\nb.isOpen=a.isOpen;return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,TRASHCAN_OPEN$$module$build$src$core$events$utils,TrashcanOpen$$module$build$src$core$events$events_trashcan_open);var module$build$src$core$events$events_trashcan_open={};module$build$src$core$events$events_trashcan_open.TrashcanOpen=TrashcanOpen$$module$build$src$core$events$events_trashcan_open;var BlockDelete$$module$build$src$core$events$events_block_delete=class extends BlockBase$$module$build$src$core$events$events_block_base{constructor(a){super(a);this.type=$.DELETE$$module$build$src$core$events$utils;if(a){if(a.getParent())throw Error(\"Connected blocks cannot be deleted.\");a.isShadow()&&(this.recordUndo=!1);this.oldXml=blockToDomWithXY$$module$build$src$core$xml(a);this.ids=getDescendantIds$$module$build$src$core$events$utils(a);this.wasShadow=a.isShadow();this.oldJson=save$$module$build$src$core$serialization$blocks(a,\n{addCoordinates:!0})}}toJson(){const a=super.toJson();if(!this.oldXml)throw Error(\"The old block XML is undefined. Either pass a block to the constructor, or call fromJson\");if(!this.ids)throw Error(\"The block IDs are undefined. Either pass a block to the constructor, or call fromJson\");if(void 0===this.wasShadow)throw Error(\"Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson\");if(!this.oldJson)throw Error(\"The old block JSON is undefined. Either pass a block to the constructor, or call fromJson\");\na.oldXml=domToText$$module$build$src$core$xml(this.oldXml);a.ids=this.ids;a.wasShadow=this.wasShadow;a.oldJson=this.oldJson;this.recordUndo||(a.recordUndo=this.recordUndo);return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockDelete$$module$build$src$core$events$events_block_delete);b.oldXml=$.textToDom$$module$build$src$core$utils$xml(a.oldXml);b.ids=a.ids;b.wasShadow=a.wasShadow||\"shadow\"===b.oldXml.tagName.toLowerCase();b.oldJson=a.oldJson;void 0!==a.recordUndo&&(b.recordUndo=\na.recordUndo);return b}run(a){const b=this.getEventWorkspace_();if(!this.ids)throw Error(\"The block IDs are undefined. Either pass a block to the constructor, or call fromJson\");if(!this.oldJson)throw Error(\"The old block JSON is undefined. Either pass a block to the constructor, or call fromJson\");if(a)for(a=0;a<this.ids.length;a++){const c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn(\"Can't delete non-existent block: \"+c)}else append$$module$build$src$core$serialization$blocks(this.oldJson,\nb)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,$.DELETE$$module$build$src$core$events$utils,BlockDelete$$module$build$src$core$events$events_block_delete);var module$build$src$core$events$events_block_delete={};module$build$src$core$events$events_block_delete.BlockDelete=BlockDelete$$module$build$src$core$events$events_block_delete;var Block$$module$build$src$core$block=class{constructor(a,b,c){this.data=null;this.disposed=!1;this.hue_=null;this.colour_=\"#000000\";this.styleName_=\"\";this.suppressPrefixSuffix=!1;this.previousConnection=this.nextConnection=this.outputConnection=null;this.inputList=[];this.icons=[];this.disabled=!1;this.tooltip=\"\";this.contextMenu=!0;this.parentBlock_=null;this.childBlocks_=[];this.editable_=this.movable_=this.deletable_=!0;this.collapsed_=this.isShadow_=!1;this.outputShape_=null;this.isInsertionMarker_=\nthis.disposing=!1;this.onchangeWrapper_=this.helpUrl=this.rendered=null;this.statementInputCount=0;this.workspace=a;this.id=c&&!a.getBlockById(c)?c:genUid$$module$build$src$core$utils$idgenerator();a.setBlockById(this.id,this);this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.isInFlyout=a.isFlyout;this.isInMutator=a.isMutator;this.RTL=a.RTL;if(b){this.type=b;c=Blocks$$module$build$src$core$blocks[b];if(!c||\"object\"!==typeof c)throw TypeError(\"Invalid block definition for type: \"+\nb);Object.assign(this,c)}a.addTopBlock(this);a.addTypedBlock(this);new.target===Block$$module$build$src$core$block&&this.doInit_()}doInit_(){const a=$.getGroup$$module$build$src$core$events$utils();a||$.setGroup$$module$build$src$core$events$utils(!0);const b=getRecordUndo$$module$build$src$core$events$utils();try{\"function\"===typeof this.init&&(setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),setRecordUndo$$module$build$src$core$events$utils(b)),isEnabled$$module$build$src$core$events$utils()&&\nfire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(this))}finally{$.setGroup$$module$build$src$core$events$utils(a),setRecordUndo$$module$build$src$core$events$utils(b)}this.inputsInlineDefault=this.inputsInline;\"function\"===typeof this.onchange&&this.setOnChange(this.onchange)}dispose(a){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(a),isEnabled$$module$build$src$core$events$utils()&&\nfire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal())}disposeInternal(){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0,\"function\"===typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(a=>a.disposeInternal()),\nthis.inputList.forEach(a=>a.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(a=>a.dispose()),this.disposed=!0)}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(const a of this.inputList)for(const b of a.fieldRow)b.initModel&&b.initModel()}unplug(a){this.outputConnection&&this.unplugFromRow_(a);this.previousConnection&&this.unplugFromStack_(a)}unplugFromRow_(a){let b=null,c;if(null==(c=this.outputConnection)?0:c.isConnected())b=this.outputConnection.targetConnection,\nthis.outputConnection.disconnect();b&&a&&(a=this.getOnlyValueConnection_())&&a.isConnected()&&!a.targetBlock().isShadow()&&(a=a.targetConnection,null==a||a.disconnect(),this.workspace.connectionChecker.canConnect(a,b,!1)?b.connect(a):null==a||a.onFailedConnect(b))}getOnlyValueConnection_(){let a=null;for(let b=0;b<this.inputList.length;b++){const c=this.inputList[b].connection;if(c&&c.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&c.targetConnection){if(a)return null;a=\nc}}return a}unplugFromStack_(a){let b=null;var c;if(null==(c=this.previousConnection)?0:c.isConnected())b=this.previousConnection.targetConnection,this.previousConnection.disconnect();c=this.getNextBlock();if(a&&c&&!c.isShadow()){let d,e;a=null!=(e=null==(d=this.nextConnection)?void 0:d.targetConnection)?e:null;null==a||a.disconnect();b&&this.workspace.connectionChecker.canConnect(b,a,!1)&&b.connect(a)}}getConnections_(a){a=[];this.outputConnection&&a.push(this.outputConnection);this.previousConnection&&\na.push(this.previousConnection);this.nextConnection&&a.push(this.nextConnection);for(let b=0,c;c=this.inputList[b];b++)c.connection&&a.push(c.connection);return a}lastConnectionInStack(a){let b=this.nextConnection;for(;b;){const c=b.targetBlock();if(!c||a&&c.isShadow())return b;b=c.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(a){for(let b=0,c;c=this.inputList[b];b++)if(c.connection&&c.connection.targetBlock()===a)return c;return null}getSurroundParent(){let a=\nthis,b;do if(b=a,a=a.getParent(),!a)return null;while(a.getNextBlock()===b);return a}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let a,b=this;do a=b,b=a.parentBlock_;while(b);return a}getTopStackBlock(){let a=this,b;do b=a.getPreviousBlock();while(b&&b.getNextBlock()===a&&(a=b));return a}getChildren(a){if(!a)return this.childBlocks_;a=[];for(let c=0,d;d=this.inputList[c];c++)if(d.connection){var b=\nd.connection.targetBlock();b&&a.push(b)}(b=this.getNextBlock())&&a.push(b);return a}setParent(a){if(a!==this.parentBlock_){var b=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),c=!!b;if(c&&a&&b!==a)throw Error(\"Block connected to superior one that is not new parent.\");if(!c&&a)throw Error(\"Block not connected to new parent.\");if(c&&!a)throw Error(\"Cannot set parent to null while block is still connected to superior block.\");\nthis.parentBlock_?removeElem$$module$build$src$core$utils$array(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this);(this.parentBlock_=a)?a.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(a){const b=[this],c=this.getChildren(a);for(let d,e=0;d=c[e];e++)b.push(...d.getDescendants(a));return b}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(a){this.deletable_=\na}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(a){this.movable_=a}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(getBlockTypeCounts$$module$build$src$core$common(this,!0)):!0}isShadow(){return this.isShadow_}setShadow(a){this.isShadow_=a}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(a){this.isInsertionMarker_=a}isEditable(){return this.editable_&&\n!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(a){this.editable_=a;for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)e.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const a of this.inputList)if(a.connection||1<a.fieldRow.length)return!1;return!0}getMatchingConnection(a,b){const c=this.getConnections_(!0);a=a.getConnections_(!0);if(c.length!==a.length)throw Error(\"Connection lists did not match in length.\");\nfor(let d=0;d<a.length;d++)if(a[d]===b)return c[d];return null}setHelpUrl(a){this.helpUrl=a}setTooltip(a){this.tooltip=a}getTooltip(){return getTooltipOfObject$$module$build$src$core$tooltip(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(a){a=parseBlockColour$$module$build$src$core$utils$parsing(a);this.hue_=a.hue;this.colour_=a.hex}setStyle(a){this.styleName_=a}setOnChange(a){if(a&&\"function\"!==typeof a)throw Error(\"onchange must be a function.\");\nthis.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_);this.onchange=a;this.onchangeWrapper_=a.bind(this);this.workspace.addChangeListener(this.onchangeWrapper_)}getField(a){if(\"string\"!==typeof a)throw TypeError(\"Block.prototype.getField expects a string with the field name but received \"+(void 0===a?\"nothing\":a+\" of type \"+typeof a)+\" instead\");for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)if(e.name===a)return e;return null}getVars(){const a=\n[];for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)e.referencesVariables()&&a.push(e.getValue());return a}getVarModels(){const a=[];for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)if(e.referencesVariables()){const f=this.workspace.getVariableById(e.getValue());f&&a.push(f)}return a}updateVarName(a){for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)e.referencesVariables()&&a.getId()===e.getValue()&&e.refreshVariableName()}renameVarById(a,\nb){for(let c=0,d;d=this.inputList[c];c++)for(let e=0,f;f=d.fieldRow[e];e++)f.referencesVariables()&&a===f.getValue()&&f.setValue(b)}getFieldValue(a){return(a=this.getField(a))?a.getValue():null}setFieldValue(a,b){const c=this.getField(b);if(!c)throw Error('Field \"'+b+'\" not found.');c.setValue(a)}setPreviousStatement(a,b){if(a)void 0===b&&(b=null),this.previousConnection||(this.previousConnection=this.makeConnection_(ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(b);\nelse if(this.previousConnection){if(this.previousConnection.isConnected())throw Error(\"Must disconnect previous statement before removing connection.\");this.previousConnection.dispose();this.previousConnection=null}}setNextStatement(a,b){if(a)void 0===b&&(b=null),this.nextConnection||(this.nextConnection=this.makeConnection_(ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT)),this.nextConnection.setCheck(b);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error(\"Must disconnect next statement before removing connection.\");\nthis.nextConnection.dispose();this.nextConnection=null}}setOutput(a,b){if(a)void 0===b&&(b=null),this.outputConnection||(this.outputConnection=this.makeConnection_(ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE)),this.outputConnection.setCheck(b);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error(\"Must disconnect output value before removing connection.\");this.outputConnection.dispose();this.outputConnection=null}}setInputsInline(a){this.inputsInline!==\na&&(fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this,\"inline\",null,this.inputsInline,a)),this.inputsInline=a)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var a=1;a<this.inputList.length;a++)if(this.inputList[a-1]instanceof DummyInput$$module$build$src$core$inputs$dummy_input&&this.inputList[a]instanceof DummyInput$$module$build$src$core$inputs$dummy_input)return!1;for(a=1;a<this.inputList.length;a++)if(this.inputList[a-\n1]instanceof $.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[a]instanceof DummyInput$$module$build$src$core$inputs$dummy_input)return!0;for(a=0;a<this.inputList.length;a++)if(this.inputList[a]instanceof EndRowInput$$module$build$src$core$inputs$end_row_input)return!0;return!1}setOutputShape(a){this.outputShape_=a}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(a){if(this.isEnabled()!==a){const b=this.disabled;this.disabled=!a;fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this,\n\"disabled\",null,b,!a))}}getInheritedDisabled(){let a=this.getSurroundParent();for(;a;){if(a.disabled)return!0;a=a.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(a){this.collapsed_!==a&&(fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this,\"collapsed\",null,this.collapsed_,a)),this.collapsed_=a)}toString(a,b){b=this.toTokens(b);for(let d=2;d<b.length;d++)\"(\"===b[d-2]&&\")\"===b[d]&&(b[d-\n2]=b[d-1],b.splice(d-1,2));let c=\"\";b=b.reduce((d,e)=>{d=d+(\"(\"===c||\")\"===e?\"\":\" \")+e;c=e[e.length-1];return d},\"\");b=b.trim()||\"???\";a&&b.length>a&&(b=b.substring(0,a-3)+\"...\");return b}toTokens(a=\"?\"){const b=[];for(const d of this.inputList)if(d.name!=COLLAPSED_INPUT_NAME$$module$build$src$core$constants){for(const e of d.fieldRow)b.push(e.getText());if(d.connection){const e=d.connection.targetBlock();if(e){var c=d.connection;let f=c.getCheck();!f&&c.targetConnection&&(f=c.targetConnection.getCheck());\n(c=!!f&&(-1!==f.indexOf(\"Boolean\")||-1!==f.indexOf(\"Number\")))&&b.push(\"(\");b.push(...e.toTokens(a));c&&b.push(\")\")}else b.push(a)}}return b}appendValueInput(a){return this.appendInput(new $.ValueInput$$module$build$src$core$inputs$value_input(a,this))}appendStatementInput(a){this.statementInputCount++;return this.appendInput(new StatementInput$$module$build$src$core$inputs$statement_input(a,this))}appendDummyInput(a=\"\"){return this.appendInput(new DummyInput$$module$build$src$core$inputs$dummy_input(a,\nthis))}appendEndRowInput(a=\"\"){return this.appendInput(new EndRowInput$$module$build$src$core$inputs$end_row_input(a,this))}appendInput(a){this.inputList.push(a);return a}appendInputFromRegistry(a,b){return(a=getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.INPUT,a,!1))?this.appendInput(new a(b,this)):null}jsonInit(a){var b=a.type?'Block \"'+a.type+'\": ':\"\";if(a.output&&a.previousStatement)throw Error(b+\"Must not have both an output and a previousStatement.\");for(var c=\n0;a[\"args\"+c];){if(void 0===a[\"message\"+c])throw Error(b+`args${c} must have a corresponding message (message${c}).`);c++}a.style&&a.style.hat&&(this.hat=a.style.hat,a.style=null);if(a.style&&a.colour)throw Error(b+\"Must not have both a colour and a style.\");a.style?this.jsonInitStyle_(a,b):this.jsonInitColour_(a,b);for(c=0;void 0!==a[\"message\"+c];)this.interpolate_(a[\"message\"+c],a[\"args\"+c]||[],a[\"implicitAlign\"+c]||a[\"lastDummyAlign\"+c],b),c++;void 0!==a.inputsInline&&($.disable$$module$build$src$core$events$utils(),\nthis.setInputsInline(a.inputsInline),$.enable$$module$build$src$core$events$utils());void 0!==a.output&&this.setOutput(!0,a.output);void 0!==a.outputShape&&this.setOutputShape(a.outputShape);void 0!==a.previousStatement&&this.setPreviousStatement(!0,a.previousStatement);void 0!==a.nextStatement&&this.setNextStatement(!0,a.nextStatement);void 0!==a.tooltip&&(c=replaceMessageReferences$$module$build$src$core$utils$parsing(a.tooltip),this.setTooltip(c));void 0!==a.enableContextMenu&&(this.contextMenu=\n!!a.enableContextMenu);void 0!==a.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!a.suppressPrefixSuffix);void 0!==a.helpUrl&&(c=replaceMessageReferences$$module$build$src$core$utils$parsing(a.helpUrl),this.setHelpUrl(c));\"string\"===typeof a.extensions&&(console.warn(b+\"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '\"+a.type+\"' block.\"),a.extensions=[a.extensions]);void 0!==a.mutator&&apply$$module$build$src$core$extensions(a.mutator,this,!0);a=a.extensions;\nif(Array.isArray(a))for(b=0;b<a.length;b++)apply$$module$build$src$core$extensions(a[b],this,!1)}jsonInitColour_(a,b){if(\"colour\"in a)if(void 0===a.colour)console.warn(b+\"Undefined colour value.\");else{a=a.colour;try{this.setColour(a)}catch(c){console.warn(b+\"Illegal colour value: \",a)}}}jsonInitStyle_(a,b){a=a.style;try{this.setStyle(a)}catch(c){console.warn(b+\"Style does not exist: \",a)}}mixin(a,b){if(void 0!==b&&\"boolean\"!==typeof b)throw Error(\"opt_disableCheck must be a boolean if provided\");\nif(!b){b=[];for(const c in a)void 0!==this[c]&&b.push(c);if(b.length)throw Error(\"Mixin will overwrite block members: \"+JSON.stringify(b));}Object.assign(this,a)}interpolate_(a,b,c,d){a=tokenizeInterpolation$$module$build$src$core$utils$parsing(a);this.validateTokens_(a,b.length);b=this.interpolateArguments_(a,b,c);c=[];for(let e=0,f;f=b[e];e++)if(this.isInputKeyword_(f.type)){if(a=this.inputFromJson_(f,d)){for(let g=0,h;h=c[g];g++)a.appendField(h[0],h[1]);c.length=0}}else(a=this.fieldFromJson_(f))&&\nc.push([a,f.name])}validateTokens_(a,b){const c=[];let d=0;for(let e=0;e<a.length;e++){const f=a[e];if(\"number\"===typeof f){if(1>f||f>b)throw Error('Block \"'+this.type+'\": Message index %'+f+\" out of range.\");if(c[f])throw Error('Block \"'+this.type+'\": Message index %'+f+\" duplicated.\");c[f]=!0;d++}}if(d!==b)throw Error('Block \"'+this.type+'\": Message does not reference all '+b+\" arg(s).\");}interpolateArguments_(a,b,c){const d=[];for(let f=0;f<a.length;f++){var e=a[f];\"number\"===typeof e&&(e=b[e-\n1]);if(\"string\"===typeof e)if(\"\\n\"===e)e={type:\"input_end_row\"},c&&(e.align=c);else if(e=this.stringToFieldJson_(e),!e)continue;d.push(e)}(a=d.length)&&!this.isInputKeyword_(d[a-1].type)&&(a={type:\"input_dummy\"},c&&(a.align=c),d.push(a));return d}fieldFromJson_(a){const b=$.fromJson$$module$build$src$core$field_registry(a);return!b&&a.alt?\"string\"===typeof a.alt?(a=this.stringToFieldJson_(a.alt))?this.fieldFromJson_(a):null:this.fieldFromJson_(a.alt):b}inputFromJson_(a,b){var c={LEFT:$.Align$$module$build$src$core$inputs$align.LEFT,\nRIGHT:$.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:$.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:$.Align$$module$build$src$core$inputs$align.CENTRE};let d;switch(a.type){case \"input_value\":d=this.appendValueInput(a.name);break;case \"input_statement\":d=this.appendStatementInput(a.name);break;case \"input_dummy\":d=this.appendDummyInput(a.name);break;case \"input_end_row\":d=this.appendEndRowInput(a.name);break;default:d=this.appendInputFromRegistry(a.type,a.name)}if(!d)return null;\na.check&&d.setCheck(a.check);a.align&&(c=c[a.align.toUpperCase()],void 0===c?console.warn(b+\"Illegal align value: \",a.align):d.setAlign(c));return d}isInputKeyword_(a){return\"input_value\"===a||\"input_statement\"===a||\"input_dummy\"===a||\"input_end_row\"===a||hasItem$$module$build$src$core$registry(Type$$module$build$src$core$registry.INPUT,a)}stringToFieldJson_(a){return(a=a.trim())?{type:\"field_label\",text:a}:null}moveInputBefore(a,b){if(a!==b){var c=-1,d=b?-1:this.inputList.length;for(let e=0,f;f=\nthis.inputList[e];e++)if(f.name===a){if(c=e,-1!==d)break}else if(b&&f.name===b&&(d=e,-1!==c))break;if(-1===c)throw Error('Named input \"'+a+'\" not found.');if(-1===d)throw Error('Reference input \"'+b+'\" not found.');this.moveNumberedInputBefore(c,d)}}moveNumberedInputBefore(a,b){if(a===b)throw Error(\"Can't move input to itself.\");if(a>=this.inputList.length)throw RangeError(\"Input index \"+a+\" out of bounds.\");if(b>this.inputList.length)throw RangeError(\"Reference input \"+b+\" out of bounds.\");const c=\nthis.inputList[a];this.inputList.splice(a,1);a<b&&b--;this.inputList.splice(b,0,c)}removeInput(a,b){for(let c=0,d;d=this.inputList[c];c++)if(d.name===a)return d instanceof StatementInput$$module$build$src$core$inputs$statement_input&&this.statementInputCount--,d.dispose(),this.inputList.splice(c,1),!0;if(b)return!1;throw Error(\"Input not found: \"+a);}getInput(a){for(let b=0,c;c=this.inputList[b];b++)if(c.name===a)return c;return null}getInputTargetBlock(a){return(a=this.getInput(a))&&a.connection&&\na.connection.targetBlock()}getCommentText(){let a,b;return null!=(b=null==(a=this.getIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE))?void 0:a.getText())?b:null}setCommentText(a){var b;let c;const d=null!=(c=null==(b=this.getIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE))?void 0:b.getText())?c:null;d!==a&&(null!==a?((b=this.getIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE))||(b=this.addIcon(new CommentIcon$$module$build$src$core$icons$comment_icon(this))),\n$.disable$$module$build$src$core$events$utils(),b.setText(a),$.enable$$module$build$src$core$events$utils()):this.removeIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE),fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this,\"comment\",null,d,a)))}setWarningText(a,b){}setMutator(a){}addIcon(a){if(this.hasIcon(a.getType()))throw new DuplicateIconType$$module$build$src$core$icons$exceptions(a);this.icons.push(a);\nthis.icons.sort((b,c)=>b.getWeight()-c.getWeight());return a}removeIcon(a){if(!this.hasIcon(a))return!1;let b;null==(b=this.getIcon(a))||b.dispose();this.icons=this.icons.filter(c=>!c.getType().equals(a));return!0}hasIcon(a){return this.icons.some(b=>b.getType().equals(a))}getIcon(a){return a instanceof IconType$$module$build$src$core$icons$icon_types?this.icons.find(b=>b.getType().equals(a)):this.icons.find(b=>b.getType().toString()===a)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(a,\nb,c){if(this.parentBlock_)throw Error(\"Block has parent\");const d=new (get$$module$build$src$core$events$utils($.MOVE$$module$build$src$core$events$utils))(this);c&&d.setReason(c);this.xy_.translate(a,b);d.recordNew();fire$$module$build$src$core$events$utils(d)}makeConnection_(a){return new Connection$$module$build$src$core$connection(this,a)}allInputsFilled(a){void 0===a&&(a=!0);if(!a&&this.isShadow())return!1;for(let c=0,d;d=this.inputList[c];c++)if(d.connection){var b=d.connection.targetBlock();\nif(!b||!b.allInputsFilled(a))return!1}return(b=this.getNextBlock())?b.allInputsFilled(a):!0}toDevString(){let a=this.type?'\"'+this.type+'\" block':\"Block\";this.id&&(a+=' (id=\"'+this.id+'\")');return a}};Block$$module$build$src$core$block.COLLAPSED_INPUT_NAME=COLLAPSED_INPUT_NAME$$module$build$src$core$constants;Block$$module$build$src$core$block.COLLAPSED_FIELD_NAME=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;var module$build$src$core$block={};module$build$src$core$block.Block=Block$$module$build$src$core$block;var Marker$$module$build$src$core$keyboard_nav$marker=class{constructor(){this.drawer=this.curNode=this.colour=null;this.type=\"marker\"}setDrawer(a){this.drawer=a}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(a){const b=this.curNode;this.curNode=a;this.drawer&&this.drawer.draw(b,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},module$build$src$core$keyboard_nav$marker=\n{};module$build$src$core$keyboard_nav$marker.Marker=Marker$$module$build$src$core$keyboard_nav$marker;var Cursor$$module$build$src$core$keyboard_nav$cursor=class extends Marker$$module$build$src$core$keyboard_nav$marker{constructor(){super();this.type=\"cursor\"}next(){var a=this.getCurNode();if(!a)return null;for(a=a.next();a&&a.next()&&(a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT||a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK);)a=a.next();a&&this.setCurNode(a);return a}in(){var a=this.getCurNode();if(!a)return null;if(a.getType()===\nASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS||a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT)a=a.next();let b,c;(a=null!=(c=null==(b=a)?void 0:b.in())?c:null)&&this.setCurNode(a);return a}prev(){var a=this.getCurNode();if(!a)return null;for(a=a.prev();a&&a.prev()&&(a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT||a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK);)a=a.prev();a&&this.setCurNode(a);\nreturn a}out(){var a=this.getCurNode();if(!a)return null;(a=a.out())&&a.getType()===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK&&(a=a.prev()||a);a&&this.setCurNode(a);return a}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.CURSOR,DEFAULT$$module$build$src$core$registry,Cursor$$module$build$src$core$keyboard_nav$cursor);var module$build$src$core$keyboard_nav$cursor={};module$build$src$core$keyboard_nav$cursor.Cursor=Cursor$$module$build$src$core$keyboard_nav$cursor;var BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor=class extends Cursor$$module$build$src$core$keyboard_nav$cursor{constructor(){super()}next(){var a=this.getCurNode();if(!a)return null;(a=this.getNextNode_(a,this.validNode_))&&this.setCurNode(a);return a}in(){return this.next()}prev(){var a=this.getCurNode();if(!a)return null;(a=this.getPreviousNode_(a,this.validNode_))&&this.setCurNode(a);return a}out(){return this.prev()}getNextNode_(a,b){if(!a)return null;const c=a.in()||a.next();\nif(b(c))return c;if(c)return this.getNextNode_(c,b);a=this.findSiblingOrParent(a.out());return b(a)?a:a?this.getNextNode_(a,b):null}getPreviousNode_(a,b){if(!a)return null;let c=a.prev();c=c?this.getRightMostChild(c):a.out();return b(c)?c:c?this.getPreviousNode_(c,b):null}validNode_(a){let b=!1;a=a&&a.getType();if(a===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT||a===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT||a===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD||\na===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT||a===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS||a===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE)b=!0;return b}findSiblingOrParent(a){if(!a)return null;const b=a.next();return b?b:this.findSiblingOrParent(a.out())}getRightMostChild(a){if(!a.in())return a;for(a=a.in();a&&a.next();)a=a.next();return this.getRightMostChild(a)}};\nBasicCursor$$module$build$src$core$keyboard_nav$basic_cursor.registrationName=\"basicCursor\";register$$module$build$src$core$registry(Type$$module$build$src$core$registry.CURSOR,BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor.registrationName,BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor);var module$build$src$core$keyboard_nav$basic_cursor={};module$build$src$core$keyboard_nav$basic_cursor.BasicCursor=BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor;var TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor=class extends BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor{validNode_(a){let b=!1;const c=a&&a.getType();a&&(a=a.getLocation(),c===ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD&&a&&a.isTabNavigable()&&a.isClickable()&&(b=!0));return b}},module$build$src$core$keyboard_nav$tab_navigate_cursor={};module$build$src$core$keyboard_nav$tab_navigate_cursor.TabNavigateCursor=TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor;var BUMP_RANDOMNESS$$module$build$src$core$rendered_connection=10,RenderedConnection$$module$build$src$core$rendered_connection=class extends Connection$$module$build$src$core$connection{constructor(a,b){super(a,b);this.targetConnection=this.highlightPath=null;this.db=a.workspace.connectionDBList[b];this.dbOpposite=a.workspace.connectionDBList[OPPOSITE_TYPE$$module$build$src$core$internal_constants[b]];this.offsetInBlock=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.trackedState=\nRenderedConnection$$module$build$src$core$rendered_connection.TrackedState.WILL_TRACK}dispose(){super.dispose();this.trackedState===RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED&&this.db.removeConnection(this,this.y);this.highlightPath&&(removeNode$$module$build$src$core$utils$dom(this.highlightPath),this.highlightPath=null)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(a){const b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*\nb+a*a)}bumpAwayFrom(a){if(!this.sourceBlock_.workspace.isDragging()){var b=this.sourceBlock_.getRootBlock();if(!b.isInFlyout){var c=!1;if(!b.isMovable()){b=a.getSourceBlock().getRootBlock();if(!b.isMovable())return;a=this;c=!0}var d=getSelected$$module$build$src$core$common()==b;d||b.addSelect();var e=a.x+$.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*BUMP_RANDOMNESS$$module$build$src$core$rendered_connection)-this.x,f=a.y+$.config$$module$build$src$core$config.snapRadius+\nMath.floor(Math.random()*BUMP_RANDOMNESS$$module$build$src$core$rendered_connection)-this.y;c&&(f=-f);b.RTL&&(e=a.x-$.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*BUMP_RANDOMNESS$$module$build$src$core$rendered_connection)-this.x);b.moveBy(e,f,[\"bump\"]);d||b.removeSelect()}}}moveTo(a,b){let c=!1;this.trackedState===RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.WILL_TRACK?(this.db.addConnection(this,b),this.trackedState=RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED,\nc=!0):this.trackedState===RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,b),c=!0);this.x=a;this.y=b;return c}moveBy(a,b){return this.moveTo(this.x+a,this.y+b)}moveToOffset(a){return this.moveTo(a.x+this.offsetInBlock.x,a.y+this.offsetInBlock.y)}setOffsetInBlock(a,b){this.offsetInBlock.x=a;this.offsetInBlock.y=b}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var a=this.targetConnection;\nconst b=this.targetBlock();a&&b&&(a=Coordinate$$module$build$src$core$utils$coordinate.difference(this.offsetInBlock,a.offsetInBlock),b.translate(a.x,a.y))}closest(a,b){return this.dbOpposite.searchForClosest(this,a,b)}highlight(){if(!this.highlightPath){var a=this.sourceBlock_.workspace.getRenderer().getConstants();var b=a.shapeFor(this);this.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||this.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?(a=\na.TAB_OFFSET_FROM_TOP,b=moveBy$$module$build$src$core$utils$svg_paths(0,-a)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a)+b.pathDown+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a)):(a=a.NOTCH_OFFSET_LEFT-a.CORNER_RADIUS,b=moveBy$$module$build$src$core$utils$svg_paths(-a,0)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",a)+b.pathLeft+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",a));a=this.offsetInBlock;this.highlightPath=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,\n{\"class\":\"blocklyHighlightedConnectionPath\",d:b,transform:`translate(${a.x}, ${a.y})`+(this.sourceBlock_.RTL?\" scale(-1 1)\":\"\")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(removeNode$$module$build$src$core$utils$dom(this.highlightPath),this.highlightPath=null)}setTracking(a){a&&this.trackedState===RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED||!a&&this.trackedState===RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.UNTRACKED||\nthis.sourceBlock_.isInFlyout||(a?(this.db.addConnection(this,this.y),this.trackedState=RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED):(this.trackedState===RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.UNTRACKED))}stopTrackingAll(){this.setTracking(!1);if(this.targetConnection){const a=this.targetBlock().getDescendants(!1);\nfor(let b=0;b<a.length;b++){const c=a[b],d=c.getConnections_(!0);for(let e=0;e<d.length;e++)d[e].setTracking(!1);for(const e of c.getIcons())hasBubble$$module$build$src$core$interfaces$i_has_bubble(e)&&e.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let a=[];if(this.type!==ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&this.type!==ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT)return a;const b=this.targetBlock();if(b){let c;b.isCollapsed()?\n(c=[],b.outputConnection&&c.push(b.outputConnection),b.nextConnection&&c.push(b.nextConnection),b.previousConnection&&c.push(b.previousConnection)):c=b.getConnections_(!0);for(let d=0;d<c.length;d++)a.push(...c[d].startTrackingAll());a.length||(a=[b])}return a}onFailedConnect(a){const b=this.getSourceBlock();if(getRecordUndo$$module$build$src$core$events$utils()){const c=$.getGroup$$module$build$src$core$events$utils();setTimeout(function(){b.isDisposed()||b.getParent()||($.setGroup$$module$build$src$core$events$utils(c),\nthis.bumpAwayFrom(a),$.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),$.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(a=!0){const {parentConnection:b,childConnection:c}=this.getParentAndChildConnections();if(b&&c){var d=b.getSourceBlock(),e=c.getSourceBlock();super.disconnectInternal(a);d.rendered&&d.queueRender();e.rendered&&(e.updateDisabled(),e.queueRender(),e.getSvgRoot().style.display=\"block\")}}respawnShadow_(){super.respawnShadow_();const a=this.targetBlock();\na&&(a.initSvg(),a.queueRender())}neighbours(a){return this.dbOpposite.getNeighbours(this,a)}connect_(a){super.connect_(a);var b=this.getSourceBlock();a=a.getSourceBlock();const c=b.rendered,d=a.rendered;c&&b.updateDisabled();d&&a.updateDisabled();c&&d&&(this.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT||this.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT?a.queueRender():b.queueRender());if(b=b.getInputWithBlock(a))b=b.isVisible(),a.getSvgRoot().style.display=\nb?\"block\":\"none\"}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}setCheck(a){super.setCheck(a);this.sourceBlock_.rendered&&this.sourceBlock_.queueRender();return this}};\n(function(a){a=a.TrackedState||(a.TrackedState={});a[a.WILL_TRACK=-1]=\"WILL_TRACK\";a[a.UNTRACKED=0]=\"UNTRACKED\";a[a.TRACKED=1]=\"TRACKED\"})(RenderedConnection$$module$build$src$core$rendered_connection||(RenderedConnection$$module$build$src$core$rendered_connection={}));var TrackedState$$module$build$src$core$rendered_connection=RenderedConnection$$module$build$src$core$rendered_connection.TrackedState,module$build$src$core$rendered_connection={};\nmodule$build$src$core$rendered_connection.RenderedConnection=RenderedConnection$$module$build$src$core$rendered_connection;module$build$src$core$rendered_connection.TrackedState=TrackedState$$module$build$src$core$rendered_connection;var BlockSvg$$module$build$src$core$block_svg=class extends Block$$module$build$src$core$block{constructor(a,b,c){super(a,b,c);this.width=this.height=0;this.warningTextDb=new Map;this.warning=this.mutator=null;this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=this.rendered=!1;this.translation=\"\";this.bumpNeighboursPid=0;this.dragging=!1;this.relativeCoords=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.workspace=a;this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,\n{});this.style=a.getRenderer().getConstants().getBlockStyle(null);this.pathObject=a.getRenderer().makePathObject(this.svgGroup_,this.style);a=this.pathObject.svgPath;a.tooltip=this;bindMouseEvents$$module$build$src$core$tooltip(a);this.svgGroup_.setAttribute(\"data-id\",this.id);this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError(\"Workspace is headless.\");for(let b=0,c;c=this.inputList[b];b++)c.init();for(var a of this.getIcons())a.initView(this.createIconPointerDownListener(a)),a.updateEditable();\nthis.applyColour();this.pathObject.updateMovable(this.isMovable());a=this.getSvgRoot();this.workspace.options.readOnly||this.eventsInit_||!a||conditionalBind$$module$build$src$core$browser_events(a,\"pointerdown\",this,this.onMouseDown_);this.eventsInit_=!0;a.parentNode||this.workspace.getCanvas().appendChild(a)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(getSelected$$module$build$src$core$common()!==\nthis){var a=null;if(getSelected$$module$build$src$core$common()){a=getSelected$$module$build$src$core$common().id;$.disable$$module$build$src$core$events$utils();try{getSelected$$module$build$src$core$common().unselect()}finally{$.enable$$module$build$src$core$events$utils()}}a=new (get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(a,this.id,this.workspace.id);fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(this);this.addSelect()}}unselect(){if(getSelected$$module$build$src$core$common()===\nthis){var a=new (get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(this.id,null,this.workspace.id);a.workspaceId=this.workspace.id;fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(null);this.removeSelect()}}setParent(a){const b=this.parentBlock_;if(a!==b){startTextWidthCache$$module$build$src$core$utils$dom();super.setParent(a);stopTextWidthCache$$module$build$src$core$utils$dom();var c=this.getSvgRoot();if(!this.workspace.isClearing&&\nc){var d=this.getRelativeToSurfaceXY();a?a.getSvgRoot().appendChild(c):b&&((a=this.workspace.getCanvas().querySelector(\".blocklyDragging\"))?this.workspace.getCanvas().insertBefore(c,a):this.workspace.getCanvas().appendChild(c),this.translate(d.x,d.y));this.applyColour()}}}getRelativeToSurfaceXY(){const a=this.workspace.getLayerManager();if(!a)throw Error(\"Cannot calculate position because the workspace has not been appended\");let b=0,c=0,d=this.getSvgRoot();if(d){do{const e=getRelativeXY$$module$build$src$core$utils$svg_math(d);\nb+=e.x;c+=e.y;d=d.parentNode}while(d&&!a.hasLayer(d))}return new Coordinate$$module$build$src$core$utils$coordinate(b,c)}moveBy(a,b,c){if(this.parentBlock_)throw Error(\"Block has parent\");const d=isEnabled$$module$build$src$core$events$utils();let e=null;d&&(e=new (get$$module$build$src$core$events$utils($.MOVE$$module$build$src$core$events$utils))(this),c&&e.setReason(c));a=new Coordinate$$module$build$src$core$utils$coordinate(a,b);b=this.getRelativeToSurfaceXY();a=Coordinate$$module$build$src$core$utils$coordinate.sum(b,\na);this.translate(a.x,a.y);this.updateComponentLocations(a);d&&e&&(e.recordNew(),fire$$module$build$src$core$events$utils(e));this.workspace.resizeContents()}translate(a,b){this.translation=`translate(${a}, ${b})`;this.relativeCoords=new Coordinate$$module$build$src$core$utils$coordinate(a,b);this.getSvgRoot().setAttribute(\"transform\",this.getTranslation())}getTranslation(){return this.translation}moveTo(a,b){const c=this.getRelativeToSurfaceXY();this.moveBy(a.x-c.x,a.y-c.y,b)}moveDuringDrag(a){this.translate(a.x,\na.y);this.getSvgRoot().setAttribute(\"transform\",this.getTranslation());this.updateComponentLocations(a)}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var a=this.workspace.getGrid();if(a&&a.shouldSnap()){var b=a.getSpacing(),c=b/2,d=this.getRelativeToSurfaceXY();a=Math.round(Math.round((d.x-c)/b)*b+c-d.x);b=Math.round(Math.round((d.y-c)/b)*b+c-d.y);(a||b)&&this.moveBy(a,b,[\"snap\"])}}}getBoundingRectangle(){const a=this.getRelativeToSurfaceXY(),\nb=this.getHeightWidth();let c,d;this.RTL?(c=a.x-b.width,d=a.x):(c=a.x,d=a.x+b.width);return new Rect$$module$build$src$core$utils$rect(a.y,a.y+b.height,c,d)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let a=0,b;b=this.inputList[a];a++)b.markDirty()}setCollapsed(a){this.collapsed_!==a&&(super.setCollapsed(a),this.updateCollapsed_())}updateCollapsed_(){var a=this.isCollapsed();const b=COLLAPSED_INPUT_NAME$$module$build$src$core$constants,c=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;\nfor(let e=0,f;f=this.inputList[e];e++)f.name!==b&&f.setVisible(!a);for(var d of this.getIcons())d.updateCollapsed();a?(a=this.toString(COLLAPSE_CHARS$$module$build$src$core$internal_constants),(d=this.getField(c))?d.setValue(a):(this.getInput(b)||this.appendDummyInput(b)).appendField(new FieldLabel$$module$build$src$core$field_label(a),c)):(this.updateDisabled(),this.removeInput(b))}tab(a,b){const c=new TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor;c.setCurNode(ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(a));\na=c.getCurNode();b?c.next():c.prev();(b=c.getCurNode())&&b!==a&&(b.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(b))}onMouseDown_(a){const b=this.workspace.getGesture(a);b&&b.handleBlockStart(a,this)}showHelp(){const a=\"function\"===typeof this.helpUrl?this.helpUrl():this.helpUrl;a&&window.open(a)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const a=ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.getContextMenuOptions(ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,\n{block:this});this.customContextMenu&&this.customContextMenu(a);return a}showContextMenu(a){const b=this.generateContextMenu();b&&b.length&&(show$$module$build$src$core$contextmenu(a,b,this.RTL),setCurrentBlock$$module$build$src$core$contextmenu(this))}updateComponentLocations(a){if(this.rendered){this.dragging||this.updateConnectionLocations(a);this.updateIconLocations(a);this.updateFieldLocations(a);for(const b of this.getChildren(!1))b.updateComponentLocations(Coordinate$$module$build$src$core$utils$coordinate.sum(a,\nb.relativeCoords))}}updateConnectionLocations(a){for(const b of this.getConnections_(!1))b.moveToOffset(a)}updateIconLocations(a){for(const b of this.getIcons())b.onLocationChange(a)}updateFieldLocations(a){for(const b of this.inputList)for(const c of b.fieldRow)c.onLocationChange(a)}setDragging(a){(this.dragging=a)?(this.translation=\"\",draggingConnections$$module$build$src$core$common.push(...this.getConnections_(!0)),addClass$$module$build$src$core$utils$dom(this.svgGroup_,\"blocklyDragging\")):(draggingConnections$$module$build$src$core$common.length=\n0,removeClass$$module$build$src$core$utils$dom(this.svgGroup_,\"blocklyDragging\"));for(let b=0;b<this.childBlocks_.length;b++)this.childBlocks_[b].setDragging(a)}setMovable(a){super.setMovable(a);this.pathObject.updateMovable(a)}setEditable(a){super.setEditable(a);a=this.getIcons();for(let b=0;b<a.length;b++)a[b].updateEditable()}setShadow(a){super.setShadow(a);this.applyColour()}setInsertionMarker(a){this.isInsertionMarker_!==a&&(this.isInsertionMarker_=a)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),\nthis.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(a,b){this.isDeadOrDying()||(dispose$$module$build$src$core$tooltip(),hide$$module$build$src$core$contextmenu(),b&&this.rendered&&(this.unplug(a),disposeUiEffect$$module$build$src$core$block_animations(this)),super.dispose(!!a),removeNode$$module$build$src$core$utils$dom(this.svgGroup_))}disposeInternal(){this.isDeadOrDying()||(super.disposeInternal(),this.rendered=!1,getSelected$$module$build$src$core$common()===\nthis&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach(a=>clearTimeout(a)),this.warningTextDb.clear(),this.getIcons().forEach(a=>a.dispose()))}checkAndDelete(){this.workspace.isFlyout||($.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),$.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:BlockPaster$$module$build$src$core$clipboard$block_paster.TYPE,\nblockState:save$$module$build$src$core$serialization$blocks(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:getBlockTypeCounts$$module$build$src$core$common(this,!0)}}applyColour(){this.pathObject.applyColour(this);const a=this.getIcons();for(let b=0;b<a.length;b++)a[b].applyColour();for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)e.applyColour()}updateDisabled(){const a=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===a){let b;null==(b=this.getNextBlock())||\nb.updateDisabled()}else{this.applyColour();this.visuallyDisabled=a;for(const b of this.getChildren(!1))b.updateDisabled()}}getCommentIcon(){warn$$module$build$src$core$utils$deprecation(\"getCommentIcon\",\"v10\",\"v11\",\"getIcon\");let a;return null!=(a=this.getIcon(CommentIcon$$module$build$src$core$icons$comment_icon.TYPE))?a:null}setWarningText(a,b=\"\"){if(b)this.warningTextDb.has(b)&&(clearTimeout(this.warningTextDb.get(b)),this.warningTextDb.delete(b));else{for(var c of this.warningTextDb.values())clearTimeout(c);\nthis.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(b,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(b),this.setWarningText(a,b))},100));else if(this.isInFlyout&&(a=null),c=this.getIcon(WarningIcon$$module$build$src$core$icons$warning_icon.TYPE),a){let d=this.getSurroundParent(),e=null;for(;d;)d.isCollapsed()&&(e=d),d=d.getSurroundParent();e&&e.setWarningText($.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,BlockSvg$$module$build$src$core$block_svg.COLLAPSED_WARNING_ID);\nc?c.addMessage(a,b):this.addIcon((new WarningIcon$$module$build$src$core$icons$warning_icon(this)).addMessage(a,b))}else c&&(b?(c.addMessage(\"\",b),c.getText()||this.removeIcon(WarningIcon$$module$build$src$core$icons$warning_icon.TYPE)):this.removeIcon(WarningIcon$$module$build$src$core$icons$warning_icon.TYPE))}setMutator(a){this.removeIcon($.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);a&&this.addIcon(a)}addIcon(a){super.addIcon(a);a instanceof WarningIcon$$module$build$src$core$icons$warning_icon&&\n(this.warning=a);a instanceof $.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=a);this.rendered&&(a.initView(this.createIconPointerDownListener(a)),a.applyColour(),a.updateEditable(),this.queueRender(),triggerQueuedRenders$$module$build$src$core$render_management(),this.bumpNeighbours());return a}createIconPointerDownListener(a){return b=>{this.isDeadOrDying()||(b=this.workspace.getGesture(b))&&b.setStartIcon(a)}}removeIcon(a){const b=super.removeIcon(a);a.equals(WarningIcon$$module$build$src$core$icons$warning_icon.TYPE)&&\n(this.warning=null);a.equals($.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null);this.rendered&&(this.queueRender(),triggerQueuedRenders$$module$build$src$core$render_management(),this.bumpNeighbours());return b}setEnabled(a){this.isEnabled()!==a&&(super.setEnabled(a),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(a){this.rendered&&this.pathObject.updateHighlighted(a)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(a){this.pathObject.updateDraggingDelete(a)}getColour(){return this.style.colourPrimary}setColour(a){super.setColour(a);\na=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_);this.pathObject.setStyle(a.style);this.style=a.style;this.styleName_=a.name;this.applyColour()}setStyle(a){const b=this.workspace.getRenderer().getConstants().getBlockStyle(a);this.styleName_=a;if(b)this.hat=b.hat,this.pathObject.setStyle(b),this.colour_=b.colourPrimary,this.style=b,this.applyColour();else throw Error(\"Invalid style name: \"+a);}bringToFront(a=!1){let b=this;if(!b.isDeadOrDying()){do{const c=b.getSvgRoot(),\nd=c.parentNode,e=d.childNodes;e[e.length-1]!==c&&d.appendChild(c);if(a)break;b=b.getParent()}while(b)}}setPreviousStatement(a,b){super.setPreviousStatement(a,b);this.rendered&&(this.queueRender(),this.bumpNeighbours())}setNextStatement(a,b){super.setNextStatement(a,b);this.rendered&&(this.queueRender(),this.bumpNeighbours())}setOutput(a,b){super.setOutput(a,b);this.rendered&&(this.queueRender(),this.bumpNeighbours())}setInputsInline(a){super.setInputsInline(a);this.rendered&&(this.queueRender(),this.bumpNeighbours())}removeInput(a,\nb){a=super.removeInput(a,b);this.rendered&&(this.queueRender(),this.bumpNeighbours());return a}moveNumberedInputBefore(a,b){super.moveNumberedInputBefore(a,b);this.rendered&&(this.queueRender(),this.bumpNeighbours())}appendInput(a){super.appendInput(a);this.rendered&&(this.queueRender(),this.bumpNeighbours());return a}setConnectionTracking(a){this.previousConnection&&this.previousConnection.setTracking(a);this.outputConnection&&this.outputConnection.setTracking(a);if(this.nextConnection){this.nextConnection.setTracking(a);\nvar b=this.nextConnection.targetBlock();b&&b.setConnectionTracking(a)}if(!this.collapsed_)for(b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;c&&(c.setTracking(a),(c=c.targetBlock())&&c.setConnectionTracking(a))}}getConnections_(a){const b=[];if(a||this.rendered)if(this.outputConnection&&b.push(this.outputConnection),this.previousConnection&&b.push(this.previousConnection),this.nextConnection&&b.push(this.nextConnection),a||!this.collapsed_)for(let c=0,d;d=this.inputList[c];c++)d.connection&&\nb.push(d.connection);return b}lastConnectionInStack(a){return super.lastConnectionInStack(a)}getMatchingConnection(a,b){return super.getMatchingConnection(a,b)}makeConnection_(a){return new RenderedConnection$$module$build$src$core$rendered_connection(this,a)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){if(!this.bumpNeighboursPid){var a=$.getGroup$$module$build$src$core$events$utils();this.bumpNeighboursPid=setTimeout(()=>{const b=\n$.getGroup$$module$build$src$core$events$utils();$.setGroup$$module$build$src$core$events$utils(a);this.getRootBlock().bumpNeighboursInternal();$.setGroup$$module$build$src$core$events$utils(b);this.bumpNeighboursPid=0},$.config$$module$build$src$core$config.bumpDelay)}}bumpNeighboursInternal(){const a=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||a.isInFlyout))for(const b of this.getConnections_(!1)){if(b.isSuperior()){let c;null==(c=b.targetBlock())||c.bumpNeighboursInternal()}for(const c of b.neighbours($.config$$module$build$src$core$config.snapRadius))c.getSourceBlock().getRootBlock()!==\na&&(b.isConnected()&&c.isConnected()||(b.isSuperior()?c.bumpAwayFrom(b):b.bumpAwayFrom(c)))}}scheduleSnapAndBump(){const a=$.getGroup$$module$build$src$core$events$utils();setTimeout(()=>{$.setGroup$$module$build$src$core$events$utils(a);this.snapToGrid();$.setGroup$$module$build$src$core$events$utils(!1)},$.config$$module$build$src$core$config.bumpDelay/2);this.bumpNeighbours()}positionNearConnection(a,b,c){if(a.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT||a.type===\nConnectionType$$module$build$src$core$connection_type.INPUT_VALUE){let d=b.x;b=b.y;d+=c.x-a.getOffsetInBlock().x;b+=c.y-a.getOffsetInBlock().y;this.moveBy(d,b)}}getChildren(a){return super.getChildren(a)}queueRender(){return queueRender$$module$build$src$core$render_management(this)}render(){this.queueRender();triggerQueuedRenders$$module$build$src$core$render_management()}renderEfficiently(){this.rendered=!0;startTextWidthCache$$module$build$src$core$utils$dom();this.isCollapsed()&&this.updateCollapsed_();\nthis.isEnabled()||this.updateDisabled();this.workspace.getRenderer().render(this);this.tightenChildrenEfficiently();stopTextWidthCache$$module$build$src$core$utils$dom();this.updateMarkers_()}tightenChildrenEfficiently(){for(const a of this.inputList){const b=a.connection;b&&b.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw();this.workspace.keyboardAccessibilityMode&&\nthis.pathObject.markerSvg&&this.workspace.getMarker(MarkerManager$$module$build$src$core$marker_manager.LOCAL_MARKER).draw();for(const a of this.inputList)for(const b of a.fieldRow)b.updateMarkers_()}setCursorSvg(a){this.pathObject.setCursorSvg(a)}setMarkerSvg(a){this.pathObject.setMarkerSvg(a)}getHeightWidth(){let a=this.height,b=this.width;var c=this.getNextBlock();if(c){c=c.getHeightWidth();const d=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;a+=c.height-d;b=Math.max(b,c.width)}return{height:a,\nwidth:b}}fadeForReplacement(a){this.pathObject.updateReplacementFade(a)}highlightShapeForInput(a,b){this.pathObject.updateShapeForInputHighlight(a,b)}};BlockSvg$$module$build$src$core$block_svg.INLINE=-1;BlockSvg$$module$build$src$core$block_svg.COLLAPSED_WARNING_ID=\"TEMP_COLLAPSED_WARNING_\";var module$build$src$core$block_svg={};module$build$src$core$block_svg.BlockSvg=BlockSvg$$module$build$src$core$block_svg;var DragTarget$$module$build$src$core$drag_target=class{constructor(){}onDragEnter(a){}onDragOver(a){}onDragExit(a){}onDrop(a){}getClientRect(){return null}shouldPreventMove(a){return!1}},module$build$src$core$drag_target={};module$build$src$core$drag_target.DragTarget=DragTarget$$module$build$src$core$drag_target;var DeleteArea$$module$build$src$core$delete_area=class extends DragTarget$$module$build$src$core$drag_target{constructor(){super();this.wouldDelete_=!1}wouldDelete(a,b){a instanceof BlockSvg$$module$build$src$core$block_svg?(a=!a.getParent()&&a.isDeletable(),this.updateWouldDelete_(a&&!b)):this.updateWouldDelete_(a.isDeletable());return this.wouldDelete_}updateWouldDelete_(a){this.wouldDelete_=a}},module$build$src$core$delete_area={};module$build$src$core$delete_area.DeleteArea=DeleteArea$$module$build$src$core$delete_area;var Trashcan$$module$build$src$core$trashcan=class extends DeleteArea$$module$build$src$core$delete_area{constructor(a){super();this.workspace=a;this.id=\"trashcan\";this.contents=[];this.flyout=null;this.isLidOpen=!1;this.minOpenness=0;this.lidTask=this.svgLid=this.svgGroup=null;this.top=this.left=this.lidOpen=0;this.initialized=!1;0>=this.workspace.options.maxTrashcanContents||(a=new Options$$module$build$src$core$options({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,\nrenderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(a.toolboxPosition=this.workspace.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?Position$$module$build$src$core$utils$toolbox.BOTTOM:Position$$module$build$src$core$utils$toolbox.TOP,this.flyout=new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,\n!0))(a)):(a.toolboxPosition=this.workspace.toolboxPosition===Position$$module$build$src$core$utils$toolbox.RIGHT?Position$$module$build$src$core$utils$toolbox.LEFT:Position$$module$build$src$core$utils$toolbox.RIGHT,this.flyout=new (getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(a)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,\n{\"class\":\"blocklyTrash\"});let a;const b=String(Math.random()).substring(2);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:\"blocklyTrashBodyClipPath\"+b},this.svgGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:WIDTH$$module$build$src$core$trashcan,height:BODY_HEIGHT$$module$build$src$core$trashcan,y:LID_HEIGHT$$module$build$src$core$trashcan},a);const c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,\n{width:SPRITE$$module$build$src$core$sprites.width,x:-SPRITE_LEFT$$module$build$src$core$trashcan,height:SPRITE$$module$build$src$core$sprites.height,y:-SPRITE_TOP$$module$build$src$core$trashcan,\"clip-path\":\"url(#blocklyTrashBodyClipPath\"+b+\")\"},this.svgGroup);c.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,\n{id:\"blocklyTrashLidClipPath\"+b},this.svgGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:WIDTH$$module$build$src$core$trashcan,height:LID_HEIGHT$$module$build$src$core$trashcan},a);this.svgLid=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,x:-SPRITE_LEFT$$module$build$src$core$trashcan,height:SPRITE$$module$build$src$core$sprites.height,y:-SPRITE_TOP$$module$build$src$core$trashcan,\n\"clip-path\":\"url(#blocklyTrashLidClipPath\"+b+\")\"},this.svgGroup);this.svgLid.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);bind$$module$build$src$core$browser_events(this.svgGroup,\"pointerdown\",this,this.blockMouseDownWhenOpenable);bind$$module$build$src$core$browser_events(this.svgGroup,\"pointerup\",this,this.click);bind$$module$build$src$core$browser_events(c,\"pointerover\",this,this.mouseOver);bind$$module$build$src$core$browser_events(c,\n\"pointerout\",this,this.mouseOut);this.animateLid();return this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(insertAfter$$module$build$src$core$utils$dom(this.flyout.createDom(Svg$$module$build$src$core$utils$svg.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace));this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA,\nComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET,ComponentManager$$module$build$src$core$component_manager.Capability.POSITIONABLE]});this.initialized=!0;this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent(\"trashcan\");this.svgGroup&&removeNode$$module$build$src$core$utils$dom(this.svgGroup);this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var a=\nthis.contents.map(function(c){return JSON.parse(c)}),b=this.workspace.getParentSvg().style;b.cursor=\"wait\";setTimeout(()=>{let c;null==(c=this.flyout)||c.show(a);b.cursor=\"\";let d;null==(d=this.workspace.scrollbar)||d.setVisible(!1)},10);this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var a;null==(a=this.flyout)||a.hide();var b;null==(b=this.workspace.scrollbar)||b.setVisible(!0);this.fireUiEvent(!1);this.workspace.recordDragTargets()}}autoHide(a){!a&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&\n(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(a,b){if(this.initialized){var c=getCornerOppositeToolbox$$module$build$src$core$positionable_helpers(this.workspace,a);a=getStartPositionRect$$module$build$src$core$positionable_helpers(c,new Size$$module$build$src$core$utils$size(WIDTH$$module$build$src$core$trashcan,BODY_HEIGHT$$module$build$src$core$trashcan+LID_HEIGHT$$module$build$src$core$trashcan),MARGIN_HORIZONTAL$$module$build$src$core$trashcan,MARGIN_VERTICAL$$module$build$src$core$trashcan,\na,this.workspace);b=bumpPositionRect$$module$build$src$core$positionable_helpers(a,MARGIN_VERTICAL$$module$build$src$core$trashcan,c.vertical===verticalPosition$$module$build$src$core$positionable_helpers.TOP?bumpDirection$$module$build$src$core$positionable_helpers.DOWN:bumpDirection$$module$build$src$core$positionable_helpers.UP,b);this.top=b.top;this.left=b.left;var d;null==(d=this.svgGroup)||d.setAttribute(\"transform\",\"translate(\"+this.left+\",\"+this.top+\")\")}}getBoundingRectangle(){return new Rect$$module$build$src$core$utils$rect(this.top,\nthis.top+BODY_HEIGHT$$module$build$src$core$trashcan+LID_HEIGHT$$module$build$src$core$trashcan,this.left,this.left+WIDTH$$module$build$src$core$trashcan)}getClientRect(){if(!this.svgGroup)return null;var a=this.svgGroup.getBoundingClientRect();const b=a.top+SPRITE_TOP$$module$build$src$core$trashcan-MARGIN_HOTSPOT$$module$build$src$core$trashcan;a=a.left+SPRITE_LEFT$$module$build$src$core$trashcan-MARGIN_HOTSPOT$$module$build$src$core$trashcan;return new Rect$$module$build$src$core$utils$rect(b,\nb+LID_HEIGHT$$module$build$src$core$trashcan+BODY_HEIGHT$$module$build$src$core$trashcan+2*MARGIN_HOTSPOT$$module$build$src$core$trashcan,a,a+WIDTH$$module$build$src$core$trashcan+2*MARGIN_HOTSPOT$$module$build$src$core$trashcan)}onDragOver(a){this.setLidOpen(this.wouldDelete_)}onDragExit(a){this.setLidOpen(!1)}onDrop(a){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(a){this.isLidOpen!==a&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=a,this.animateLid())}animateLid(){const a=\nANIMATION_FRAMES$$module$build$src$core$trashcan;var b=1/(a+1);this.lidOpen+=this.isLidOpen?b:-b;this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1);this.setLidAngle(this.lidOpen*MAX_LID_ANGLE$$module$build$src$core$trashcan);b=OPACITY_MIN$$module$build$src$core$trashcan+this.lidOpen*(OPACITY_MAX$$module$build$src$core$trashcan-OPACITY_MIN$$module$build$src$core$trashcan);this.svgGroup&&(this.svgGroup.style.opacity=`${b}`);this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=\nsetTimeout(this.animateLid.bind(this),ANIMATION_LENGTH$$module$build$src$core$trashcan/a))}setLidAngle(a){const b=this.workspace.toolboxPosition===Position$$module$build$src$core$utils$toolbox.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let c;null==(c=this.svgLid)||c.setAttribute(\"transform\",\"rotate(\"+(b?-a:a)+\",\"+(b?4:WIDTH$$module$build$src$core$trashcan-4)+\",\"+(LID_HEIGHT$$module$build$src$core$trashcan-2)+\")\")}setMinOpenness(a){this.minOpenness=a;this.isLidOpen||this.setLidAngle(a*\nMAX_LID_ANGLE$$module$build$src$core$trashcan)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(a){a=new (get$$module$build$src$core$events$utils(TRASHCAN_OPEN$$module$build$src$core$events$utils))(a,this.workspace.id);fire$$module$build$src$core$events$utils(a)}blockMouseDownWhenOpenable(a){!this.contentsIsOpen()&&this.hasContents()&&a.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(a){if(!(0>=\nthis.workspace.options.maxTrashcanContents||a.type!==$.DELETE$$module$build$src$core$events$utils||a.type!==$.DELETE$$module$build$src$core$events$utils||a.wasShadow)){if(!a.oldJson)throw Error(\"Encountered a delete event without proper oldJson\");a=JSON.stringify(this.cleanBlockJson(a.oldJson));if(-1===this.contents.indexOf(a)){for(this.contents.unshift(a);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(HAS_BLOCKS_LID_ANGLE$$module$build$src$core$trashcan)}}}cleanBlockJson(a){function b(c){if(c){delete c.id;\ndelete c.x;delete c.y;delete c.enabled;if(c.icons&&c.icons.comment){var d=c.icons.comment;delete d.height;delete d.width;delete d.pinned}d=c.inputs;for(var e in d){var f=d[e];const g=f.block;f=f.shadow;g&&b(g);f&&b(f)}c.next&&(e=c.next,c=e.block,e=e.shadow,c&&b(c),e&&b(e))}}a=JSON.parse(JSON.stringify(a));b(a);return Object.assign({},{kind:\"BLOCK\"},a)}},WIDTH$$module$build$src$core$trashcan=47,BODY_HEIGHT$$module$build$src$core$trashcan=44,LID_HEIGHT$$module$build$src$core$trashcan=16,MARGIN_VERTICAL$$module$build$src$core$trashcan=\n20,MARGIN_HORIZONTAL$$module$build$src$core$trashcan=20,MARGIN_HOTSPOT$$module$build$src$core$trashcan=10,SPRITE_LEFT$$module$build$src$core$trashcan=0,SPRITE_TOP$$module$build$src$core$trashcan=32,HAS_BLOCKS_LID_ANGLE$$module$build$src$core$trashcan=.1,ANIMATION_LENGTH$$module$build$src$core$trashcan=80,ANIMATION_FRAMES$$module$build$src$core$trashcan=4,OPACITY_MIN$$module$build$src$core$trashcan=.4,OPACITY_MAX$$module$build$src$core$trashcan=.8,MAX_LID_ANGLE$$module$build$src$core$trashcan=45,module$build$src$core$trashcan=\n{};module$build$src$core$trashcan.Trashcan=Trashcan$$module$build$src$core$trashcan;var ShortcutRegistry$$module$build$src$core$shortcut_registry=class{constructor(){this.shortcuts=new Map;this.keyMap=new Map;this.reset()}reset(){this.shortcuts.clear();this.keyMap.clear()}register(a,b){if(this.shortcuts.get(a.name)&&!b)throw Error(`Shortcut named \"${a.name}\" already exists.`);this.shortcuts.set(a.name,a);if((b=a.keyCodes)&&0<b.length)for(let c=0;c<b.length;c++)this.addKeyMapping(b[c],a.name,!!a.allowCollision)}unregister(a){if(!this.shortcuts.get(a))return console.warn(`Keyboard shortcut named \"${a}\" not found.`),\n!1;this.removeAllKeyMappings(a);this.shortcuts.delete(a);return!0}addKeyMapping(a,b,c){a=`${a}`;const d=this.keyMap.get(a);if(d&&!c)throw Error(`Shortcut named \"${b}\" collides with shortcuts \"${d}\"`);d&&c?d.unshift(b):this.keyMap.set(a,[b])}removeKeyMapping(a,b,c){const d=this.keyMap.get(a);if(!d)return c||console.warn(`No keyboard shortcut named \"${b}\" registered with key code \"${a}\"`),!1;const e=d.indexOf(b);if(-1<e)return d.splice(e,1),0===d.length&&this.keyMap.delete(a),!0;c||console.warn(`No keyboard shortcut named \"${b}\" registered with key code \"${a}\"`);\nreturn!1}removeAllKeyMappings(a){for(const b of this.keyMap.keys())this.removeKeyMapping(b,a,!0)}setKeyMap(a){this.keyMap.clear();for(const b in a)this.keyMap.set(b,a[b])}getKeyMap(){const a=Object.create(null);for(const [b,c]of this.keyMap)a[b]=c;return a}getRegistry(){const a=Object.create(null);for(const [b,c]of this.shortcuts)a[b]=c;return deepMerge$$module$build$src$core$utils$object(Object.create(null),a)}onKeyDown(a,b){var c=this.serializeKeyEvent_(b);c=this.getShortcutNamesByKeyCode(c);if(!c)return!1;\nfor(let d=0,e;e=c[d];d++){const f=this.shortcuts.get(e);let g,h;if(null==(g=f)||!g.preconditionFn||(null==(h=f)?0:h.preconditionFn(a))){let k,l;if((null==(k=f)?0:k.callback)&&(null==(l=f)?0:l.callback(a,b,f)))return!0}}return!1}getShortcutNamesByKeyCode(a){return this.keyMap.get(a)||[]}getKeyCodesByShortcutName(a){const b=[];for(const [c,d]of this.keyMap)-1<d.indexOf(a)&&b.push(c);return b}serializeKeyEvent_(a){let b=\"\";for(const c in ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys)a.getModifierState(c)&&\n(\"\"!==b&&(b+=\"+\"),b+=c);\"\"!==b&&a.keyCode?b=b+\"+\"+a.keyCode:a.keyCode&&(b=String(a.keyCode));return b}checkModifiers_(a){for(let b=0,c;c=a[b];b++)if(!(c in ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys))throw Error(c+\" is not a valid modifier key.\");}createSerializedKey(a,b){let c=\"\";if(b){this.checkModifiers_(b);for(const d in ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys)-1<b.indexOf(ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys[d])&&\n(\"\"!==c&&(c+=\"+\"),c+=d)}\"\"!==c&&a?c=c+\"+\"+a:a&&(c=`${a}`);return c}};ShortcutRegistry$$module$build$src$core$shortcut_registry.registry=new ShortcutRegistry$$module$build$src$core$shortcut_registry;(function(a){a=a.modifierKeys||(a.modifierKeys={});a[a.Shift=16]=\"Shift\";a[a.Control=17]=\"Control\";a[a.Alt=18]=\"Alt\";a[a.Meta=91]=\"Meta\"})(ShortcutRegistry$$module$build$src$core$shortcut_registry||(ShortcutRegistry$$module$build$src$core$shortcut_registry={}));\nvar module$build$src$core$shortcut_registry={};module$build$src$core$shortcut_registry.ShortcutRegistry=ShortcutRegistry$$module$build$src$core$shortcut_registry;var module$build$src$core$interfaces$i_copyable={};module$build$src$core$interfaces$i_copyable.isCopyable=isCopyable$$module$build$src$core$interfaces$i_copyable;var names$$module$build$src$core$shortcut_items;(function(a){a.ESCAPE=\"escape\";a.DELETE=\"delete\";a.COPY=\"copy\";a.CUT=\"cut\";a.PASTE=\"paste\";a.UNDO=\"undo\";a.REDO=\"redo\"})(names$$module$build$src$core$shortcut_items||(names$$module$build$src$core$shortcut_items={}));var copyData$$module$build$src$core$shortcut_items=null,copyWorkspace$$module$build$src$core$shortcut_items=null;registerDefaultShortcuts$$module$build$src$core$shortcut_items();var module$build$src$core$shortcut_items={};\nmodule$build$src$core$shortcut_items.names=names$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerCopy=registerCopy$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerCut=registerCut$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerDefaultShortcuts=registerDefaultShortcuts$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerDelete=registerDelete$$module$build$src$core$shortcut_items;\nmodule$build$src$core$shortcut_items.registerEscape=registerEscape$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerPaste=registerPaste$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerRedo=registerRedo$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerUndo=registerUndo$$module$build$src$core$shortcut_items;var ProcedureSerializer$$module$build$src$core$serialization$procedures=class{constructor(a,b){this.procedureModelClass=a;this.parameterModelClass=b;this.priority=PROCEDURES$$module$build$src$core$serialization$priorities}save(a){a=a.getProcedureMap().getProcedures().map(b=>saveProcedure$$module$build$src$core$serialization$procedures(b));return a.length?a:null}load(a,b){const c=b.getProcedureMap();for(const d of a)c.add(loadProcedure$$module$build$src$core$serialization$procedures(this.procedureModelClass,\nthis.parameterModelClass,d,b))}clear(a){a.getProcedureMap().clear()}},module$build$src$core$serialization$procedures={};module$build$src$core$serialization$procedures.ProcedureSerializer=ProcedureSerializer$$module$build$src$core$serialization$procedures;module$build$src$core$serialization$procedures.loadParameter=loadParameter$$module$build$src$core$serialization$procedures;module$build$src$core$serialization$procedures.loadProcedure=loadProcedure$$module$build$src$core$serialization$procedures;\nmodule$build$src$core$serialization$procedures.saveParameter=saveParameter$$module$build$src$core$serialization$procedures;module$build$src$core$serialization$procedures.saveProcedure=saveProcedure$$module$build$src$core$serialization$procedures;var VariableSerializer$$module$build$src$core$serialization$variables=class{constructor(){this.priority=VARIABLES$$module$build$src$core$serialization$priorities}save(a){const b=[];for(const c of a.getAllVariables())a={name:c.name,id:c.getId()},c.type&&(a.type=c.type),b.push(a);return b.length?b:null}load(a,b){for(const c of a)b.createVariable(c.name,c.type,c.id)}clear(a){a.getVariableMap().clear()}};register$$module$build$src$core$serialization$registry(\"variables\",new VariableSerializer$$module$build$src$core$serialization$variables);\nvar module$build$src$core$serialization$variables={};module$build$src$core$serialization$variables.VariableSerializer=VariableSerializer$$module$build$src$core$serialization$variables;var module$build$src$core$serialization$workspaces={};module$build$src$core$serialization$workspaces.load=load$$module$build$src$core$serialization$workspaces;module$build$src$core$serialization$workspaces.save=save$$module$build$src$core$serialization$workspaces;var module$build$src$core$serialization={blocks:module$build$src$core$serialization$blocks,exceptions:module$build$src$core$serialization$exceptions,priorities:module$build$src$core$serialization$priorities,procedures:module$build$src$core$serialization$procedures,registry:module$build$src$core$serialization$registry,variables:module$build$src$core$serialization$variables,workspaces:module$build$src$core$serialization$workspaces};var ScrollbarPair$$module$build$src$core$scrollbar_pair=class{constructor(a,b,c,d,e){this.workspace=a;this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null;b=void 0===b?!0:b;c=void 0===c?!0:c;const f=b&&c;b&&(this.hScroll=new Scrollbar$$module$build$src$core$scrollbar(a,!0,f,d,e));c&&(this.vScroll=new Scrollbar$$module$build$src$core$scrollbar(a,!1,f,d,e));f&&(this.corner_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{height:Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness,\nwidth:Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness,\"class\":\"blocklyScrollbarBackground\"}),insertAfter$$module$build$src$core$utils$dom(this.corner_,a.getBubbleCanvas()))}dispose(){removeNode$$module$build$src$core$utils$dom(this.corner_);this.oldHostMetrics_=this.corner_=null;this.hScroll&&(this.hScroll.dispose(),this.hScroll=null);this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const a=this.workspace.getMetrics();if(a){var b=!1,c=!1;this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===\na.viewWidth&&this.oldHostMetrics_.viewHeight===a.viewHeight&&this.oldHostMetrics_.absoluteTop===a.absoluteTop&&this.oldHostMetrics_.absoluteLeft===a.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===a.scrollWidth&&this.oldHostMetrics_.viewLeft===a.viewLeft&&this.oldHostMetrics_.scrollLeft===a.scrollLeft||(b=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===a.scrollHeight&&this.oldHostMetrics_.viewTop===a.viewTop&&this.oldHostMetrics_.scrollTop===a.scrollTop||(c=!0)):\nc=b=!0;if(b||c){try{$.disable$$module$build$src$core$events$utils(),this.hScroll&&b&&this.hScroll.resize(a),this.vScroll&&c&&this.vScroll.resize(a)}finally{$.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==a.viewWidth||this.oldHostMetrics_.absoluteLeft!==a.absoluteLeft){let d;null==(d=this.corner_)||d.setAttribute(\"x\",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||\nthis.oldHostMetrics_.viewHeight!==a.viewHeight||this.oldHostMetrics_.absoluteTop!==a.absoluteTop){let d;null==(d=this.corner_)||d.setAttribute(\"y\",String(this.hScroll.position.y))}}this.oldHostMetrics_=a}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(a,b){this.hScroll&&this.hScroll.setOrigin(a,b);this.vScroll&&this.vScroll.setOrigin(a,b)}set(a,b,c){this.hScroll&&this.hScroll.set(a,!1);this.vScroll&&this.vScroll.set(b,!1);if(c||void 0===c)a={},this.hScroll&&\n(a.x=this.hScroll.getRatio_()),this.vScroll&&(a.y=this.vScroll.getRatio_()),this.workspace.setMetrics(a)}setX(a){this.hScroll&&this.hScroll.set(a,!0)}setY(a){this.vScroll&&this.vScroll.set(a,!0)}setContainerVisible(a){this.hScroll&&this.hScroll.setContainerVisible(a);this.vScroll&&this.vScroll.setContainerVisible(a)}isVisible(){let a=!1;this.hScroll&&(a=this.hScroll.isVisible());this.vScroll&&(a=a||this.vScroll.isVisible());return a}setVisible(a){this.hScroll&&this.hScroll.setVisibleInternal(a);this.vScroll&&\nthis.vScroll.setVisibleInternal(a)}resizeContent(a){this.hScroll&&this.hScroll.resizeContentHorizontal(a);this.vScroll&&this.vScroll.resizeContentVertical(a)}resizeView(a){this.hScroll&&this.hScroll.resizeViewHorizontal(a);this.vScroll&&this.vScroll.resizeViewVertical(a)}},module$build$src$core$scrollbar_pair={};module$build$src$core$scrollbar_pair.ScrollbarPair=ScrollbarPair$$module$build$src$core$scrollbar_pair;var MetricsManager$$module$build$src$core$metrics_manager=class{constructor(a){this.workspace_=a}getDimensionsPx_(a){let b=0,c=0;a&&(b=a.getWidth(),c=a.getHeight());return new Size$$module$build$src$core$utils$size(b,c)}getFlyoutMetrics(a){a=this.getDimensionsPx_(this.workspace_.getFlyout(a));return{width:a.width,height:a.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const a=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:a.width,height:a.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let a=\n0,b=0;const c=this.getToolboxMetrics(),d=this.getFlyoutMetrics(),e=!!this.workspace_.getToolbox();var f;const g=!(null==(f=this.workspace_.getFlyout())?0:f.autoClose);f=e?c.position:d.position;const h=f===Position$$module$build$src$core$utils$toolbox.TOP;f===Position$$module$build$src$core$utils$toolbox.LEFT&&(e&&(a+=c.width),g&&(a+=d.width));h&&(e&&(b+=c.height),g&&(b+=d.height));return{top:b,left:a}}getViewMetrics(a){a=a?this.workspace_.scale:1;const b=this.getSvgMetrics(),c=this.getToolboxMetrics(),\nd=this.getFlyoutMetrics(),e=!!this.workspace_.getToolbox();var f;const g=!(null==(f=this.workspace_.getFlyout())?0:f.autoClose);f=e?c.position:d.position;const h=f===Position$$module$build$src$core$utils$toolbox.LEFT||f===Position$$module$build$src$core$utils$toolbox.RIGHT;if(f===Position$$module$build$src$core$utils$toolbox.TOP||f===Position$$module$build$src$core$utils$toolbox.BOTTOM)e&&(b.height-=c.height),g&&(b.height-=d.height);h&&(e&&(b.width-=c.width),g&&(b.width-=d.width));return{height:b.height/\na,width:b.width/a,top:-this.workspace_.scrollY/a,left:-this.workspace_.scrollX/a}}getContentMetrics(a){a=a?1:this.workspace_.scale;const b=this.workspace_.getBlocksBoundingBox();return{height:(b.bottom-b.top)*a,width:(b.right-b.left)*a,top:b.top*a,left:b.left*a}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(a){if(!this.hasFixedEdges())return{};const b=this.workspace_.isMovableHorizontally(),c=this.workspace_.isMovableVertically();\na=a||this.getViewMetrics(!1);const d={};c||(d.top=a.top,d.bottom=a.top+a.height);b||(d.left=a.left,d.right=a.left+a.width);return d}getPaddedContent_(a,b){const c=b.top+b.height,d=b.left+b.width,e=a.width;a=a.height;const f=e/2,g=a/2;return{top:Math.min(b.top-g,c-a),bottom:Math.max(c+g,b.top+a),left:Math.min(b.left-f,d-e),right:Math.max(d+f,b.left+e)}}getScrollMetrics(a,b,c){a=a?this.workspace_.scale:1;b=b||this.getViewMetrics(!1);var d=c||this.getContentMetrics();c=this.getComputedFixedEdges_(b);\nb=this.getPaddedContent_(b,d);d=void 0!==c.top?c.top:b.top;const e=void 0!==c.left?c.left:b.left;return{top:d/a,left:e/a,width:((void 0!==c.right?c.right:b.right)-e)/a,height:((void 0!==c.bottom?c.bottom:b.bottom)-d)/a}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const a=this.getToolboxMetrics(),b=this.getFlyoutMetrics(!0),c=this.getSvgMetrics(),d=this.getAbsoluteMetrics(),e=this.getViewMetrics(),\nf=this.getContentMetrics(),g=this.getScrollMetrics(!1,e,f);return{contentHeight:f.height,contentWidth:f.width,contentTop:f.top,contentLeft:f.left,scrollHeight:g.height,scrollWidth:g.width,scrollTop:g.top,scrollLeft:g.left,viewHeight:e.height,viewWidth:e.width,viewTop:e.top,viewLeft:e.left,absoluteTop:d.top,absoluteLeft:d.left,svgHeight:c.height,svgWidth:c.width,toolboxWidth:a.width,toolboxHeight:a.height,toolboxPosition:a.position,flyoutWidth:b.width,flyoutHeight:b.height}}};\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.METRICS_MANAGER,DEFAULT$$module$build$src$core$registry,MetricsManager$$module$build$src$core$metrics_manager);var module$build$src$core$metrics_manager={};module$build$src$core$metrics_manager.MetricsManager=MetricsManager$$module$build$src$core$metrics_manager;var FinishedLoading$$module$build$src$core$events$workspace_events=class extends Abstract$$module$build$src$core$events$events_abstract{constructor(a){super();this.isBlank=!0;this.recordUndo=!1;this.type=FINISHED_LOADING$$module$build$src$core$events$utils;this.isBlank=!!a;a&&(this.workspaceId=a.id)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,FINISHED_LOADING$$module$build$src$core$events$utils,FinishedLoading$$module$build$src$core$events$workspace_events);\nvar module$build$src$core$events$workspace_events={};module$build$src$core$events$workspace_events.FinishedLoading=FinishedLoading$$module$build$src$core$events$workspace_events;var BlockDrag$$module$build$src$core$events$events_block_drag=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c){super(a?a.workspace.id:void 0);this.type=BLOCK_DRAG$$module$build$src$core$events$utils;a&&(this.blockId=a.id,this.isStart=b,this.blocks=c)}toJson(){const a=super.toJson();if(void 0===this.isStart)throw Error(\"Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson\");if(void 0===this.blockId)throw Error(\"The block ID is undefined. Either pass a block to the constructor, or call fromJson\");\na.isStart=this.isStart;a.blockId=this.blockId;a.blocks=this.blocks;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockDrag$$module$build$src$core$events$events_block_drag);b.isStart=a.isStart;b.blockId=a.blockId;b.blocks=a.blocks;return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,BLOCK_DRAG$$module$build$src$core$events$utils,BlockDrag$$module$build$src$core$events$events_block_drag);\nvar module$build$src$core$events$events_block_drag={};module$build$src$core$events$events_block_drag.BlockDrag=BlockDrag$$module$build$src$core$events$events_block_drag;var bumpIntoBounds$$module$build$src$core$bump_objects=bumpObjectIntoBounds$$module$build$src$core$bump_objects,module$build$src$core$bump_objects={};module$build$src$core$bump_objects.bumpIntoBounds=bumpObjectIntoBounds$$module$build$src$core$bump_objects;module$build$src$core$bump_objects.bumpIntoBoundsHandler=bumpIntoBoundsHandler$$module$build$src$core$bump_objects;module$build$src$core$bump_objects.bumpTopObjectsIntoBounds=bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects;var BlockDragger$$module$build$src$core$block_dragger=class{constructor(a,b){this.dragTarget_=null;this.wouldDeleteBlock_=!1;this.dragIconData_=[];this.draggingBlock_=a;this.draggedConnectionManager_=new InsertionMarkerManager$$module$build$src$core$insertion_marker_manager(this.draggingBlock_);this.workspace_=b;this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY();this.dragIconData_=initIconData$$module$build$src$core$block_dragger(a,this.startXY_)}dispose(){this.dragIconData_.length=0;this.draggedConnectionManager_&&\nthis.draggedConnectionManager_.dispose()}startDrag(a,b){$.getGroup$$module$build$src$core$events$utils()||$.setGroup$$module$build$src$core$events$utils(!0);this.fireDragStartEvent_();this.draggingBlock_.bringToFront(!0);startTextWidthCache$$module$build$src$core$utils$dom();this.workspace_.setResizesEnabled(!1);disconnectUiStop$$module$build$src$core$block_animations();this.shouldDisconnect_(b)&&this.disconnectBlock_(b,a);this.draggingBlock_.setDragging(!0);let c;null==(c=this.workspace_.getLayerManager())||\nc.moveToDragLayer(this.draggingBlock_)}shouldDisconnect_(a){return!!(this.draggingBlock_.getParent()||a&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(a,b){this.draggingBlock_.unplug(a);a=this.pixelsToWorkspaceUnits_(b);a=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,a);this.draggingBlock_.translate(a.x,a.y);disconnectUiEffect$$module$build$src$core$block_animations(this.draggingBlock_);this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const a=\nnew (get$$module$build$src$core$events$utils(BLOCK_DRAG$$module$build$src$core$events$utils))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));fire$$module$build$src$core$events$utils(a)}drag(a,b){b=this.pixelsToWorkspaceUnits_(b);var c=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,b);this.draggingBlock_.moveDuringDrag(c);c=this.dragTarget_;this.dragTarget_=this.workspace_.getDragTarget(a);this.draggedConnectionManager_.update(b,this.dragTarget_);a=this.wouldDeleteBlock_;\nthis.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock;a!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_();this.dragTarget_!==c&&(c&&c.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_));this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(a,b){this.drag(a,b);this.fireDragEndEvent_();stopTextWidthCache$$module$build$src$core$utils$dom();disconnectUiStop$$module$build$src$core$block_animations();a=null;\nthis.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)||(a=this.getNewLocationAfterDrag_(b).delta);if(this.dragTarget_)this.dragTarget_.onDrop(this.draggingBlock_);if(!this.maybeDeleteBlock_()){let c;null==(c=this.workspace_.getLayerManager())||c.moveOffDragLayer(this.draggingBlock_,BLOCK$$module$build$src$core$layers);this.draggingBlock_.setDragging(!1);a?this.updateBlockAfterMove_():bumpObjectIntoBounds$$module$build$src$core$bump_objects(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),\nthis.draggingBlock_)}this.workspace_.setResizesEnabled(!0);$.setGroup$$module$build$src$core$events$utils(!1)}getNewLocationAfterDrag_(a){a=this.pixelsToWorkspaceUnits_(a);const b=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,a);return{delta:a,newLocation:b}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),draggingConnections$$module$build$src$core$common.length=0,!0):!1}updateBlockAfterMove_(){this.fireMoveEvent_();\nthis.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.queueRender();this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const a=new (get$$module$build$src$core$events$utils(BLOCK_DRAG$$module$build$src$core$events$utils))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));fire$$module$build$src$core$events$utils(a)}updateToolboxStyle_(a){const b=this.workspace_.getToolbox();if(b){const c=this.draggingBlock_.isDeletable()?\n\"blocklyToolboxDelete\":\"blocklyToolboxGrab\";a&&\"function\"===typeof b.removeStyle?b.removeStyle(c):a||\"function\"!==typeof b.addStyle||b.addStyle(c)}}fireMoveEvent_(){if(!this.draggingBlock_.isDeadOrDying()){var a=new (get$$module$build$src$core$events$utils($.MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);a.setReason([\"drag\"]);a.oldCoordinate=this.startXY_;a.recordNew();fire$$module$build$src$core$events$utils(a)}}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(a){a=\nnew Coordinate$$module$build$src$core$utils$coordinate(a.x/this.workspace_.scale,a.y/this.workspace_.scale);this.workspace_.isMutator&&a.scale(1/this.workspace_.options.parentWorkspace.scale);return a}dragIcons_(){warn$$module$build$src$core$utils$deprecation(\"Blockly.BlockDragger.prototype.dragIcons_\",\"v10\",\"v11\")}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.BLOCK_DRAGGER,DEFAULT$$module$build$src$core$registry,BlockDragger$$module$build$src$core$block_dragger);var module$build$src$core$block_dragger={};module$build$src$core$block_dragger.BlockDragger=BlockDragger$$module$build$src$core$block_dragger;var module$build$src$core$bubbles={};module$build$src$core$bubbles.Bubble=Bubble$$module$build$src$core$bubbles$bubble;module$build$src$core$bubbles.MiniWorkspaceBubble=MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble;module$build$src$core$bubbles.TextBubble=TextBubble$$module$build$src$core$bubbles$text_bubble;module$build$src$core$bubbles.TextInputBubble=TextInputBubble$$module$build$src$core$bubbles$textinput_bubble;var BlockFieldIntermediateChange$$module$build$src$core$events$events_block_field_intermediate_change=class extends BlockBase$$module$build$src$core$events$events_block_base{constructor(a,b,c,d){super(a);this.type=BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils;this.recordUndo=!1;a&&(this.name=b,this.oldValue=c,this.newValue=d)}toJson(){const a=super.toJson();if(!this.name)throw Error(\"The changed field name is undefined. Either pass a name to the constructor, or call fromJson.\");\na.name=this.name;a.oldValue=this.oldValue;a.newValue=this.newValue;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockFieldIntermediateChange$$module$build$src$core$events$events_block_field_intermediate_change);b.name=a.name;b.oldValue=a.oldValue;b.newValue=a.newValue;return b}isNull(){return this.oldValue===this.newValue}run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error(\"The block ID is undefined. Either pass a block to the constructor, or call fromJson\");\nb=b.getBlockById(this.blockId);if(!b)throw Error(\"The associated block is undefined. Either pass a block to the constructor, or call fromJson\");a=a?this.newValue:this.oldValue;(b=b.getField(this.name))?b.setValue(a):console.warn(\"Can't set non-existent field: \"+this.name)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils,BlockFieldIntermediateChange$$module$build$src$core$events$events_block_field_intermediate_change);\nvar module$build$src$core$events$events_block_field_intermediate_change={};module$build$src$core$events$events_block_field_intermediate_change.BlockFieldIntermediateChange=BlockFieldIntermediateChange$$module$build$src$core$events$events_block_field_intermediate_change;var BlockMove$$module$build$src$core$events$events_block_move=class extends BlockBase$$module$build$src$core$events$events_block_base{constructor(a){super(a);this.type=$.MOVE$$module$build$src$core$events$utils;a&&(a.isShadow()&&(this.recordUndo=!1),a=this.currentLocation_(),this.oldParentId=a.parentId,this.oldInputName=a.inputName,this.oldCoordinate=a.coordinate)}toJson(){const a=super.toJson();a.oldParentId=this.oldParentId;a.oldInputName=this.oldInputName;this.oldCoordinate&&(a.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, `+\n`${Math.round(this.oldCoordinate.y)}`);a.newParentId=this.newParentId;a.newInputName=this.newInputName;this.newCoordinate&&(a.newCoordinate=`${Math.round(this.newCoordinate.x)}, `+`${Math.round(this.newCoordinate.y)}`);this.reason&&(a.reason=this.reason);this.recordUndo||(a.recordUndo=this.recordUndo);return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BlockMove$$module$build$src$core$events$events_block_move);b.oldParentId=a.oldParentId;b.oldInputName=a.oldInputName;a.oldCoordinate&&\n(c=a.oldCoordinate.split(\",\"),b.oldCoordinate=new Coordinate$$module$build$src$core$utils$coordinate(Number(c[0]),Number(c[1])));b.newParentId=a.newParentId;b.newInputName=a.newInputName;a.newCoordinate&&(c=a.newCoordinate.split(\",\"),b.newCoordinate=new Coordinate$$module$build$src$core$utils$coordinate(Number(c[0]),Number(c[1])));void 0!==a.reason&&(b.reason=a.reason);void 0!==a.recordUndo&&(b.recordUndo=a.recordUndo);return b}recordNew(){const a=this.currentLocation_();this.newParentId=a.parentId;\nthis.newInputName=a.inputName;this.newCoordinate=a.coordinate}setReason(a){this.reason=a}currentLocation_(){var a=this.getEventWorkspace_();if(!this.blockId)throw Error(\"The block ID is undefined. Either pass a block to the constructor, or call fromJson\");var b=a.getBlockById(this.blockId);if(!b)throw Error(\"The block associated with the block move event could not be found\");a={};const c=b.getParent();if(c){if(a.parentId=c.id,b=c.getInputWithBlock(b))a.inputName=b.name}else a.coordinate=b.getRelativeToSurfaceXY();\nreturn a}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Coordinate$$module$build$src$core$utils$coordinate.equals(this.oldCoordinate,this.newCoordinate)}run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error(\"The block ID is undefined. Either pass a block to the constructor, or call fromJson\");var c=b.getBlockById(this.blockId);if(c){var d=a?this.newParentId:this.oldParentId,e=a?this.newInputName:this.oldInputName;a=a?this.newCoordinate:this.oldCoordinate;\nif(d){var f=b.getBlockById(d);if(!f){console.warn(\"Can't connect to non-existent block: \"+d);return}}c.getParent()&&c.unplug();if(a)e=c.getRelativeToSurfaceXY(),c.moveBy(a.x-e.x,a.y-e.y,this.reason);else{b=c.outputConnection;if(!b||c.previousConnection&&c.previousConnection.isConnected())b=c.previousConnection;let g,h;c=null==(h=b)?void 0:h.type;if(e){if(c=f.getInput(e))g=c.connection}else c===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT&&(g=f.nextConnection);g&&b?b.connect(g):\nconsole.warn(\"Can't connect to non-existent input: \"+e)}}else console.warn(\"Can't move non-existent block: \"+this.blockId)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,$.MOVE$$module$build$src$core$events$utils,BlockMove$$module$build$src$core$events$events_block_move);var module$build$src$core$events$events_block_move={};module$build$src$core$events$events_block_move.BlockMove=BlockMove$$module$build$src$core$events$events_block_move;var BubbleOpen$$module$build$src$core$events$events_bubble_open=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c){super(a?a.workspace.id:void 0);this.type=BUBBLE_OPEN$$module$build$src$core$events$utils;a&&(this.blockId=a.id,this.isOpen=b,this.bubbleType=c)}toJson(){const a=super.toJson();if(void 0===this.isOpen)throw Error(\"Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson\");if(!this.bubbleType)throw Error(\"The type of bubble is undefined. Either pass the value to the constructor, or call fromJson\");\na.isOpen=this.isOpen;a.bubbleType=this.bubbleType;a.blockId=this.blockId||\"\";return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new BubbleOpen$$module$build$src$core$events$events_bubble_open);b.isOpen=a.isOpen;b.bubbleType=a.bubbleType;b.blockId=a.blockId;return b}},BubbleType$$module$build$src$core$events$events_bubble_open;\n(function(a){a.MUTATOR=\"mutator\";a.COMMENT=\"comment\";a.WARNING=\"warning\"})(BubbleType$$module$build$src$core$events$events_bubble_open||(BubbleType$$module$build$src$core$events$events_bubble_open={}));register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,BUBBLE_OPEN$$module$build$src$core$events$utils,BubbleOpen$$module$build$src$core$events$events_bubble_open);var module$build$src$core$events$events_bubble_open={};\nmodule$build$src$core$events$events_bubble_open.BubbleOpen=BubbleOpen$$module$build$src$core$events$events_bubble_open;module$build$src$core$events$events_bubble_open.BubbleType=BubbleType$$module$build$src$core$events$events_bubble_open;var CommentBase$$module$build$src$core$events$events_comment_base=class extends Abstract$$module$build$src$core$events$events_abstract{constructor(a){super();this.isBlank=!a;a&&(this.commentId=a.id,this.workspaceId=a.workspace.id,this.group=$.getGroup$$module$build$src$core$events$utils(),this.recordUndo=getRecordUndo$$module$build$src$core$events$utils())}toJson(){const a=super.toJson();if(!this.commentId)throw Error(\"The comment ID is undefined. Either pass a comment to the constructor, or call fromJson\");\na.commentId=this.commentId;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new CommentBase$$module$build$src$core$events$events_comment_base);b.commentId=a.commentId;return b}static CommentCreateDeleteHelper(a,b){var c=a.getEventWorkspace_();if(b){b=$.createElement$$module$build$src$core$utils$xml(\"xml\");if(!a.xml)throw Error(\"Ecountered a comment event without proper xml\");b.appendChild(a.xml);$.domToWorkspace$$module$build$src$core$xml(b,c)}else{if(!a.commentId)throw Error(\"The comment ID is undefined. Either pass a comment to the constructor, or call fromJson\");\n(c=c.getCommentById(a.commentId))?c.dispose():console.warn(\"Can't uncreate non-existent comment: \"+a.commentId)}}},module$build$src$core$events$events_comment_base={};module$build$src$core$events$events_comment_base.CommentBase=CommentBase$$module$build$src$core$events$events_comment_base;var CommentChange$$module$build$src$core$events$events_comment_change=class extends CommentBase$$module$build$src$core$events$events_comment_base{constructor(a,b,c){super(a);this.type=COMMENT_CHANGE$$module$build$src$core$events$utils;a&&(this.oldContents_=\"undefined\"===typeof b?\"\":b,this.newContents_=\"undefined\"===typeof c?\"\":c)}toJson(){const a=super.toJson();if(!this.oldContents_)throw Error(\"The old contents is undefined. Either pass a value to the constructor, or call fromJson\");if(!this.newContents_)throw Error(\"The new contents is undefined. Either pass a value to the constructor, or call fromJson\");\na.oldContents=this.oldContents_;a.newContents=this.newContents_;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new CommentChange$$module$build$src$core$events$events_comment_change);b.oldContents_=a.oldContents;b.newContents_=a.newContents;return b}isNull(){return this.oldContents_===this.newContents_}run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error(\"The comment ID is undefined. Either pass a comment to the constructor, or call fromJson\");if(b=b.getCommentById(this.commentId)){var c=\na?this.newContents_:this.oldContents_;if(!c){if(a)throw Error(\"The new contents is undefined. Either pass a value to the constructor, or call fromJson\");throw Error(\"The old contents is undefined. Either pass a value to the constructor, or call fromJson\");}b.setContent(c)}else console.warn(\"Can't change non-existent comment: \"+this.commentId)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_CHANGE$$module$build$src$core$events$utils,CommentChange$$module$build$src$core$events$events_comment_change);\nvar module$build$src$core$events$events_comment_change={};module$build$src$core$events$events_comment_change.CommentChange=CommentChange$$module$build$src$core$events$events_comment_change;var CommentCreate$$module$build$src$core$events$events_comment_create=class extends CommentBase$$module$build$src$core$events$events_comment_base{constructor(a){super(a);this.type=COMMENT_CREATE$$module$build$src$core$events$utils;a&&(this.xml=a.toXmlWithXY())}toJson(){const a=super.toJson();if(!this.xml)throw Error(\"The comment XML is undefined. Either pass a comment to the constructor, or call fromJson\");a.xml=domToText$$module$build$src$core$xml(this.xml);return a}static fromJson(a,b,c){b=super.fromJson(a,\nb,null!=c?c:new CommentCreate$$module$build$src$core$events$events_comment_create);b.xml=$.textToDom$$module$build$src$core$utils$xml(a.xml);return b}run(a){CommentBase$$module$build$src$core$events$events_comment_base.CommentCreateDeleteHelper(this,a)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_CREATE$$module$build$src$core$events$utils,CommentCreate$$module$build$src$core$events$events_comment_create);\nvar module$build$src$core$events$events_comment_create={};module$build$src$core$events$events_comment_create.CommentCreate=CommentCreate$$module$build$src$core$events$events_comment_create;var CommentDelete$$module$build$src$core$events$events_comment_delete=class extends CommentBase$$module$build$src$core$events$events_comment_base{constructor(a){super(a);this.type=COMMENT_DELETE$$module$build$src$core$events$utils;a&&(this.xml=a.toXmlWithXY())}run(a){CommentBase$$module$build$src$core$events$events_comment_base.CommentCreateDeleteHelper(this,!a)}toJson(){const a=super.toJson();if(!this.xml)throw Error(\"The comment XML is undefined. Either pass a comment to the constructor, or call fromJson\");\na.xml=domToText$$module$build$src$core$xml(this.xml);return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new CommentDelete$$module$build$src$core$events$events_comment_delete);b.xml=$.textToDom$$module$build$src$core$utils$xml(a.xml);return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_DELETE$$module$build$src$core$events$utils,CommentDelete$$module$build$src$core$events$events_comment_delete);\nvar module$build$src$core$events$events_comment_delete={};module$build$src$core$events$events_comment_delete.CommentDelete=CommentDelete$$module$build$src$core$events$events_comment_delete;var CommentMove$$module$build$src$core$events$events_comment_move=class extends CommentBase$$module$build$src$core$events$events_comment_base{constructor(a){super(a);this.type=COMMENT_MOVE$$module$build$src$core$events$utils;a&&(this.comment_=a,this.oldCoordinate_=a.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error(\"Tried to record the new position of a comment on the same event twice.\");if(!this.comment_)throw Error(\"The comment is undefined. Pass a comment to the constructor if you want to use the record functionality\");\nthis.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setOldCoordinate(a){this.oldCoordinate_=a}toJson(){const a=super.toJson();if(!this.oldCoordinate_)throw Error(\"The old comment position is undefined. Either pass a comment to the constructor, or call fromJson\");if(!this.newCoordinate_)throw Error(\"The new comment position is undefined. Either call recordNew, or call fromJson\");a.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, `+`${Math.round(this.oldCoordinate_.y)}`;a.newCoordinate=Math.round(this.newCoordinate_.x)+\n\",\"+Math.round(this.newCoordinate_.y);return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new CommentMove$$module$build$src$core$events$events_comment_move);c=a.oldCoordinate.split(\",\");b.oldCoordinate_=new Coordinate$$module$build$src$core$utils$coordinate(Number(c[0]),Number(c[1]));c=a.newCoordinate.split(\",\");b.newCoordinate_=new Coordinate$$module$build$src$core$utils$coordinate(Number(c[0]),Number(c[1]));return b}isNull(){return Coordinate$$module$build$src$core$utils$coordinate.equals(this.oldCoordinate_,\nthis.newCoordinate_)}run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error(\"The comment ID is undefined. Either pass a comment to the constructor, or call fromJson\");if(b=b.getCommentById(this.commentId)){a=a?this.newCoordinate_:this.oldCoordinate_;if(!a)throw Error(\"Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson\");var c=b.getRelativeToSurfaceXY();b.moveBy(a.x-c.x,a.y-c.y)}else console.warn(\"Can't move non-existent comment: \"+\nthis.commentId)}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_MOVE$$module$build$src$core$events$utils,CommentMove$$module$build$src$core$events$events_comment_move);var module$build$src$core$events$events_comment_move={};module$build$src$core$events$events_comment_move.CommentMove=CommentMove$$module$build$src$core$events$events_comment_move;var ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select=class extends UiBase$$module$build$src$core$events$events_ui_base{constructor(a,b,c){super(c);this.type=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils;this.oldItem=null!=a?a:void 0;this.newItem=null!=b?b:void 0}toJson(){const a=super.toJson();a.oldItem=this.oldItem;a.newItem=this.newItem;return a}static fromJson(a,b,c){b=super.fromJson(a,b,null!=c?c:new ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select);\nb.oldItem=a.oldItem;b.newItem=a.newItem;return b}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils,ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select);var module$build$src$core$events$events_toolbox_item_select={};module$build$src$core$events$events_toolbox_item_select.ToolboxItemSelect=ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select;var BLOCK_CHANGE$$module$build$src$core$events$events=$.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE$$module$build$src$core$events$events=$.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE$$module$build$src$core$events$events=$.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG$$module$build$src$core$events$events=BLOCK_DRAG$$module$build$src$core$events$utils,BLOCK_MOVE$$module$build$src$core$events$events=$.MOVE$$module$build$src$core$events$utils,BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$events=\nBLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils,BUBBLE_OPEN$$module$build$src$core$events$events=BUBBLE_OPEN$$module$build$src$core$events$utils,BUMP_EVENTS$$module$build$src$core$events$events=BUMP_EVENTS$$module$build$src$core$events$utils,CHANGE$$module$build$src$core$events$events=$.CHANGE$$module$build$src$core$events$utils,CLICK$$module$build$src$core$events$events=CLICK$$module$build$src$core$events$utils,COMMENT_CHANGE$$module$build$src$core$events$events=COMMENT_CHANGE$$module$build$src$core$events$utils,\nCOMMENT_CREATE$$module$build$src$core$events$events=COMMENT_CREATE$$module$build$src$core$events$utils,COMMENT_DELETE$$module$build$src$core$events$events=COMMENT_DELETE$$module$build$src$core$events$utils,COMMENT_MOVE$$module$build$src$core$events$events=COMMENT_MOVE$$module$build$src$core$events$utils,CREATE$$module$build$src$core$events$events=$.CREATE$$module$build$src$core$events$utils,DELETE$$module$build$src$core$events$events=$.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING$$module$build$src$core$events$events=\nFINISHED_LOADING$$module$build$src$core$events$utils,MARKER_MOVE$$module$build$src$core$events$events=MARKER_MOVE$$module$build$src$core$events$utils,MOVE$$module$build$src$core$events$events=$.MOVE$$module$build$src$core$events$utils,SELECTED$$module$build$src$core$events$events=SELECTED$$module$build$src$core$events$utils,THEME_CHANGE$$module$build$src$core$events$events=THEME_CHANGE$$module$build$src$core$events$utils,TOOLBOX_ITEM_SELECT$$module$build$src$core$events$events=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils,\nTRASHCAN_OPEN$$module$build$src$core$events$events=TRASHCAN_OPEN$$module$build$src$core$events$utils,UI$$module$build$src$core$events$events=UI$$module$build$src$core$events$utils,VAR_CREATE$$module$build$src$core$events$events=VAR_CREATE$$module$build$src$core$events$utils,VAR_DELETE$$module$build$src$core$events$events=VAR_DELETE$$module$build$src$core$events$utils,VAR_RENAME$$module$build$src$core$events$events=VAR_RENAME$$module$build$src$core$events$utils,VIEWPORT_CHANGE$$module$build$src$core$events$events=\nVIEWPORT_CHANGE$$module$build$src$core$events$utils,clearPendingUndo$$module$build$src$core$events$events=clearPendingUndo$$module$build$src$core$events$utils,disable$$module$build$src$core$events$events=$.disable$$module$build$src$core$events$utils,enable$$module$build$src$core$events$events=$.enable$$module$build$src$core$events$utils,filter$$module$build$src$core$events$events=filter$$module$build$src$core$events$utils,fire$$module$build$src$core$events$events=fire$$module$build$src$core$events$utils,\nfromJson$$module$build$src$core$events$events=fromJson$$module$build$src$core$events$utils,getDescendantIds$$module$build$src$core$events$events=getDescendantIds$$module$build$src$core$events$utils,get$$module$build$src$core$events$events=get$$module$build$src$core$events$utils,getGroup$$module$build$src$core$events$events=$.getGroup$$module$build$src$core$events$utils,getRecordUndo$$module$build$src$core$events$events=getRecordUndo$$module$build$src$core$events$utils,isEnabled$$module$build$src$core$events$events=\nisEnabled$$module$build$src$core$events$utils,setGroup$$module$build$src$core$events$events=$.setGroup$$module$build$src$core$events$utils,setRecordUndo$$module$build$src$core$events$events=setRecordUndo$$module$build$src$core$events$utils,disableOrphans$$module$build$src$core$events$events=disableOrphans$$module$build$src$core$events$utils,module$build$src$core$events$events={};module$build$src$core$events$events.Abstract=Abstract$$module$build$src$core$events$events_abstract;\nmodule$build$src$core$events$events.BLOCK_CHANGE=$.CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$events.BLOCK_CREATE=$.CREATE$$module$build$src$core$events$utils;module$build$src$core$events$events.BLOCK_DELETE=$.DELETE$$module$build$src$core$events$utils;module$build$src$core$events$events.BLOCK_DRAG=BLOCK_DRAG$$module$build$src$core$events$utils;module$build$src$core$events$events.BLOCK_FIELD_INTERMEDIATE_CHANGE=BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils;\nmodule$build$src$core$events$events.BLOCK_MOVE=$.MOVE$$module$build$src$core$events$utils;module$build$src$core$events$events.BUBBLE_OPEN=BUBBLE_OPEN$$module$build$src$core$events$utils;module$build$src$core$events$events.BUMP_EVENTS=BUMP_EVENTS$$module$build$src$core$events$utils;module$build$src$core$events$events.BlockBase=BlockBase$$module$build$src$core$events$events_block_base;module$build$src$core$events$events.BlockChange=BlockChange$$module$build$src$core$events$events_block_change;\nmodule$build$src$core$events$events.BlockCreate=BlockCreate$$module$build$src$core$events$events_block_create;module$build$src$core$events$events.BlockDelete=BlockDelete$$module$build$src$core$events$events_block_delete;module$build$src$core$events$events.BlockDrag=BlockDrag$$module$build$src$core$events$events_block_drag;module$build$src$core$events$events.BlockFieldIntermediateChange=BlockFieldIntermediateChange$$module$build$src$core$events$events_block_field_intermediate_change;\nmodule$build$src$core$events$events.BlockMove=BlockMove$$module$build$src$core$events$events_block_move;module$build$src$core$events$events.BubbleOpen=BubbleOpen$$module$build$src$core$events$events_bubble_open;module$build$src$core$events$events.BubbleType=BubbleType$$module$build$src$core$events$events_bubble_open;module$build$src$core$events$events.CHANGE=$.CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$events.CLICK=CLICK$$module$build$src$core$events$utils;\nmodule$build$src$core$events$events.COMMENT_CHANGE=COMMENT_CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$events.COMMENT_CREATE=COMMENT_CREATE$$module$build$src$core$events$utils;module$build$src$core$events$events.COMMENT_DELETE=COMMENT_DELETE$$module$build$src$core$events$utils;module$build$src$core$events$events.COMMENT_MOVE=COMMENT_MOVE$$module$build$src$core$events$utils;module$build$src$core$events$events.CREATE=$.CREATE$$module$build$src$core$events$utils;\nmodule$build$src$core$events$events.Click=Click$$module$build$src$core$events$events_click;module$build$src$core$events$events.ClickTarget=ClickTarget$$module$build$src$core$events$events_click;module$build$src$core$events$events.CommentBase=CommentBase$$module$build$src$core$events$events_comment_base;module$build$src$core$events$events.CommentChange=CommentChange$$module$build$src$core$events$events_comment_change;module$build$src$core$events$events.CommentCreate=CommentCreate$$module$build$src$core$events$events_comment_create;\nmodule$build$src$core$events$events.CommentDelete=CommentDelete$$module$build$src$core$events$events_comment_delete;module$build$src$core$events$events.CommentMove=CommentMove$$module$build$src$core$events$events_comment_move;module$build$src$core$events$events.DELETE=$.DELETE$$module$build$src$core$events$utils;module$build$src$core$events$events.FINISHED_LOADING=FINISHED_LOADING$$module$build$src$core$events$utils;module$build$src$core$events$events.FinishedLoading=FinishedLoading$$module$build$src$core$events$workspace_events;\nmodule$build$src$core$events$events.MARKER_MOVE=MARKER_MOVE$$module$build$src$core$events$utils;module$build$src$core$events$events.MOVE=$.MOVE$$module$build$src$core$events$utils;module$build$src$core$events$events.MarkerMove=MarkerMove$$module$build$src$core$events$events_marker_move;module$build$src$core$events$events.SELECTED=SELECTED$$module$build$src$core$events$utils;module$build$src$core$events$events.Selected=Selected$$module$build$src$core$events$events_selected;\nmodule$build$src$core$events$events.THEME_CHANGE=THEME_CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$events.TOOLBOX_ITEM_SELECT=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils;module$build$src$core$events$events.TRASHCAN_OPEN=TRASHCAN_OPEN$$module$build$src$core$events$utils;module$build$src$core$events$events.ThemeChange=ThemeChange$$module$build$src$core$events$events_theme_change;module$build$src$core$events$events.ToolboxItemSelect=ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select;\nmodule$build$src$core$events$events.TrashcanOpen=TrashcanOpen$$module$build$src$core$events$events_trashcan_open;module$build$src$core$events$events.UI=UI$$module$build$src$core$events$utils;module$build$src$core$events$events.UiBase=UiBase$$module$build$src$core$events$events_ui_base;module$build$src$core$events$events.VAR_CREATE=VAR_CREATE$$module$build$src$core$events$utils;module$build$src$core$events$events.VAR_DELETE=VAR_DELETE$$module$build$src$core$events$utils;\nmodule$build$src$core$events$events.VAR_RENAME=VAR_RENAME$$module$build$src$core$events$utils;module$build$src$core$events$events.VIEWPORT_CHANGE=VIEWPORT_CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$events.VarBase=VarBase$$module$build$src$core$events$events_var_base;module$build$src$core$events$events.VarCreate=VarCreate$$module$build$src$core$events$events_var_create;module$build$src$core$events$events.VarDelete=VarDelete$$module$build$src$core$events$events_var_delete;\nmodule$build$src$core$events$events.VarRename=VarRename$$module$build$src$core$events$events_var_rename;module$build$src$core$events$events.ViewportChange=ViewportChange$$module$build$src$core$events$events_viewport;module$build$src$core$events$events.clearPendingUndo=clearPendingUndo$$module$build$src$core$events$utils;module$build$src$core$events$events.disable=$.disable$$module$build$src$core$events$utils;module$build$src$core$events$events.disableOrphans=disableOrphans$$module$build$src$core$events$utils;\nmodule$build$src$core$events$events.enable=$.enable$$module$build$src$core$events$utils;module$build$src$core$events$events.filter=filter$$module$build$src$core$events$utils;module$build$src$core$events$events.fire=fire$$module$build$src$core$events$utils;module$build$src$core$events$events.fromJson=fromJson$$module$build$src$core$events$utils;module$build$src$core$events$events.get=get$$module$build$src$core$events$utils;module$build$src$core$events$events.getDescendantIds=getDescendantIds$$module$build$src$core$events$utils;\nmodule$build$src$core$events$events.getGroup=$.getGroup$$module$build$src$core$events$utils;module$build$src$core$events$events.getRecordUndo=getRecordUndo$$module$build$src$core$events$utils;module$build$src$core$events$events.isEnabled=isEnabled$$module$build$src$core$events$utils;module$build$src$core$events$events.setGroup=$.setGroup$$module$build$src$core$events$utils;module$build$src$core$events$events.setRecordUndo=setRecordUndo$$module$build$src$core$events$utils;var ConstantProvider$$module$build$src$core$renderers$zelos$constants=class extends ConstantProvider$$module$build$src$core$renderers$common$constants{constructor(){super();this.GRID_UNIT=4;this.CURSOR_COLOUR=\"#ffa200\";this.CURSOR_RADIUS=5;this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0;this.START_HAT_HEIGHT=22;this.START_HAT_WIDTH=96;this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5};this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},\n2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}};this.FULL_BLOCK_FIELDS=!0;this.FIELD_TEXT_FONTWEIGHT=\"bold\";this.FIELD_TEXT_FONTFAMILY='\"Helvetica Neue\", \"Segoe UI\", Helvetica, sans-serif';this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0;this.SELECTED_GLOW_COLOUR=\"#fff200\";\nthis.SELECTED_GLOW_SIZE=.5;this.REPLACEMENT_GLOW_COLOUR=\"#fff200\";this.REPLACEMENT_GLOW_SIZE=2;this.selectedGlowFilterId=\"\";this.selectedGlowFilter=null;this.replacementGlowFilterId=\"\";this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null;this.SMALL_PADDING=this.GRID_UNIT;this.MEDIUM_PADDING=2*this.GRID_UNIT;this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT;this.LARGE_PADDING=4*this.GRID_UNIT;this.CORNER_RADIUS=1*this.GRID_UNIT;this.NOTCH_WIDTH=9*this.GRID_UNIT;this.NOTCH_HEIGHT=2*this.GRID_UNIT;\nthis.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT;this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT;this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT;this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT;this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS;this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING;this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS;this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT;this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT;this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*\nthis.GRID_UNIT;this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT;this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT;this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT;this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT;this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT;this.CURSOR_WS_WIDTH=20*this.GRID_UNIT;this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT;this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS;this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT;this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT;this.FIELD_BORDER_RECT_HEIGHT=\n8*this.GRID_UNIT;this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT;this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING;this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT;this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT;this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT;this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(a){super.setFontConstants_(a);this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init();\nthis.HEXAGONAL=this.makeHexagonal();this.ROUNDED=this.makeRounded();this.SQUARED=this.makeSquared();this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(a){super.setDynamicProperties_(a);this.SELECTED_GLOW_COLOUR=a.getComponentStyle(\"selectedGlowColour\")||this.SELECTED_GLOW_COLOUR;const b=Number(a.getComponentStyle(\"selectedGlowSize\"));this.SELECTED_GLOW_SIZE=b&&!isNaN(b)?b:this.SELECTED_GLOW_SIZE;this.REPLACEMENT_GLOW_COLOUR=a.getComponentStyle(\"replacementGlowColour\")||\nthis.REPLACEMENT_GLOW_COLOUR;this.REPLACEMENT_GLOW_SIZE=(a=Number(a.getComponentStyle(\"replacementGlowSize\")))&&!isNaN(a)?a:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose();this.selectedGlowFilter&&removeNode$$module$build$src$core$utils$dom(this.selectedGlowFilter);this.replacementGlowFilter&&removeNode$$module$build$src$core$utils$dom(this.replacementGlowFilter)}makeStartHat(){const a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH,c=curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(25,\n-a),point$$module$build$src$core$utils$svg_paths(71,-a),point$$module$build$src$core$utils$svg_paths(b,0)]);return{height:a,width:b,path:c}}makeHexagonal(){function a(c,d,e){var f=c/2;f=f>b?b:f;e=e?-1:1;c=(d?-1:1)*c/2;return lineTo$$module$build$src$core$utils$svg_paths(-e*f,c)+lineTo$$module$build$src$core$utils$svg_paths(e*f,c)}const b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(c){c/=2;return c>b?b:c},height(c){return c},connectionOffsetY(c){return c/\n2},connectionOffsetX(c){return-c},pathDown(c){return a(c,!1,!1)},pathUp(c){return a(c,!0,!1)},pathRightDown(c){return a(c,!1,!0)},pathRightUp(c){return a(c,!1,!0)}}}makeRounded(){function a(d,e,f){const g=d>c?d-c:0;d=(d>c?c:d)/2;return arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",d,point$$module$build$src$core$utils$svg_paths((e?-1:1)*d,(e?-1:1)*d))+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",(f?1:-1)*g)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",d,point$$module$build$src$core$utils$svg_paths((e?\n1:-1)*d,(e?-1:1)*d))}const b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=2*b;return{type:this.SHAPES.ROUND,isDynamic:!0,width(d){d/=2;return d>b?b:d},height(d){return d},connectionOffsetY(d){return d/2},connectionOffsetX(d){return-d},pathDown(d){return a(d,!1,!1)},pathUp(d){return a(d,!0,!1)},pathRightDown(d){return a(d,!1,!0)},pathRightUp(d){return a(d,!1,!0)}}}makeSquared(){function a(c,d,e){c-=2*b;return arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",b,point$$module$build$src$core$utils$svg_paths((d?\n-1:1)*b,(d?-1:1)*b))+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",(e?1:-1)*c)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",b,point$$module$build$src$core$utils$svg_paths((d?1:-1)*b,(d?-1:1)*b))}const b=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(c){return b},height(c){return c},connectionOffsetY(c){return c/2},connectionOffsetX(c){return-c},pathDown(c){return a(c,!1,!1)},pathUp(c){return a(c,!0,!1)},pathRightDown(c){return a(c,!1,!0)},pathRightUp(c){return a(c,\n!1,!0)}}}shapeFor(a){let b=a.getCheck();!b&&a.targetConnection&&(b=a.targetConnection.getCheck());switch(a.type){case ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE:case ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE:a=a.getSourceBlock().getOutputShape();if(null!==a)switch(a){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}if(b&&-1!==b.indexOf(\"Boolean\"))return this.HEXAGONAL;\nif(b&&-1!==b.indexOf(\"Number\"))return this.ROUNDED;b&&b.indexOf(\"String\");return this.ROUNDED;case ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT:case ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT:return this.NOTCH;default:throw Error(\"Unknown type\");}}makeNotch(){function a(l){return curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(l*e/2,0),point$$module$build$src$core$utils$svg_paths(l*e*3/4,g/2),point$$module$build$src$core$utils$svg_paths(l*\ne,g)])+line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(l*e,f)])+curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(l*e/4,g/2),point$$module$build$src$core$utils$svg_paths(l*e/2,g),point$$module$build$src$core$utils$svg_paths(l*e,g)])+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",l*d)+curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(l*e/2,0),point$$module$build$src$core$utils$svg_paths(l*\ne*3/4,-(g/2)),point$$module$build$src$core$utils$svg_paths(l*e,-g)])+line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(l*e,-f)])+curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(l*e/4,-(g/2)),point$$module$build$src$core$utils$svg_paths(l*e/2,-g),point$$module$build$src$core$utils$svg_paths(l*e,-g)])}const b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=b/3,e=d/3,f=c/2,g=f/2,h=a(1),k=a(-1);return{type:this.SHAPES.NOTCH,\nwidth:b,height:c,pathLeft:h,pathRight:k}}makeInsideCorners(){const a=this.CORNER_RADIUS,b=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a,point$$module$build$src$core$utils$svg_paths(-a,a)),c=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a,point$$module$build$src$core$utils$svg_paths(-a,a)),d=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a,point$$module$build$src$core$utils$svg_paths(a,a)),e=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a,point$$module$build$src$core$utils$svg_paths(a,\na));return{width:a,height:a,pathTop:b,pathBottom:d,rightWidth:a,rightHeight:a,pathTopRight:c,pathBottomRight:e}}generateSecondaryColour_(a){return blend$$module$build$src$core$utils$colour(\"#000\",a,.15)||a}generateTertiaryColour_(a){return blend$$module$build$src$core$utils$colour(\"#000\",a,.25)||a}createDom(a,b,c){super.createDom(a,b,c);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.DEFS,{},a);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,\n{id:\"blocklySelectedGlowFilter\"+this.randomIdentifier,height:\"160%\",width:\"180%\",y:\"-30%\",x:\"-40%\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR,{\"in\":\"SourceGraphic\",stdDeviation:this.SELECTED_GLOW_SIZE},b);c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER,{result:\"outBlur\"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFUNCA,{type:\"table\",\ntableValues:\"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"},c);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFLOOD,{\"flood-color\":this.SELECTED_GLOW_COLOUR,\"flood-opacity\":1,result:\"outColor\"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{\"in\":\"outColor\",in2:\"outBlur\",operator:\"in\",result:\"outGlow\"},b);this.selectedGlowFilterId=b.id;this.selectedGlowFilter=b;a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,\n{id:\"blocklyReplacementGlowFilter\"+this.randomIdentifier,height:\"160%\",width:\"180%\",y:\"-30%\",x:\"-40%\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR,{\"in\":\"SourceGraphic\",stdDeviation:this.REPLACEMENT_GLOW_SIZE},a);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER,{result:\"outBlur\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFUNCA,{type:\"table\",\ntableValues:\"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFLOOD,{\"flood-color\":this.REPLACEMENT_GLOW_COLOUR,\"flood-opacity\":1,result:\"outColor\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{\"in\":\"outColor\",in2:\"outBlur\",operator:\"in\",result:\"outGlow\"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{\"in\":\"SourceGraphic\",\nin2:\"outGlow\",operator:\"over\"},a);this.replacementGlowFilterId=a.id;this.replacementGlowFilter=a}getCSS_(a){return[`${a} .blocklyText,`,`${a} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}`+`pt ${this.FIELD_TEXT_FONTFAMILY};`,\"}\",`${a} .blocklyText {`,\"fill: #fff;\",\"}\",`${a} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${a} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\"}\",`${a} .blocklyNonEditableText>text,`,\n`${a} .blocklyEditableText>text,`,`${a} .blocklyNonEditableText>g>text,`,`${a} .blocklyEditableText>g>text {`,\"fill: #575E75;\",\"}\",`${a} .blocklyFlyoutLabelText {`,\"fill: #575E75;\",\"}\",`${a} .blocklyText.blocklyBubbleText {`,\"fill: #575E75;\",\"}\",`${a} .blocklyDraggable:not(.blocklyDisabled)`,\" .blocklyEditableText:not(.editing):hover>rect,\",`${a} .blocklyDraggable:not(.blocklyDisabled)`,\" .blocklyEditableText:not(.editing):hover>.blocklyPath {\",\"stroke: #fff;\",\"stroke-width: 2;\",\"}\",`${a} .blocklyHtmlInput {`,\n`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\"color: #575E75;\",\"}\",`${a} .blocklyDropdownText {`,\"fill: #fff !important;\",\"}\",`${a}.blocklyWidgetDiv .goog-menuitem,`,`${a}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\"}\",`${a}.blocklyDropDownDiv .goog-menuitem-content {`,\"color: #fff;\",\"}\",`${a} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,\"}\",`${a} .blocklyDisabled > .blocklyOutlinePath {`,\n`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,\"}\",`${a} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\"stroke: none;\",\"}\"]}},module$build$src$core$renderers$zelos$constants={};module$build$src$core$renderers$zelos$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$zelos$constants;var Drawer$$module$build$src$core$renderers$zelos$drawer=class extends Drawer$$module$build$src$core$renderers$common$drawer{constructor(a,b){super(a,b)}draw(){const a=this.block_.pathObject;a.beginDrawing();this.drawOutline_();this.drawInternals_();a.setPath(this.outlinePath_+\"\\n\"+this.inlinePath_);this.info_.RTL&&a.flipRTL();this.recordSizeOnBlock_();this.info_.outputConnection&&(a.outputShapeType=this.info_.outputConnection.shape.type);a.endDrawing()}drawOutline_(){this.info_.outputConnection&&\nthis.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(a){if(!(0>=a.height)){if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(a)){const d=\na.precedesStatement;var b=a.followsStatement;if(d||b){const e=this.constants_.INSIDE_CORNERS;var c=e.rightHeight;c=a.height-(d?c:0);b=b?e.pathBottomRight:\"\";a=0<c?lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.yPos+c):\"\";this.outlinePath_+=b+a+(d?e.pathTopRight:\"\");return}}this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.yPos+a.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error(\"Cannot draw the output connection of a block that doesn't have one\");\nthis.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error(\"Cannot draw the output connection of a block that doesn't have one\");this.positionOutputConnection_();this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height);this.outlinePath_+=\"z\"}drawFlatTop_(){const a=this.info_.topRow;this.positionPreviousConnection_();this.outlinePath_+=moveBy$$module$build$src$core$utils$svg_paths(a.xPos,\nthis.info_.startY);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",a.width)}drawFlatBottom_(){const a=this.info_.bottomRow;this.positionNextConnection_();this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.baseline);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",-a.width)}drawInlineInput_(a){this.positionInlineInputConnection_(a);const b=a.input.name;if(!a.connectedBlock&&!this.info_.isInsertionMarker){var c=a.width-2*a.connectionWidth;\na=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+a.connectionWidth,a.centerline-a.height/2)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",c)+a.shape.pathRightDown(a.height)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",-c)+a.shape.pathUp(a.height)+\"z\";this.block_.pathObject.setOutlinePath(b,a)}}drawStatementInput_(a){var b=a.getLastInput();const c=b.xPos+b.notchOffset+b.shape.width,d=this.constants_.INSIDE_CORNERS,e=b.shape.pathRight+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",\n-(b.notchOffset-d.width))+d.pathTop,f=a.height-2*d.height;b=d.pathBottom+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",b.notchOffset-d.width)+(b.connectedBottomNextConnection?\"\":b.shape.pathLeft);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",c)+e+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",f)+b+lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",a.xPos+a.width);this.positionStatementInputConnection_(a)}},module$build$src$core$renderers$zelos$drawer={};\nmodule$build$src$core$renderers$zelos$drawer.Drawer=Drawer$$module$build$src$core$renderers$zelos$drawer;var FieldImage$$module$build$src$core$field_image=class extends Field$$module$build$src$core$field{constructor(a,b,c,d,e,f,g){super(Field$$module$build$src$core$field.SKIP_SETUP);this.imageElement=this.clickHandler=null;this.flipRtl=this.isDirty_=this.EDITABLE=!1;this.altText=\"\";c=Number(replaceMessageReferences$$module$build$src$core$utils$parsing(c));b=Number(replaceMessageReferences$$module$build$src$core$utils$parsing(b));if(isNaN(c)||isNaN(b))throw Error(\"Height and width values of an image field must cast to numbers.\");\nif(0>=c||0>=b)throw Error(\"Height and width values of an image field must be greater than 0.\");this.size_=new Size$$module$build$src$core$utils$size(b,c+FieldImage$$module$build$src$core$field_image.Y_PADDING);this.imageHeight=c;\"function\"===typeof e&&(this.clickHandler=e);a!==Field$$module$build$src$core$field.SKIP_SETUP&&(g?this.configure_(g):(this.flipRtl=!!f,this.altText=replaceMessageReferences$$module$build$src$core$utils$parsing(d)||\"\"),this.setValue(replaceMessageReferences$$module$build$src$core$utils$parsing(a)))}configure_(a){super.configure_(a);\na.flipRtl&&(this.flipRtl=a.flipRtl);a.alt&&(this.altText=replaceMessageReferences$$module$build$src$core$utils$parsing(a.alt))}initView(){this.imageElement=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{height:this.imageHeight+\"px\",width:this.size_.width+\"px\",alt:this.altText},this.fieldGroup_);this.imageElement.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.value_);this.clickHandler&&(this.imageElement.style.cursor=\"pointer\")}updateSize_(){}doClassValidation_(a){return\"string\"!==\ntypeof a?null:a}doValueUpdate_(a){this.value_=a;this.imageElement&&this.imageElement.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,\"xlink:href\",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(a){a!==this.altText&&(this.altText=a||\"\",this.imageElement&&this.imageElement.setAttribute(\"alt\",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(a){this.clickHandler=a}getText_(){return this.altText}static fromJson(a){if(!a.src||!a.width||!a.height)throw Error(\"src, width, and height values for an image field arerequired. The width and height must be non-zero.\");\nreturn new this(a.src,a.width,a.height,void 0,void 0,void 0,a)}};FieldImage$$module$build$src$core$field_image.Y_PADDING=1;register$$module$build$src$core$field_registry(\"field_image\",FieldImage$$module$build$src$core$field_image);FieldImage$$module$build$src$core$field_image.prototype.DEFAULT_VALUE=\"\";var module$build$src$core$field_image={};module$build$src$core$field_image.FieldImage=FieldImage$$module$build$src$core$field_image;var FieldInput$$module$build$src$core$field_input=class extends Field$$module$build$src$core$field{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.spellcheck_=!0;this.htmlInput_=null;this.isTextValid_=this.isBeingEdited_=!1;this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null;this.fullBlockClickTarget_=!1;this.workspace_=null;this.SERIALIZABLE=!0;this.CURSOR=\"text\";a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),\nthis.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a);void 0!==a.spellcheck&&(this.spellcheck_=a.spellcheck)}initView(){if(!this.getSourceBlock())throw new UnattachedFieldError$$module$build$src$core$field;super.initView();this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;let b;return this.fullBlockClickTarget_=!(null==(b=this.getConstants())||\n!b.FULL_BLOCK_FIELDS)&&a.isSimpleReporter()}doValueInvalid_(a){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,a=this.value_,this.value_=this.htmlInput_.getAttribute(\"data-untyped-default-value\"),this.sourceBlock_&&isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,\"field\",this.name||null,a,this.value_)))}doValueUpdate_(a){this.isTextValid_=\nthis.isDirty_=!0;this.value_=a}applyColour(){const a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display=\"block\",this.borderRect_.setAttribute(\"stroke\",a.style.colourTertiary)):(this.borderRect_.style.display=\"none\",a.pathObject.svgPath.setAttribute(\"fill\",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let a;if(null==(a=\nthis.getConstants())?0:a.FULL_BLOCK_FIELDS)this.render_(),this.isDirty_=!1;return super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){super.render_();if(this.isBeingEdited_){var a=this.htmlInput_;this.isTextValid_?(removeClass$$module$build$src$core$utils$dom(a,\"blocklyInvalidInput\"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!1)):(addClass$$module$build$src$core$utils$dom(a,\"blocklyInvalidInput\"),setState$$module$build$src$core$utils$aria(a,\nState$$module$build$src$core$utils$aria.INVALID,!0))}a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;this.getConstants().FULL_BLOCK_FIELDS&&a.applyColour()}setSpellcheck(a){a!==this.spellcheck_&&(this.spellcheck_=a,this.htmlInput_&&this.htmlInput_.setAttribute(\"spellcheck\",this.spellcheck_))}showEditor_(a,b=!1){this.workspace_=this.sourceBlock_.workspace;!b&&this.workspace_.options.modalInputs&&(MOBILE$$module$build$src$core$utils$useragent||ANDROID$$module$build$src$core$utils$useragent||\nIPAD$$module$build$src$core$utils$useragent)?this.showPromptEditor_():this.showInlineEditor_(b)}showPromptEditor_(){prompt$$module$build$src$core$dialog($.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),a=>{null!==a&&this.setValue(this.getValueFromEditorText_(a));this.onFinishEditing_(this.value_)})}showInlineEditor_(a){const b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;show$$module$build$src$core$widgetdiv(this,b.RTL,this.widgetDispose_.bind(this));\nthis.htmlInput_=this.widgetCreate_();this.isBeingEdited_=!0;this.valueWhenEditorWasOpened_=this.value_;a||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;$.setGroup$$module$build$src$core$events$utils(!0);const b=getDiv$$module$build$src$core$widgetdiv();var c=this.getClickTarget_();if(!c)throw Error(\"A click target has not been set.\");addClass$$module$build$src$core$utils$dom(c,\n\"editing\");c=document.createElement(\"input\");c.className=\"blocklyHtmlInput\";c.setAttribute(\"spellcheck\",this.spellcheck_);const d=this.workspace_.getScale();var e=this.getConstants().FIELD_TEXT_FONTSIZE*d+\"pt\";b.style.fontSize=e;c.style.fontSize=e;e=FieldInput$$module$build$src$core$field_input.BORDERRADIUS*d+\"px\";this.isFullBlockField()&&(e=this.getScaledBBox(),e=(e.bottom-e.top)/2+\"px\",a=a.getParent()?a.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,c.style.border=1*d+\"px solid \"+\na,b.style.borderRadius=e,b.style.transition=\"box-shadow 0.25s ease 0s\",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(b.style.boxShadow=\"rgba(255, 255, 255, 0.3) 0 0 0 \"+4*d+\"px\"));c.style.borderRadius=e;b.appendChild(c);c.value=c.defaultValue=this.getEditorText_(this.value_);c.setAttribute(\"data-untyped-default-value\",String(this.value_));this.resizeEditor_();this.bindInputEvents_(c);return c}widgetDispose_(){this.isBeingEdited_=!1;this.isTextValid_=!0;this.forceRerender();this.onFinishEditing_(this.value_);\nthis.sourceBlock_&&isEnabled$$module$build$src$core$events$utils()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,\"field\",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null);$.setGroup$$module$build$src$core$events$utils(!1);this.unbindInputEvents_();var a=getDiv$$module$build$src$core$widgetdiv().style;\na.width=\"auto\";a.height=\"auto\";a.fontSize=\"\";a.transition=\"\";a.boxShadow=\"\";this.htmlInput_=null;a=this.getClickTarget_();if(!a)throw Error(\"A click target has not been set.\");removeClass$$module$build$src$core$utils$dom(a,\"editing\")}onFinishEditing_(a){}bindInputEvents_(a){this.onKeyDownWrapper_=conditionalBind$$module$build$src$core$browser_events(a,\"keydown\",this,this.onHtmlInputKeyDown_);this.onKeyInputWrapper_=conditionalBind$$module$build$src$core$browser_events(a,\"input\",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&\n(unbind$$module$build$src$core$browser_events(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null);this.onKeyInputWrapper_&&(unbind$$module$build$src$core$browser_events(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(a){\"Enter\"===a.key?(hide$$module$build$src$core$widgetdiv(),hideWithoutAnimation$$module$build$src$core$dropdowndiv()):\"Escape\"===a.key?(this.setValue(this.htmlInput_.getAttribute(\"data-untyped-default-value\")),hide$$module$build$src$core$widgetdiv(),hideWithoutAnimation$$module$build$src$core$dropdowndiv()):\n\"Tab\"===a.key&&(hide$$module$build$src$core$widgetdiv(),hideWithoutAnimation$$module$build$src$core$dropdowndiv(),this.sourceBlock_.tab(this,!a.shiftKey),a.preventDefault())}onHtmlInputChange_(a){a=this.value_;this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1);this.sourceBlock_&&isEnabled$$module$build$src$core$events$utils()&&this.value_!==a&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,\nthis.name||null,a,this.value_))}setEditorValue_(a,b=!0){this.isDirty_=!0;this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(a));this.setValue(a,b)}resizeEditor_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;const b=getDiv$$module$build$src$core$widgetdiv(),c=this.getScaledBBox();b.style.width=c.right-c.left+\"px\";b.style.height=c.bottom-c.top+\"px\";a=new Coordinate$$module$build$src$core$utils$coordinate(a.RTL?c.right-b.offsetWidth:c.left,\nc.top);b.style.left=a.x+\"px\";b.style.top=a.y+\"px\"}repositionForWindowResize(){const a=this.getSourceBlock();if(!(a instanceof BlockSvg$$module$build$src$core$block_svg))return!1;bumpObjectIntoBounds$$module$build$src$core$bump_objects(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),a)||this.resizeEditor_();return!0}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(a){return`${a}`}getValueFromEditorText_(a){return a}};\nFieldInput$$module$build$src$core$field_input.BORDERRADIUS=4;var module$build$src$core$field_input={};module$build$src$core$field_input.FieldInput=FieldInput$$module$build$src$core$field_input;var FieldTextInput$$module$build$src$core$field_textinput=class extends FieldInput$$module$build$src$core$field_input{constructor(a,b,c){super(a,b,c)}doClassValidation_(a){return void 0===a?null:`${a}`}static fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a)}};register$$module$build$src$core$field_registry(\"field_input\",FieldTextInput$$module$build$src$core$field_textinput);\nFieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE=\"\";var module$build$src$core$field_textinput={};module$build$src$core$field_textinput.FieldTextInput=FieldTextInput$$module$build$src$core$field_textinput;var BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row=class extends BottomRow$$module$build$src$core$renderers$measurables$bottom_row{constructor(a){super(a)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(a){return!!a.outputConnection}hasRightSquareCorner(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection}},module$build$src$core$renderers$zelos$measurables$bottom_row={};module$build$src$core$renderers$zelos$measurables$bottom_row.BottomRow=BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row;var StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs=class extends StatementInput$$module$build$src$core$renderers$measurables$statement_input{constructor(a,b){super(a,b);this.connectedBottomNextConnection=!1;if(this.connectedBlock){for(a=this.connectedBlock;b=a.getNextBlock();)a=b;a.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},module$build$src$core$renderers$zelos$measurables$inputs={};\nmodule$build$src$core$renderers$zelos$measurables$inputs.StatementInput=StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs;var RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements=class extends Measurable$$module$build$src$core$renderers$measurables$base{constructor(a){super(a);this.width=this.height=0;this.type|=Types$$module$build$src$core$renderers$measurables$types.getType(\"RIGHT_CONNECTION\")}},module$build$src$core$renderers$zelos$measurables$row_elements={};module$build$src$core$renderers$zelos$measurables$row_elements.RightConnectionShape=RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements;var TopRow$$module$build$src$core$renderers$zelos$measurables$top_row=class extends TopRow$$module$build$src$core$renderers$measurables$top_row{constructor(a){super(a)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(a){const b=(a.hat?\"cap\"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection;return!!a.outputConnection||b}hasRightSquareCorner(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection}},module$build$src$core$renderers$zelos$measurables$top_row=\n{};module$build$src$core$renderers$zelos$measurables$top_row.TopRow=TopRow$$module$build$src$core$renderers$zelos$measurables$top_row;var RenderInfo$$module$build$src$core$renderers$zelos$info=class extends RenderInfo$$module$build$src$core$renderers$common$info{constructor(a,b){super(a,b);this.isInline=!0;this.renderer_=a;this.constants_=this.renderer_.getConstants();this.topRow=new TopRow$$module$build$src$core$renderers$zelos$measurables$top_row(this.constants_);this.bottomRow=new BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row(this.constants_);this.isMultiRow=!b.getInputsInline()||b.isCollapsed();this.hasStatementInput=\n0<b.statementInputCount;this.rightSide=this.outputConnection?new RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements(this.constants_):null;this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_();this.addElemSpacing_();this.addRowSpacing_();this.adjustXPosition_();this.computeBounds_();this.alignRowElements_();this.finalize_()}shouldStartNewRow_(a,b){return b?b instanceof EndRowInput$$module$build$src$core$inputs$end_row_input||\na instanceof StatementInput$$module$build$src$core$inputs$statement_input||b instanceof StatementInput$$module$build$src$core$inputs$statement_input?!0:a instanceof $.ValueInput$$module$build$src$core$inputs$value_input||a instanceof DummyInput$$module$build$src$core$inputs$dummy_input||a instanceof EndRowInput$$module$build$src$core$inputs$end_row_input?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(a){return a.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||\n0):super.getDesiredRowWidth_(a)}getInRowSpacing_(a,b){return a&&b||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!a&&b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:a&&Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b&&(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))?\nb.notchOffset-this.constants_.CORNER_RADIUS:a&&Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isHat(b)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(a,b){if(Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)&&Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const c=\nTypes$$module$build$src$core$renderers$measurables$types.isInputRow(a)&&a.hasStatement,d=Types$$module$build$src$core$renderers$measurables$types.isInputRow(b)&&b.hasStatement;return d||c?(a=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),d&&c?Math.max(a,this.constants_.DUMMY_INPUT_MIN_HEIGHT):a):Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)?a.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:\nMath.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.outputConnection?!b.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(a,b){const c=this.width-\nthis.startX;return Types$$module$build$src$core$renderers$measurables$types.isInputRow(a)&&a.hasStatement||Types$$module$build$src$core$renderers$measurables$types.isInputRow(b)&&b.hasStatement?Math.max(c,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):c}getElemCenterline_(a,b){if(a.hasStatement&&!Types$$module$build$src$core$renderers$measurables$types.isSpacer(b)&&!Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return a.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/\n2;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)&&b instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection){const c=b.connectedBlock;if(c&&c.outputConnection&&c.nextConnection)return a.yPos+c.height/2}return super.getElemCenterline_(a,b)}addInput_(a,b){if((a instanceof DummyInput$$module$build$src$core$inputs$dummy_input||a instanceof EndRowInput$$module$build$src$core$inputs$end_row_input)&&b.hasDummyInput&&b.align===$.Align$$module$build$src$core$inputs$align.LEFT&&\na.align===$.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(b,a);else if(a instanceof StatementInput$$module$build$src$core$inputs$statement_input){b.elements.push(new StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs(this.constants_,a));b.hasStatement=!0;null===b.align&&(b.align=a.align);return}super.addInput_(a,b)}addAlignmentPadding_(a,b){if(this.rightAlignedDummyInputs.get(a)){let c;for(let d=0;d<a.elements.length;d++){const e=a.elements[d];\nTypes$$module$build$src$core$renderers$measurables$types.isSpacer(e)&&(c=e);if(Types$$module$build$src$core$renderers$measurables$types.isField(e)&&e instanceof Field$$module$build$src$core$renderers$measurables$field&&e.parentInput===this.rightAlignedDummyInputs.get(a))break}if(c){c.width+=b;a.width+=b;return}}super.addAlignmentPadding_(a,b)}adjustXPosition_(){const a=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let b=a;for(let e=2;e<this.rows.length-1;e+=2){var c=this.rows[e-1];\nconst f=this.rows[e];var d=this.rows[e+1];c=2===e?!!this.topRow.hasPreviousConnection:!!c.followsStatement;d=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!d.precedesStatement;if(Types$$module$build$src$core$renderers$measurables$types.isInputRow(f)&&f.hasStatement){f.measure();let g,h;b=f.width-(null!=(h=null==(g=f.getLastInput())?void 0:g.width)?h:0)+a}else if(c&&(2===e||d)&&Types$$module$build$src$core$renderers$measurables$types.isInputRow(f)&&!f.hasStatement){d=f.xPos;c=null;for(let g=\n0;g<f.elements.length;g++){const h=f.elements[g];Types$$module$build$src$core$renderers$measurables$types.isSpacer(h)&&(c=h);c&&(Types$$module$build$src$core$renderers$measurables$types.isField(h)||Types$$module$build$src$core$renderers$measurables$types.isInput(h))&&d<b&&!(Types$$module$build$src$core$renderers$measurables$types.isField(h)&&h instanceof Field$$module$build$src$core$renderers$measurables$field&&(h.field instanceof FieldLabel$$module$build$src$core$field_label||h.field instanceof FieldImage$$module$build$src$core$field_image))&&\n(c.width+=b-d);d+=h.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var a=this.outputConnection.shape;if(\"isDynamic\"in a&&a.isDynamic){var b=0;for(var c=0;c<this.rows.length;c++){const d=this.rows[c];d.yPos=b;b+=d.height}this.height=b;c=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height;b=a.height(c);c=a.width(c);this.outputConnection.height=b;this.outputConnection.width=c;this.outputConnection.startX=c;this.outputConnection.connectionOffsetY=\na.connectionOffsetY(b);this.outputConnection.connectionOffsetX=a.connectionOffsetX(c);a=0;this.hasStatementInput||this.bottomRow.hasNextConnection||(a=c,this.rightSide.height=b,this.rightSide.width=a,this.rightSide.centerline=b/2,this.rightSide.xPos=this.width+a);this.startX=c;this.width+=c+a;this.widthWithChildren+=c+a}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){var a=0;for(var b=0;b<this.rows.length;b++){var c=this.rows[b];\nif(!Types$$module$build$src$core$renderers$measurables$types.isInputRow(c))continue;a=c.elements[c.elements.length-2];let d=this.getNegativeSpacing_(c.elements[1]),e=this.getNegativeSpacing_(a);a=d+e;const f=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-a<f&&(a=this.width-f,d=a/2,e=a/2);c.elements.unshift(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,-d));c.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,\n-e))}if(a)for(this.width-=a,this.widthWithChildren-=a,this.rightSide.xPos-=a,b=0;b<this.rows.length;b++)c=this.rows[b],Types$$module$build$src$core$renderers$measurables$types.isTopOrBottomRow(c)&&(c.elements[1].width-=a),c.width-=a,c.widthWithConnectedBlocks-=a}}getNegativeSpacing_(a){if(!a||!this.outputConnection)return 0;const b=this.outputConnection.width;var c=this.outputConnection.shape.type;const d=this.constants_;if(1<this.inputRows.length)switch(c){case d.SHAPES.ROUND:return c=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,\nc=this.height/2>c?c:this.height/2,b-c*(1-Math.sin(Math.acos((c-this.constants_.SMALL_PADDING)/c)));default:return 0}if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a)&&a instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection){const e=a.connectedBlock;a=e?e.pathObject.outputShapeType:a.shape.type;return null==a||e&&e.outputConnection&&(e.statementInputCount||e.nextConnection)||c===d.SHAPES.HEXAGONAL&&c!==a?0:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][a]}return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&\na instanceof Field$$module$build$src$core$renderers$measurables$field?c===d.SHAPES.ROUND&&a.field instanceof FieldTextInput$$module$build$src$core$field_textinput?b-2.75*d.GRID_UNIT:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][0]:Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let d=2;d<this.rows.length-1;d+=2){const e=this.rows[d-1],f=this.rows[d],g=this.rows[d+1];var a=2===d,b=d+2>=this.rows.length-\n1?!!this.bottomRow.hasNextConnection:!!g.precedesStatement;if(a?this.topRow.hasPreviousConnection:e.followsStatement){var c=f.elements[1];c=3===f.elements.length&&c instanceof Field$$module$build$src$core$renderers$measurables$field&&(c.field instanceof FieldLabel$$module$build$src$core$field_label||c.field instanceof FieldImage$$module$build$src$core$field_image);if(!a&&c)e.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.SMALL_PADDING,f.height-=this.constants_.MEDIUM_PADDING;else if(!a&&\n!b)e.height+=this.constants_.SMALL_PADDING;else if(b){a=!1;for(b=0;b<f.elements.length;b++)if(c=f.elements[b],c instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection&&Types$$module$build$src$core$renderers$measurables$types.isInlineInput(c)&&c.connectedBlock&&!c.connectedBlock.isShadow()&&40<=c.connectedBlock.getHeightWidth().height){a=!0;break}a&&(e.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_();\nthis.finalizeHorizontalAlignment_();this.finalizeVerticalAlignment_();super.finalize_();this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},module$build$src$core$renderers$zelos$info={};module$build$src$core$renderers$zelos$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$zelos$info;var MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg=class extends MarkerSvg$$module$build$src$core$renderers$common$marker_svg{constructor(a,b,c){super(a,b,c);this.markerCircle=null}showWithInputOutput(a){const b=a.getSourceBlock();a=a.getLocation().getOffsetInBlock();this.positionCircle(a.x,a.y);this.setParent_(b);this.showCurrent_()}showWithOutput_(a){this.showWithInputOutput(a)}showWithInput_(a){this.showWithInputOutput(a)}showWithBlock_(a){a=a.getLocation();const b=a.getHeightWidth();\nthis.positionRect_(0,0,b.width,b.height);this.setParent_(a);this.showCurrent_()}positionCircle(a,b){let c;null==(c=this.markerCircle)||c.setAttribute(\"cx\",`${a}`);let d;null==(d=this.markerCircle)||d.setAttribute(\"cy\",`${b}`);this.currentMarkerSvg=this.markerCircle}hide(){super.hide();this.markerCircle&&(this.markerCircle.style.display=\"none\")}createDomInternal_(){super.createDomInternal_();this.markerCircle=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,\n{r:this.constants_.CURSOR_RADIUS,\"stroke-width\":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_);this.hide();if(this.isCursor()){const a=this.getBlinkProperties_();createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,a,this.markerCircle)}return this.markerSvg_}applyColour_(a){super.applyColour_(a);let b;null==(b=this.markerCircle)||b.setAttribute(\"fill\",this.colour_);let c;null==(c=this.markerCircle)||c.setAttribute(\"stroke\",this.colour_);if(this.isCursor()){a=\nthis.colour_+\";transparent;transparent;\";let d;null==(d=this.markerCircle)||d.firstElementChild.setAttribute(\"values\",a)}}},module$build$src$core$renderers$zelos$marker_svg={};module$build$src$core$renderers$zelos$marker_svg.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg;var PathObject$$module$build$src$core$renderers$zelos$path_object=class extends PathObject$$module$build$src$core$renderers$common$path_object{constructor(a,b,c){super(a,b,c);this.svgPathSelected=null;this.outlines=new Map;this.remainingOutlines=new Set;this.outputShapeType=null;this.constants=c}setPath(a){super.setPath(a);this.svgPathSelected&&this.svgPathSelected.setAttribute(\"d\",a)}applyColour(a){super.applyColour(a);const b=a.getParent();a.isShadow()&&b&&this.svgPath.setAttribute(\"stroke\",b.style.colourTertiary);\nfor(const c of this.outlines.values())c.setAttribute(\"fill\",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const a of this.outlines.values())a.setAttribute(\"transform\",\"scale(-1 1)\")}updateSelected(a){this.setClass_(\"blocklySelected\",a);a?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute(\"fill\",\"none\"),this.svgPathSelected.setAttribute(\"filter\",\"url(#\"+this.constants.selectedGlowFilterId+\")\"),this.svgRoot.appendChild(this.svgPathSelected)):\nthis.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(a){this.setClass_(\"blocklyReplaceable\",a);a?this.svgPath.setAttribute(\"filter\",\"url(#\"+this.constants.replacementGlowFilterId+\")\"):this.svgPath.removeAttribute(\"filter\")}updateShapeForInputHighlight(a,b){a=a.getParentInput().name;(a=this.getOutlinePath(a))&&(b?a.setAttribute(\"filter\",\"url(#\"+this.constants.replacementGlowFilterId+\")\"):a.removeAttribute(\"filter\"))}beginDrawing(){this.remainingOutlines.clear();\nfor(const a of this.outlines.keys())this.remainingOutlines.add(a)}endDrawing(){if(this.remainingOutlines.size)for(const a of this.remainingOutlines)this.removeOutlinePath(a);this.remainingOutlines.clear()}setOutlinePath(a,b){a=this.getOutlinePath(a);a.setAttribute(\"d\",b);a.setAttribute(\"fill\",this.style.colourTertiary)}getOutlinePath(a){this.outlines.has(a)||this.outlines.set(a,createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyOutlinePath\",\nd:\"\"},this.svgRoot));this.remainingOutlines.delete(a);return this.outlines.get(a)}removeOutlinePath(a){let b,c;null==(b=this.outlines.get(a))||null==(c=b.parentNode)||c.removeChild(this.outlines.get(a));this.outlines.delete(a)}},module$build$src$core$renderers$zelos$path_object={};module$build$src$core$renderers$zelos$path_object.PathObject=PathObject$$module$build$src$core$renderers$zelos$path_object;var Renderer$$module$build$src$core$renderers$zelos$renderer=class extends Renderer$$module$build$src$core$renderers$common$renderer{constructor(a){super(a)}makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$zelos$constants}makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$zelos$info(this,a)}makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$zelos$drawer(a,b)}makeMarkerDrawer(a,b){return new MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg(a,\nthis.getConstants(),b)}makePathObject(a,b){return new PathObject$$module$build$src$core$renderers$zelos$path_object(a,b,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(a){return a.type!==ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&a.type!==ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE}getConnectionPreviewMethod(a,b,c){return b.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?a.isConnected()?InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.REPLACEMENT_FADE:\nInsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(a,b,c)}};register$$module$build$src$core$renderers$common$block_rendering(\"zelos\",Renderer$$module$build$src$core$renderers$zelos$renderer);var module$build$src$core$renderers$zelos$renderer={};module$build$src$core$renderers$zelos$renderer.Renderer=Renderer$$module$build$src$core$renderers$zelos$renderer;var module$build$src$core$renderers$zelos$zelos={};module$build$src$core$renderers$zelos$zelos.BottomRow=BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row;module$build$src$core$renderers$zelos$zelos.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$zelos$constants;module$build$src$core$renderers$zelos$zelos.Drawer=Drawer$$module$build$src$core$renderers$zelos$drawer;module$build$src$core$renderers$zelos$zelos.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg;\nmodule$build$src$core$renderers$zelos$zelos.PathObject=PathObject$$module$build$src$core$renderers$zelos$path_object;module$build$src$core$renderers$zelos$zelos.RenderInfo=RenderInfo$$module$build$src$core$renderers$zelos$info;module$build$src$core$renderers$zelos$zelos.Renderer=Renderer$$module$build$src$core$renderers$zelos$renderer;module$build$src$core$renderers$zelos$zelos.RightConnectionShape=RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements;\nmodule$build$src$core$renderers$zelos$zelos.StatementInput=StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs;module$build$src$core$renderers$zelos$zelos.TopRow=TopRow$$module$build$src$core$renderers$zelos$measurables$top_row;registerDefaultOptions$$module$build$src$core$contextmenu_items();var module$build$src$core$contextmenu_items={};module$build$src$core$contextmenu_items.registerCleanup=registerCleanup$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerCollapse=registerCollapse$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerCollapseExpandBlock=registerCollapseExpandBlock$$module$build$src$core$contextmenu_items;\nmodule$build$src$core$contextmenu_items.registerComment=registerComment$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDefaultOptions=registerDefaultOptions$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDelete=registerDelete$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDeleteAll=registerDeleteAll$$module$build$src$core$contextmenu_items;\nmodule$build$src$core$contextmenu_items.registerDisable=registerDisable$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDuplicate=registerDuplicate$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerExpand=registerExpand$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerHelp=registerHelp$$module$build$src$core$contextmenu_items;\nmodule$build$src$core$contextmenu_items.registerInline=registerInline$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerRedo=registerRedo$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerUndo=registerUndo$$module$build$src$core$contextmenu_items;var FieldAngle$$module$build$src$core$field_angle=class extends FieldInput$$module$build$src$core$field_input{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.clockwise=FieldAngle$$module$build$src$core$field_angle.CLOCKWISE;this.offset=FieldAngle$$module$build$src$core$field_angle.OFFSET;this.wrap=FieldAngle$$module$build$src$core$field_angle.WRAP;this.round=FieldAngle$$module$build$src$core$field_angle.ROUND;this.boundEvents=[];this.symbol_=this.gauge=this.line=null;\na!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a);switch(a.mode){case Mode$$module$build$src$core$field_angle.COMPASS:this.clockwise=!0;this.offset=90;break;case Mode$$module$build$src$core$field_angle.PROTRACTOR:this.clockwise=!1,this.offset=0}a.clockwise&&(this.clockwise=a.clockwise);a.offset&&(this.offset=a.offset);a.wrap&&(this.wrap=a.wrap);a.round&&(this.round=a.round)}initView(){super.initView();\nthis.symbol_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TSPAN,{});this.symbol_.appendChild(document.createTextNode(\"\\u00b0\"));this.getTextElement().appendChild(this.symbol_)}render_(){super.render_();this.updateGraph()}showEditor_(a){super.showEditor_(a,MOBILE$$module$build$src$core$utils$useragent||ANDROID$$module$build$src$core$utils$useragent||IPAD$$module$build$src$core$utils$useragent);a=this.dropdownCreate();getContentDiv$$module$build$src$core$dropdowndiv().appendChild(a);\nthis.sourceBlock_ instanceof BlockSvg$$module$build$src$core$block_svg&&setColour$$module$build$src$core$dropdowndiv(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary);showPositionedByField$$module$build$src$core$dropdowndiv(this,this.dropdownDispose.bind(this));this.updateGraph()}dropdownCreate(){const a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{xmlns:SVG_NS$$module$build$src$core$utils$dom,\"xmlns:html\":HTML_NS$$module$build$src$core$utils$dom,\n\"xmlns:xlink\":XLINK_NS$$module$build$src$core$utils$dom,version:\"1.1\",height:2*FieldAngle$$module$build$src$core$field_angle.HALF+\"px\",width:2*FieldAngle$$module$build$src$core$field_angle.HALF+\"px\"});a.style.touchAction=\"none\";const b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{cx:FieldAngle$$module$build$src$core$field_angle.HALF,cy:FieldAngle$$module$build$src$core$field_angle.HALF,r:FieldAngle$$module$build$src$core$field_angle.RADIUS,\"class\":\"blocklyAngleCircle\"},\na);this.gauge=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyAngleGauge\"},a);this.line=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:FieldAngle$$module$build$src$core$field_angle.HALF,y1:FieldAngle$$module$build$src$core$field_angle.HALF,\"class\":\"blocklyAngleLine\"},a);for(let c=0;360>c;c+=15)createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:FieldAngle$$module$build$src$core$field_angle.HALF+\nFieldAngle$$module$build$src$core$field_angle.RADIUS,y1:FieldAngle$$module$build$src$core$field_angle.HALF,x2:FieldAngle$$module$build$src$core$field_angle.HALF+FieldAngle$$module$build$src$core$field_angle.RADIUS-(0===c%45?10:5),y2:FieldAngle$$module$build$src$core$field_angle.HALF,\"class\":\"blocklyAngleMarks\",transform:\"rotate(\"+c+\",\"+FieldAngle$$module$build$src$core$field_angle.HALF+\",\"+FieldAngle$$module$build$src$core$field_angle.HALF+\")\"},a);this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(a,\n\"click\",this,this.hide));this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(b,\"pointerdown\",this,this.onMouseMove_,!0));this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(b,\"pointermove\",this,this.onMouseMove_,!0));return a}dropdownDispose(){for(const a of this.boundEvents)unbind$$module$build$src$core$browser_events(a);this.boundEvents.length=0;this.line=this.gauge=null}hide(){hideIfOwner$$module$build$src$core$dropdowndiv(this);hide$$module$build$src$core$widgetdiv()}onMouseMove_(a){var b=\nthis.gauge.ownerSVGElement.getBoundingClientRect();const c=a.clientX-b.left-FieldAngle$$module$build$src$core$field_angle.HALF;a=a.clientY-b.top-FieldAngle$$module$build$src$core$field_angle.HALF;b=Math.atan(-a/c);isNaN(b)||(b=toDegrees$$module$build$src$core$utils$math(b),0>c?b+=180:0<a&&(b+=360),b=this.clockwise?this.offset+360-b:360-(this.offset-b),this.displayMouseOrKeyboardValue(b))}displayMouseOrKeyboardValue(a){this.round&&(a=Math.round(a/this.round)*this.round);a=this.wrapValue(a);if(a!==\nthis.value_){const b=this.value_;this.setEditorValue_(a,!1);this.sourceBlock_&&isEnabled$$module$build$src$core$events$utils()&&this.value_!==b&&fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(BLOCK_FIELD_INTERMEDIATE_CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,this.name||null,b,this.value_))}}updateGraph(){if(this.gauge&&this.line){var a=Number(this.getText())+this.offset,b=toRadians$$module$build$src$core$utils$math(a%360);a=[\"M \",FieldAngle$$module$build$src$core$field_angle.HALF,\n\",\",FieldAngle$$module$build$src$core$field_angle.HALF];var c=FieldAngle$$module$build$src$core$field_angle.HALF,d=FieldAngle$$module$build$src$core$field_angle.HALF;if(!isNaN(b)){const e=Number(this.clockwise),f=toRadians$$module$build$src$core$utils$math(this.offset),g=Math.cos(f)*FieldAngle$$module$build$src$core$field_angle.RADIUS,h=Math.sin(f)*-FieldAngle$$module$build$src$core$field_angle.RADIUS;e&&(b=2*f-b);c+=Math.cos(b)*FieldAngle$$module$build$src$core$field_angle.RADIUS;d-=Math.sin(b)*\nFieldAngle$$module$build$src$core$field_angle.RADIUS;b=Math.abs(Math.floor((b-f)/Math.PI)%2);e&&(b=1-b);a.push(\" l \",g,\",\",h,\" A \",FieldAngle$$module$build$src$core$field_angle.RADIUS,\",\",FieldAngle$$module$build$src$core$field_angle.RADIUS,\" 0 \",b,\" \",e,\" \",c,\",\",d,\" z\")}this.gauge.setAttribute(\"d\",a.join(\"\"));this.line.setAttribute(\"x2\",`${c}`);this.line.setAttribute(\"y2\",`${d}`)}}onHtmlInputKeyDown_(a){super.onHtmlInputKeyDown_(a);var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;\nlet c=0;switch(a.key){case \"ArrowLeft\":c=b.RTL?1:-1;break;case \"ArrowRight\":c=b.RTL?-1:1;break;case \"ArrowDown\":c=-1;break;case \"ArrowUp\":c=1}c&&(b=this.getValue(),this.displayMouseOrKeyboardValue(b+c*this.round),a.preventDefault(),a.stopPropagation())}doClassValidation_(a){a=Number(a);return isNaN(a)||!isFinite(a)?null:this.wrapValue(a)}wrapValue(a){a%=360;0>a&&(a+=360);a>this.wrap&&(a-=360);return a}static fromJson(a){return new this(a.angle,void 0,a)}};\nFieldAngle$$module$build$src$core$field_angle.HALF=50;FieldAngle$$module$build$src$core$field_angle.RADIUS=FieldAngle$$module$build$src$core$field_angle.HALF-1;FieldAngle$$module$build$src$core$field_angle.CLOCKWISE=!1;FieldAngle$$module$build$src$core$field_angle.OFFSET=0;FieldAngle$$module$build$src$core$field_angle.WRAP=360;FieldAngle$$module$build$src$core$field_angle.ROUND=15;register$$module$build$src$core$field_registry(\"field_angle\",FieldAngle$$module$build$src$core$field_angle);\nFieldAngle$$module$build$src$core$field_angle.prototype.DEFAULT_VALUE=0;register$$module$build$src$core$css(\"\\n.blocklyAngleCircle {\\n  stroke: #444;\\n  stroke-width: 1;\\n  fill: #ddd;\\n  fill-opacity: 0.8;\\n}\\n\\n.blocklyAngleMarks {\\n  stroke: #444;\\n  stroke-width: 1;\\n}\\n\\n.blocklyAngleGauge {\\n  fill: #f88;\\n  fill-opacity: 0.8;\\n  pointer-events: none;\\n}\\n\\n.blocklyAngleLine {\\n  stroke: #f00;\\n  stroke-width: 2;\\n  stroke-linecap: round;\\n  pointer-events: none;\\n}\\n\");var Mode$$module$build$src$core$field_angle;\n(function(a){a.COMPASS=\"compass\";a.PROTRACTOR=\"protractor\"})(Mode$$module$build$src$core$field_angle||(Mode$$module$build$src$core$field_angle={}));var module$build$src$core$field_angle={};module$build$src$core$field_angle.FieldAngle=FieldAngle$$module$build$src$core$field_angle;module$build$src$core$field_angle.Mode=Mode$$module$build$src$core$field_angle;var FieldCheckbox$$module$build$src$core$field_checkbox=class extends Field$$module$build$src$core$field{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.SERIALIZABLE=!0;this.CURSOR=\"default\";this.value_=this.value_;this.checkChar=FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a);a.checkCharacter&&(this.checkChar=\na.checkCharacter)}saveState(){const a=this.saveLegacyState(FieldCheckbox$$module$build$src$core$field_checkbox);return null!==a?a:this.getValueBoolean()}initView(){super.initView();const a=this.getTextElement();addClass$$module$build$src$core$utils$dom(a,\"blocklyCheckbox\");a.style.display=this.value_?\"block\":\"none\"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_());this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(a){this.checkChar=\na||FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR;this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(a){return!0===a||\"TRUE\"===a?\"TRUE\":!1===a||\"FALSE\"===a?\"FALSE\":null}doValueUpdate_(a){this.value_=this.convertValueToBool_(a);this.textElement_&&(this.textElement_.style.display=this.value_?\"block\":\"none\")}getValue(){return this.value_?\"TRUE\":\"FALSE\"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(a){return\"string\"===\ntypeof a?\"TRUE\"===a:!!a}static fromJson(a){return new this(a.checked,void 0,a)}};FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR=\"\\u2713\";register$$module$build$src$core$field_registry(\"field_checkbox\",FieldCheckbox$$module$build$src$core$field_checkbox);FieldCheckbox$$module$build$src$core$field_checkbox.prototype.DEFAULT_VALUE=!1;var module$build$src$core$field_checkbox={};module$build$src$core$field_checkbox.FieldCheckbox=FieldCheckbox$$module$build$src$core$field_checkbox;var FieldColour$$module$build$src$core$field_colour=class extends Field$$module$build$src$core$field{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.highlightedIndex=this.picker=null;this.boundEvents=[];this.SERIALIZABLE=!0;this.CURSOR=\"default\";this.isDirty_=!1;this.titles=this.colours=null;this.columns=0;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a);a.colourOptions&&\n(this.colours=a.colourOptions);a.colourTitles&&(this.titles=a.colourTitles);a.columns&&(this.columns=a.columns)}initView(){this.size_=new Size$$module$build$src$core$utils$size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT);this.createBorderRect_();this.getBorderRect().style.fillOpacity=\"1\";this.getBorderRect().setAttribute(\"stroke\",\"#fff\");this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const a=this.getSourceBlock();\nif(!a)throw new UnattachedFieldError$$module$build$src$core$field;const b=this.getConstants();return a.isSimpleReporter()&&!(null==b||!b.FIELD_COLOUR_FULL_BLOCK)}applyColour(){const a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;if(this.fieldGroup_){var b=this.borderRect_;if(!b)throw Error(\"The border rect has not been initialized\");this.isFullBlockField()?(b.style.display=\"none\",a.pathObject.svgPath.setAttribute(\"fill\",this.getValue()),a.pathObject.svgPath.setAttribute(\"stroke\",\n\"#fff\")):(b.style.display=\"block\",b.style.fill=this.getValue())}}getSize(){let a;if(null==(a=this.getConstants())?0:a.FIELD_COLOUR_FULL_BLOCK)this.render_(),this.isDirty_=!1;return super.getSize()}render_(){super.render_();const a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;a.applyColour()}updateSize_(a){var b=this.getConstants();this.isFullBlockField()?(a=2*(null!=a?a:0),b=b.FIELD_TEXT_HEIGHT):(a=b.FIELD_COLOUR_DEFAULT_WIDTH,b=b.FIELD_COLOUR_DEFAULT_HEIGHT);\nthis.size_.height=b;this.size_.width=a;this.positionBorderRect_()}doClassValidation_(a){return\"string\"!==typeof a?null:parse$$module$build$src$core$utils$colour(a)}getText(){let a=this.value_;/^#(.)\\1(.)\\2(.)\\3$/.test(a)&&(a=\"#\"+a[1]+a[3]+a[5]);return a}setColours(a,b){this.colours=a;b&&(this.titles=b);return this}setColumns(a){this.columns=a;return this}showEditor_(){this.dropdownCreate();getContentDiv$$module$build$src$core$dropdowndiv().appendChild(this.picker);showPositionedByField$$module$build$src$core$dropdowndiv(this,\nthis.dropdownDispose.bind(this));this.picker.focus({preventScroll:!0})}onClick(a){a=(a=a.target)&&a.getAttribute(\"data-colour\");null!==a&&(this.setValue(a),hideIfOwner$$module$build$src$core$dropdowndiv(this))}onKeyDown(a){let b=!0;var c;switch(a.key){case \"ArrowUp\":this.moveHighlightBy(0,-1);break;case \"ArrowDown\":this.moveHighlightBy(0,1);break;case \"ArrowLeft\":this.moveHighlightBy(-1,0);break;case \"ArrowRight\":this.moveHighlightBy(1,0);break;case \"Enter\":if(c=this.getHighlighted())c=c.getAttribute(\"data-colour\"),\nnull!==c&&this.setValue(c);hideWithoutAnimation$$module$build$src$core$dropdowndiv();break;default:b=!1}b&&a.stopPropagation()}moveHighlightBy(a,b){if(this.highlightedIndex){var c=this.colours||FieldColour$$module$build$src$core$field_colour.COLOURS,d=this.columns||FieldColour$$module$build$src$core$field_colour.COLUMNS,e=this.highlightedIndex%d,f=Math.floor(this.highlightedIndex/d);e+=a;f+=b;0>a?0>e&&0<f?(e=d-1,f--):0>e&&(e=0):0<a?e>d-1&&f<Math.floor(c.length/d)-1?(e=0,f++):e>d-1&&e--:0>b?0>f&&(f=\n0):0<b&&f>Math.floor(c.length/d)-1&&(f=Math.floor(c.length/d)-1);this.setHighlightedCell(this.picker.childNodes[f].childNodes[e],f*d+e)}}onMouseMove(a){const b=(a=a.target)&&Number(a.getAttribute(\"data-index\"));null!==b&&b!==this.highlightedIndex&&this.setHighlightedCell(a,b)}onMouseEnter(){let a;null==(a=this.picker)||a.focus({preventScroll:!0})}onMouseLeave(){var a;null==(a=this.picker)||a.blur();(a=this.getHighlighted())&&removeClass$$module$build$src$core$utils$dom(a,\"blocklyColourHighlighted\")}getHighlighted(){if(!this.highlightedIndex)return null;\nconst a=this.columns||FieldColour$$module$build$src$core$field_colour.COLUMNS,b=this.picker.childNodes[Math.floor(this.highlightedIndex/a)];return b?b.childNodes[this.highlightedIndex%a]:null}setHighlightedCell(a,b){const c=this.getHighlighted();c&&removeClass$$module$build$src$core$utils$dom(c,\"blocklyColourHighlighted\");addClass$$module$build$src$core$utils$dom(a,\"blocklyColourHighlighted\");this.highlightedIndex=b;(a=a.getAttribute(\"id\"))&&this.picker&&setState$$module$build$src$core$utils$aria(this.picker,\nState$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,a)}dropdownCreate(){const a=this.columns||FieldColour$$module$build$src$core$field_colour.COLUMNS,b=this.colours||FieldColour$$module$build$src$core$field_colour.COLOURS,c=this.titles||FieldColour$$module$build$src$core$field_colour.TITLES,d=this.getValue(),e=document.createElement(\"table\");e.className=\"blocklyColourTable\";e.tabIndex=0;e.dir=\"ltr\";setRole$$module$build$src$core$utils$aria(e,Role$$module$build$src$core$utils$aria.GRID);setState$$module$build$src$core$utils$aria(e,\nState$$module$build$src$core$utils$aria.EXPANDED,!0);setState$$module$build$src$core$utils$aria(e,State$$module$build$src$core$utils$aria.ROWCOUNT,Math.floor(b.length/a));setState$$module$build$src$core$utils$aria(e,State$$module$build$src$core$utils$aria.COLCOUNT,a);let f;for(let g=0;g<b.length;g++){0===g%a&&(f=document.createElement(\"tr\"),setRole$$module$build$src$core$utils$aria(f,Role$$module$build$src$core$utils$aria.ROW),e.appendChild(f));const h=document.createElement(\"td\");f.appendChild(h);\nh.setAttribute(\"data-colour\",b[g]);h.title=c[g]||b[g];h.id=getNextUniqueId$$module$build$src$core$utils$idgenerator();h.setAttribute(\"data-index\",`${g}`);setRole$$module$build$src$core$utils$aria(h,Role$$module$build$src$core$utils$aria.GRIDCELL);setState$$module$build$src$core$utils$aria(h,State$$module$build$src$core$utils$aria.LABEL,b[g]);setState$$module$build$src$core$utils$aria(h,State$$module$build$src$core$utils$aria.SELECTED,b[g]===d);h.style.backgroundColor=b[g];b[g]===d&&(h.className=\"blocklyColourSelected\",\nthis.highlightedIndex=g)}this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(e,\"pointerdown\",this,this.onClick,!0));this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(e,\"pointermove\",this,this.onMouseMove,!0));this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(e,\"pointerenter\",this,this.onMouseEnter,!0));this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(e,\"pointerleave\",this,this.onMouseLeave,!0));\nthis.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(e,\"keydown\",this,this.onKeyDown,!1));this.picker=e}dropdownDispose(){for(const a of this.boundEvents)unbind$$module$build$src$core$browser_events(a);this.boundEvents.length=0;this.highlightedIndex=this.picker=null}static fromJson(a){return new this(a.colour,void 0,a)}};FieldColour$$module$build$src$core$field_colour.COLOURS=\"#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033\".split(\" \");\nFieldColour$$module$build$src$core$field_colour.TITLES=[];FieldColour$$module$build$src$core$field_colour.COLUMNS=7;FieldColour$$module$build$src$core$field_colour.prototype.DEFAULT_VALUE=FieldColour$$module$build$src$core$field_colour.COLOURS[0];register$$module$build$src$core$field_registry(\"field_colour\",FieldColour$$module$build$src$core$field_colour);register$$module$build$src$core$css(\"\\n.blocklyColourTable {\\n  border-collapse: collapse;\\n  display: block;\\n  outline: none;\\n  padding: 1px;\\n}\\n\\n.blocklyColourTable>tr>td {\\n  border: 0.5px solid #888;\\n  box-sizing: border-box;\\n  cursor: pointer;\\n  display: inline-block;\\n  height: 20px;\\n  padding: 0;\\n  width: 20px;\\n}\\n\\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\\n  border-color: #eee;\\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\\n  position: relative;\\n}\\n\\n.blocklyColourSelected, .blocklyColourSelected:hover {\\n  border-color: #eee !important;\\n  outline: 1px solid #333;\\n  position: relative;\\n}\\n\");\nvar module$build$src$core$field_colour={};module$build$src$core$field_colour.FieldColour=FieldColour$$module$build$src$core$field_colour;var FieldLabelSerializable$$module$build$src$core$field_label_serializable=class extends FieldLabel$$module$build$src$core$field_label{constructor(a,b,c){super(String(null!=a?a:\"\"),b,c);this.EDITABLE=!1;this.SERIALIZABLE=!0}static fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a)}};register$$module$build$src$core$field_registry(\"field_label_serializable\",FieldLabelSerializable$$module$build$src$core$field_label_serializable);\nvar module$build$src$core$field_label_serializable={};module$build$src$core$field_label_serializable.FieldLabelSerializable=FieldLabelSerializable$$module$build$src$core$field_label_serializable;var FieldMultilineInput$$module$build$src$core$field_multilineinput=class extends FieldTextInput$$module$build$src$core$field_textinput{constructor(a,b,c){super(Field$$module$build$src$core$field.SKIP_SETUP);this.textGroup=null;this.maxLines_=Infinity;this.isOverflowedY_=!1;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a);a.maxLines&&this.setMaxLines(a.maxLines)}toXml(a){a.textContent=this.getValue().replace(/\\n/g,\n\"&#10;\");return a}fromXml(a){this.setValue(a.textContent.replace(/&#10;/g,\"\\n\"))}saveState(){const a=this.saveLegacyState(FieldMultilineInput$$module$build$src$core$field_multilineinput);return null!==a?a:this.getValue()}loadState(a){this.loadLegacyState(Field$$module$build$src$core$field,a)||this.setValue(a)}initView(){this.createBorderRect_();this.textGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":\"blocklyEditableText\"},this.fieldGroup_)}getDisplayText_(){const a=\nthis.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;let b=this.getText();if(!b)return Field$$module$build$src$core$field.NBSP;const c=b.split(\"\\n\");b=\"\";const d=this.isOverflowedY_?this.maxLines_:c.length;for(let e=0;e<d;e++){let f=c[e];f.length>this.maxDisplayLength?f=f.substring(0,this.maxDisplayLength-4)+\"...\":this.isOverflowedY_&&e===d-1&&(f=f.substring(0,f.length-3)+\"...\");f=f.replace(/\\s/g,Field$$module$build$src$core$field.NBSP);b+=f;e!==d-1&&(b+=\"\\n\")}a.RTL&&\n(b+=\"\\u200f\");return b}doValueUpdate_(a){super.doValueUpdate_(a);null!==this.value_&&(this.isOverflowedY_=this.value_.split(\"\\n\").length>this.maxLines_)}render_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;for(var b,c=this.textGroup;b=c.firstChild;)c.removeChild(b);b=this.getDisplayText_().split(\"\\n\");let d=0;for(let e=0;e<b.length;e++){const f=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,\n{\"class\":\"blocklyText blocklyMultilineText\",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:d+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},c).appendChild(document.createTextNode(b[e]));d+=f}this.isBeingEdited_&&(c=this.htmlInput_,this.isOverflowedY_?addClass$$module$build$src$core$utils$dom(c,\"blocklyHtmlTextAreaInputOverflowedY\"):removeClass$$module$build$src$core$utils$dom(c,\"blocklyHtmlTextAreaInputOverflowedY\"));this.updateSize_();this.isBeingEdited_&&\n(a.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),a=this.htmlInput_,this.isTextValid_?(removeClass$$module$build$src$core$utils$dom(a,\"blocklyInvalidInput\"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!1)):(addClass$$module$build$src$core$utils$dom(a,\"blocklyInvalidInput\"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!0)))}updateSize_(){var a=this.textGroup.childNodes;const b=this.getConstants().FIELD_TEXT_FONTSIZE,\nc=this.getConstants().FIELD_TEXT_FONTWEIGHT,d=this.getConstants().FIELD_TEXT_FONTFAMILY;let e=0,f=0;for(var g=0;g<a.length;g++){var h=getFastTextWidth$$module$build$src$core$utils$dom(a[g],b,c,d);h>e&&(e=h);f+=this.getConstants().FIELD_TEXT_HEIGHT+(0<g?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){a=String(this.value_).split(\"\\n\");g=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{\"class\":\"blocklyText blocklyMultilineText\"});\nfor(h=0;h<a.length;h++){a[h].length>this.maxDisplayLength&&(a[h]=a[h].substring(0,this.maxDisplayLength));g.textContent=a[h];const k=getFastTextWidth$$module$build$src$core$utils$dom(g,b,c,d);k>e&&(e=k)}e+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(f+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,e+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute(\"width\",`${e}`),this.borderRect_.setAttribute(\"height\",`${f}`));this.size_.width=e;this.size_.height=\nf;this.positionBorderRect_()}showEditor_(a,b){super.showEditor_(a,b);this.forceRerender()}widgetCreate_(){const a=getDiv$$module$build$src$core$widgetdiv(),b=this.workspace_.getScale(),c=document.createElement(\"textarea\");c.className=\"blocklyHtmlInput blocklyHtmlTextAreaInput\";c.setAttribute(\"spellcheck\",String(this.spellcheck_));var d=this.getConstants().FIELD_TEXT_FONTSIZE*b+\"pt\";a.style.fontSize=d;c.style.fontSize=d;c.style.borderRadius=FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*\nb+\"px\";d=this.getConstants().FIELD_BORDER_RECT_X_PADDING*b;const e=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*b/2;c.style.padding=e+\"px \"+d+\"px \"+e+\"px \"+d+\"px\";d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;c.style.lineHeight=d*b+\"px\";a.appendChild(c);c.value=c.defaultValue=this.getEditorText_(this.value_);c.setAttribute(\"data-untyped-default-value\",String(this.value_));c.setAttribute(\"data-old-value\",\"\");GECKO$$module$build$src$core$utils$useragent?\nsetTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_();this.bindInputEvents_(c);return c}setMaxLines(a){\"number\"===typeof a&&0<a&&a!==this.maxLines_&&(this.maxLines_=a,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(a){if(\"Enter\"!==a.key)super.onHtmlInputKeyDown_(a)}static fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a)}};register$$module$build$src$core$field_registry(\"field_multilinetext\",FieldMultilineInput$$module$build$src$core$field_multilineinput);\nregister$$module$build$src$core$css(\"\\n.blocklyHtmlTextAreaInput {\\n  font-family: monospace;\\n  resize: none;\\n  overflow: hidden;\\n  height: 100%;\\n  text-align: left;\\n}\\n\\n.blocklyHtmlTextAreaInputOverflowedY {\\n  overflow-y: scroll;\\n}\\n\");var module$build$src$core$field_multilineinput={};module$build$src$core$field_multilineinput.FieldMultilineInput=FieldMultilineInput$$module$build$src$core$field_multilineinput;var FieldNumber$$module$build$src$core$field_number=class extends FieldInput$$module$build$src$core$field_input{constructor(a,b,c,d,e,f){super(Field$$module$build$src$core$field.SKIP_SETUP);this.min_=-Infinity;this.max_=Infinity;this.precision_=0;this.decimalPlaces=null;this.spellcheck_=!1;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(f?this.configure_(f):this.setConstraints(b,c,d),this.setValue(a),e&&this.setValidator(e))}configure_(a){super.configure_(a);this.setMinInternal(a.min);this.setMaxInternal(a.max);\nthis.setPrecisionInternal(a.precision)}setConstraints(a,b,c){this.setMinInternal(a);this.setMaxInternal(b);this.setPrecisionInternal(c);this.setValue(this.getValue())}setMin(a){this.setMinInternal(a);this.setValue(this.getValue())}setMinInternal(a){null==a?this.min_=-Infinity:(a=Number(a),isNaN(a)||(this.min_=a))}getMin(){return this.min_}setMax(a){this.setMaxInternal(a);this.setValue(this.getValue())}setMaxInternal(a){null==a?this.max_=Infinity:(a=Number(a),isNaN(a)||(this.max_=a))}getMax(){return this.max_}setPrecision(a){this.setPrecisionInternal(a);\nthis.setValue(this.getValue())}setPrecisionInternal(a){this.precision_=Number(a)||0;let b=String(this.precision_);-1!==b.indexOf(\"e\")&&(b=this.precision_.toLocaleString(\"en-US\",{maximumFractionDigits:20}));const c=b.indexOf(\".\");this.decimalPlaces=-1===c?a?0:null:b.length-c-1}getPrecision(){return this.precision_}doClassValidation_(a){if(null===a)return null;a=`${a}`.replace(/O/gi,\"0\");a=a.replace(/,/g,\"\");a=a.replace(/infinity/i,\"Infinity\");a=Number(a||0);if(isNaN(a))return null;a=Math.min(Math.max(a,\nthis.min_),this.max_);this.precision_&&isFinite(a)&&(a=Math.round(a/this.precision_)*this.precision_);null!==this.decimalPlaces&&(a=Number(a.toFixed(this.decimalPlaces)));return a}widgetCreate_(){const a=super.widgetCreate_();-Infinity<this.min_&&(a.min=`${this.min_}`,setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.VALUEMIN,this.min_));Infinity>this.max_&&(a.max=`${this.max_}`,setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.VALUEMAX,\nthis.max_));return a}static fromJson(a){return new this(a.value,void 0,void 0,void 0,void 0,a)}};register$$module$build$src$core$field_registry(\"field_number\",FieldNumber$$module$build$src$core$field_number);FieldNumber$$module$build$src$core$field_number.prototype.DEFAULT_VALUE=0;var module$build$src$core$field_number={};module$build$src$core$field_number.FieldNumber=FieldNumber$$module$build$src$core$field_number;var FieldVariable$$module$build$src$core$field_variable=class extends FieldDropdown$$module$build$src$core$field_dropdown{constructor(a,b,c,d,e){super(Field$$module$build$src$core$field.SKIP_SETUP);this.defaultType=\"\";this.variableTypes=[];this.variable=null;this.SERIALIZABLE=!0;this.menuGenerator_=FieldVariable$$module$build$src$core$field_variable.dropdownCreate;this.defaultVariableName=\"string\"===typeof a?a:\"\";this.size_=new Size$$module$build$src$core$utils$size(0,0);a!==Field$$module$build$src$core$field.SKIP_SETUP&&\n(e?this.configure_(e):this.setTypes(c,d),b&&this.setValidator(b))}configure_(a){super.configure_(a);this.setTypes(a.variableTypes,a.defaultType)}initModel(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;this.variable||(a=$.getOrCreateVariablePackage$$module$build$src$core$variables(a.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(a.getId()))}shouldAddBorderRect_(){const a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field;\nreturn super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||\"variables_get\"!==a.type)}fromXml(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;const c=a.getAttribute(\"id\"),d=a.textContent,e=a.getAttribute(\"variabletype\")||a.getAttribute(\"variableType\")||\"\";b=$.getOrCreateVariablePackage$$module$build$src$core$variables(b.workspace,c,d,e);if(null!==e&&e!==b.type)throw Error(\"Serialized variable type with id '\"+b.getId()+\n\"' had type \"+b.type+\", and does not match variable field that references it: \"+domToText$$module$build$src$core$xml(a)+\".\");this.setValue(b.getId())}toXml(a){this.initModel();a.id=this.variable.getId();a.textContent=this.variable.name;this.variable.type&&a.setAttribute(\"variabletype\",this.variable.type);return a}saveState(a){var b=this.saveLegacyState(FieldVariable$$module$build$src$core$field_variable);if(null!==b)return b;this.initModel();b={id:this.variable.getId()};a&&(b.name=this.variable.name,\nb.type=this.variable.type);return b}loadState(a){const b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;this.loadLegacyState(FieldVariable$$module$build$src$core$field_variable,a)||(a=$.getOrCreateVariablePackage$$module$build$src$core$variables(b.workspace,a.id||null,a.name,a.type||\"\"),this.setValue(a.getId()))}setSourceBlock(a){if(a.isShadow())throw Error(\"Variable fields are not allowed to exist on shadow blocks.\");super.setSourceBlock(a)}getValue(){return this.variable?\nthis.variable.getId():null}getText(){return this.variable?this.variable.name:\"\"}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(a){if(null===a)return null;var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;b=$.getVariable$$module$build$src$core$variables(b.workspace,a);if(!b)return console.warn(\"Variable id doesn't point to a real variable! ID was \"+a),null;b=b.type;return this.typeIsAllowed(b)?\na:(console.warn(\"Variable type doesn't match this field!  Type was \"+b),null)}doValueUpdate_(a){const b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field;this.variable=$.getVariable$$module$build$src$core$variables(b.workspace,a);super.doValueUpdate_(a)}typeIsAllowed(a){const b=this.getVariableTypes();if(!b)return!0;for(let c=0;c<b.length;c++)if(a===b[c])return!0;return!1}getVariableTypes(){var a=this.variableTypes;if(null===a&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();\na=a||[\"\"];if(0===a.length)throw a=this.getText(),Error(\"'variableTypes' of field variable \"+a+\" was an empty list\");return a}setTypes(a=null,b=\"\"){if(Array.isArray(a)){let c=!1;for(let d=0;d<a.length;d++)a[d]===b&&(c=!0);if(!c)throw Error(\"Invalid default type '\"+b+\"' in the definition of a FieldVariable\");}else if(null!==a)throw Error(\"'variableTypes' was not an array in the definition of a FieldVariable\");this.defaultType=b;this.variableTypes=a}refreshVariableName(){this.forceRerender()}onItemSelected_(a,\nb){a=b.getValue();if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(a===RENAME_VARIABLE_ID$$module$build$src$core$internal_constants){$.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(a===DELETE_VARIABLE_ID$$module$build$src$core$internal_constants){this.sourceBlock_.workspace.deleteVariableById(this.variable.getId());return}}this.setValue(a)}referencesVariables(){return!0}static fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.variable),\nvoid 0,void 0,void 0,a)}static dropdownCreate(){if(!this.variable)throw Error(\"Tried to call dropdownCreate on a variable field with no variable selected.\");const a=this.getText();let b=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){var c=this.getVariableTypes();for(var d=0;d<c.length;d++){const e=this.sourceBlock_.workspace.getVariablesOfType(c[d]);b=b.concat(e)}}b.sort(VariableModel$$module$build$src$core$variable_model.compareByName);c=[];for(d=0;d<b.length;d++)c[d]=[b[d].name,b[d].getId()];\nc.push([$.Msg$$module$build$src$core$msg.RENAME_VARIABLE,RENAME_VARIABLE_ID$$module$build$src$core$internal_constants]);$.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&c.push([$.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace(\"%1\",a),DELETE_VARIABLE_ID$$module$build$src$core$internal_constants]);return c}};register$$module$build$src$core$field_registry(\"field_variable\",FieldVariable$$module$build$src$core$field_variable);var module$build$src$core$field_variable={};\nmodule$build$src$core$field_variable.FieldVariable=FieldVariable$$module$build$src$core$field_variable;var FlyoutButton$$module$build$src$core$flyout_button=class{constructor(a,b,c,d){this.workspace=a;this.targetWorkspace=b;this.isLabel_=d;this.onMouseUpWrapper=null;this.height=this.width=0;this.svgText=this.svgGroup=null;this.text=c.text;this.position=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.callbackKey=c.callbackKey||c.callbackkey;this.cssClass=c[\"web-class\"]||null;this.info=c}createDom(){var a=this.isLabel_?\"blocklyFlyoutLabel\":\"blocklyFlyoutButton\";this.cssClass&&(a+=\" \"+\nthis.cssClass);this.svgGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{\"class\":a},this.workspace.getCanvas());let b;this.isLabel_||(b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"class\":\"blocklyFlyoutButtonShadow\",rx:FlyoutButton$$module$build$src$core$flyout_button.BORDER_RADIUS,ry:FlyoutButton$$module$build$src$core$flyout_button.BORDER_RADIUS,x:1,y:1},this.svgGroup));a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,\n{\"class\":this.isLabel_?\"blocklyFlyoutLabelBackground\":\"blocklyFlyoutButtonBackground\",rx:FlyoutButton$$module$build$src$core$flyout_button.BORDER_RADIUS,ry:FlyoutButton$$module$build$src$core$flyout_button.BORDER_RADIUS},this.svgGroup);const c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{\"class\":this.isLabel_?\"blocklyFlyoutLabelText\":\"blocklyText\",x:0,y:0,\"text-anchor\":\"middle\"},this.svgGroup);var d=replaceMessageReferences$$module$build$src$core$utils$parsing(this.text);\nthis.workspace.RTL&&(d+=\"\\u200f\");c.textContent=d;this.isLabel_&&(this.svgText=c,this.workspace.getThemeManager().subscribe(this.svgText,\"flyoutForegroundColour\",\"fill\"));const e=getComputedStyle$$module$build$src$core$utils$style(c,\"fontSize\"),f=getComputedStyle$$module$build$src$core$utils$style(c,\"fontWeight\"),g=getComputedStyle$$module$build$src$core$utils$style(c,\"fontFamily\");this.width=getFastTextWidthWithSizeString$$module$build$src$core$utils$dom(c,e,f,g);d=measureFontMetrics$$module$build$src$core$utils$dom(d,\ne,f,g);this.height=d.height;if(!this.isLabel_){this.width+=2*FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_X;this.height+=2*FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_Y;let h;null==(h=b)||h.setAttribute(\"width\",String(this.width));let k;null==(k=b)||k.setAttribute(\"height\",String(this.height))}a.setAttribute(\"width\",String(this.width));a.setAttribute(\"height\",String(this.height));c.setAttribute(\"x\",String(this.width/2));c.setAttribute(\"y\",String(this.height/2-d.height/\n2+d.baseline));this.updateTransform();this.onMouseUpWrapper=conditionalBind$$module$build$src$core$browser_events(this.svgGroup,\"pointerup\",this,this.onMouseUp);return this.svgGroup}show(){this.updateTransform();this.svgGroup.setAttribute(\"display\",\"block\")}updateTransform(){this.svgGroup.setAttribute(\"transform\",\"translate(\"+this.position.x+\",\"+this.position.y+\")\")}moveTo(a,b){this.position.x=a;this.position.y=b;this.updateTransform()}isLabel(){return this.isLabel_}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper&&\nunbind$$module$build$src$core$browser_events(this.onMouseUpWrapper);this.svgGroup&&removeNode$$module$build$src$core$utils$dom(this.svgGroup);this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}onMouseUp(a){(a=this.targetWorkspace.getGesture(a))&&a.cancel();this.isLabel_&&this.callbackKey?console.warn(\"Labels should not have callbacks. Label text: \"+this.text):this.isLabel_||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isLabel_||(a=this.targetWorkspace.getButtonCallback(this.callbackKey))&&\na(this):console.warn(\"Buttons should have callbacks. Button text: \"+this.text)}};FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_X=5;FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_Y=2;FlyoutButton$$module$build$src$core$flyout_button.BORDER_RADIUS=4;register$$module$build$src$core$css(\"\\n.blocklyFlyoutButton {\\n  fill: #888;\\n  cursor: default;\\n}\\n\\n.blocklyFlyoutButtonShadow {\\n  fill: #666;\\n}\\n\\n.blocklyFlyoutButton:hover {\\n  fill: #aaa;\\n}\\n\\n.blocklyFlyoutLabel {\\n  cursor: default;\\n}\\n\\n.blocklyFlyoutLabelBackground {\\n  opacity: 0;\\n}\\n\");\nvar module$build$src$core$flyout_button={};module$build$src$core$flyout_button.FlyoutButton=FlyoutButton$$module$build$src$core$flyout_button;var FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager=class extends MetricsManager$$module$build$src$core$metrics_manager{constructor(a,b){super(a);this.flyout_=b}getBoundingBox_(){let a;try{a=this.workspace_.getCanvas().getBBox()}catch(b){a={height:0,y:0,width:0,x:0}}return a}getContentMetrics(a){const b=this.getBoundingBox_();a=a?1:this.workspace_.scale;return{height:b.height*a,width:b.width*a,top:b.y*a,left:b.x*a}}getScrollMetrics(a,b,c){b=c||this.getContentMetrics();c=this.flyout_.MARGIN*\nthis.workspace_.scale;a=a?this.workspace_.scale:1;return{height:(b.height+2*c)/a,width:(b.width+b.left+c)/a,top:0,left:0}}},module$build$src$core$flyout_metrics_manager={};module$build$src$core$flyout_metrics_manager.FlyoutMetricsManager=FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager;var FlyoutItemType$$module$build$src$core$flyout_base;(function(a){a.BLOCK=\"block\";a.BUTTON=\"button\"})(FlyoutItemType$$module$build$src$core$flyout_base||(FlyoutItemType$$module$build$src$core$flyout_base={}));\nvar Flyout$$module$build$src$core$flyout_base=class extends DeleteArea$$module$build$src$core$delete_area{constructor(a){super();this.horizontalLayout=!1;this.boundEvents=[];this.filterWrapper=this.reflowWrapper=null;this.mats=[];this.buttons_=[];this.listeners=[];this.permanentlyDisabled=[];this.recycledBlocks=[];this.autoClose=!0;this.isVisible_=!1;this.containerVisible=!0;this.CORNER_RADIUS=8;this.SCROLLBAR_MARGIN=2.5;this.height_=this.width_=0;this.dragAngleRange_=70;this.svgGroup_=this.svgBackground_=\nnull;a.setMetrics=this.setMetrics_.bind(this);this.workspace_=new WorkspaceSvg$$module$build$src$core$workspace_svg(a);this.workspace_.setMetricsManager(new FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager(this.workspace_,this));this.workspace_.internalIsFlyout=!0;this.workspace_.setVisible(this.isVisible_);this.id=genUid$$module$build$src$core$utils$idgenerator();this.RTL=!!a.RTL;this.toolboxPosition_=a.toolboxPosition;this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH;\nthis.rectMap_=new WeakMap;this.MARGIN=this.CORNER_RADIUS;this.GAP_X=3*this.MARGIN;this.GAP_Y=3*this.MARGIN}createDom(a){this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(a,{\"class\":\"blocklyFlyout\"});this.svgGroup_.style.display=\"none\";this.svgBackground_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyFlyoutBackground\"},this.svgGroup_);this.svgGroup_.appendChild(this.workspace_.createDom());this.workspace_.getThemeManager().subscribe(this.svgBackground_,\n\"flyoutBackgroundColour\",\"fill\");this.workspace_.getThemeManager().subscribe(this.svgBackground_,\"flyoutOpacity\",\"fill-opacity\");return this.svgGroup_}init(a){this.targetWorkspace=a;this.workspace_.targetWorkspace=a;this.workspace_.scrollbar=new ScrollbarPair$$module$build$src$core$scrollbar_pair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,\"blocklyFlyoutScrollbar\",this.SCROLLBAR_MARGIN);this.hide();this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,\n\"wheel\",this,this.wheel_));this.filterWrapper=this.filterForCapacity.bind(this);this.targetWorkspace.addChangeListener(this.filterWrapper);this.boundEvents.push(conditionalBind$$module$build$src$core$browser_events(this.svgBackground_,\"pointerdown\",this,this.onMouseDown));this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace);this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap());this.workspace_.createPotentialVariableMap();a.getComponentManager().addComponent({component:this,\nweight:1,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA,ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET]})}dispose(){this.hide();this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const a of this.boundEvents)unbind$$module$build$src$core$browser_events(a);this.boundEvents.length=0;this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper);\nthis.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose());this.svgGroup_&&removeNode$$module$build$src$core$utils$dom(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(a){this.autoClose=a;this.targetWorkspace.recordDragTargets();this.targetWorkspace.resizeContents()}autoHide(a){!a&&this.targetWorkspace.getFlyout(!0)===\nthis&&this.autoClose&&this.hide()}isVisible(){return this.isVisible_}setVisible(a){const b=a!==this.isVisible();this.isVisible_=a;b&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(a){const b=a!==this.containerVisible;this.containerVisible=a;b&&this.updateDisplay()}updateDisplay(){let a;a=this.containerVisible?this.isVisible():!1;this.svgGroup_&&(this.svgGroup_.style.display=a?\"block\":\"none\");let b;null==(b=this.workspace_.scrollbar)||b.setContainerVisible(a)}positionAt_(a,\nb,c,d){let e;null==(e=this.svgGroup_)||e.setAttribute(\"width\",`${a}`);let f;null==(f=this.svgGroup_)||f.setAttribute(\"height\",`${b}`);this.workspace_.setCachedParentSvgSize(a,b);this.svgGroup_&&setCssTransform$$module$build$src$core$utils$dom(this.svgGroup_,\"translate(\"+c+\"px,\"+d+\"px)\");if(a=this.workspace_.scrollbar)a.setOrigin(c,d),a.resize(),a.hScroll&&a.hScroll.setPosition(a.hScroll.position.x,a.hScroll.position.y),a.vScroll&&a.vScroll.setPosition(a.vScroll.position.x,a.vScroll.position.y)}hide(){if(this.isVisible()){this.setVisible(!1);\nfor(const a of this.listeners)unbind$$module$build$src$core$browser_events(a);this.listeners.length=0;this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(a){this.workspace_.setResizesEnabled(!1);this.hide();this.clearOldBlocks();\"string\"===typeof a&&(a=this.getDynamicCategoryContents(a));this.setVisible(!0);a=convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(a);a=this.createFlyoutInfo(a);triggerQueuedRenders$$module$build$src$core$render_management(this.workspace_);\nthis.layout_(a.contents,a.gaps);this.horizontalLayout?this.height_=0:this.width_=0;this.workspace_.setResizesEnabled(!0);this.reflow();this.filterForCapacity();this.position();this.reflowWrapper=this.reflow.bind(this);this.workspace_.addChangeListener(this.reflowWrapper);this.emptyRecycledBlocks()}createFlyoutInfo(a){const b=[],c=[];this.permanentlyDisabled.length=0;const d=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const e of a){if(\"custom\"in e){a=this.getDynamicCategoryContents(e.custom);a=\nconvertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(a);const {contents:f,gaps:g}=this.createFlyoutInfo(a);b.push(...f);c.push(...g)}switch(e.kind.toUpperCase()){case \"BLOCK\":a=e;const f=this.createFlyoutBlock(a);b.push({type:FlyoutItemType$$module$build$src$core$flyout_base.BLOCK,block:f});this.addBlockGap(a,c,d);break;case \"SEP\":this.addSeparatorGap(e,c,d);break;case \"LABEL\":a=this.createButton(e,!0);b.push({type:FlyoutItemType$$module$build$src$core$flyout_base.BUTTON,button:a});c.push(d);\nbreak;case \"BUTTON\":a=this.createButton(e,!1),b.push({type:FlyoutItemType$$module$build$src$core$flyout_base.BUTTON,button:a}),c.push(d)}}return{contents:b,gaps:c}}getDynamicCategoryContents(a){a=this.workspace_.targetWorkspace.getToolboxCategoryCallback(a);if(\"function\"!==typeof a)throw TypeError(\"Couldn't find a callback function when opening a toolbox category.\");return a(this.workspace_.targetWorkspace)}createButton(a,b){return new FlyoutButton$$module$build$src$core$flyout_button(this.workspace_,\nthis.targetWorkspace,a,b)}createFlyoutBlock(a){let b;a.blockxml?(a=\"string\"===typeof a.blockxml?$.textToDom$$module$build$src$core$utils$xml(a.blockxml):a.blockxml,(b=this.getRecycledBlock(a.getAttribute(\"type\")))||(b=domToBlockInternal$$module$build$src$core$xml(a,this.workspace_))):(b=this.getRecycledBlock(a.type),b||(void 0===a.enabled&&(a.enabled=\"true\"!==a.disabled&&!0!==a.disabled),b=appendInternal$$module$build$src$core$serialization$blocks(a,this.workspace_)));b.isEnabled()||this.permanentlyDisabled.push(b);\nreturn b}getRecycledBlock(a){let b=-1;for(let c=0;c<this.recycledBlocks.length;c++)if(this.recycledBlocks[c].type===a){b=c;break}return-1===b?void 0:this.recycledBlocks.splice(b,1)[0]}addBlockGap(a,b,c){let d;a.gap?d=parseInt(String(a.gap)):a.blockxml&&(a=\"string\"===typeof a.blockxml?$.textToDom$$module$build$src$core$utils$xml(a.blockxml):a.blockxml,d=parseInt(a.getAttribute(\"gap\")));b.push(!d||isNaN(d)?c:d)}addSeparatorGap(a,b,c){a=parseInt(String(a.gap));!isNaN(a)&&0<b.length?b[b.length-1]=a:b.push(c)}clearOldBlocks(){var a=\nthis.workspace_.getTopBlocks(!1);for(let c=0,d;d=a[c];c++)this.blockIsRecyclable_(d)?this.recycleBlock(d):d.dispose(!1,!1);for(a=0;a<this.mats.length;a++){const c=this.mats[a];c&&(unbindMouseEvents$$module$build$src$core$tooltip(c),removeNode$$module$build$src$core$utils$dom(c))}this.mats.length=0;for(let c=0,d;d=this.buttons_[c];c++)d.dispose();this.buttons_.length=0;let b;null==(b=this.workspace_.getPotentialVariableMap())||b.clear()}emptyRecycledBlocks(){for(let a=0;a<this.recycledBlocks.length;a++)this.recycledBlocks[a].dispose();\nthis.recycledBlocks=[]}blockIsRecyclable_(a){return!1}recycleBlock(a){const b=a.getRelativeToSurfaceXY();a.moveBy(-b.x,-b.y);this.recycledBlocks.push(a)}addBlockListeners_(a,b,c){this.listeners.push(conditionalBind$$module$build$src$core$browser_events(a,\"pointerdown\",null,this.blockMouseDown(b)));this.listeners.push(conditionalBind$$module$build$src$core$browser_events(c,\"pointerdown\",null,this.blockMouseDown(b)));this.listeners.push(bind$$module$build$src$core$browser_events(a,\"pointerenter\",b,\nb.addSelect));this.listeners.push(bind$$module$build$src$core$browser_events(a,\"pointerleave\",b,b.removeSelect));this.listeners.push(bind$$module$build$src$core$browser_events(c,\"pointerenter\",b,b.addSelect));this.listeners.push(bind$$module$build$src$core$browser_events(c,\"pointerleave\",b,b.removeSelect))}blockMouseDown(a){return b=>{const c=this.targetWorkspace.getGesture(b);c&&(c.setStartBlock(a),c.handleFlyoutStart(b,this))}}onMouseDown(a){const b=this.targetWorkspace.getGesture(a);b&&b.handleFlyoutStart(a,\nthis)}isBlockCreatable(a){return a.isEnabled()}createBlock(a){let b=null;$.disable$$module$build$src$core$events$utils();var c=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{b=this.placeNewBlock(a)}finally{$.enable$$module$build$src$core$events$utils()}this.targetWorkspace.hideChaff();a=getAddedVariables$$module$build$src$core$variables(this.targetWorkspace,c);if(isEnabled$$module$build$src$core$events$utils()){$.setGroup$$module$build$src$core$events$utils(!0);\nfor(c=0;c<a.length;c++){const d=a[c];fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils(VAR_CREATE$$module$build$src$core$events$utils))(d))}fire$$module$build$src$core$events$utils(new (get$$module$build$src$core$events$utils($.CREATE$$module$build$src$core$events$utils))(b))}this.autoClose?this.hide():this.filterForCapacity();return b}initFlyoutButton_(a,b,c){const d=a.createDom();a.moveTo(b,c);a.show();this.listeners.push(conditionalBind$$module$build$src$core$browser_events(d,\n\"pointerdown\",this,this.onMouseDown));this.buttons_.push(a)}createRect_(a,b,c,d,e){b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{\"fill-opacity\":0,x:b,y:c,height:d.height,width:d.width});b.tooltip=a;bindMouseEvents$$module$build$src$core$tooltip(b);this.workspace_.getCanvas().insertBefore(b,a.getSvgRoot());this.rectMap_.set(a,b);return this.mats[e]=b}moveRectToBlock_(a,b){const c=b.getHeightWidth();a.setAttribute(\"width\",String(c.width));a.setAttribute(\"height\",\nString(c.height));b=b.getRelativeToSurfaceXY();a.setAttribute(\"y\",String(b.y));a.setAttribute(\"x\",String(this.RTL?b.x-c.width:b.x))}filterForCapacity(){const a=this.workspace_.getTopBlocks(!1);for(let b=0,c;c=a[b];b++)if(-1===this.permanentlyDisabled.indexOf(c)){const d=this.targetWorkspace.isCapacityAvailable(getBlockTypeCounts$$module$build$src$core$common(c));for(;c;)c.setEnabled(d),c=c.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper);this.reflowInternal_();\nthis.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(a){var b=this.targetWorkspace;if(!a.getSvgRoot())throw Error(\"oldBlock is not rendered\");const c=save$$module$build$src$core$serialization$blocks(a);b.setResizesEnabled(!1);b=append$$module$build$src$core$serialization$blocks(c,b);this.positionNewBlock(a,b);return b}positionNewBlock(a,b){const c=this.targetWorkspace;var d=\nc.getOriginOffsetInPixels(),e=this.workspace_.getOriginOffsetInPixels();a=a.getRelativeToSurfaceXY();a.scale(this.workspace_.scale);e=Coordinate$$module$build$src$core$utils$coordinate.sum(e,a);d=Coordinate$$module$build$src$core$utils$coordinate.difference(e,d);d.scale(1/c.scale);b.moveTo(new Coordinate$$module$build$src$core$utils$coordinate(d.x,d.y))}};Flyout$$module$build$src$core$flyout_base.FlyoutItemType=FlyoutItemType$$module$build$src$core$flyout_base;\nvar module$build$src$core$flyout_base={};module$build$src$core$flyout_base.Flyout=Flyout$$module$build$src$core$flyout_base;var HorizontalFlyout$$module$build$src$core$flyout_horizontal=class extends Flyout$$module$build$src$core$flyout_base{constructor(a){super(a);this.horizontalLayout=!0}setMetrics_(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics();\"number\"===typeof a.x&&(this.workspace_.scrollX=-(c.left+(c.width-d.width)*a.x));this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;\nvar a=this.targetWorkspace.getMetricsManager();const b=a.getAbsoluteMetrics(),c=a.getViewMetrics();a=a.getToolboxMetrics();const d=this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?d?a.height:c.height-this.height_:d?0:c.height:d?0:c.height+b.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();\nthis.width_=a.width;this.setBackgroundPath(a.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS);a=this.getX();var b=this.getY();this.positionAt_(this.width_,this.height_,a,b)}}setBackgroundPath(a,b){const c=this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.TOP,d=[\"M 0,\"+(c?0:this.CORNER_RADIUS)];c?(d.push(\"h\",a+2*this.CORNER_RADIUS),d.push(\"v\",b),d.push(\"a\",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push(\"h\",-a),d.push(\"a\",this.CORNER_RADIUS,\nthis.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(d.push(\"a\",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),d.push(\"h\",a),d.push(\"a\",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),d.push(\"v\",b),d.push(\"h\",-a-2*this.CORNER_RADIUS));d.push(\"z\");this.svgBackground_.setAttribute(\"d\",d.join(\" \"))}scrollToStart(){let a;null==(a=this.workspace_.scrollbar)||a.setX(this.RTL?Infinity:0)}wheel_(a){var b=getScrollDeltaPixels$$module$build$src$core$browser_events(a);\nif(b=b.x||b.y){const c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().left-d.left+b;let e;null==(e=this.workspace_.scrollbar)||e.setX(b);hide$$module$build$src$core$widgetdiv();hideWithoutAnimation$$module$build$src$core$dropdowndiv()}a.preventDefault();a.stopPropagation()}layout_(a,b){this.workspace_.scale=this.targetWorkspace.scale;const c=this.MARGIN;let d=c+this.tabWidth_;this.RTL&&(a=a.reverse());for(let h=0,k;k=a[h];h++)if(\"block\"===k.type){var e=k.block,f=e.getDescendants(!1);\nfor(let m=0,n;n=f[m];m++)n.isInFlyout=!0;f=e.getSvgRoot();const l=e.getHeightWidth();var g=e.outputConnection?this.tabWidth_:0;g=this.RTL?d+l.width:d-g;e.moveBy(g,c);g=this.createRect_(e,g,c,l,h);d+=l.width+b[h];this.addBlockListeners_(f,e,g)}else\"button\"===k.type&&(e=k.button,this.initFlyoutButton_(e,d,c),d+=e.width+b[h])}isDragTowardWorkspace(a){a=Math.atan2(a.y,a.x)/Math.PI*180;const b=this.dragAngleRange_;return a<90+b&&a>90-b||a>-90-b&&a<-90+b?!0:!1}getClientRect(){if(!this.svgGroup_||this.autoClose||\n!this.isVisible())return null;const a=this.svgGroup_.getBoundingClientRect(),b=a.top;return this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.TOP?new Rect$$module$build$src$core$utils$rect(-1E9,b+a.height,-1E9,1E9):new Rect$$module$build$src$core$utils$rect(b,1E9,-1E9,1E9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let a=0;const b=this.workspace_.getTopBlocks(!1);for(let d=0,e;e=b[d];d++)a=Math.max(a,e.getHeightWidth().height);const c=this.buttons_;for(let d=\n0,e;e=c[d];d++)a=Math.max(a,e.height);a+=1.5*this.MARGIN;a*=this.workspace_.scale;a+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness;if(this.height_!==a){for(let d=0,e;e=b[d];d++)this.rectMap_.has(e)&&this.moveRectToBlock_(this.rectMap_.get(e),e);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Position$$module$build$src$core$utils$toolbox.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+\na);this.height_=a;this.position();this.targetWorkspace.resizeContents();this.targetWorkspace.recordDragTargets()}}};register$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,DEFAULT$$module$build$src$core$registry,HorizontalFlyout$$module$build$src$core$flyout_horizontal);var module$build$src$core$flyout_horizontal={};module$build$src$core$flyout_horizontal.HorizontalFlyout=HorizontalFlyout$$module$build$src$core$flyout_horizontal;var VerticalFlyout$$module$build$src$core$flyout_vertical=class extends Flyout$$module$build$src$core$flyout_base{constructor(a){super(a)}setMetrics_(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics();\"number\"===typeof a.y&&(this.workspace_.scrollY=-(c.top+(c.height-d.height)*a.y));this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top)}}getX(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager();\nconst b=a.getAbsoluteMetrics(),c=a.getViewMetrics();a=a.getToolboxMetrics();return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?a.width:c.width-this.width_:this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?0:c.width:this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?0:c.width+b.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&\nthis.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=a.height;this.setBackgroundPath(this.width_-this.CORNER_RADIUS,a.height-2*this.CORNER_RADIUS);a=this.getX();var b=this.getY();this.positionAt_(this.width_,this.height_,a,b)}}setBackgroundPath(a,b){const c=this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.RIGHT;var d=a+this.CORNER_RADIUS;d=[\"M \"+(c?d:0)+\",0\"];d.push(\"h\",c?-a:a);d.push(\"a\",this.CORNER_RADIUS,this.CORNER_RADIUS,\n0,0,c?0:1,c?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS);d.push(\"v\",Math.max(0,b));d.push(\"a\",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS);d.push(\"h\",c?a:-a);d.push(\"z\");this.svgBackground_.setAttribute(\"d\",d.join(\" \"))}scrollToStart(){let a;null==(a=this.workspace_.scrollbar)||a.setY(0)}wheel_(a){var b=getScrollDeltaPixels$$module$build$src$core$browser_events(a);if(b.y){const c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();\nb=c.getViewMetrics().top-d.top+b.y;let e;null==(e=this.workspace_.scrollbar)||e.setY(b);hide$$module$build$src$core$widgetdiv();hideWithoutAnimation$$module$build$src$core$dropdowndiv()}a.preventDefault();a.stopPropagation()}layout_(a,b){this.workspace_.scale=this.targetWorkspace.scale;var c=this.MARGIN;const d=this.RTL?c:c+this.tabWidth_;for(let h=0,k;k=a[h];h++)if(\"block\"===k.type){var e=k.block,f=e.getDescendants(!1);for(let m=0,n;n=f[m];m++)n.isInFlyout=!0;f=e.getSvgRoot();const l=e.getHeightWidth();\nvar g=e.outputConnection?d-this.tabWidth_:d;e.moveBy(g,c);g=this.createRect_(e,this.RTL?g-l.width:g,c,l,h);this.addBlockListeners_(f,e,g);c+=l.height+b[h]}else\"button\"===k.type&&(e=k.button,this.initFlyoutButton_(e,d,c),c+=e.height+b[h])}isDragTowardWorkspace(a){a=Math.atan2(a.y,a.x)/Math.PI*180;const b=this.dragAngleRange_;return a<b&&a>-b||a<-180+b||a>180-b?!0:!1}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const a=this.svgGroup_.getBoundingClientRect(),b=a.left;\nreturn this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?new Rect$$module$build$src$core$utils$rect(-1E9,1E9,-1E9,b+a.width):new Rect$$module$build$src$core$utils$rect(-1E9,1E9,b,1E9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let a=0;var b=this.workspace_.getTopBlocks(!1);for(let d=0,e;e=b[d];d++){var c=e.getHeightWidth().width;e.outputConnection&&(c-=this.tabWidth_);a=Math.max(a,c)}for(let d=0,e;e=this.buttons_[d];d++)a=Math.max(a,e.width);a+=1.5*this.MARGIN+\nthis.tabWidth_;a*=this.workspace_.scale;a+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness;if(this.width_!==a){for(let d=0,e;e=b[d];d++){if(this.RTL){c=e.getRelativeToSurfaceXY().x;let f=a/this.workspace_.scale-this.MARGIN;e.outputConnection||(f-=this.tabWidth_);e.moveBy(f-c,0)}this.rectMap_.has(e)&&this.moveRectToBlock_(this.rectMap_.get(e),e)}if(this.RTL)for(let d=0,e;e=this.buttons_[d];d++)b=e.getPosition().y,e.moveTo(a/this.workspace_.scale-e.width-this.MARGIN-this.tabWidth_,b);\nthis.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Position$$module$build$src$core$utils$toolbox.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+a,this.targetWorkspace.scrollY);this.width_=a;this.position();this.targetWorkspace.resizeContents();this.targetWorkspace.recordDragTargets()}}};VerticalFlyout$$module$build$src$core$flyout_vertical.registryName=\"verticalFlyout\";\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,DEFAULT$$module$build$src$core$registry,VerticalFlyout$$module$build$src$core$flyout_vertical);var module$build$src$core$flyout_vertical={};module$build$src$core$flyout_vertical.VerticalFlyout=VerticalFlyout$$module$build$src$core$flyout_vertical;var module$build$src$core$generator;\n$.CodeGenerator$$module$build$src$core$generator=class{constructor(a){this.forBlock=Object.create(null);this.FUNCTION_NAME_PLACEHOLDER_=\"{leCUI8hutHZI4480Dc}\";this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null;this.INDENT=\"  \";this.COMMENT_WRAP=60;this.ORDER_OVERRIDES=[];this.isInitialized=null;this.RESERVED_WORDS_=\"\";this.definitions_=Object.create(null);this.functionNames_=Object.create(null);this.nameDB_=void 0;this.name_=a;this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,\n\"g\")}workspaceToCode(a){a||(console.warn(\"No workspace specified in workspaceToCode call.  Guessing.\"),a=getMainWorkspace$$module$build$src$core$common());var b=[];this.init(a);a=a.getTopBlocks(!0);for(let c=0,d;d=a[c];c++){let e=this.blockToCode(d);Array.isArray(e)&&(e=e[0]);e&&(d.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!d.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,d)+e),this.STATEMENT_SUFFIX&&!d.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,\nd))),b.push(e))}b=b.join(\"\\n\");b=this.finish(b);b=b.replace(/^\\s+\\n/,\"\");b=b.replace(/\\n\\s+$/,\"\\n\");return b=b.replace(/[ \\t]+\\n/g,\"\\n\")}prefixLines(a,b){return b+a.replace(/(?!\\n$)\\n/g,\"\\n\"+b)}allNestedComments(a){const b=[];a=a.getDescendants(!0);for(let c=0;c<a.length;c++){const d=a[c].getCommentText();d&&b.push(d)}b.length&&b.push(\"\");return b.join(\"\\n\")}blockToCode(a,b){!1===this.isInitialized&&console.warn(\"CodeGenerator init was not called before blockToCode was called.\");if(!a)return\"\";if(!a.isEnabled())return b?\n\"\":this.blockToCode(a.getNextBlock());if(a.isInsertionMarker())return b?\"\":this.blockToCode(a.getChildren(!1)[0]);var c=this.forBlock[a.type];!c&&this[a.type]&&(warn$$module$build$src$core$utils$deprecation(\"block generator functions on CodeGenerator objects\",\"10.0\",\"11.0\",\"the .forBlock[blockType] dictionary\"),c=this[a.type]);if(\"function\"!==typeof c)throw Error(`${this.name_} generator does not know how to generate code `+`for block type \"${a.type}\".`);c=c.call(a,a,this);if(Array.isArray(c)){if(!a.outputConnection)throw TypeError(\"Expecting string from statement block: \"+\na.type);return[this.scrub_(a,c[0],b),c[1]]}if(\"string\"===typeof c)return this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(c=this.injectId(this.STATEMENT_PREFIX,a)+c),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(c+=this.injectId(this.STATEMENT_SUFFIX,a)),this.scrub_(a,c,b);if(null===c)return\"\";throw SyntaxError(\"Invalid code generated: \"+c);}valueToCode(a,b,c){if(isNaN(c))throw TypeError(\"Expecting valid order from block: \"+a.type);var d=a.getInputTargetBlock(b);if(!d)return\"\";b=this.blockToCode(d);\nif(\"\"===b)return\"\";if(!Array.isArray(b))throw TypeError(`Expecting tuple from value block: ${d.type} See `+\"developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information\");a=b[0];b=b[1];if(isNaN(b))throw TypeError(\"Expecting valid order from value block: \"+d.type);if(!a)return\"\";d=!1;var e=Math.floor(c);const f=Math.floor(b);if(e<=f&&(e!==f||0!==e&&99!==e))for(d=!0,e=0;e<this.ORDER_OVERRIDES.length;e++)if(this.ORDER_OVERRIDES[e][0]===c&&this.ORDER_OVERRIDES[e][1]===\nb){d=!1;break}d&&(a=\"(\"+a+\")\");return a}statementToCode(a,b){a=a.getInputTargetBlock(b);b=this.blockToCode(a);if(\"string\"!==typeof b)throw TypeError(\"Expecting code from statement block: \"+(a&&a.type));b&&(b=this.prefixLines(b,this.INDENT));return b}addLoopTrap(a,b){this.INFINITE_LOOP_TRAP&&(a=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,b),this.INDENT)+a);this.STATEMENT_SUFFIX&&!b.suppressPrefixSuffix&&(a=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,b),this.INDENT)+a);this.STATEMENT_PREFIX&&\n!b.suppressPrefixSuffix&&(a+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,b),this.INDENT));return a}injectId(a,b){b=b.id.replace(/\\$/g,\"$$$$\");return a.replace(/%1/g,\"'\"+b+\"'\")}addReservedWords(a){this.RESERVED_WORDS_+=a+\",\"}provideFunction_(a,b){if(!this.definitions_[a]){const c=this.nameDB_.getDistinctName(a,$.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[a]=c;Array.isArray(b)&&(b=b.join(\"\\n\"));b=b.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,c);let d;for(;d!==\nb;)d=b,b=b.replace(/^(( {2})*) {2}/gm,\"$1\\x00\");b=b.replace(/\\0/g,this.INDENT);this.definitions_[a]=b}return this.functionNames_[a]}getVariableName(a){return this.getName(a,$.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(a){return this.getName(a,$.NameType$$module$build$src$core$names.PROCEDURE)}getName(a,b){if(!this.nameDB_)throw Error(\"Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.\");return this.nameDB_.getName(a,b)}init(a){this.definitions_=\nObject.create(null);this.functionNames_=Object.create(null)}scrub_(a,b,c){return b}finish(a){this.definitions_=Object.create(null);this.functionNames_=Object.create(null);return a}scrubNakedValue(a){return a}};module$build$src$core$generator={};module$build$src$core$generator.CodeGenerator=$.CodeGenerator$$module$build$src$core$generator;var documentEventsBound$$module$build$src$core$inject=!1,module$build$src$core$inject={};module$build$src$core$inject.inject=inject$$module$build$src$core$inject;var module$build$src$core$inputs={};module$build$src$core$inputs.Align=$.Align$$module$build$src$core$inputs$align;module$build$src$core$inputs.DummyInput=DummyInput$$module$build$src$core$inputs$dummy_input;module$build$src$core$inputs.EndRowInput=EndRowInput$$module$build$src$core$inputs$end_row_input;module$build$src$core$inputs.Input=Input$$module$build$src$core$inputs$input;module$build$src$core$inputs.StatementInput=StatementInput$$module$build$src$core$inputs$statement_input;\nmodule$build$src$core$inputs.ValueInput=$.ValueInput$$module$build$src$core$inputs$value_input;module$build$src$core$inputs.inputTypes=$.inputTypes$$module$build$src$core$inputs$input_types;var module$build$src$core$interfaces$i_icon={};module$build$src$core$interfaces$i_icon.isIcon=isIcon$$module$build$src$core$interfaces$i_icon;var module$build$src$core$interfaces$i_paster={};module$build$src$core$interfaces$i_paster.isPaster=isPaster$$module$build$src$core$interfaces$i_paster;var ConstantProvider$$module$build$src$core$renderers$geras$constants=class extends ConstantProvider$$module$build$src$core$renderers$common$constants{constructor(){super();this.FIELD_TEXT_BASELINE_CENTER=!1;this.DARK_PATH_OFFSET=1;this.MAX_BOTTOM_WIDTH=30;this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(a){return super.getCSS_(a).concat([`${a} .blocklyInsertionMarker>.blocklyPathLight,`,`${a} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\"stroke: none;\",\n\"}\"])}},module$build$src$core$renderers$geras$constants={};module$build$src$core$renderers$geras$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$geras$constants;var Highlighter$$module$build$src$core$renderers$geras$highlighter=class{constructor(a){this.inlineSteps_=this.steps_=\"\";this.info_=a;this.RTL_=this.info_.RTL;a=a.getRenderer();this.constants_=a.getConstants();this.highlightConstants_=a.getHighlightConstants();this.highlightOffset=this.highlightConstants_.OFFSET;this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER;this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER;this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB;this.notchPaths_=\nthis.highlightConstants_.NOTCH;this.startPaths_=this.highlightConstants_.START_HAT;this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+\"\\n\"+this.inlineSteps_}drawTopCorner(a){this.steps_+=moveBy$$module$build$src$core$utils$svg_paths(a.xPos,this.info_.startY);for(let b=0,c;c=a.elements[b];b++)Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(c)?this.steps_+=this.highlightConstants_.START_POINT:Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(c)?\nthis.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(c)?this.steps_+=this.notchPaths_.pathLeft:Types$$module$build$src$core$renderers$measurables$types.isHat(c)?this.steps_+=this.startPaths_.path(this.RTL_):Types$$module$build$src$core$renderers$measurables$types.isSpacer(c)&&0!==c.width&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",c.xPos+c.width-this.highlightOffset));this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",\na.xPos+a.width-this.highlightOffset)}drawJaggedEdge_(a){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(a){const b=a.getLastInput();if(this.RTL_){const c=a.height-b.connectionHeight;this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos+b.width-this.highlightOffset,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",\nc)}else this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos+b.width,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(a){const b=a.getLastInput();if(b)if(this.RTL_){const c=a.height-2*this.insideCornerPaths_.height;this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos,a.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",c)+this.insideCornerPaths_.pathBottom(this.RTL_)+lineTo$$module$build$src$core$utils$svg_paths(a.width-\nb.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos,a.yPos+a.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+lineTo$$module$build$src$core$utils$svg_paths(a.width-b.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(a){const b=a.xPos+a.width-this.highlightOffset;a instanceof SpacerRow$$module$build$src$core$renderers$measurables$spacer_row&&a.followsStatement&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",b));\nthis.RTL_&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",b),a.height>this.highlightOffset&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.yPos+a.height-this.highlightOffset)))}drawBottomRow(a){if(this.RTL_)this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.baseline-this.highlightOffset);else{const b=this.info_.bottomRow.elements[0];Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(b)?this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+\nthis.highlightOffset,a.baseline-this.highlightOffset):Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(b)&&(this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos,a.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var a=this.info_.outputConnection;a&&(a=a.connectionOffsetY+a.height,this.RTL_?this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(this.info_.startX,a):(this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(this.info_.startX+\nthis.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_));this.RTL_||(a=this.info_.topRow,Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a.elements[0])?this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",this.outsideCornerPaths_.height):this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",a.capline+this.highlightOffset))}drawInlineInput(a){const b=\nthis.highlightOffset,c=a.xPos+a.connectionWidth;var d=a.centerline-a.height/2;const e=a.width-a.connectionWidth,f=d+b;this.RTL_?(d=a.connectionOffsetY-b,a=a.height-(a.connectionOffsetY+a.connectionHeight)+b,this.inlineSteps_+=moveTo$$module$build$src$core$utils$svg_paths(c-b,f)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",d)+this.puzzleTabPaths_.pathDown(this.RTL_)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",e)):this.inlineSteps_+=\nmoveTo$$module$build$src$core$utils$svg_paths(a.xPos+a.width+b,f)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",a.height)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",-e)+moveTo$$module$build$src$core$utils$svg_paths(c,d+a.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},module$build$src$core$renderers$geras$highlighter={};module$build$src$core$renderers$geras$highlighter.Highlighter=Highlighter$$module$build$src$core$renderers$geras$highlighter;var Drawer$$module$build$src$core$renderers$geras$drawer=class extends Drawer$$module$build$src$core$renderers$common$drawer{constructor(a,b){super(a,b);this.highlighter_=new Highlighter$$module$build$src$core$renderers$geras$highlighter(b)}draw(){this.drawOutline_();this.drawInternals_();const a=this.block_.pathObject;a.setPath(this.outlinePath_+\"\\n\"+this.inlinePath_);a.setHighlightPath(this.highlighter_.getPath());this.info_.RTL&&a.flipRTL();this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow);\nthis.highlighter_.drawRightSideRow(this.info_.topRow);super.drawTop_()}drawJaggedEdge_(a){this.highlighter_.drawJaggedEdge_(a);super.drawJaggedEdge_(a)}drawValueInput_(a){this.highlighter_.drawValueInput(a);super.drawValueInput_(a)}drawStatementInput_(a){this.highlighter_.drawStatementInput(a);super.drawStatementInput_(a)}drawRightSideRow_(a){this.highlighter_.drawRightSideRow(a);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths(\"H\",a.xPos+a.width)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"V\",\na.yPos+a.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow);super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft();super.drawLeft_()}drawInlineInput_(a){this.highlighter_.drawInlineInput(a);super.drawInlineInput_(a)}positionInlineInputConnection_(a){const b=a.centerline-a.height/2;if(a.connectionModel){let c=a.xPos+a.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1);a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(a){const b=\na.getLastInput();if(null==b?0:b.connectionModel){let c=a.xPos+a.statementEdge+b.notchOffset;c=this.info_.RTL?-1*c:c+this.constants_.DARK_PATH_OFFSET;b.connectionModel.setOffsetInBlock(c,a.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(a){const b=a.getLastInput();if(b&&b.connectionModel){let c=a.xPos+a.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1);b.connectionModel.setOffsetInBlock(c,a.yPos)}}positionNextConnection_(){const a=this.info_.bottomRow;if(a.connection){const b=\na.connection,c=b.xPos;b.connectionModel.setOffsetInBlock((this.info_.RTL?-c:c)+this.constants_.DARK_PATH_OFFSET/2,a.baseline+this.constants_.DARK_PATH_OFFSET)}}},module$build$src$core$renderers$geras$drawer={};module$build$src$core$renderers$geras$drawer.Drawer=Drawer$$module$build$src$core$renderers$geras$drawer;var HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants=class{constructor(a){this.OFFSET=.5;this.constantProvider=a;this.START_POINT=moveBy$$module$build$src$core$utils$svg_paths(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner();this.OUTSIDE_CORNER=this.makeOutsideCorner();this.PUZZLE_TAB=this.makePuzzleTab();this.NOTCH=this.makeNotch();this.JAGGED_TEETH=this.makeJaggedTeeth();this.START_HAT=this.makeStartHat()}makeInsideCorner(){const a=this.constantProvider.CORNER_RADIUS,\nb=this.OFFSET,c=(1-Math.SQRT1_2)*(a+b)-b,d=moveBy$$module$build$src$core$utils$svg_paths(c,c)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a,point$$module$build$src$core$utils$svg_paths(-c-b,a-c)),e=arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a+b,point$$module$build$src$core$utils$svg_paths(a+b,a+b)),f=moveBy$$module$build$src$core$utils$svg_paths(c,-c)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,0\",a+b,point$$module$build$src$core$utils$svg_paths(a-c,c+b));return{width:a+\nb,height:a,pathTop(g){return g?d:\"\"},pathBottom(g){return g?e:f}}}makeOutsideCorner(){const a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a-b)+b,d=moveBy$$module$build$src$core$utils$svg_paths(c,c)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a-b,point$$module$build$src$core$utils$svg_paths(a-c,-c+b)),e=moveBy$$module$build$src$core$utils$svg_paths(b,a)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a-b,point$$module$build$src$core$utils$svg_paths(a,-a+\nb)),f=-c,g=moveBy$$module$build$src$core$utils$svg_paths(c,f)+arc$$module$build$src$core$utils$svg_paths(\"a\",\"0 0,1\",a-b,point$$module$build$src$core$utils$svg_paths(-c+b,-f-a));return{height:a,topLeft(h){return h?d:e},bottomLeft(){return g}}}makePuzzleTab(){const a=this.constantProvider.TAB_WIDTH,b=this.constantProvider.TAB_HEIGHT,c=moveBy$$module$build$src$core$utils$svg_paths(-2,-b+3.4)+lineTo$$module$build$src$core$utils$svg_paths(-.45*a,-2.1),d=lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",\n2.5)+moveBy$$module$build$src$core$utils$svg_paths(.97*-a,2.5)+curve$$module$build$src$core$utils$svg_paths(\"q\",[point$$module$build$src$core$utils$svg_paths(.05*-a,10),point$$module$build$src$core$utils$svg_paths(.3*a,9.5)])+moveBy$$module$build$src$core$utils$svg_paths(.67*a,-1.9)+lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",2.5),e=lineOnAxis$$module$build$src$core$utils$svg_paths(\"v\",-1.5)+moveBy$$module$build$src$core$utils$svg_paths(-.92*a,-.5)+curve$$module$build$src$core$utils$svg_paths(\"q\",\n[point$$module$build$src$core$utils$svg_paths(-.19*a,-5.5),point$$module$build$src$core$utils$svg_paths(0,-11)])+moveBy$$module$build$src$core$utils$svg_paths(.92*a,1),f=moveBy$$module$build$src$core$utils$svg_paths(-5,b-.7)+lineTo$$module$build$src$core$utils$svg_paths(.46*a,-2.1);return{width:a,height:b,pathUp(g){return g?c:e},pathDown(g){return g?d:f}}}makeNotch(){return{pathLeft:lineOnAxis$$module$build$src$core$utils$svg_paths(\"h\",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:lineTo$$module$build$src$core$utils$svg_paths(5.1,\n2.6)+moveBy$$module$build$src$core$utils$svg_paths(-10.2,6.8)+lineTo$$module$build$src$core$utils$svg_paths(5.1,2.6),height:12,width:10.2}}makeStartHat(){const a=this.constantProvider.START_HAT.height,b=moveBy$$module$build$src$core$utils$svg_paths(25,-8.7)+curve$$module$build$src$core$utils$svg_paths(\"c\",[point$$module$build$src$core$utils$svg_paths(29.7,-6.2),point$$module$build$src$core$utils$svg_paths(57.2,-.5),point$$module$build$src$core$utils$svg_paths(75,8.7)]),c=curve$$module$build$src$core$utils$svg_paths(\"c\",\n[point$$module$build$src$core$utils$svg_paths(17.8,-9.2),point$$module$build$src$core$utils$svg_paths(45.3,-14.9),point$$module$build$src$core$utils$svg_paths(75,-8.7)])+moveTo$$module$build$src$core$utils$svg_paths(100.5,a+.5);return{path(d){return d?b:c}}}},module$build$src$core$renderers$geras$highlight_constants={};module$build$src$core$renderers$geras$highlight_constants.HighlightConstantProvider=HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants;var InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input=class extends InlineInput$$module$build$src$core$renderers$measurables$inline_input{constructor(a,b){super(a,b);this.constants_=a;this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},module$build$src$core$renderers$geras$measurables$inline_input={};module$build$src$core$renderers$geras$measurables$inline_input.InlineInput=InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input;var StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input=class extends StatementInput$$module$build$src$core$renderers$measurables$statement_input{constructor(a,b){super(a,b);this.constants_=a;this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},module$build$src$core$renderers$geras$measurables$statement_input={};module$build$src$core$renderers$geras$measurables$statement_input.StatementInput=StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input;var RenderInfo$$module$build$src$core$renderers$geras$info=class extends RenderInfo$$module$build$src$core$renderers$common$info{constructor(a,b){super(a,b);this.renderer_=a}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_();this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof StatementInput$$module$build$src$core$inputs$statement_input||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(a,\nb){if(this.isInline&&a instanceof $.ValueInput$$module$build$src$core$inputs$value_input)b.elements.push(new InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input(this.constants_,a)),b.hasInlineInput=!0;else if(a instanceof StatementInput$$module$build$src$core$inputs$statement_input)b.elements.push(new StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input(this.constants_,a)),b.hasStatement=!0;else if(a instanceof $.ValueInput$$module$build$src$core$inputs$value_input)b.elements.push(new ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input(this.constants_,\na)),b.hasExternalInput=!0;else if(a instanceof DummyInput$$module$build$src$core$inputs$dummy_input||a instanceof EndRowInput$$module$build$src$core$inputs$end_row_input)b.minHeight=Math.max(b.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0;this.isInline||null!==b.align||(b.align=a.align)}addElemSpacing_(){let a=!1;for(let c=0,d;d=this.rows[c];c++)d.hasExternalInput&&(a=!0);for(let c=0,d;d=this.rows[c];c++){var b=d.elements;d.elements=[];d.startsWithElemSpacer()&&d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,\nthis.getInRowSpacing_(null,b[0])));if(b.length){for(let e=0;e<b.length-1;e++){d.elements.push(b[e]);const f=this.getInRowSpacing_(b[e],b[e+1]);d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,f))}d.elements.push(b[b.length-1]);d.endsWithElemSpacer()&&(b=this.getInRowSpacing_(b[b.length-1],null),a&&d.hasDummyInput&&(b+=this.constants_.TAB_WIDTH),d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,\nb)))}}}getInRowSpacing_(a,b){if(!a)return b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&(!b||\nTypes$$module$build$src$core$renderers$measurables$types.isStatementInput(b)))return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable?this.constants_.MEDIUM_PADDING:Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?2*this.constants_.LARGE_PADDING+1:Types$$module$build$src$core$renderers$measurables$types.isHat(a)?this.constants_.NO_PADDING:Types$$module$build$src$core$renderers$measurables$types.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:\nTypes$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b){if(Types$$module$build$src$core$renderers$measurables$types.isExternalInput(a))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a))return this.constants_.LARGE_PADDING;\nif(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(a))return this.constants_.NO_PADDING}if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isInput(b)){if(Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable){if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.SMALL_PADDING}else{if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||\nTypes$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Types$$module$build$src$core$renderers$measurables$types.isIcon(a)&&b&&!Types$$module$build$src$core$renderers$measurables$types.isInput(b))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a)&&\nb&&Types$$module$build$src$core$renderers$measurables$types.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b){if(Types$$module$build$src$core$renderers$measurables$types.isHat(b))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b))return b.notchOffset;if(Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))return b.notchOffset+\n(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b){if(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS;if(Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&\nb&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&a.isEditable===b.isEditable||b&&Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(a,b){return Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)&&Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)||\nTypes$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||!a.hasStatement&&b.hasDummyInput||a.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(a,b){if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return a.yPos+b.height/\n2;if(Types$$module$build$src$core$renderers$measurables$types.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b)?a+b.height/2:a-b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isTopRow(a))return Types$$module$build$src$core$renderers$measurables$types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;let c=a.yPos;Types$$module$build$src$core$renderers$measurables$types.isField(b)||Types$$module$build$src$core$renderers$measurables$types.isIcon(b)?\n(c+=b.height/2,(a.hasInlineInput||a.hasStatement)&&b.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=a.height&&(c+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):c=Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)?c+b.height/2:c+a.height/2;return c}alignRowElements_(){if(this.isInline){var a=0,b=new WeakMap,c=null;for(let d=this.rows.length-1,e;e=this.rows[d];d--)b.set(e,a),Types$$module$build$src$core$renderers$measurables$types.isInputRow(e)&&(e.hasStatement&&this.alignStatementRow_(e),\nc&&c.hasStatement&&e.width<c.width?b.set(e,c.width):a=e.hasStatement?e.width:Math.max(a,e.width),c=e);a=0;for(let d=0,e;e=this.rows[d];d++)e.hasStatement?a=this.getDesiredRowWidth_(e):Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)?e.width=Math.max(a,b.get(e)):(c=e.width,a=Math.max(a,b.get(e))-c,0<a&&this.addAlignmentPadding_(e,a),a=e.width)}else super.alignRowElements_()}getDesiredRowWidth_(a){return this.isInline&&a.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+\nthis.startX:super.getDesiredRowWidth_(a)}finalize_(){let a=0,b=0;for(let d=0,e;e=this.rows[d];d++){e.yPos=b;e.xPos=this.startX;b+=e.height;a=Math.max(a,e.widthWithConnectedBlocks);var c=b-this.topRow.ascenderHeight;e===this.bottomRow&&c<this.constants_.MIN_BLOCK_HEIGHT&&(c=this.constants_.MIN_BLOCK_HEIGHT-c,this.bottomRow.height+=c,b+=c);this.recordElemPositions_(e)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&\n(a=Math.max(a,c.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET));this.bottomRow.baseline=b-this.bottomRow.descenderHeight;this.widthWithChildren=a+this.startX+this.constants_.DARK_PATH_OFFSET;this.width+=this.constants_.DARK_PATH_OFFSET;this.height=b+this.constants_.DARK_PATH_OFFSET;this.startY=this.topRow.capline}},module$build$src$core$renderers$geras$info={};module$build$src$core$renderers$geras$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$geras$info;var PathObject$$module$build$src$core$renderers$geras$path_object=class extends PathObject$$module$build$src$core$renderers$common$path_object{constructor(a,b,c){super(a,b,c);this.constants=c;this.colourDark=\"#000000\";this.svgPathDark=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{\"class\":\"blocklyPathDark\",transform:\"translate(1,1)\"});this.svgRoot.insertBefore(this.svgPathDark,this.svgPath);this.svgPathLight=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,\n{\"class\":\"blocklyPathLight\"},this.svgRoot)}setPath(a){this.svgPath.setAttribute(\"d\",a);this.svgPathDark.setAttribute(\"d\",a)}setHighlightPath(a){this.svgPathLight.setAttribute(\"d\",a)}flipRTL(){this.svgPath.setAttribute(\"transform\",\"scale(-1 1)\");this.svgPathLight.setAttribute(\"transform\",\"scale(-1 1)\");this.svgPathDark.setAttribute(\"transform\",\"translate(1,1) scale(-1 1)\")}applyColour(a){this.svgPathLight.style.display=\"\";this.svgPathDark.style.display=\"\";if(!this.style.colourTertiary)throw Error(\"The renderer did not properly initialize the tertiary colour of the block style\");\nthis.svgPathLight.setAttribute(\"stroke\",this.style.colourTertiary);this.svgPathDark.setAttribute(\"fill\",this.colourDark);super.applyColour(a);this.svgPath.setAttribute(\"stroke\",\"none\")}setStyle(a){this.style=a;this.colourDark=blend$$module$build$src$core$utils$colour(\"#000\",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(a){a?(this.svgPath.setAttribute(\"filter\",\"url(#\"+this.constants.embossFilterId+\")\"),this.svgPathLight.style.display=\"none\"):(this.svgPath.setAttribute(\"filter\",\"none\"),\nthis.svgPathLight.style.display=\"inline\")}updateShadow_(a){if(a){this.svgPathLight.style.display=\"none\";if(!this.style.colourSecondary)throw Error(\"The renderer did not properly initialize the secondary colour of the block style block style\");this.svgPathDark.setAttribute(\"fill\",this.style.colourSecondary);this.svgPath.setAttribute(\"stroke\",\"none\");this.svgPath.setAttribute(\"fill\",this.style.colourSecondary)}}updateDisabled_(a){super.updateDisabled_(a);a&&this.svgPath.setAttribute(\"stroke\",\"none\")}},\nmodule$build$src$core$renderers$geras$path_object={};module$build$src$core$renderers$geras$path_object.PathObject=PathObject$$module$build$src$core$renderers$geras$path_object;var Renderer$$module$build$src$core$renderers$geras$renderer=class extends Renderer$$module$build$src$core$renderers$common$renderer{constructor(a){super(a);this.highlightConstants=null}init(a,b){super.init(a,b);this.highlightConstants=this.makeHighlightConstants_();this.highlightConstants.init()}refreshDom(a,b){super.refreshDom(a,b);this.getHighlightConstants().init()}makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$geras$constants}makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$geras$info(this,\na)}makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$geras$drawer(a,b)}makePathObject(a,b){return new PathObject$$module$build$src$core$renderers$geras$path_object(a,b,this.getConstants())}makeHighlightConstants_(){return new HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error(\"Cannot access the highlight constants because init has not been called\");return this.highlightConstants}};\nregister$$module$build$src$core$renderers$common$block_rendering(\"geras\",Renderer$$module$build$src$core$renderers$geras$renderer);var module$build$src$core$renderers$geras$renderer={};module$build$src$core$renderers$geras$renderer.Renderer=Renderer$$module$build$src$core$renderers$geras$renderer;var module$build$src$core$renderers$geras$geras={};module$build$src$core$renderers$geras$geras.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$geras$constants;module$build$src$core$renderers$geras$geras.Drawer=Drawer$$module$build$src$core$renderers$geras$drawer;module$build$src$core$renderers$geras$geras.HighlightConstantProvider=HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants;module$build$src$core$renderers$geras$geras.Highlighter=Highlighter$$module$build$src$core$renderers$geras$highlighter;\nmodule$build$src$core$renderers$geras$geras.InlineInput=InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input;module$build$src$core$renderers$geras$geras.PathObject=PathObject$$module$build$src$core$renderers$geras$path_object;module$build$src$core$renderers$geras$geras.RenderInfo=RenderInfo$$module$build$src$core$renderers$geras$info;module$build$src$core$renderers$geras$geras.Renderer=Renderer$$module$build$src$core$renderers$geras$renderer;\nmodule$build$src$core$renderers$geras$geras.StatementInput=StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input;var ConstantProvider$$module$build$src$core$renderers$minimalist$constants=class extends ConstantProvider$$module$build$src$core$renderers$common$constants{constructor(){super();warn$$module$build$src$core$utils$deprecation(\"Blockly.minimalist.ConstantProvider\",\"v10\",\"v11\",\"Blockly.blockRendering.ConstantProvider\")}},module$build$src$core$renderers$minimalist$constants={};module$build$src$core$renderers$minimalist$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$minimalist$constants;var Drawer$$module$build$src$core$renderers$minimalist$drawer=class extends Drawer$$module$build$src$core$renderers$common$drawer{constructor(a,b){super(a,b);warn$$module$build$src$core$utils$deprecation(\"Blockly.minimalist.Drawer\",\"v10\",\"v11\",\"Blockly.blockRendering.Drawer\")}},module$build$src$core$renderers$minimalist$drawer={};module$build$src$core$renderers$minimalist$drawer.Drawer=Drawer$$module$build$src$core$renderers$minimalist$drawer;var RenderInfo$$module$build$src$core$renderers$minimalist$info=class extends RenderInfo$$module$build$src$core$renderers$common$info{constructor(a,b){super(a,b);warn$$module$build$src$core$utils$deprecation(\"Blockly.minimalist.RenderInfo\",\"v10\",\"v11\",\"Blockly.blockRendering.RenderInfo\")}getRenderer(){return this.renderer_}},module$build$src$core$renderers$minimalist$info={};module$build$src$core$renderers$minimalist$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$minimalist$info;var Renderer$$module$build$src$core$renderers$minimalist$renderer=class extends Renderer$$module$build$src$core$renderers$common$renderer{constructor(a){super(a);warn$$module$build$src$core$utils$deprecation(\"Blockly.minimalist.Renderer\",\"v10\",\"v11\",\"Blockly.blockRendering.Renderer\")}makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$minimalist$constants}makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$minimalist$info(this,a)}makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$minimalist$drawer(a,\nb)}};register$$module$build$src$core$renderers$common$block_rendering(\"minimalist\",Renderer$$module$build$src$core$renderers$minimalist$renderer);var module$build$src$core$renderers$minimalist$renderer={};module$build$src$core$renderers$minimalist$renderer.Renderer=Renderer$$module$build$src$core$renderers$minimalist$renderer;var module$build$src$core$renderers$minimalist$minimalist={};module$build$src$core$renderers$minimalist$minimalist.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$minimalist$constants;module$build$src$core$renderers$minimalist$minimalist.Drawer=Drawer$$module$build$src$core$renderers$minimalist$drawer;module$build$src$core$renderers$minimalist$minimalist.RenderInfo=RenderInfo$$module$build$src$core$renderers$minimalist$info;\nmodule$build$src$core$renderers$minimalist$minimalist.Renderer=Renderer$$module$build$src$core$renderers$minimalist$renderer;var RenderInfo$$module$build$src$core$renderers$thrasos$info=class extends RenderInfo$$module$build$src$core$renderers$common$info{constructor(a,b){super(a,b)}getRenderer(){return this.renderer_}addElemSpacing_(){let a=!1;for(var b=0;b<this.rows.length;b++)if(this.rows[b].hasExternalInput){a=!0;break}for(b=0;b<this.rows.length;b++){const d=this.rows[b];var c=d.elements;d.elements=[];d.startsWithElemSpacer()&&d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,\nthis.getInRowSpacing_(null,c[0])));if(c.length){for(let e=0;e<c.length-1;e++){d.elements.push(c[e]);const f=this.getInRowSpacing_(c[e],c[e+1]);d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,f))}d.elements.push(c[c.length-1]);d.endsWithElemSpacer()&&(c=this.getInRowSpacing_(c[c.length-1],null),a&&d.hasDummyInput&&(c+=this.constants_.TAB_WIDTH),d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,\nc)))}}}getInRowSpacing_(a,b){if(!a)return b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b)return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&\na.isEditable?this.constants_.MEDIUM_PADDING:Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?2*this.constants_.LARGE_PADDING+1:Types$$module$build$src$core$renderers$measurables$types.isHat(a)?this.constants_.NO_PADDING:Types$$module$build$src$core$renderers$measurables$types.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(a)?\nthis.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b){if(Types$$module$build$src$core$renderers$measurables$types.isExternalInput(a))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(a))return this.constants_.NO_PADDING}if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&\nb&&Types$$module$build$src$core$renderers$measurables$types.isInput(b)){if(Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable){if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.SMALL_PADDING}else{if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;\nif(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Types$$module$build$src$core$renderers$measurables$types.isIcon(a)&&b&&!Types$$module$build$src$core$renderers$measurables$types.isInput(b))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isField(b))return b.isEditable?\nthis.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b){if(Types$$module$build$src$core$renderers$measurables$types.isHat(b))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))return b.notchOffset}return Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&\nb?b.notchOffset-this.constants_.CORNER_RADIUS:Types$$module$build$src$core$renderers$measurables$types.isField(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&a.isEditable===b.isEditable||b&&Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(a,b){return Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)&&Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?\nthis.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)||Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||a.hasDummyInput||b.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(a,\nb){if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return a.yPos+b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b)?a+b.height/2:a-b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isTopRow(a))return Types$$module$build$src$core$renderers$measurables$types.isHat(b)?a.capline-b.height/2:a.capline+b.height/\n2;let c=a.yPos;return c=Types$$module$build$src$core$renderers$measurables$types.isField(b)&&a.hasStatement?c+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+b.height/2):c+a.height/2}finalize_(){let a=0,b=0;for(var c=0;c<this.rows.length;c++){const e=this.rows[c];e.yPos=b;e.xPos=this.startX;b+=e.height;a=Math.max(a,e.widthWithConnectedBlocks);var d=b-this.topRow.ascenderHeight;e===this.bottomRow&&d<this.constants_.MIN_BLOCK_HEIGHT&&(d=this.constants_.MIN_BLOCK_HEIGHT-d,this.bottomRow.height+=d,b+=d);this.recordElemPositions_(e)}this.outputConnection&&\nthis.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(a=Math.max(a,c.getHeightWidth().width));this.bottomRow.baseline=b-this.bottomRow.descenderHeight;this.widthWithChildren=a+this.startX;this.height=b;this.startY=this.topRow.capline}},module$build$src$core$renderers$thrasos$info={};module$build$src$core$renderers$thrasos$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$thrasos$info;var Renderer$$module$build$src$core$renderers$thrasos$renderer=class extends Renderer$$module$build$src$core$renderers$common$renderer{constructor(a){super(a)}makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$thrasos$info(this,a)}};register$$module$build$src$core$renderers$common$block_rendering(\"thrasos\",Renderer$$module$build$src$core$renderers$thrasos$renderer);var module$build$src$core$renderers$thrasos$renderer={};\nmodule$build$src$core$renderers$thrasos$renderer.Renderer=Renderer$$module$build$src$core$renderers$thrasos$renderer;var module$build$src$core$renderers$thrasos$thrasos={};module$build$src$core$renderers$thrasos$thrasos.RenderInfo=RenderInfo$$module$build$src$core$renderers$thrasos$info;module$build$src$core$renderers$thrasos$thrasos.Renderer=Renderer$$module$build$src$core$renderers$thrasos$renderer;var defaultBlockStyles$$module$build$src$core$theme$zelos={colour_blocks:{colourPrimary:\"#CF63CF\",colourSecondary:\"#C94FC9\",colourTertiary:\"#BD42BD\"},list_blocks:{colourPrimary:\"#9966FF\",colourSecondary:\"#855CD6\",colourTertiary:\"#774DCB\"},logic_blocks:{colourPrimary:\"#4C97FF\",colourSecondary:\"#4280D7\",colourTertiary:\"#3373CC\"},loop_blocks:{colourPrimary:\"#0fBD8C\",colourSecondary:\"#0DA57A\",colourTertiary:\"#0B8E69\"},math_blocks:{colourPrimary:\"#59C059\",colourSecondary:\"#46B946\",colourTertiary:\"#389438\"},\nprocedure_blocks:{colourPrimary:\"#FF6680\",colourSecondary:\"#FF4D6A\",colourTertiary:\"#FF3355\"},text_blocks:{colourPrimary:\"#FFBF00\",colourSecondary:\"#E6AC00\",colourTertiary:\"#CC9900\"},variable_blocks:{colourPrimary:\"#FF8C1A\",colourSecondary:\"#FF8000\",colourTertiary:\"#DB6E00\"},variable_dynamic_blocks:{colourPrimary:\"#FF8C1A\",colourSecondary:\"#FF8000\",colourTertiary:\"#DB6E00\"},hat_blocks:{colourPrimary:\"#4C97FF\",colourSecondary:\"#4280D7\",colourTertiary:\"#3373CC\",hat:\"cap\"}},categoryStyles$$module$build$src$core$theme$zelos=\n{colour_category:{colour:\"#CF63CF\"},list_category:{colour:\"#9966FF\"},logic_category:{colour:\"#4C97FF\"},loop_category:{colour:\"#0fBD8C\"},math_category:{colour:\"#59C059\"},procedure_category:{colour:\"#FF6680\"},text_category:{colour:\"#FFBF00\"},variable_category:{colour:\"#FF8C1A\"},variable_dynamic_category:{colour:\"#FF8C1A\"}},Zelos$$module$build$src$core$theme$zelos=new Theme$$module$build$src$core$theme(\"zelos\",defaultBlockStyles$$module$build$src$core$theme$zelos,categoryStyles$$module$build$src$core$theme$zelos),\nmodule$build$src$core$theme$zelos={Zelos:Zelos$$module$build$src$core$theme$zelos};var module$build$src$core$theme$themes={Classic:Classic$$module$build$src$core$theme$classic,Zelos:Zelos$$module$build$src$core$theme$zelos};var ToolboxItem$$module$build$src$core$toolbox$toolbox_item=class{constructor(a,b,c){this.id_=a.toolboxitemid||getNextUniqueId$$module$build$src$core$utils$idgenerator();this.level_=(this.parent_=c||null)?this.parent_.getLevel()+1:0;this.toolboxItemDef_=a;this.parentToolbox_=b;this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(a){}},\nmodule$build$src$core$toolbox$toolbox_item={};module$build$src$core$toolbox$toolbox_item.ToolboxItem=ToolboxItem$$module$build$src$core$toolbox$toolbox_item;var ToolboxCategory$$module$build$src$core$toolbox$category=class extends ToolboxItem$$module$build$src$core$toolbox$toolbox_item{constructor(a,b,c){super(a,b,c);this.colour_=this.name_=\"\";this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null;this.isDisabled_=this.isHidden_=!1;this.flyoutItems_=[];this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_);this.parseContents_(this.toolboxItemDef_);this.createDom_();\"true\"===this.toolboxItemDef_.hidden&&\nthis.hide()}makeDefaultCssConfig_(){return{container:\"blocklyToolboxCategory\",row:\"blocklyTreeRow\",rowcontentcontainer:\"blocklyTreeRowContentContainer\",icon:\"blocklyTreeIcon\",label:\"blocklyTreeLabel\",contents:\"blocklyToolboxContents\",selected:\"blocklyTreeSelected\",openicon:\"blocklyTreeIconOpen\",closedicon:\"blocklyTreeIconClosed\"}}parseContents_(a){if(\"custom\"in a)this.flyoutItems_=a.custom;else if(a=a.contents)for(let b=0;b<a.length;b++){const c=a[b];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(c)}}parseCategoryDef_(a){this.name_=\n\"name\"in a?replaceMessageReferences$$module$build$src$core$utils$parsing(a.name):\"\";this.colour_=this.getColour_(a);Object.assign(this.cssConfig_,a.cssconfig||a.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_();setRole$$module$build$src$core$utils$aria(this.htmlDiv_,Role$$module$build$src$core$utils$aria.TREEITEM);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.SELECTED,!1);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.LEVEL,\nthis.level_+1);this.rowDiv_=this.createRowContainer_();this.rowDiv_.style.pointerEvents=\"auto\";this.htmlDiv_.appendChild(this.rowDiv_);this.rowContents_=this.createRowContentsContainer_();this.rowContents_.style.pointerEvents=\"none\";this.rowDiv_.appendChild(this.rowContents_);this.iconDom_=this.createIconDom_();setRole$$module$build$src$core$utils$aria(this.iconDom_,Role$$module$build$src$core$utils$aria.PRESENTATION);this.rowContents_.appendChild(this.iconDom_);this.labelDom_=this.createLabelDom_(this.name_);\nthis.rowContents_.appendChild(this.labelDom_);const a=this.labelDom_.getAttribute(\"id\");a&&setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.LABELLEDBY,a);this.addColourBorder_(this.colour_);return this.htmlDiv_}createContainer_(){const a=document.createElement(\"div\"),b=this.cssConfig_.container;b&&addClass$$module$build$src$core$utils$dom(a,b);return a}createRowContainer_(){const a=document.createElement(\"div\");var b=this.cssConfig_.row;b&&addClass$$module$build$src$core$utils$dom(a,\nb);b=`${ToolboxCategory$$module$build$src$core$toolbox$category.nestedPadding*this.getLevel()}px`;this.workspace_.RTL?a.style.paddingRight=b:a.style.paddingLeft=b;return a}createRowContentsContainer_(){const a=document.createElement(\"div\"),b=this.cssConfig_.rowcontentcontainer;b&&addClass$$module$build$src$core$utils$dom(a,b);return a}createIconDom_(){const a=document.createElement(\"span\");if(!this.parentToolbox_.isHorizontal()){const b=this.cssConfig_.icon;b&&addClass$$module$build$src$core$utils$dom(a,\nb)}a.style.display=\"inline-block\";return a}createLabelDom_(a){const b=document.createElement(\"span\");b.setAttribute(\"id\",this.getId()+\".label\");b.textContent=a;(a=this.cssConfig_.label)&&addClass$$module$build$src$core$utils$dom(b,a);return b}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_);this.addColourBorder_(this.colour_)}addColourBorder_(a){a&&(a=ToolboxCategory$$module$build$src$core$toolbox$category.borderWidth+\"px solid \"+(a||\"#ddd\"),this.workspace_.RTL?this.rowDiv_.style.borderRight=\na:this.rowDiv_.style.borderLeft=a)}getColour_(a){const b=a.categorystyle||a.categoryStyle;if((a=a.colour)&&b)console.warn('Toolbox category \"'+this.name_+'\" must not have both a style and a colour');else{if(b)return this.getColourfromStyle_(b);if(a)return this.parseColour_(a)}return\"\"}getColourfromStyle_(a){var b=this.workspace_.getTheme();if(a&&b){if((b=b.categoryStyles[a])&&b.colour)return this.parseColour_(b.colour);console.warn('Style \"'+a+'\" must exist and contain a colour value')}return\"\"}getClickTarget(){return this.rowDiv_}parseColour_(a){a=\nreplaceMessageReferences$$module$build$src$core$utils$parsing(a);if(null==a||\"\"===a)return\"\";var b=Number(a);if(isNaN(b)){if(b=parse$$module$build$src$core$utils$colour(a))return b;console.warn('Toolbox category \"'+this.name_+'\" has unrecognized colour attribute: '+a);return\"\"}return hueToHex$$module$build$src$core$utils$colour(b)}openIcon_(a){if(a){var b=this.cssConfig_.closedicon;b&&removeClasses$$module$build$src$core$utils$dom(a,b);(b=this.cssConfig_.openicon)&&addClass$$module$build$src$core$utils$dom(a,\nb)}}closeIcon_(a){if(a){var b=this.cssConfig_.openicon;b&&removeClasses$$module$build$src$core$utils$dom(a,b);(b=this.cssConfig_.closedicon)&&addClass$$module$build$src$core$utils$dom(a,b)}}setVisible_(a){this.htmlDiv_.style.display=a?\"block\":\"none\";this.isHidden_=!a;this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let a=\nthis;for(;a.getParent();)if(a=a.getParent(),!a.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(a){}setSelected(a){if(this.rowDiv_){var b=this.cssConfig_.selected;if(a){const c=this.parseColour_(ToolboxCategory$$module$build$src$core$toolbox$category.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||c;b&&addClass$$module$build$src$core$utils$dom(this.rowDiv_,b)}else this.rowDiv_.style.backgroundColor=\"\",b&&removeClass$$module$build$src$core$utils$dom(this.rowDiv_,\nb);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.SELECTED,a)}}setDisabled(a){this.isDisabled_=a;this.getDiv().setAttribute(\"disabled\",`${a}`);a?this.getDiv().setAttribute(\"disabled\",\"true\"):this.getDiv().removeAttribute(\"disabled\")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(a){this.flyoutItems_=[];this.toolboxItemDef_=\"string\"===typeof a?{kind:this.toolboxItemDef_.kind,\ncustom:a,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:\"name\"in this.toolboxItemDef_?this.toolboxItemDef_.name:\"\",contents:convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(a),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,\nhidden:this.toolboxItemDef_.hidden};this.parseContents_(this.toolboxItemDef_)}dispose(){removeNode$$module$build$src$core$utils$dom(this.htmlDiv_)}};ToolboxCategory$$module$build$src$core$toolbox$category.registrationName=\"category\";ToolboxCategory$$module$build$src$core$toolbox$category.nestedPadding=19;ToolboxCategory$$module$build$src$core$toolbox$category.borderWidth=8;ToolboxCategory$$module$build$src$core$toolbox$category.defaultBackgroundColour=\"#57e\";register$$module$build$src$core$css('\\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\\n  background-color: rgba(255, 255, 255, .2);\\n}\\n\\n.blocklyToolboxDiv[layout=\"h\"] .blocklyToolboxCategory {\\n  margin: 1px 5px 1px 0;\\n}\\n\\n.blocklyToolboxDiv[dir=\"RTL\"][layout=\"h\"] .blocklyToolboxCategory {\\n  margin: 1px 0 1px 5px;\\n}\\n\\n.blocklyTreeRow {\\n  height: 22px;\\n  line-height: 22px;\\n  margin-bottom: 3px;\\n  padding-right: 8px;\\n  white-space: nowrap;\\n}\\n\\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeRow {\\n  margin-left: 8px;\\n  padding-right: 0;\\n}\\n\\n.blocklyTreeIcon {\\n  background-image: url(<<<PATH>>>/sprites.png);\\n  height: 16px;\\n  vertical-align: middle;\\n  visibility: hidden;\\n  width: 16px;\\n}\\n\\n.blocklyTreeIconClosed {\\n  background-position: -32px -1px;\\n}\\n\\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeIconClosed {\\n  background-position: 0 -1px;\\n}\\n\\n.blocklyTreeSelected>.blocklyTreeIconClosed {\\n  background-position: -32px -17px;\\n}\\n\\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeSelected>.blocklyTreeIconClosed {\\n  background-position: 0 -17px;\\n}\\n\\n.blocklyTreeIconOpen {\\n  background-position: -16px -1px;\\n}\\n\\n.blocklyTreeSelected>.blocklyTreeIconOpen {\\n  background-position: -16px -17px;\\n}\\n\\n.blocklyTreeLabel {\\n  cursor: default;\\n  font: 16px sans-serif;\\n  padding: 0 3px;\\n  vertical-align: middle;\\n}\\n\\n.blocklyToolboxDelete .blocklyTreeLabel {\\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\\n}\\n\\n.blocklyTreeSelected .blocklyTreeLabel {\\n  color: #fff;\\n}\\n');\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,ToolboxCategory$$module$build$src$core$toolbox$category.registrationName,ToolboxCategory$$module$build$src$core$toolbox$category);var module$build$src$core$toolbox$category={};module$build$src$core$toolbox$category.ToolboxCategory=ToolboxCategory$$module$build$src$core$toolbox$category;var ToolboxSeparator$$module$build$src$core$toolbox$separator=class extends ToolboxItem$$module$build$src$core$toolbox$toolbox_item{constructor(a,b){super(a,b);this.cssConfig_={container:\"blocklyTreeSeparator\"};this.htmlDiv_=null;Object.assign(this.cssConfig_,a.cssconfig||a.cssConfig)}init(){this.createDom_()}createDom_(){const a=document.createElement(\"div\"),b=this.cssConfig_.container;b&&addClass$$module$build$src$core$utils$dom(a,b);return this.htmlDiv_=a}getDiv(){return this.htmlDiv_}dispose(){removeNode$$module$build$src$core$utils$dom(this.htmlDiv_)}};\nToolboxSeparator$$module$build$src$core$toolbox$separator.registrationName=\"sep\";register$$module$build$src$core$css('\\n.blocklyTreeSeparator {\\n  border-bottom: solid #e5e5e5 1px;\\n  height: 0;\\n  margin: 5px 0;\\n}\\n\\n.blocklyToolboxDiv[layout=\"h\"] .blocklyTreeSeparator {\\n  border-right: solid #e5e5e5 1px;\\n  border-bottom: none;\\n  height: auto;\\n  margin: 0 5px 0 5px;\\n  padding: 5px 0;\\n  width: 0;\\n}\\n');\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,ToolboxSeparator$$module$build$src$core$toolbox$separator.registrationName,ToolboxSeparator$$module$build$src$core$toolbox$separator);var module$build$src$core$toolbox$separator={};module$build$src$core$toolbox$separator.ToolboxSeparator=ToolboxSeparator$$module$build$src$core$toolbox$separator;var CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category=class extends ToolboxCategory$$module$build$src$core$toolbox$category{constructor(a,b,c){super(a,b,c);this.subcategoriesDiv_=null;this.expanded_=!1;this.toolboxItems_=[]}makeDefaultCssConfig_(){const a=super.makeDefaultCssConfig_();a.contents=\"blocklyToolboxContents\";return a}parseContents_(a){if(\"custom\"in a)this.flyoutItems_=a.custom;else{const b=a.contents;if(b){this.flyoutItems_=[];a=!0;for(let c=0;c<b.length;c++){const d=\nb[c];!hasItem$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,d.kind)||d.kind.toLowerCase()===ToolboxSeparator$$module$build$src$core$toolbox$separator.registrationName&&a?(this.flyoutItems_.push(d),a=!0):(this.createToolboxItem_(d),a=!1)}}}}createToolboxItem_(a){let b=a.kind;\"CATEGORY\"===b.toUpperCase()&&isCategoryCollapsible$$module$build$src$core$utils$toolbox(a)&&(b=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName);\na=new (getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,b))(a,this.parentToolbox_,this);this.toolboxItems_.push(a)}init(){super.init();this.setExpanded(\"true\"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const a=this.getChildToolboxItems();this.subcategoriesDiv_=this.createSubCategoriesDom_(a);setRole$$module$build$src$core$utils$aria(this.subcategoriesDiv_,Role$$module$build$src$core$utils$aria.GROUP);\nthis.htmlDiv_.appendChild(this.subcategoriesDiv_);this.closeIcon_(this.iconDom_);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.EXPANDED,!1);return this.htmlDiv_}createIconDom_(){const a=document.createElement(\"span\");if(!this.parentToolbox_.isHorizontal()){const b=this.cssConfig_.icon;b&&addClass$$module$build$src$core$utils$dom(a,b);a.style.visibility=\"visible\"}a.style.display=\"inline-block\";return a}createSubCategoriesDom_(a){const b=document.createElement(\"div\");\nb.style.display=\"none\";var c=this.cssConfig_.contents;c&&addClass$$module$build$src$core$utils$dom(b,c);for(c=0;c<a.length;c++){const d=a[c];d.init();const e=d.getDiv();b.appendChild(e);if(d.getClickTarget){let f;null==(f=d.getClickTarget())||f.setAttribute(\"id\",d.getId())}}return b}setExpanded(a){if(this.expanded_!==a){if(this.expanded_=a)this.subcategoriesDiv_.style.display=\"block\",this.openIcon_(this.iconDom_);else{let b;null==(b=this.parentToolbox_.getFlyout())||b.setVisible(!1);this.subcategoriesDiv_.style.display=\n\"none\";this.closeIcon_(this.iconDom_)}setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.EXPANDED,a);this.parentToolbox_.handleToolboxItemResize()}}setVisible_(a){this.htmlDiv_.style.display=a?\"block\":\"none\";const b=this.getChildToolboxItems();for(let c=0;c<b.length;c++)b[c].setVisible_(a);this.isHidden_=!a;this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(a){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};\nCollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName=\"collapsibleCategory\";register$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName,CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category);var module$build$src$core$toolbox$collapsible_category={};\nmodule$build$src$core$toolbox$collapsible_category.CollapsibleToolboxCategory=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category;var module$build$src$core$interfaces$i_selectable_toolbox_item={};module$build$src$core$interfaces$i_selectable_toolbox_item.isSelectableToolboxItem=isSelectableToolboxItem$$module$build$src$core$interfaces$i_selectable_toolbox_item;var Toolbox$$module$build$src$core$toolbox$toolbox=class extends DeleteArea$$module$build$src$core$delete_area{constructor(a){super();this.id=\"toolbox\";this.contentsDiv_=this.HtmlDiv=null;this.isVisible_=!1;this.contents_=[];this.height_=this.width_=0;this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null;this.boundEvents_=[];this.workspace_=a;this.toolboxDef_=a.options.languageTree||{contents:[]};this.horizontalLayout_=a.options.horizontalLayout;this.RTL=a.options.RTL;this.contentMap_=\nObject.create(null);this.toolboxPosition=a.options.toolboxPosition}onShortcut(a){return!1}init(){var a=this.workspace_;const b=a.getParentSvg();this.flyout_=this.createFlyout_();this.HtmlDiv=this.createDom_(this.workspace_);insertAfter$$module$build$src$core$utils$dom(this.flyout_.createDom(\"svg\"),b);this.setVisible(!0);this.flyout_.init(a);this.render(this.toolboxDef_);a=a.getThemeManager();a.subscribe(this.HtmlDiv,\"toolboxBackgroundColour\",\"background-color\");a.subscribe(this.HtmlDiv,\"toolboxForegroundColour\",\n\"color\");this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA,ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET]})}createDom_(a){a=a.getParentSvg();const b=this.createContainer_();this.contentsDiv_=this.createContentsContainer_();this.contentsDiv_.tabIndex=0;setRole$$module$build$src$core$utils$aria(this.contentsDiv_,\nRole$$module$build$src$core$utils$aria.TREE);b.appendChild(this.contentsDiv_);a.parentNode.insertBefore(b,a);this.attachEvents_(b,this.contentsDiv_);return b}createContainer_(){const a=document.createElement(\"div\");a.setAttribute(\"layout\",this.isHorizontal()?\"h\":\"v\");addClass$$module$build$src$core$utils$dom(a,\"blocklyToolboxDiv\");addClass$$module$build$src$core$utils$dom(a,\"blocklyNonSelectable\");a.setAttribute(\"dir\",this.RTL?\"RTL\":\"LTR\");return a}createContentsContainer_(){const a=document.createElement(\"div\");\naddClass$$module$build$src$core$utils$dom(a,\"blocklyToolboxContents\");this.isHorizontal()&&(a.style.flexDirection=\"row\");return a}attachEvents_(a,b){a=conditionalBind$$module$build$src$core$browser_events(a,\"pointerdown\",this,this.onClick_,!1);this.boundEvents_.push(a);b=conditionalBind$$module$build$src$core$browser_events(b,\"keydown\",this,this.onKeyDown_,!1);this.boundEvents_.push(b)}onClick_(a){if(isRightButton$$module$build$src$core$browser_events(a)||a.target===this.HtmlDiv)getMainWorkspace$$module$build$src$core$common().hideChaff(!1);\nelse{var b=a.target.getAttribute(\"id\");b&&(b=this.getToolboxItemById(b),b.isSelectable()&&(this.setSelectedItem(b),b.onClick(a)));getMainWorkspace$$module$build$src$core$common().hideChaff(!0)}clearTouchIdentifier$$module$build$src$core$touch()}onKeyDown_(a){let b=!1;switch(a.key){case \"ArrowDown\":b=this.selectNext_();break;case \"ArrowUp\":b=this.selectPrevious_();break;case \"ArrowLeft\":b=this.selectParent_();break;case \"ArrowRight\":b=this.selectChild_();break;case \"Enter\":case \" \":this.selectedItem_&&\nthis.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),b=!0);break;default:b=!1}!b&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(b=this.selectedItem_.onKeyDown(a));b&&a.preventDefault()}createFlyout_(){const a=this.workspace_,b=new Options$$module$build$src$core$options({parentWorkspace:a,rtl:a.RTL,oneBasedIndex:a.options.oneBasedIndex,horizontalLayout:a.horizontalLayout,renderer:a.options.renderer,rendererOverrides:a.options.rendererOverrides,move:{scrollbars:!0}});b.toolboxPosition=\na.options.toolboxPosition;return new (a.horizontalLayout?getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,a.options,!0):getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,a.options,!0))(b)}render(a){this.toolboxDef_=a;for(let b=0;b<this.contents_.length;b++){const c=this.contents_[b];c&&c.dispose()}this.contents_=[];this.contentMap_=Object.create(null);this.renderContents_(a.contents);\nthis.position();this.handleToolboxItemResize()}renderContents_(a){const b=document.createDocumentFragment();for(let c=0;c<a.length;c++)this.createToolboxItem_(a[c],b);this.contentsDiv_.appendChild(b)}createToolboxItem_(a,b){var c=a.kind;\"CATEGORY\"===c.toUpperCase()&&isCategoryCollapsible$$module$build$src$core$utils$toolbox(a)&&(c=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName);if(c=getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,\nc.toLowerCase()))a=new c(a,this),a.init(),this.addToolboxItem_(a),(c=a.getDiv())&&b.appendChild(c),a.getClickTarget()&&a.getClickTarget().setAttribute(\"id\",a.getId())}addToolboxItem_(a){this.contents_.push(a);this.contentMap_[a.getId()]=a;if(a.isCollapsible()){a=a.getChildToolboxItems();for(let b=0;b<a.length;b++)this.addToolboxItem_(a[b])}}getToolboxItems(){return this.contents_}addStyle(a){a&&this.HtmlDiv&&addClass$$module$build$src$core$utils$dom(this.HtmlDiv,a)}removeStyle(a){a&&this.HtmlDiv&&\nremoveClass$$module$build$src$core$utils$dom(this.HtmlDiv,a)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var a=this.HtmlDiv.getBoundingClientRect();const b=a.top,c=b+a.height,d=a.left;a=d+a.width;return this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?new Rect$$module$build$src$core$utils$rect(-1E7,c,-1E7,1E7):this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.BOTTOM?new Rect$$module$build$src$core$utils$rect(b,1E7,-1E7,1E7):this.toolboxPosition===\nPosition$$module$build$src$core$utils$toolbox.LEFT?new Rect$$module$build$src$core$utils$rect(-1E7,1E7,-1E7,a):new Rect$$module$build$src$core$utils$rect(-1E7,1E7,d,1E7)}wouldDelete(a,b){a instanceof BlockSvg$$module$build$src$core$block_svg?this.updateWouldDelete_(!a.getParent()&&a.isDeletable()):this.updateWouldDelete_(a.isDeletable());return this.wouldDelete_}onDragEnter(a){this.updateCursorDeleteStyle_(!0)}onDragExit(a){this.updateCursorDeleteStyle_(!1)}onDrop(a){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(a){a!==\nthis.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=a,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(a){const b=this.wouldDelete_?\"blocklyToolboxDelete\":\"blocklyToolboxGrab\";a?this.addStyle(b):this.removeStyle(b)}getToolboxItemById(a){return this.contentMap_[a]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const a=\nthis.workspace_.getMetrics(),b=this.HtmlDiv;b&&(this.horizontalLayout_?(b.style.left=\"0\",b.style.height=\"auto\",b.style.width=\"100%\",this.height_=b.offsetHeight,this.width_=a.viewWidth,this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?b.style.top=\"0\":b.style.bottom=\"0\"):(this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.RIGHT?b.style.right=\"0\":b.style.left=\"0\",b.style.height=\"100%\",this.width_=b.offsetWidth,this.height_=a.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const a=\nthis.workspace_,b=this.HtmlDiv.getBoundingClientRect();a.translate(this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.LEFT?a.scrollX+b.width:a.scrollX,this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?a.scrollY+b.height:a.scrollY);svgResize$$module$build$src$core$common(a)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let a=0;a<this.contents_.length;a++){const b=this.contents_[a];b.refreshTheme&&b.refreshTheme()}}refreshSelection(){this.selectedItem_&&\nthis.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(a){this.isVisible_!==a&&(this.HtmlDiv.style.display=a?\"block\":\"none\",this.isVisible_=a,this.workspace_.recordDragTargets())}autoHide(a){!a&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(a){const b=this.selectedItem_;!a&&!b||a&&!isSelectableToolboxItem$$module$build$src$core$interfaces$i_selectable_toolbox_item(a)||(this.shouldDeselectItem_(b,\na)&&null!==b&&this.deselectItem_(b),this.shouldSelectItem_(b,a)&&null!==a&&this.selectItem_(b,a),this.updateFlyout_(b,a),this.fireSelectEvent_(b,a))}shouldDeselectItem_(a,b){return null!==a&&(!a.isCollapsible()||a!==b)}shouldSelectItem_(a,b){return null!==b&&b!==a}deselectItem_(a){this.selectedItem_=null;this.previouslySelectedItem_=a;a.setSelected(!1);setState$$module$build$src$core$utils$aria(this.contentsDiv_,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,\"\")}selectItem_(a,b){this.selectedItem_=\nb;this.previouslySelectedItem_=a;b.setSelected(!0);setState$$module$build$src$core$utils$aria(this.contentsDiv_,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,b.getId())}selectItemByPosition(a){-1<a&&a<this.contents_.length&&(a=this.contents_[a],a.isSelectable()&&this.setSelectedItem(a))}updateFlyout_(a,b){b&&(a!==b||b.isCollapsible())&&b.getContents().length?(this.flyout_.show(b.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(a,b){const c=a&&a.getName();\nlet d=b&&b.getName();a===b&&(d=null);a=new (get$$module$build$src$core$events$utils(TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils))(c,d,this.workspace_.id);fire$$module$build$src$core$events$utils(a)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild_(){if(!this.selectedItem_||\n!this.selectedItem_.isCollapsible())return!1;const a=this.selectedItem_;a.isExpanded()?this.selectNext_():a.toggleExpanded();return!0}selectNext_(){if(!this.selectedItem_)return!1;let a=this.contents_.indexOf(this.selectedItem_)+1;if(-1<a&&a<this.contents_.length){let b=this.contents_[a];for(;b&&!b.isSelectable();)b=this.contents_[++a];if(b&&b.isSelectable())return this.setSelectedItem(b),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let a=this.contents_.indexOf(this.selectedItem_)-\n1;if(-1<a&&a<this.contents_.length){let b=this.contents_[a];for(;b&&!b.isSelectable();)b=this.contents_[--a];if(b&&b.isSelectable())return this.setSelectedItem(b),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent(\"toolbox\");this.flyout_.dispose();for(var a=0;a<this.contents_.length;a++)this.contents_[a].dispose();for(a=0;a<this.boundEvents_.length;a++)unbind$$module$build$src$core$browser_events(this.boundEvents_[a]);this.boundEvents_=[];this.contents_=[];this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),\nremoveNode$$module$build$src$core$utils$dom(this.HtmlDiv))}};register$$module$build$src$core$css('\\n.blocklyToolboxDelete {\\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\\n}\\n\\n.blocklyToolboxGrab {\\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\\n  cursor: grabbing;\\n  cursor: -webkit-grabbing;\\n}\\n\\n/* Category tree in Toolbox. */\\n.blocklyToolboxDiv {\\n  background-color: #ddd;\\n  overflow-x: visible;\\n  overflow-y: auto;\\n  padding: 4px 0 4px 0;\\n  position: absolute;\\n  z-index: 70;  /* so blocks go under toolbox when dragging */\\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\\n}\\n\\n.blocklyToolboxContents {\\n  display: flex;\\n  flex-wrap: wrap;\\n  flex-direction: column;\\n}\\n\\n.blocklyToolboxContents:focus {\\n  outline: none;\\n}\\n');\nregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX,DEFAULT$$module$build$src$core$registry,Toolbox$$module$build$src$core$toolbox$toolbox);var module$build$src$core$toolbox$toolbox={};module$build$src$core$toolbox$toolbox.Toolbox=Toolbox$$module$build$src$core$toolbox$toolbox;var VERSION$$module$build$src$core$blockly=\"10.3.1\",ALIGN_LEFT$$module$build$src$core$blockly=$.Align$$module$build$src$core$inputs$align.LEFT,ALIGN_CENTRE$$module$build$src$core$blockly=$.Align$$module$build$src$core$inputs$align.CENTRE,ALIGN_RIGHT$$module$build$src$core$blockly=$.Align$$module$build$src$core$inputs$align.RIGHT,INPUT_VALUE$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE,OUTPUT_VALUE$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE,\nNEXT_STATEMENT$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT,PREVIOUS_STATEMENT$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT,DUMMY_INPUT$$module$build$src$core$blockly=$.inputTypes$$module$build$src$core$inputs$input_types.DUMMY,TOOLBOX_AT_TOP$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.TOP,TOOLBOX_AT_BOTTOM$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.BOTTOM,\nTOOLBOX_AT_LEFT$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.LEFT,TOOLBOX_AT_RIGHT$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.RIGHT,svgResize$$module$build$src$core$blockly=svgResize$$module$build$src$core$common,getMainWorkspace$$module$build$src$core$blockly=getMainWorkspace$$module$build$src$core$common,getSelected$$module$build$src$core$blockly=getSelected$$module$build$src$core$common,defineBlocksWithJsonArray$$module$build$src$core$blockly=\ndefineBlocksWithJsonArray$$module$build$src$core$common,setParentContainer$$module$build$src$core$blockly=setParentContainer$$module$build$src$core$common,COLLAPSE_CHARS$$module$build$src$core$blockly=COLLAPSE_CHARS$$module$build$src$core$internal_constants,DRAG_STACK$$module$build$src$core$blockly=DRAG_STACK$$module$build$src$core$internal_constants,OPPOSITE_TYPE$$module$build$src$core$blockly=OPPOSITE_TYPE$$module$build$src$core$internal_constants,RENAME_VARIABLE_ID$$module$build$src$core$blockly=\nRENAME_VARIABLE_ID$$module$build$src$core$internal_constants,DELETE_VARIABLE_ID$$module$build$src$core$blockly=DELETE_VARIABLE_ID$$module$build$src$core$internal_constants,COLLAPSED_INPUT_NAME$$module$build$src$core$blockly=COLLAPSED_INPUT_NAME$$module$build$src$core$constants,COLLAPSED_FIELD_NAME$$module$build$src$core$blockly=COLLAPSED_FIELD_NAME$$module$build$src$core$constants,VARIABLE_CATEGORY_NAME$$module$build$src$core$blockly=CATEGORY_NAME$$module$build$src$core$variables,VARIABLE_DYNAMIC_CATEGORY_NAME$$module$build$src$core$blockly=\nCATEGORY_NAME$$module$build$src$core$variables_dynamic,PROCEDURE_CATEGORY_NAME$$module$build$src$core$blockly=CATEGORY_NAME$$module$build$src$core$procedures;Workspace$$module$build$src$core$workspace.prototype.newBlock=function(a,b){return new Block$$module$build$src$core$block(this,a,b)};WorkspaceSvg$$module$build$src$core$workspace_svg.prototype.newBlock=function(a,b){return new BlockSvg$$module$build$src$core$block_svg(this,a,b)};WorkspaceSvg$$module$build$src$core$workspace_svg.newTrashcan=function(a){return new Trashcan$$module$build$src$core$trashcan(a)};\nWorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.prototype.showContextMenu=function(a){if(!this.workspace.options.readOnly){var b=[];this.isDeletable()&&this.isMovable()&&(b.push(commentDuplicateOption$$module$build$src$core$contextmenu(this)),b.push(commentDeleteOption$$module$build$src$core$contextmenu(this)));show$$module$build$src$core$contextmenu(a,b,this.RTL)}};MiniWorkspaceBubble$$module$build$src$core$bubbles$mini_workspace_bubble.prototype.newWorkspaceSvg=function(a){return new WorkspaceSvg$$module$build$src$core$workspace_svg(a)};\n$.Names$$module$build$src$core$names.prototype.populateProcedures=function(a){a=allProcedures$$module$build$src$core$procedures(a);a=a[0].concat(a[1]);for(let b=0;b<a.length;b++)this.getName(a[b][0],$.Names$$module$build$src$core$names.NameType.PROCEDURE)};\nvar DropDownDiv$$module$build$src$core$blockly=module$build$src$core$dropdowndiv,connectionTypes$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type,module$build$src$core$blockly={ALIGN_CENTRE:ALIGN_CENTRE$$module$build$src$core$blockly,ALIGN_LEFT:ALIGN_LEFT$$module$build$src$core$blockly,ALIGN_RIGHT:ALIGN_RIGHT$$module$build$src$core$blockly};module$build$src$core$blockly.ASTNode=ASTNode$$module$build$src$core$keyboard_nav$ast_node;\nmodule$build$src$core$blockly.BasicCursor=BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor;module$build$src$core$blockly.Block=Block$$module$build$src$core$block;module$build$src$core$blockly.BlockDragger=BlockDragger$$module$build$src$core$block_dragger;module$build$src$core$blockly.BlockSvg=BlockSvg$$module$build$src$core$block_svg;module$build$src$core$blockly.Blocks=Blocks$$module$build$src$core$blocks;module$build$src$core$blockly.Bubble=Bubble$$module$build$src$core$bubbles$bubble;\nmodule$build$src$core$blockly.BubbleDragger=BubbleDragger$$module$build$src$core$bubble_dragger;module$build$src$core$blockly.COLLAPSED_FIELD_NAME=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;module$build$src$core$blockly.COLLAPSED_INPUT_NAME=COLLAPSED_INPUT_NAME$$module$build$src$core$constants;module$build$src$core$blockly.COLLAPSE_CHARS=COLLAPSE_CHARS$$module$build$src$core$internal_constants;module$build$src$core$blockly.CodeGenerator=$.CodeGenerator$$module$build$src$core$generator;\nmodule$build$src$core$blockly.CollapsibleToolboxCategory=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category;module$build$src$core$blockly.ComponentManager=ComponentManager$$module$build$src$core$component_manager;module$build$src$core$blockly.Connection=Connection$$module$build$src$core$connection;module$build$src$core$blockly.ConnectionChecker=ConnectionChecker$$module$build$src$core$connection_checker;module$build$src$core$blockly.ConnectionDB=ConnectionDB$$module$build$src$core$connection_db;\nmodule$build$src$core$blockly.ConnectionType=ConnectionType$$module$build$src$core$connection_type;module$build$src$core$blockly.ContextMenu=module$build$src$core$contextmenu;module$build$src$core$blockly.ContextMenuItems=module$build$src$core$contextmenu_items;module$build$src$core$blockly.ContextMenuRegistry=ContextMenuRegistry$$module$build$src$core$contextmenu_registry;module$build$src$core$blockly.Css=module$build$src$core$css;module$build$src$core$blockly.Cursor=Cursor$$module$build$src$core$keyboard_nav$cursor;\nmodule$build$src$core$blockly.DELETE_VARIABLE_ID=DELETE_VARIABLE_ID$$module$build$src$core$internal_constants;module$build$src$core$blockly.DRAG_STACK=DRAG_STACK$$module$build$src$core$internal_constants;module$build$src$core$blockly.DUMMY_INPUT=DUMMY_INPUT$$module$build$src$core$blockly;module$build$src$core$blockly.DeleteArea=DeleteArea$$module$build$src$core$delete_area;module$build$src$core$blockly.DragTarget=DragTarget$$module$build$src$core$drag_target;\nmodule$build$src$core$blockly.DropDownDiv=module$build$src$core$dropdowndiv;module$build$src$core$blockly.Events=module$build$src$core$events$events;module$build$src$core$blockly.Extensions=module$build$src$core$extensions;module$build$src$core$blockly.Field=Field$$module$build$src$core$field;module$build$src$core$blockly.FieldAngle=FieldAngle$$module$build$src$core$field_angle;module$build$src$core$blockly.FieldCheckbox=FieldCheckbox$$module$build$src$core$field_checkbox;\nmodule$build$src$core$blockly.FieldColour=FieldColour$$module$build$src$core$field_colour;module$build$src$core$blockly.FieldDropdown=FieldDropdown$$module$build$src$core$field_dropdown;module$build$src$core$blockly.FieldImage=FieldImage$$module$build$src$core$field_image;module$build$src$core$blockly.FieldLabel=FieldLabel$$module$build$src$core$field_label;module$build$src$core$blockly.FieldLabelSerializable=FieldLabelSerializable$$module$build$src$core$field_label_serializable;\nmodule$build$src$core$blockly.FieldMultilineInput=FieldMultilineInput$$module$build$src$core$field_multilineinput;module$build$src$core$blockly.FieldNumber=FieldNumber$$module$build$src$core$field_number;module$build$src$core$blockly.FieldTextInput=FieldTextInput$$module$build$src$core$field_textinput;module$build$src$core$blockly.FieldVariable=FieldVariable$$module$build$src$core$field_variable;module$build$src$core$blockly.Flyout=Flyout$$module$build$src$core$flyout_base;\nmodule$build$src$core$blockly.FlyoutButton=FlyoutButton$$module$build$src$core$flyout_button;module$build$src$core$blockly.FlyoutMetricsManager=FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager;module$build$src$core$blockly.Generator=$.CodeGenerator$$module$build$src$core$generator;module$build$src$core$blockly.Gesture=Gesture$$module$build$src$core$gesture;module$build$src$core$blockly.Grid=Grid$$module$build$src$core$grid;module$build$src$core$blockly.HorizontalFlyout=HorizontalFlyout$$module$build$src$core$flyout_horizontal;\nmodule$build$src$core$blockly.INPUT_VALUE=INPUT_VALUE$$module$build$src$core$blockly;module$build$src$core$blockly.Input=Input$$module$build$src$core$inputs$input;module$build$src$core$blockly.InsertionMarkerManager=InsertionMarkerManager$$module$build$src$core$insertion_marker_manager;module$build$src$core$blockly.Marker=Marker$$module$build$src$core$keyboard_nav$marker;module$build$src$core$blockly.MarkerManager=MarkerManager$$module$build$src$core$marker_manager;\nmodule$build$src$core$blockly.Menu=Menu$$module$build$src$core$menu;module$build$src$core$blockly.MenuItem=MenuItem$$module$build$src$core$menuitem;module$build$src$core$blockly.MetricsManager=MetricsManager$$module$build$src$core$metrics_manager;module$build$src$core$blockly.Msg=$.Msg$$module$build$src$core$msg;module$build$src$core$blockly.NEXT_STATEMENT=NEXT_STATEMENT$$module$build$src$core$blockly;module$build$src$core$blockly.Names=$.Names$$module$build$src$core$names;\nmodule$build$src$core$blockly.OPPOSITE_TYPE=OPPOSITE_TYPE$$module$build$src$core$internal_constants;module$build$src$core$blockly.OUTPUT_VALUE=OUTPUT_VALUE$$module$build$src$core$blockly;module$build$src$core$blockly.Options=Options$$module$build$src$core$options;module$build$src$core$blockly.PREVIOUS_STATEMENT=PREVIOUS_STATEMENT$$module$build$src$core$blockly;module$build$src$core$blockly.PROCEDURE_CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$procedures;\nmodule$build$src$core$blockly.Procedures=module$build$src$core$procedures;module$build$src$core$blockly.RENAME_VARIABLE_ID=RENAME_VARIABLE_ID$$module$build$src$core$internal_constants;module$build$src$core$blockly.RenderedConnection=RenderedConnection$$module$build$src$core$rendered_connection;module$build$src$core$blockly.Scrollbar=Scrollbar$$module$build$src$core$scrollbar;module$build$src$core$blockly.ScrollbarPair=ScrollbarPair$$module$build$src$core$scrollbar_pair;\nmodule$build$src$core$blockly.ShortcutItems=module$build$src$core$shortcut_items;module$build$src$core$blockly.ShortcutRegistry=ShortcutRegistry$$module$build$src$core$shortcut_registry;module$build$src$core$blockly.TOOLBOX_AT_BOTTOM=TOOLBOX_AT_BOTTOM$$module$build$src$core$blockly;module$build$src$core$blockly.TOOLBOX_AT_LEFT=TOOLBOX_AT_LEFT$$module$build$src$core$blockly;module$build$src$core$blockly.TOOLBOX_AT_RIGHT=TOOLBOX_AT_RIGHT$$module$build$src$core$blockly;\nmodule$build$src$core$blockly.TOOLBOX_AT_TOP=TOOLBOX_AT_TOP$$module$build$src$core$blockly;module$build$src$core$blockly.TabNavigateCursor=TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor;module$build$src$core$blockly.Theme=Theme$$module$build$src$core$theme;module$build$src$core$blockly.ThemeManager=ThemeManager$$module$build$src$core$theme_manager;module$build$src$core$blockly.Themes=module$build$src$core$theme$themes;module$build$src$core$blockly.Toolbox=Toolbox$$module$build$src$core$toolbox$toolbox;\nmodule$build$src$core$blockly.ToolboxCategory=ToolboxCategory$$module$build$src$core$toolbox$category;module$build$src$core$blockly.ToolboxItem=ToolboxItem$$module$build$src$core$toolbox$toolbox_item;module$build$src$core$blockly.ToolboxSeparator=ToolboxSeparator$$module$build$src$core$toolbox$separator;module$build$src$core$blockly.Tooltip=module$build$src$core$tooltip;module$build$src$core$blockly.Touch=module$build$src$core$touch;module$build$src$core$blockly.Trashcan=Trashcan$$module$build$src$core$trashcan;\nmodule$build$src$core$blockly.UnattachedFieldError=UnattachedFieldError$$module$build$src$core$field;module$build$src$core$blockly.VARIABLE_CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$variables;module$build$src$core$blockly.VARIABLE_DYNAMIC_CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$variables_dynamic;module$build$src$core$blockly.VERSION=VERSION$$module$build$src$core$blockly;module$build$src$core$blockly.VariableMap=VariableMap$$module$build$src$core$variable_map;\nmodule$build$src$core$blockly.VariableModel=VariableModel$$module$build$src$core$variable_model;module$build$src$core$blockly.Variables=module$build$src$core$variables;module$build$src$core$blockly.VariablesDynamic=module$build$src$core$variables_dynamic;module$build$src$core$blockly.VerticalFlyout=VerticalFlyout$$module$build$src$core$flyout_vertical;module$build$src$core$blockly.WidgetDiv=module$build$src$core$widgetdiv;module$build$src$core$blockly.Workspace=Workspace$$module$build$src$core$workspace;\nmodule$build$src$core$blockly.WorkspaceAudio=WorkspaceAudio$$module$build$src$core$workspace_audio;module$build$src$core$blockly.WorkspaceComment=WorkspaceComment$$module$build$src$core$workspace_comment;module$build$src$core$blockly.WorkspaceCommentSvg=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg;module$build$src$core$blockly.WorkspaceDragger=WorkspaceDragger$$module$build$src$core$workspace_dragger;module$build$src$core$blockly.WorkspaceSvg=WorkspaceSvg$$module$build$src$core$workspace_svg;\nmodule$build$src$core$blockly.Xml=module$build$src$core$xml;module$build$src$core$blockly.ZoomControls=ZoomControls$$module$build$src$core$zoom_controls;module$build$src$core$blockly.blockAnimations=module$build$src$core$block_animations;module$build$src$core$blockly.blockRendering=module$build$src$core$renderers$common$block_rendering;module$build$src$core$blockly.browserEvents=module$build$src$core$browser_events;module$build$src$core$blockly.bubbles=module$build$src$core$bubbles;\nmodule$build$src$core$blockly.bumpObjects=module$build$src$core$bump_objects;module$build$src$core$blockly.clipboard=module$build$src$core$clipboard;module$build$src$core$blockly.common=module$build$src$core$common;module$build$src$core$blockly.config=$.config$$module$build$src$core$config;module$build$src$core$blockly.connectionTypes=connectionTypes$$module$build$src$core$blockly;module$build$src$core$blockly.constants=module$build$src$core$constants;\nmodule$build$src$core$blockly.defineBlocksWithJsonArray=defineBlocksWithJsonArray$$module$build$src$core$common;module$build$src$core$blockly.dialog=module$build$src$core$dialog;module$build$src$core$blockly.fieldRegistry=module$build$src$core$field_registry;module$build$src$core$blockly.geras=module$build$src$core$renderers$geras$geras;module$build$src$core$blockly.getMainWorkspace=getMainWorkspace$$module$build$src$core$common;module$build$src$core$blockly.getSelected=getSelected$$module$build$src$core$common;\nmodule$build$src$core$blockly.hasBubble=hasBubble$$module$build$src$core$interfaces$i_has_bubble;module$build$src$core$blockly.hideChaff=hideChaff$$module$build$src$core$blockly;module$build$src$core$blockly.icons=module$build$src$core$icons;module$build$src$core$blockly.inject=inject$$module$build$src$core$inject;module$build$src$core$blockly.inputTypes=$.inputTypes$$module$build$src$core$inputs$input_types;module$build$src$core$blockly.inputs=module$build$src$core$inputs;\nmodule$build$src$core$blockly.isCopyable=isCopyable$$module$build$src$core$interfaces$i_copyable;module$build$src$core$blockly.isIcon=isIcon$$module$build$src$core$interfaces$i_icon;module$build$src$core$blockly.isObservable=isObservable$$module$build$src$core$interfaces$i_observable;module$build$src$core$blockly.isPaster=isPaster$$module$build$src$core$interfaces$i_paster;module$build$src$core$blockly.isSerializable=isSerializable$$module$build$src$core$interfaces$i_serializable;\nmodule$build$src$core$blockly.isVariableBackedParameterModel=isVariableBackedParameterModel$$module$build$src$core$interfaces$i_variable_backed_parameter_model;module$build$src$core$blockly.minimalist=module$build$src$core$renderers$minimalist$minimalist;module$build$src$core$blockly.procedures=module$build$src$core$procedures;module$build$src$core$blockly.registry=module$build$src$core$registry;module$build$src$core$blockly.renderManagement=module$build$src$core$render_management;\nmodule$build$src$core$blockly.serialization=module$build$src$core$serialization;module$build$src$core$blockly.setLocale=setLocale$$module$build$src$core$msg;module$build$src$core$blockly.setParentContainer=setParentContainer$$module$build$src$core$common;module$build$src$core$blockly.svgResize=svgResize$$module$build$src$core$common;module$build$src$core$blockly.thrasos=module$build$src$core$renderers$thrasos$thrasos;module$build$src$core$blockly.uiPosition=module$build$src$core$positionable_helpers;\nmodule$build$src$core$blockly.utils=module$build$src$core$utils;module$build$src$core$blockly.zelos=module$build$src$core$renderers$zelos$zelos;Object.defineProperties(module$build$src$core$blockly,{HSV_SATURATION:{get:function(){warn$$module$build$src$core$utils$deprecation(\"Blockly.HSV_SATURATION\",\"version 10\",\"version 11\",\"Blockly.utils.colour.getHsvSaturation()\");return getHsvSaturation$$module$build$src$core$utils$colour()},set:function(a){warn$$module$build$src$core$utils$deprecation(\"Blockly.HSV_SATURATION\",\"version 10\",\"version 11\",\"Blockly.utils.colour.setHsvSaturation()\");setHsvSaturation$$module$build$src$core$utils$colour(a)}},\nHSV_VALUE:{get:function(){warn$$module$build$src$core$utils$deprecation(\"Blockly.HSV_VALUE\",\"version 10\",\"version 11\",\"Blockly.utils.colour.getHsvValue()\");return getHsvValue$$module$build$src$core$utils$colour()},set:function(a){warn$$module$build$src$core$utils$deprecation(\"Blockly.HSV_VALUE\",\"version 10\",\"version 11\",\"Blockly.utils.colour.setHsvValue()\");setHsvValue$$module$build$src$core$utils$colour(a)}}});\"Blockly\"in globalThis||(globalThis.Blockly={Msg:module$build$src$core$msg});\nvar module$build$src$core$main={};var module$build$src$core$blockly_options={};var module$build$src$core$utils$metrics={};var module$build$src$core$renderers$common$i_path_object={};var module$build$src$core$interfaces$i_toolbox_item={};var module$build$src$core$interfaces$i_toolbox={};var module$build$src$core$interfaces$i_styleable={};var module$build$src$core$interfaces$i_serializer={};var module$build$src$core$interfaces$i_selectable={};var module$build$src$core$interfaces$i_rendered_element={};module$build$src$core$interfaces$i_rendered_element.isRenderedElement=isRenderedElement$$module$build$src$core$interfaces$i_rendered_element;var module$build$src$core$interfaces$i_registrable={};var module$build$src$core$interfaces$i_procedure_model={};var module$build$src$core$interfaces$i_procedure_map={};var module$build$src$core$interfaces$i_positionable={};var module$build$src$core$interfaces$i_parameter_model={};var module$build$src$core$interfaces$i_movable={};var module$build$src$core$interfaces$i_metrics_manager={};var module$build$src$core$interfaces$i_keyboard_accessible={};var module$build$src$core$interfaces$i_flyout={};var module$build$src$core$interfaces$i_draggable={};var module$build$src$core$interfaces$i_drag_target={};var module$build$src$core$interfaces$i_delete_area={};var module$build$src$core$interfaces$i_deletable={};var module$build$src$core$interfaces$i_contextmenu={};var module$build$src$core$interfaces$i_connection_checker={};var module$build$src$core$interfaces$i_component={};var module$build$src$core$interfaces$i_collapsible_toolbox_item={};var module$build$src$core$interfaces$i_bubble={};var module$build$src$core$interfaces$i_bounded_element={};var module$build$src$core$interfaces$i_block_dragger={};var module$build$src$core$interfaces$i_autohideable={};var module$build$src$core$interfaces$i_ast_node_location_with_block={};var module$build$src$core$interfaces$i_ast_node_location_svg={};var module$build$src$core$interfaces$i_ast_node_location={};\nmodule$build$src$core$blockly.__namespace__=$;\nreturn module$build$src$core$blockly;\n}));\n\n\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/blockly_compressed.js?");

/***/ }),

/***/ "./node_modules/blockly/blocks.js":
/*!****************************************!*\
  !*** ./node_modules/blockly/blocks.js ***!
  \****************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./blocks_compressed */ \"./node_modules/blockly/blocks_compressed.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(BlocklyBlocks) {\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly blocks module; just a wrapper for blocks_compressed.js.\n */\n\nreturn BlocklyBlocks;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/blocks.js?");

/***/ }),

/***/ "./node_modules/blockly/blocks_compressed.js":
/*!***************************************************!*\
  !*** ./node_modules/blockly/blocks_compressed.js ***!
  \***************************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// Do not edit this file; automatically generated.\n\n/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./blockly_compressed.js */ \"./node_modules/blockly/blockly_compressed.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(__parent__) {\nvar $=__parent__.__namespace__;\nvar blocks$$module$build$src$blocks$variables_dynamic=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"variables_get_dynamic\",message0:\"%1\",args0:[{type:\"field_variable\",name:\"VAR\",variable:\"%{BKY_VARIABLES_DEFAULT_NAME}\"}],output:null,style:\"variable_dynamic_blocks\",helpUrl:\"%{BKY_VARIABLES_GET_HELPURL}\",tooltip:\"%{BKY_VARIABLES_GET_TOOLTIP}\",extensions:[\"contextMenu_variableDynamicSetterGetter\"]},{type:\"variables_set_dynamic\",message0:\"%{BKY_VARIABLES_SET}\",args0:[{type:\"field_variable\",\nname:\"VAR\",variable:\"%{BKY_VARIABLES_DEFAULT_NAME}\"},{type:\"input_value\",name:\"VALUE\"}],previousStatement:null,nextStatement:null,style:\"variable_dynamic_blocks\",tooltip:\"%{BKY_VARIABLES_SET_TOOLTIP}\",helpUrl:\"%{BKY_VARIABLES_SET_HELPURL}\",extensions:[\"contextMenu_variableDynamicSetterGetter\"]}]),CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN$$module$build$src$blocks$variables_dynamic={customContextMenu:function(a){if(!this.isInFlyout){if(\"variables_get_dynamic\"===this.type){var b=\"variables_set_dynamic\";\nvar c=$.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET}else b=\"variables_get_dynamic\",c=$.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var d=this.getField(\"VAR\");b={type:b,fields:{VAR:d.saveState(!0)}};a.push({enabled:0<this.workspace.remainingCapacity(),text:c.replace(\"%1\",d.getText()),callback:$.callbackFactory$$module$build$src$core$contextmenu(this,b)})}else if(\"variables_get_dynamic\"===this.type||\"variables_get_reporter_dynamic\"===this.type)c={text:$.Msg$$module$build$src$core$msg.RENAME_VARIABLE,\nenabled:!0,callback:renameOptionCallbackFactory$$module$build$src$blocks$variables_dynamic(this)},d=this.getField(\"VAR\").getText(),d={text:$.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace(\"%1\",d),enabled:!0,callback:deleteOptionCallbackFactory$$module$build$src$blocks$variables_dynamic(this)},a.unshift(c),a.unshift(d)},onchange:function(a){a=this.getFieldValue(\"VAR\");a=$.getVariable$$module$build$src$core$variables(this.workspace,a);\"variables_get_dynamic\"===this.type?this.outputConnection.setCheck(a.type):\nthis.getInput(\"VALUE\").connection.setCheck(a.type)}},renameOptionCallbackFactory$$module$build$src$blocks$variables_dynamic=function(a){return function(){const b=a.workspace,c=a.getField(\"VAR\").getVariable();$.renameVariable$$module$build$src$core$variables(b,c)}},deleteOptionCallbackFactory$$module$build$src$blocks$variables_dynamic=function(a){return function(){const b=a.workspace,c=a.getField(\"VAR\").getVariable();b.deleteVariableById(c.getId());b.refreshToolboxSelection()}};\n$.registerMixin$$module$build$src$core$extensions(\"contextMenu_variableDynamicSetterGetter\",CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN$$module$build$src$blocks$variables_dynamic);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$variables_dynamic);var module$build$src$blocks$variables_dynamic={blocks:blocks$$module$build$src$blocks$variables_dynamic};var blocks$$module$build$src$blocks$variables=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"variables_get\",message0:\"%1\",args0:[{type:\"field_variable\",name:\"VAR\",variable:\"%{BKY_VARIABLES_DEFAULT_NAME}\"}],output:null,style:\"variable_blocks\",helpUrl:\"%{BKY_VARIABLES_GET_HELPURL}\",tooltip:\"%{BKY_VARIABLES_GET_TOOLTIP}\",extensions:[\"contextMenu_variableSetterGetter\"]},{type:\"variables_set\",message0:\"%{BKY_VARIABLES_SET}\",args0:[{type:\"field_variable\",name:\"VAR\",variable:\"%{BKY_VARIABLES_DEFAULT_NAME}\"},\n{type:\"input_value\",name:\"VALUE\"}],previousStatement:null,nextStatement:null,style:\"variable_blocks\",tooltip:\"%{BKY_VARIABLES_SET_TOOLTIP}\",helpUrl:\"%{BKY_VARIABLES_SET_HELPURL}\",extensions:[\"contextMenu_variableSetterGetter\"]}]),CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN$$module$build$src$blocks$variables={customContextMenu:function(a){if(!this.isInFlyout){if(\"variables_get\"===this.type){var b=\"variables_set\";var c=$.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET}else b=\"variables_get\",\nc=$.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var d=this.getField(\"VAR\");b={type:b,fields:{VAR:d.saveState(!0)}};a.push({enabled:0<this.workspace.remainingCapacity(),text:c.replace(\"%1\",d.getText()),callback:$.callbackFactory$$module$build$src$core$contextmenu(this,b)})}else if(\"variables_get\"===this.type||\"variables_get_reporter\"===this.type)c={text:$.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:renameOptionCallbackFactory$$module$build$src$blocks$variables(this)},\nd=this.getField(\"VAR\").getText(),d={text:$.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace(\"%1\",d),enabled:!0,callback:deleteOptionCallbackFactory$$module$build$src$blocks$variables(this)},a.unshift(c),a.unshift(d)}},renameOptionCallbackFactory$$module$build$src$blocks$variables=function(a){return function(){const b=a.workspace,c=a.getField(\"VAR\").getVariable();$.renameVariable$$module$build$src$core$variables(b,c)}},deleteOptionCallbackFactory$$module$build$src$blocks$variables=function(a){return function(){const b=\na.workspace,c=a.getField(\"VAR\").getVariable();b.deleteVariableById(c.getId());b.refreshToolboxSelection()}};$.registerMixin$$module$build$src$core$extensions(\"contextMenu_variableSetterGetter\",CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN$$module$build$src$blocks$variables);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$variables);var module$build$src$blocks$variables={blocks:blocks$$module$build$src$blocks$variables};var blocks$$module$build$src$blocks$text=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"text\",message0:\"%1\",args0:[{type:\"field_input\",name:\"TEXT\",text:\"\"}],output:\"String\",style:\"text_blocks\",helpUrl:\"%{BKY_TEXT_TEXT_HELPURL}\",tooltip:\"%{BKY_TEXT_TEXT_TOOLTIP}\",extensions:[\"text_quotes\",\"parent_tooltip_when_inline\"]},{type:\"text_multiline\",message0:\"%1 %2\",args0:[{type:\"field_image\",src:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=\",\nwidth:12,height:17,alt:\"\\u00b6\"},{type:\"field_multilinetext\",name:\"TEXT\",text:\"\"}],output:\"String\",style:\"text_blocks\",helpUrl:\"%{BKY_TEXT_TEXT_HELPURL}\",tooltip:\"%{BKY_TEXT_TEXT_TOOLTIP}\",extensions:[\"parent_tooltip_when_inline\"]},{type:\"text_join\",message0:\"\",output:\"String\",style:\"text_blocks\",helpUrl:\"%{BKY_TEXT_JOIN_HELPURL}\",tooltip:\"%{BKY_TEXT_JOIN_TOOLTIP}\",mutator:\"text_join_mutator\"},{type:\"text_create_join_container\",message0:\"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2\",args0:[{type:\"input_dummy\"},\n{type:\"input_statement\",name:\"STACK\"}],style:\"text_blocks\",tooltip:\"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}\",enableContextMenu:!1},{type:\"text_create_join_item\",message0:\"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}\",previousStatement:null,nextStatement:null,style:\"text_blocks\",tooltip:\"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}\",enableContextMenu:!1},{type:\"text_append\",message0:\"%{BKY_TEXT_APPEND_TITLE}\",args0:[{type:\"field_variable\",name:\"VAR\",variable:\"%{BKY_TEXT_APPEND_VARIABLE}\"},{type:\"input_value\",name:\"TEXT\"}],\npreviousStatement:null,nextStatement:null,style:\"text_blocks\",extensions:[\"text_append_tooltip\"]},{type:\"text_length\",message0:\"%{BKY_TEXT_LENGTH_TITLE}\",args0:[{type:\"input_value\",name:\"VALUE\",check:[\"String\",\"Array\"]}],output:\"Number\",style:\"text_blocks\",tooltip:\"%{BKY_TEXT_LENGTH_TOOLTIP}\",helpUrl:\"%{BKY_TEXT_LENGTH_HELPURL}\"},{type:\"text_isEmpty\",message0:\"%{BKY_TEXT_ISEMPTY_TITLE}\",args0:[{type:\"input_value\",name:\"VALUE\",check:[\"String\",\"Array\"]}],output:\"Boolean\",style:\"text_blocks\",tooltip:\"%{BKY_TEXT_ISEMPTY_TOOLTIP}\",\nhelpUrl:\"%{BKY_TEXT_ISEMPTY_HELPURL}\"},{type:\"text_indexOf\",message0:\"%{BKY_TEXT_INDEXOF_TITLE}\",args0:[{type:\"input_value\",name:\"VALUE\",check:\"String\"},{type:\"field_dropdown\",name:\"END\",options:[[\"%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}\",\"FIRST\"],[\"%{BKY_TEXT_INDEXOF_OPERATOR_LAST}\",\"LAST\"]]},{type:\"input_value\",name:\"FIND\",check:\"String\"}],output:\"Number\",style:\"text_blocks\",helpUrl:\"%{BKY_TEXT_INDEXOF_HELPURL}\",inputsInline:!0,extensions:[\"text_indexOf_tooltip\"]},{type:\"text_charAt\",message0:\"%{BKY_TEXT_CHARAT_TITLE}\",\nargs0:[{type:\"input_value\",name:\"VALUE\",check:\"String\"},{type:\"field_dropdown\",name:\"WHERE\",options:[[\"%{BKY_TEXT_CHARAT_FROM_START}\",\"FROM_START\"],[\"%{BKY_TEXT_CHARAT_FROM_END}\",\"FROM_END\"],[\"%{BKY_TEXT_CHARAT_FIRST}\",\"FIRST\"],[\"%{BKY_TEXT_CHARAT_LAST}\",\"LAST\"],[\"%{BKY_TEXT_CHARAT_RANDOM}\",\"RANDOM\"]]}],output:\"String\",style:\"text_blocks\",helpUrl:\"%{BKY_TEXT_CHARAT_HELPURL}\",inputsInline:!0,mutator:\"text_charAt_mutator\"}]),GET_SUBSTRING_BLOCK$$module$build$src$blocks$text={init:function(){this.WHERE_OPTIONS_1=\n[[$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,\"FROM_START\"],[$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,\"FROM_END\"],[$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,\"FIRST\"]];this.WHERE_OPTIONS_2=[[$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,\"FROM_START\"],[$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,\"FROM_END\"],[$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,\"LAST\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL);\nthis.setStyle(\"text_blocks\");this.appendValueInput(\"STRING\").setCheck(\"String\").appendField($.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);this.appendDummyInput(\"AT1\");this.appendDummyInput(\"AT2\");$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput(\"TAIL\").appendField($.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL);this.setInputsInline(!0);this.setOutput(!0,\"String\");this.updateAt_(1,!0);this.updateAt_(2,!0);this.setTooltip($.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},\nmutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");var b=this.getInput(\"AT1\")instanceof $.ValueInput$$module$build$src$core$inputs$value_input;a.setAttribute(\"at1\",`${b}`);b=this.getInput(\"AT2\")instanceof $.ValueInput$$module$build$src$core$inputs$value_input;a.setAttribute(\"at2\",`${b}`);return a},domToMutation:function(a){const b=\"true\"===a.getAttribute(\"at1\");a=\"true\"===a.getAttribute(\"at2\");this.updateAt_(1,b);this.updateAt_(2,a)},updateAt_:function(a,\nb){this.removeInput(\"AT\"+a);this.removeInput(\"ORDINAL\"+a,!0);b?(this.appendValueInput(\"AT\"+a).setCheck(\"Number\"),$.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput(\"ORDINAL\"+a).appendField($.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput(\"AT\"+a);2===a&&$.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput(\"TAIL\",!0),this.appendDummyInput(\"TAIL\").appendField($.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const c=\n$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:this[\"WHERE_OPTIONS_\"+a]});c.setValidator(function(d){const e=\"FROM_START\"===d||\"FROM_END\"===d;if(e!==b){const f=this.getSourceBlock();f.updateAt_(a,e);f.setFieldValue(d,\"WHERE\"+a);return null}});this.getInput(\"AT\"+a).appendField(c,\"WHERE\"+a);1===a&&(this.moveInputBefore(\"AT1\",\"AT2\"),this.getInput(\"ORDINAL1\")&&this.moveInputBefore(\"ORDINAL1\",\"AT2\"))}};blocks$$module$build$src$blocks$text.text_getSubstring=GET_SUBSTRING_BLOCK$$module$build$src$blocks$text;\nblocks$$module$build$src$blocks$text.text_changeCase={init:function(){const a=[[$.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,\"UPPERCASE\"],[$.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,\"LOWERCASE\"],[$.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,\"TITLECASE\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL);this.setStyle(\"text_blocks\");this.appendValueInput(\"TEXT\").setCheck(\"String\").appendField($.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",\noptions:a}),\"CASE\");this.setOutput(!0,\"String\");this.setTooltip($.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}};\nblocks$$module$build$src$blocks$text.text_trim={init:function(){const a=[[$.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,\"BOTH\"],[$.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,\"LEFT\"],[$.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,\"RIGHT\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL);this.setStyle(\"text_blocks\");this.appendValueInput(\"TEXT\").setCheck(\"String\").appendField($.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:a}),\n\"MODE\");this.setOutput(!0,\"String\");this.setTooltip($.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}};blocks$$module$build$src$blocks$text.text_print={init:function(){this.jsonInit({message0:$.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:\"input_value\",name:\"TEXT\"}],previousStatement:null,nextStatement:null,style:\"text_blocks\",tooltip:$.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:$.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};\nvar PROMPT_COMMON$$module$build$src$blocks$text={updateType_:function(a){this.outputConnection.setCheck(\"NUMBER\"===a?\"Number\":\"String\")},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"type\",this.getFieldValue(\"TYPE\"));return a},domToMutation:function(a){this.updateType_(a.getAttribute(\"type\"))}};\nblocks$$module$build$src$blocks$text.text_prompt_ext=Object.assign({},PROMPT_COMMON$$module$build$src$blocks$text,{init:function(){var a=[[$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,\"TEXT\"],[$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,\"NUMBER\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL);this.setStyle(\"text_blocks\");a=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:a});a.setValidator(b=>{this.updateType_(b)});this.appendValueInput(\"TEXT\").appendField(a,\n\"TYPE\");this.setOutput(!0,\"String\");this.setTooltip(()=>\"TEXT\"===this.getFieldValue(\"TYPE\")?$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});\nvar TEXT_PROMPT_BLOCK$$module$build$src$blocks$text=Object.assign({},PROMPT_COMMON$$module$build$src$blocks$text,{init:function(){this.mixin(QUOTE_IMAGE_MIXIN$$module$build$src$blocks$text);var a=[[$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,\"TEXT\"],[$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,\"NUMBER\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL);this.setStyle(\"text_blocks\");a=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",\noptions:a});a.setValidator(b=>{this.updateType_(b)});this.appendDummyInput().appendField(a,\"TYPE\").appendField(this.newQuote_(!0)).appendField($.fromJson$$module$build$src$core$field_registry({type:\"field_input\",text:\"\"}),\"TEXT\").appendField(this.newQuote_(!1));this.setOutput(!0,\"String\");this.setTooltip(()=>\"TEXT\"===this.getFieldValue(\"TYPE\")?$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:$.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});\nblocks$$module$build$src$blocks$text.text_prompt=TEXT_PROMPT_BLOCK$$module$build$src$blocks$text;blocks$$module$build$src$blocks$text.text_count={init:function(){this.jsonInit({message0:$.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:\"input_value\",name:\"SUB\",check:\"String\"},{type:\"input_value\",name:\"TEXT\",check:\"String\"}],output:\"Number\",inputsInline:!0,style:\"text_blocks\",tooltip:$.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:$.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}};\nblocks$$module$build$src$blocks$text.text_replace={init:function(){this.jsonInit({message0:$.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:\"input_value\",name:\"FROM\",check:\"String\"},{type:\"input_value\",name:\"TO\",check:\"String\"},{type:\"input_value\",name:\"TEXT\",check:\"String\"}],output:\"String\",inputsInline:!0,style:\"text_blocks\",tooltip:$.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:$.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}};\nblocks$$module$build$src$blocks$text.text_reverse={init:function(){this.jsonInit({message0:$.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:\"input_value\",name:\"TEXT\",check:\"String\"}],output:\"String\",inputsInline:!0,style:\"text_blocks\",tooltip:$.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:$.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};\nvar QUOTE_IMAGE_MIXIN$$module$build$src$blocks$text={QUOTE_IMAGE_LEFT_DATAURI:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC\",QUOTE_IMAGE_RIGHT_DATAURI:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==\",\nQUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(a){for(let b=0,c;c=this.inputList[b];b++)for(let d=0,e;e=c.fieldRow[d];d++)if(a===e.name){c.insertFieldAt(d,this.newQuote_(!0));c.insertFieldAt(d+2,this.newQuote_(!1));return}console.warn('field named \"'+a+'\" not found in '+this.toDevString())},newQuote_:function(a){a=this.RTL?!a:a;return $.fromJson$$module$build$src$core$field_registry({type:\"field_image\",src:a?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,\nheight:this.QUOTE_IMAGE_HEIGHT,alt:a?\"\\u201c\":\"\\u201d\"})}},QUOTES_EXTENSION$$module$build$src$blocks$text=function(){this.mixin(QUOTE_IMAGE_MIXIN$$module$build$src$blocks$text);this.quoteField_(\"TEXT\")},JOIN_MUTATOR_MIXIN$$module$build$src$blocks$text={itemCount_:0,mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"items\",`${this.itemCount_}`);return a},domToMutation:function(a){this.itemCount_=parseInt(a.getAttribute(\"items\"),10);this.updateShape_()},\nsaveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(a){this.itemCount_=a.itemCount;this.updateShape_()},decompose:function(a){const b=a.newBlock(\"text_create_join_container\");b.initSvg();let c=b.getInput(\"STACK\").connection;for(let d=0;d<this.itemCount_;d++){const e=a.newBlock(\"text_create_join_item\");e.initSvg();c.connect(e.previousConnection);c=e.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock(\"STACK\");for(a=[];b;)b.isInsertionMarker()||\na.push(b.valueConnection_),b=b.getNextBlock();for(b=0;b<this.itemCount_;b++){const c=this.getInput(\"ADD\"+b).connection.targetConnection;c&&-1===a.indexOf(c)&&c.disconnect()}this.itemCount_=a.length;this.updateShape_();for(b=0;b<this.itemCount_;b++){let c;null==(c=a[b])||c.reconnect(this,\"ADD\"+b)}},saveConnections:function(a){a=a.getInputTargetBlock(\"STACK\");let b=0;for(;a;){if(a.isInsertionMarker()){a=a.getNextBlock();continue}const c=this.getInput(\"ADD\"+b);a.valueConnection_=c&&c.connection.targetConnection;\na=a.getNextBlock();b++}},updateShape_:function(){this.itemCount_&&this.getInput(\"EMPTY\")?this.removeInput(\"EMPTY\"):this.itemCount_||this.getInput(\"EMPTY\")||this.appendDummyInput(\"EMPTY\").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var a=0;a<this.itemCount_;a++)if(!this.getInput(\"ADD\"+a)){const b=this.appendValueInput(\"ADD\"+a).setAlign($.Align$$module$build$src$core$inputs$align.RIGHT);0===a&&b.appendField($.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(a=this.itemCount_;this.getInput(\"ADD\"+\na);a++)this.removeInput(\"ADD\"+a)}},JOIN_EXTENSION$$module$build$src$blocks$text=function(){this.mixin(QUOTE_IMAGE_MIXIN$$module$build$src$blocks$text);this.itemCount_=2;this.updateShape_();this.setMutator(new $.MutatorIcon$$module$build$src$core$icons$mutator_icon([\"text_create_join_item\"],this))};$.register$$module$build$src$core$extensions(\"text_append_tooltip\",$.buildTooltipWithFieldText$$module$build$src$core$extensions(\"%{BKY_TEXT_APPEND_TOOLTIP}\",\"VAR\"));\nvar INDEXOF_TOOLTIP_EXTENSION$$module$build$src$blocks$text=function(){this.setTooltip(()=>$.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace(\"%1\",this.workspace.options.oneBasedIndex?\"0\":\"-1\"))},CHARAT_MUTATOR_MIXIN$$module$build$src$blocks$text={isAt_:!1,mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"at\",`${this.isAt_}`);return a},domToMutation:function(a){a=\"false\"!==a.getAttribute(\"at\");this.updateAt_(a)},updateAt_:function(a){this.removeInput(\"AT\",\n!0);this.removeInput(\"ORDINAL\",!0);a&&(this.appendValueInput(\"AT\").setCheck(\"Number\"),$.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput(\"ORDINAL\").appendField($.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX));$.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput(\"TAIL\",!0),this.appendDummyInput(\"TAIL\").appendField($.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL));this.isAt_=a}},CHARAT_EXTENSION$$module$build$src$blocks$text=function(){this.getField(\"WHERE\").setValidator(function(a){a=\n\"FROM_START\"===a||\"FROM_END\"===a;const b=this.getSourceBlock();a!==b.isAt_&&b.updateAt_(a)});this.updateAt_(!0);this.setTooltip(()=>{var a=this.getFieldValue(\"WHERE\");let b=$.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;(\"FROM_START\"===a||\"FROM_END\"===a)&&(a=\"FROM_START\"===a?$.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:$.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(b+=\"  \"+a.replace(\"%1\",this.workspace.options.oneBasedIndex?\"#1\":\"#0\"));return b})};\n$.register$$module$build$src$core$extensions(\"text_indexOf_tooltip\",INDEXOF_TOOLTIP_EXTENSION$$module$build$src$blocks$text);$.register$$module$build$src$core$extensions(\"text_quotes\",QUOTES_EXTENSION$$module$build$src$blocks$text);$.registerMixin$$module$build$src$core$extensions(\"quote_image_mixin\",QUOTE_IMAGE_MIXIN$$module$build$src$blocks$text);$.registerMutator$$module$build$src$core$extensions(\"text_join_mutator\",JOIN_MUTATOR_MIXIN$$module$build$src$blocks$text,JOIN_EXTENSION$$module$build$src$blocks$text);\n$.registerMutator$$module$build$src$core$extensions(\"text_charAt_mutator\",CHARAT_MUTATOR_MIXIN$$module$build$src$blocks$text,CHARAT_EXTENSION$$module$build$src$blocks$text);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$text);var module$build$src$blocks$text={blocks:blocks$$module$build$src$blocks$text};var blocks$$module$build$src$blocks$procedures={},PROCEDURE_DEF_COMMON$$module$build$src$blocks$procedures={setStatements_:function(a){this.hasStatements_!==a&&(a?(this.appendStatementInput(\"STACK\").appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput(\"RETURN\")&&this.moveInputBefore(\"STACK\",\"RETURN\")):this.removeInput(\"STACK\",!0),this.hasStatements_=a)},updateParams_:function(){let a=\"\";this.arguments_.length&&(a=$.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+\n\" \"+this.arguments_.join(\", \"));$.disable$$module$build$src$core$events$utils();try{this.setFieldValue(a,\"PARAMS\")}finally{$.enable$$module$build$src$core$events$utils()}},mutationToDom:function(a){const b=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a&&b.setAttribute(\"name\",this.getFieldValue(\"NAME\"));for(let c=0;c<this.argumentVarModels_.length;c++){const d=$.createElement$$module$build$src$core$utils$xml(\"arg\"),e=this.argumentVarModels_[c];d.setAttribute(\"name\",e.name);d.setAttribute(\"varid\",\ne.getId());a&&this.paramIds_&&d.setAttribute(\"paramId\",this.paramIds_[c]);b.appendChild(d)}this.hasStatements_||b.setAttribute(\"statements\",\"false\");return b},domToMutation:function(a){this.arguments_=[];this.argumentVarModels_=[];for(let c=0,d;d=a.childNodes[c];c++)if(\"arg\"===d.nodeName.toLowerCase()){var b=d;const e=b.getAttribute(\"name\");b=b.getAttribute(\"varid\")||b.getAttribute(\"varId\");this.arguments_.push(e);b=$.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,b,e,\n\"\");null!==b?this.argumentVarModels_.push(b):console.log(`Failed to create a variable named \"${e}\", ignoring.`)}this.updateParams_();$.mutateCallers$$module$build$src$core$procedures(this);this.setStatements_(\"false\"!==a.getAttribute(\"statements\"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const a=Object.create(null);if(this.argumentVarModels_.length){a.params=[];for(let b=0;b<this.argumentVarModels_.length;b++)a.params.push({name:this.argumentVarModels_[b].name,\nid:this.argumentVarModels_[b].getId()})}this.hasStatements_||(a.hasStatements=!1);return a},loadExtraState:function(a){this.arguments_=[];this.argumentVarModels_=[];if(a.params)for(let c=0;c<a.params.length;c++){var b=a.params[c];b=$.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,b.id,b.name,\"\");this.arguments_.push(b.name);this.argumentVarModels_.push(b)}this.updateParams_();$.mutateCallers$$module$build$src$core$procedures(this);this.setStatements_(!1===a.hasStatements?\n!1:!0)},decompose:function(a){const b=$.createElement$$module$build$src$core$utils$xml(\"block\");b.setAttribute(\"type\",\"procedures_mutatorcontainer\");var c=$.createElement$$module$build$src$core$utils$xml(\"statement\");c.setAttribute(\"name\",\"STACK\");b.appendChild(c);for(let e=0;e<this.arguments_.length;e++){const f=$.createElement$$module$build$src$core$utils$xml(\"block\");f.setAttribute(\"type\",\"procedures_mutatorarg\");var d=$.createElement$$module$build$src$core$utils$xml(\"field\");d.setAttribute(\"name\",\n\"NAME\");const g=$.createTextNode$$module$build$src$core$utils$xml(this.arguments_[e]);d.appendChild(g);f.appendChild(d);d=$.createElement$$module$build$src$core$utils$xml(\"next\");f.appendChild(d);c.appendChild(f);c=d}a=$.domToBlock$$module$build$src$core$xml(b,a);\"procedures_defreturn\"===this.type?a.setFieldValue(this.hasStatements_,\"STATEMENTS\"):a.removeInput(\"STATEMENT_INPUT\");$.mutateCallers$$module$build$src$core$procedures(this);return a},compose:function(a){this.arguments_=[];this.paramIds_=\n[];this.argumentVarModels_=[];let b=a.getInputTargetBlock(\"STACK\");for(;b&&!b.isInsertionMarker();){var c=b.getFieldValue(\"NAME\");this.arguments_.push(c);c=this.workspace.getVariable(c,\"\");this.argumentVarModels_.push(c);this.paramIds_.push(b.id);b=b.nextConnection&&b.nextConnection.targetBlock()}this.updateParams_();$.mutateCallers$$module$build$src$core$procedures(this);a=a.getFieldValue(\"STATEMENTS\");if(null!==a&&(a=\"TRUE\"===a,this.hasStatements_!==a))if(a){this.setStatements_(!0);var d;null==\n(d=this.statementConnection_)||d.reconnect(this,\"STACK\");this.statementConnection_=null}else{d=this.getInput(\"STACK\").connection;if(this.statementConnection_=d.targetConnection)d=d.targetBlock(),d.unplug(),d.bumpNeighbours();this.setStatements_(!1)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(a,b){var c=this.workspace.getVariableById(a);if(\"\"===c.type){c=c.name;b=this.workspace.getVariableById(b);var d=!1;for(let e=0;e<\nthis.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===a&&(this.arguments_[e]=b.name,this.argumentVarModels_[e]=b,d=!0);d&&(this.displayRenamedVar_(c,b.name),$.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(a){const b=a.name;let c=!1,d;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===a.getId()&&(d=this.arguments_[e],this.arguments_[e]=b,c=!0);c&&(this.displayRenamedVar_(d,b),$.mutateCallers$$module$build$src$core$procedures(this))},\ndisplayRenamedVar_:function(a,b){this.updateParams_();var c=this.getIcon($.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(c&&c.bubbleIsVisible()){c=c.getWorkspace().getAllBlocks(!1);for(let d=0,e;e=c[d];d++)\"procedures_mutatorarg\"===e.type&&$.Names$$module$build$src$core$names.equals(a,e.getFieldValue(\"NAME\"))&&e.setFieldValue(b,\"NAME\")}},customContextMenu:function(a){if(!this.isInFlyout){var b=this.getFieldValue(\"NAME\"),c={type:this.callType_,extraState:{name:b,params:this.arguments_}};\na.push({enabled:!0,text:$.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace(\"%1\",b),callback:$.callbackFactory$$module$build$src$core$contextmenu(this,c)});if(!this.isCollapsed())for(b=0;b<this.argumentVarModels_.length;b++){c=this.argumentVarModels_[b];const d={type:\"variables_get\",fields:{VAR:{name:c.name,id:c.getId(),type:c.type}}};a.push({enabled:!0,text:$.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace(\"%1\",c.name),callback:$.callbackFactory$$module$build$src$core$contextmenu(this,\nd)})}}}};\nblocks$$module$build$src$blocks$procedures.procedures_defnoreturn=Object.assign({},PROCEDURE_DEF_COMMON$$module$build$src$blocks$procedures,{init:function(){var a=$.findLegalName$$module$build$src$core$procedures(\"\",this);a=$.fromJson$$module$build$src$core$field_registry({type:\"field_input\",text:a});a.setValidator($.rename$$module$build$src$core$procedures);a.setSpellcheck(!1);this.appendDummyInput().appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(a,\"NAME\").appendField(\"\",\n\"PARAMS\");this.setMutator(new $.MutatorIcon$$module$build$src$core$icons$mutator_icon([\"procedures_mutatorarg\"],this));(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&$.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText($.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT);this.setStyle(\"procedure_blocks\");this.setTooltip($.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP);\nthis.setHelpUrl($.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL);this.arguments_=[];this.argumentVarModels_=[];this.setStatements_(!0);this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue(\"NAME\"),this.arguments_,!1]},callType_:\"procedures_callnoreturn\"});\nblocks$$module$build$src$blocks$procedures.procedures_defreturn=Object.assign({},PROCEDURE_DEF_COMMON$$module$build$src$blocks$procedures,{init:function(){var a=$.findLegalName$$module$build$src$core$procedures(\"\",this);a=$.fromJson$$module$build$src$core$field_registry({type:\"field_input\",text:a});a.setValidator($.rename$$module$build$src$core$procedures);a.setSpellcheck(!1);this.appendDummyInput().appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(a,\"NAME\").appendField(\"\",\n\"PARAMS\");this.appendValueInput(\"RETURN\").setAlign($.Align$$module$build$src$core$inputs$input.RIGHT).appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN);this.setMutator(new $.MutatorIcon$$module$build$src$core$icons$mutator_icon([\"procedures_mutatorarg\"],this));(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&$.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT);\nthis.setStyle(\"procedure_blocks\");this.setTooltip($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP);this.setHelpUrl($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL);this.arguments_=[];this.argumentVarModels_=[];this.setStatements_(!0);this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue(\"NAME\"),this.arguments_,!0]},callType_:\"procedures_callreturn\"});\nvar PROCEDURES_MUTATORCONTAINER$$module$build$src$blocks$procedures={init:function(){this.appendDummyInput().appendField($.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE);this.appendStatementInput(\"STACK\");this.appendDummyInput(\"STATEMENT_INPUT\").appendField($.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField($.fromJson$$module$build$src$core$field_registry({type:\"field_checkbox\",checked:!0}),\"STATEMENTS\");this.setStyle(\"procedure_blocks\");this.setTooltip($.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP);\nthis.contextMenu=!1}};blocks$$module$build$src$blocks$procedures.procedures_mutatorcontainer=PROCEDURES_MUTATORCONTAINER$$module$build$src$blocks$procedures;\nvar PROCEDURES_MUTATORARGUMENT$$module$build$src$blocks$procedures={init:function(){const a=$.fromJson$$module$build$src$core$field_registry({type:\"field_input\",text:$.DEFAULT_ARG$$module$build$src$core$procedures});a.setValidator(this.validator_);a.oldShowEditorFn_=a.showEditor_;a.showEditor_=function(){this.createdVariables_=[];this.oldShowEditorFn_()};this.appendDummyInput().appendField($.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(a,\"NAME\");this.setPreviousStatement(!0);\nthis.setNextStatement(!0);this.setStyle(\"procedure_blocks\");this.setTooltip($.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP);this.contextMenu=!1;a.onFinishEditing_=this.deleteIntermediateVars_;a.createdVariables_=[];a.onFinishEditing_(\"x\")},validator_:function(a){var b=this.getSourceBlock();const c=b.workspace.getRootWorkspace();a=a.replace(/[\\s\\xa0]+/g,\" \").replace(/^ | $/g,\"\");if(!a)return null;const d=(b.workspace.targetWorkspace||b.workspace).getAllBlocks(!1),e=a.toLowerCase();\nfor(let f=0;f<d.length;f++){if(d[f].id===this.getSourceBlock().id)continue;const g=d[f].getFieldValue(\"NAME\");if(g&&g.toLowerCase()===e)return null}if(b.isInFlyout)return a;(b=c.getVariable(a,\"\"))&&b.name!==a&&c.renameVariableById(b.getId(),a);b||(b=c.createVariable(a,\"\"))&&this.createdVariables_&&this.createdVariables_.push(b);return a},deleteIntermediateVars_:function(a){const b=this.getSourceBlock().workspace.getRootWorkspace();if(b)for(let c=0;c<this.createdVariables_.length;c++){const d=this.createdVariables_[c];\nd.name!==a&&b.deleteVariableById(d.getId())}}};blocks$$module$build$src$blocks$procedures.procedures_mutatorarg=PROCEDURES_MUTATORARGUMENT$$module$build$src$blocks$procedures;\nvar PROCEDURE_CALL_COMMON$$module$build$src$blocks$procedures={getProcedureCall:function(){return this.getFieldValue(\"NAME\")},renameProcedure:function(a,b){$.Names$$module$build$src$core$names.equals(a,this.getProcedureCall())&&(this.setFieldValue(b,\"NAME\"),this.setTooltip((this.outputConnection?$.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:$.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace(\"%1\",b)))},setProcedureParameters_:function(a,b){var c=$.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),\nthis.workspace);(c=(c=c&&c.getIcon($.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&c.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null);if(a.join(\"\\n\")===this.arguments_.join(\"\\n\"))this.quarkIds_=b;else{if(b.length!==a.length)throw RangeError(\"paramNames and paramIds must be the same length.\");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var d=this.getInput(\"ARG\"+e);d&&(d=d.connection.targetConnection,\nthis.quarkConnections_[this.quarkIds_[e]]=d,c&&d&&-1===b.indexOf(this.quarkIds_[e])&&(d.disconnect(),d.getSourceBlock().bumpNeighbours()))}this.arguments_=[].concat(a);this.argumentVarModels_=[];for(a=0;a<this.arguments_.length;a++)c=$.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[a],\"\"),this.argumentVarModels_.push(c);this.updateShape_();if(this.quarkIds_=b)for(b=0;b<this.arguments_.length;b++)if(a=this.quarkIds_[b],a in this.quarkConnections_){let e;\n(null==(e=this.quarkConnections_[a])?0:e.reconnect(this,\"ARG\"+b))||delete this.quarkConnections_[a]}}},updateShape_:function(){for(var a=0;a<this.arguments_.length;a++){var b=this.getField(\"ARGNAME\"+a);if(b){$.disable$$module$build$src$core$events$utils();try{b.setValue(this.arguments_[a])}finally{$.enable$$module$build$src$core$events$utils()}}else b=$.fromJson$$module$build$src$core$field_registry({type:\"field_label\",text:this.arguments_[a]}),this.appendValueInput(\"ARG\"+a).setAlign($.Align$$module$build$src$core$inputs$input.RIGHT).appendField(b,\n\"ARGNAME\"+a).init()}for(a=this.arguments_.length;this.getInput(\"ARG\"+a);a++)this.removeInput(\"ARG\"+a);if(a=this.getInput(\"TOPROW\"))this.arguments_.length?this.getField(\"WITH\")||(a.appendField($.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,\"WITH\"),a.init()):this.getField(\"WITH\")&&a.removeField(\"WITH\")},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"name\",this.getProcedureCall());for(let b=0;b<this.arguments_.length;b++){const c=\n$.createElement$$module$build$src$core$utils$xml(\"arg\");c.setAttribute(\"name\",this.arguments_[b]);a.appendChild(c)}return a},domToMutation:function(a){var b=a.getAttribute(\"name\");this.renameProcedure(this.getProcedureCall(),b);b=[];const c=[];for(let d=0,e;e=a.childNodes[d];d++)\"arg\"===e.nodeName.toLowerCase()&&(b.push(e.getAttribute(\"name\")),c.push(e.getAttribute(\"paramId\")));this.setProcedureParameters_(b,c)},saveExtraState:function(){const a=Object.create(null);a.name=this.getProcedureCall();\nthis.arguments_.length&&(a.params=this.arguments_);return a},loadExtraState:function(a){this.renameProcedure(this.getProcedureCall(),a.name);if(a=a.params){const b=[];b.length=a.length;b.fill(null);this.setProcedureParameters_(a,b)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(a){if(this.workspace&&!this.workspace.isFlyout&&a.recordUndo)if(a.type===$.CREATE$$module$build$src$core$events$utils&&-1!==a.ids.indexOf(this.id)){var b=\nthis.getProcedureCall();b=$.getDefinition$$module$build$src$core$procedures(b,this.workspace);!b||b.type===this.defType_&&JSON.stringify(b.getVars())===JSON.stringify(this.arguments_)||(b=null);if(!b){$.setGroup$$module$build$src$core$events$utils(a.group);a=$.createElement$$module$build$src$core$utils$xml(\"xml\");b=$.createElement$$module$build$src$core$utils$xml(\"block\");b.setAttribute(\"type\",this.defType_);var c=this.getRelativeToSurfaceXY(),d=c.y+2*$.config$$module$build$src$core$config.snapRadius;\nb.setAttribute(\"x\",`${c.x+$.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`);b.setAttribute(\"y\",`${d}`);c=this.mutationToDom();b.appendChild(c);c=$.createElement$$module$build$src$core$utils$xml(\"field\");c.setAttribute(\"name\",\"NAME\");d=this.getProcedureCall();const e=$.findLegalName$$module$build$src$core$procedures(d,this);d!==e&&this.renameProcedure(d,e);c.appendChild($.createTextNode$$module$build$src$core$utils$xml(d));b.appendChild(c);a.appendChild(b);$.domToWorkspace$$module$build$src$core$xml(a,\nthis.workspace);$.setGroup$$module$build$src$core$events$utils(!1)}}else a.type===$.DELETE$$module$build$src$core$events$utils?(b=this.getProcedureCall(),$.getDefinition$$module$build$src$core$procedures(b,this.workspace)||($.setGroup$$module$build$src$core$events$utils(a.group),this.dispose(!0),$.setGroup$$module$build$src$core$events$utils(!1))):a.type===$.CHANGE$$module$build$src$core$events$utils&&\"disabled\"===a.element&&(b=this.getProcedureCall(),(b=$.getDefinition$$module$build$src$core$procedures(b,\nthis.workspace))&&b.id===a.blockId&&((b=$.getGroup$$module$build$src$core$events$utils())&&console.log(\"Saw an existing group while responding to a definition change\"),$.setGroup$$module$build$src$core$events$utils(a.group),a.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),$.setGroup$$module$build$src$core$events$utils(b)))},customContextMenu:function(a){if(this.workspace.isMovable()){var b=this.getProcedureCall(),c=this.workspace;\na.push({enabled:!0,text:$.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const d=$.getDefinition$$module$build$src$core$procedures(b,c);d&&(c.centerOnBlock(d.id),d.select())}})}}};\nblocks$$module$build$src$blocks$procedures.procedures_callnoreturn=Object.assign({},PROCEDURE_CALL_COMMON$$module$build$src$blocks$procedures,{init:function(){this.appendDummyInput(\"TOPROW\").appendField(\"\",\"NAME\");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setStyle(\"procedure_blocks\");this.setHelpUrl($.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL);this.arguments_=[];this.argumentVarModels_=[];this.quarkConnections_={};this.quarkIds_=null;this.previousEnabledState_=\n!0},defType_:\"procedures_defnoreturn\"});\nblocks$$module$build$src$blocks$procedures.procedures_callreturn=Object.assign({},PROCEDURE_CALL_COMMON$$module$build$src$blocks$procedures,{init:function(){this.appendDummyInput(\"TOPROW\").appendField(\"\",\"NAME\");this.setOutput(!0);this.setStyle(\"procedure_blocks\");this.setHelpUrl($.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL);this.arguments_=[];this.argumentVarModels_=[];this.quarkConnections_={};this.quarkIds_=null;this.previousEnabledState_=!0},defType_:\"procedures_defreturn\"});\nvar PROCEDURES_IFRETURN$$module$build$src$blocks$procedures={init:function(){this.appendValueInput(\"CONDITION\").setCheck(\"Boolean\").appendField($.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF);this.appendValueInput(\"VALUE\").appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN);this.setInputsInline(!0);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setStyle(\"procedure_blocks\");this.setTooltip($.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP);this.setHelpUrl($.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL);\nthis.hasReturnValue_=!0},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"value\",String(Number(this.hasReturnValue_)));return a},domToMutation:function(a){this.hasReturnValue_=\"1\"===a.getAttribute(\"value\");this.hasReturnValue_||(this.removeInput(\"VALUE\"),this.appendDummyInput(\"VALUE\").appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(a){if(!(this.workspace.isDragging&&this.workspace.isDragging()||\na.type!==$.MOVE$$module$build$src$core$events$utils)){var b=!1,c=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(c.type)){b=!0;break}c=c.getSurroundParent()}while(c);b?(\"procedures_defnoreturn\"===c.type&&this.hasReturnValue_?(this.removeInput(\"VALUE\"),this.appendDummyInput(\"VALUE\").appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):\"procedures_defreturn\"!==c.type||this.hasReturnValue_||(this.removeInput(\"VALUE\"),this.appendValueInput(\"VALUE\").appendField($.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),\nthis.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText($.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING);this.isInFlyout||(c=$.getGroup$$module$build$src$core$events$utils(),$.setGroup$$module$build$src$core$events$utils(a.group),this.setEnabled(b),$.setGroup$$module$build$src$core$events$utils(c))}},FUNCTION_TYPES:[\"procedures_defnoreturn\",\"procedures_defreturn\"]};blocks$$module$build$src$blocks$procedures.procedures_ifreturn=PROCEDURES_IFRETURN$$module$build$src$blocks$procedures;\n$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$procedures);var module$build$src$blocks$procedures={blocks:blocks$$module$build$src$blocks$procedures};var blocks$$module$build$src$blocks$math=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"math_number\",message0:\"%1\",args0:[{type:\"field_number\",name:\"NUM\",value:0}],output:\"Number\",helpUrl:\"%{BKY_MATH_NUMBER_HELPURL}\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_NUMBER_TOOLTIP}\",extensions:[\"parent_tooltip_when_inline\"]},{type:\"math_arithmetic\",message0:\"%1 %2 %3\",args0:[{type:\"input_value\",name:\"A\",check:\"Number\"},{type:\"field_dropdown\",name:\"OP\",options:[[\"%{BKY_MATH_ADDITION_SYMBOL}\",\n\"ADD\"],[\"%{BKY_MATH_SUBTRACTION_SYMBOL}\",\"MINUS\"],[\"%{BKY_MATH_MULTIPLICATION_SYMBOL}\",\"MULTIPLY\"],[\"%{BKY_MATH_DIVISION_SYMBOL}\",\"DIVIDE\"],[\"%{BKY_MATH_POWER_SYMBOL}\",\"POWER\"]]},{type:\"input_value\",name:\"B\",check:\"Number\"}],inputsInline:!0,output:\"Number\",style:\"math_blocks\",helpUrl:\"%{BKY_MATH_ARITHMETIC_HELPURL}\",extensions:[\"math_op_tooltip\"]},{type:\"math_single\",message0:\"%1 %2\",args0:[{type:\"field_dropdown\",name:\"OP\",options:[[\"%{BKY_MATH_SINGLE_OP_ROOT}\",\"ROOT\"],[\"%{BKY_MATH_SINGLE_OP_ABSOLUTE}\",\n\"ABS\"],[\"-\",\"NEG\"],[\"ln\",\"LN\"],[\"log10\",\"LOG10\"],[\"e^\",\"EXP\"],[\"10^\",\"POW10\"]]},{type:\"input_value\",name:\"NUM\",check:\"Number\"}],output:\"Number\",style:\"math_blocks\",helpUrl:\"%{BKY_MATH_SINGLE_HELPURL}\",extensions:[\"math_op_tooltip\"]},{type:\"math_trig\",message0:\"%1 %2\",args0:[{type:\"field_dropdown\",name:\"OP\",options:[[\"%{BKY_MATH_TRIG_SIN}\",\"SIN\"],[\"%{BKY_MATH_TRIG_COS}\",\"COS\"],[\"%{BKY_MATH_TRIG_TAN}\",\"TAN\"],[\"%{BKY_MATH_TRIG_ASIN}\",\"ASIN\"],[\"%{BKY_MATH_TRIG_ACOS}\",\"ACOS\"],[\"%{BKY_MATH_TRIG_ATAN}\",\n\"ATAN\"]]},{type:\"input_value\",name:\"NUM\",check:\"Number\"}],output:\"Number\",style:\"math_blocks\",helpUrl:\"%{BKY_MATH_TRIG_HELPURL}\",extensions:[\"math_op_tooltip\"]},{type:\"math_constant\",message0:\"%1\",args0:[{type:\"field_dropdown\",name:\"CONSTANT\",options:[[\"\\u03c0\",\"PI\"],[\"e\",\"E\"],[\"\\u03c6\",\"GOLDEN_RATIO\"],[\"sqrt(2)\",\"SQRT2\"],[\"sqrt(\\u00bd)\",\"SQRT1_2\"],[\"\\u221e\",\"INFINITY\"]]}],output:\"Number\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_CONSTANT_TOOLTIP}\",helpUrl:\"%{BKY_MATH_CONSTANT_HELPURL}\"},{type:\"math_number_property\",\nmessage0:\"%1 %2\",args0:[{type:\"input_value\",name:\"NUMBER_TO_CHECK\",check:\"Number\"},{type:\"field_dropdown\",name:\"PROPERTY\",options:[[\"%{BKY_MATH_IS_EVEN}\",\"EVEN\"],[\"%{BKY_MATH_IS_ODD}\",\"ODD\"],[\"%{BKY_MATH_IS_PRIME}\",\"PRIME\"],[\"%{BKY_MATH_IS_WHOLE}\",\"WHOLE\"],[\"%{BKY_MATH_IS_POSITIVE}\",\"POSITIVE\"],[\"%{BKY_MATH_IS_NEGATIVE}\",\"NEGATIVE\"],[\"%{BKY_MATH_IS_DIVISIBLE_BY}\",\"DIVISIBLE_BY\"]]}],inputsInline:!0,output:\"Boolean\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_IS_TOOLTIP}\",mutator:\"math_is_divisibleby_mutator\"},\n{type:\"math_change\",message0:\"%{BKY_MATH_CHANGE_TITLE}\",args0:[{type:\"field_variable\",name:\"VAR\",variable:\"%{BKY_MATH_CHANGE_TITLE_ITEM}\"},{type:\"input_value\",name:\"DELTA\",check:\"Number\"}],previousStatement:null,nextStatement:null,style:\"variable_blocks\",helpUrl:\"%{BKY_MATH_CHANGE_HELPURL}\",extensions:[\"math_change_tooltip\"]},{type:\"math_round\",message0:\"%1 %2\",args0:[{type:\"field_dropdown\",name:\"OP\",options:[[\"%{BKY_MATH_ROUND_OPERATOR_ROUND}\",\"ROUND\"],[\"%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}\",\"ROUNDUP\"],\n[\"%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}\",\"ROUNDDOWN\"]]},{type:\"input_value\",name:\"NUM\",check:\"Number\"}],output:\"Number\",style:\"math_blocks\",helpUrl:\"%{BKY_MATH_ROUND_HELPURL}\",tooltip:\"%{BKY_MATH_ROUND_TOOLTIP}\"},{type:\"math_on_list\",message0:\"%1 %2\",args0:[{type:\"field_dropdown\",name:\"OP\",options:[[\"%{BKY_MATH_ONLIST_OPERATOR_SUM}\",\"SUM\"],[\"%{BKY_MATH_ONLIST_OPERATOR_MIN}\",\"MIN\"],[\"%{BKY_MATH_ONLIST_OPERATOR_MAX}\",\"MAX\"],[\"%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}\",\"AVERAGE\"],[\"%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}\",\n\"MEDIAN\"],[\"%{BKY_MATH_ONLIST_OPERATOR_MODE}\",\"MODE\"],[\"%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}\",\"STD_DEV\"],[\"%{BKY_MATH_ONLIST_OPERATOR_RANDOM}\",\"RANDOM\"]]},{type:\"input_value\",name:\"LIST\",check:\"Array\"}],output:\"Number\",style:\"math_blocks\",helpUrl:\"%{BKY_MATH_ONLIST_HELPURL}\",mutator:\"math_modes_of_list_mutator\",extensions:[\"math_op_tooltip\"]},{type:\"math_modulo\",message0:\"%{BKY_MATH_MODULO_TITLE}\",args0:[{type:\"input_value\",name:\"DIVIDEND\",check:\"Number\"},{type:\"input_value\",name:\"DIVISOR\",check:\"Number\"}],\ninputsInline:!0,output:\"Number\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_MODULO_TOOLTIP}\",helpUrl:\"%{BKY_MATH_MODULO_HELPURL}\"},{type:\"math_constrain\",message0:\"%{BKY_MATH_CONSTRAIN_TITLE}\",args0:[{type:\"input_value\",name:\"VALUE\",check:\"Number\"},{type:\"input_value\",name:\"LOW\",check:\"Number\"},{type:\"input_value\",name:\"HIGH\",check:\"Number\"}],inputsInline:!0,output:\"Number\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_CONSTRAIN_TOOLTIP}\",helpUrl:\"%{BKY_MATH_CONSTRAIN_HELPURL}\"},{type:\"math_random_int\",message0:\"%{BKY_MATH_RANDOM_INT_TITLE}\",\nargs0:[{type:\"input_value\",name:\"FROM\",check:\"Number\"},{type:\"input_value\",name:\"TO\",check:\"Number\"}],inputsInline:!0,output:\"Number\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_RANDOM_INT_TOOLTIP}\",helpUrl:\"%{BKY_MATH_RANDOM_INT_HELPURL}\"},{type:\"math_random_float\",message0:\"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}\",output:\"Number\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}\",helpUrl:\"%{BKY_MATH_RANDOM_FLOAT_HELPURL}\"},{type:\"math_atan2\",message0:\"%{BKY_MATH_ATAN2_TITLE}\",args0:[{type:\"input_value\",\nname:\"X\",check:\"Number\"},{type:\"input_value\",name:\"Y\",check:\"Number\"}],inputsInline:!0,output:\"Number\",style:\"math_blocks\",tooltip:\"%{BKY_MATH_ATAN2_TOOLTIP}\",helpUrl:\"%{BKY_MATH_ATAN2_HELPURL}\"}]),TOOLTIPS_BY_OP$$module$build$src$blocks$math={ADD:\"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}\",MINUS:\"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}\",MULTIPLY:\"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}\",DIVIDE:\"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}\",POWER:\"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}\",ROOT:\"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}\",\nABS:\"%{BKY_MATH_SINGLE_TOOLTIP_ABS}\",NEG:\"%{BKY_MATH_SINGLE_TOOLTIP_NEG}\",LN:\"%{BKY_MATH_SINGLE_TOOLTIP_LN}\",LOG10:\"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}\",EXP:\"%{BKY_MATH_SINGLE_TOOLTIP_EXP}\",POW10:\"%{BKY_MATH_SINGLE_TOOLTIP_POW10}\",SIN:\"%{BKY_MATH_TRIG_TOOLTIP_SIN}\",COS:\"%{BKY_MATH_TRIG_TOOLTIP_COS}\",TAN:\"%{BKY_MATH_TRIG_TOOLTIP_TAN}\",ASIN:\"%{BKY_MATH_TRIG_TOOLTIP_ASIN}\",ACOS:\"%{BKY_MATH_TRIG_TOOLTIP_ACOS}\",ATAN:\"%{BKY_MATH_TRIG_TOOLTIP_ATAN}\",SUM:\"%{BKY_MATH_ONLIST_TOOLTIP_SUM}\",MIN:\"%{BKY_MATH_ONLIST_TOOLTIP_MIN}\",\nMAX:\"%{BKY_MATH_ONLIST_TOOLTIP_MAX}\",AVERAGE:\"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}\",MEDIAN:\"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}\",MODE:\"%{BKY_MATH_ONLIST_TOOLTIP_MODE}\",STD_DEV:\"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}\",RANDOM:\"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}\"};$.register$$module$build$src$core$extensions(\"math_op_tooltip\",$.buildTooltipForDropdown$$module$build$src$core$extensions(\"OP\",TOOLTIPS_BY_OP$$module$build$src$blocks$math));\nvar IS_DIVISIBLEBY_MUTATOR_MIXIN$$module$build$src$blocks$math={mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\"),b=\"DIVISIBLE_BY\"===this.getFieldValue(\"PROPERTY\");a.setAttribute(\"divisor_input\",String(b));return a},domToMutation:function(a){a=\"true\"===a.getAttribute(\"divisor_input\");this.updateShape_(a)},updateShape_:function(a){const b=this.getInput(\"DIVISOR\");a?b||this.appendValueInput(\"DIVISOR\").setCheck(\"Number\"):b&&this.removeInput(\"DIVISOR\")}},IS_DIVISIBLE_MUTATOR_EXTENSION$$module$build$src$blocks$math=\nfunction(){this.getField(\"PROPERTY\").setValidator(function(a){a=\"DIVISIBLE_BY\"===a;this.getSourceBlock().updateShape_(a)})};$.registerMutator$$module$build$src$core$extensions(\"math_is_divisibleby_mutator\",IS_DIVISIBLEBY_MUTATOR_MIXIN$$module$build$src$blocks$math,IS_DIVISIBLE_MUTATOR_EXTENSION$$module$build$src$blocks$math);$.register$$module$build$src$core$extensions(\"math_change_tooltip\",$.buildTooltipWithFieldText$$module$build$src$core$extensions(\"%{BKY_MATH_CHANGE_TOOLTIP}\",\"VAR\"));\nvar LIST_MODES_MUTATOR_MIXIN$$module$build$src$blocks$math={updateType_:function(a){\"MODE\"===a?this.outputConnection.setCheck(\"Array\"):this.outputConnection.setCheck(\"Number\")},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"op\",this.getFieldValue(\"OP\"));return a},domToMutation:function(a){a=a.getAttribute(\"op\");if(null===a)throw new TypeError(\"xmlElement had no op attribute\");this.updateType_(a)}},LIST_MODES_MUTATOR_EXTENSION$$module$build$src$blocks$math=\nfunction(){this.getField(\"OP\").setValidator(function(a){this.updateType_(a)}.bind(this))};$.registerMutator$$module$build$src$core$extensions(\"math_modes_of_list_mutator\",LIST_MODES_MUTATOR_MIXIN$$module$build$src$blocks$math,LIST_MODES_MUTATOR_EXTENSION$$module$build$src$blocks$math);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$math);var module$build$src$blocks$math={blocks:blocks$$module$build$src$blocks$math};var blocks$$module$build$src$blocks$loops=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"controls_repeat_ext\",message0:\"%{BKY_CONTROLS_REPEAT_TITLE}\",args0:[{type:\"input_value\",name:\"TIMES\",check:\"Number\"}],message1:\"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1\",args1:[{type:\"input_statement\",name:\"DO\"}],previousStatement:null,nextStatement:null,style:\"loop_blocks\",tooltip:\"%{BKY_CONTROLS_REPEAT_TOOLTIP}\",helpUrl:\"%{BKY_CONTROLS_REPEAT_HELPURL}\"},{type:\"controls_repeat\",message0:\"%{BKY_CONTROLS_REPEAT_TITLE}\",\nargs0:[{type:\"field_number\",name:\"TIMES\",value:10,min:0,precision:1}],message1:\"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1\",args1:[{type:\"input_statement\",name:\"DO\"}],previousStatement:null,nextStatement:null,style:\"loop_blocks\",tooltip:\"%{BKY_CONTROLS_REPEAT_TOOLTIP}\",helpUrl:\"%{BKY_CONTROLS_REPEAT_HELPURL}\"},{type:\"controls_whileUntil\",message0:\"%1 %2\",args0:[{type:\"field_dropdown\",name:\"MODE\",options:[[\"%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}\",\"WHILE\"],[\"%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}\",\"UNTIL\"]]},\n{type:\"input_value\",name:\"BOOL\",check:\"Boolean\"}],message1:\"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1\",args1:[{type:\"input_statement\",name:\"DO\"}],previousStatement:null,nextStatement:null,style:\"loop_blocks\",helpUrl:\"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}\",extensions:[\"controls_whileUntil_tooltip\"]},{type:\"controls_for\",message0:\"%{BKY_CONTROLS_FOR_TITLE}\",args0:[{type:\"field_variable\",name:\"VAR\",variable:null},{type:\"input_value\",name:\"FROM\",check:\"Number\",align:\"RIGHT\"},{type:\"input_value\",name:\"TO\",check:\"Number\",\nalign:\"RIGHT\"},{type:\"input_value\",name:\"BY\",check:\"Number\",align:\"RIGHT\"}],message1:\"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1\",args1:[{type:\"input_statement\",name:\"DO\"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:\"loop_blocks\",helpUrl:\"%{BKY_CONTROLS_FOR_HELPURL}\",extensions:[\"contextMenu_newGetVariableBlock\",\"controls_for_tooltip\"]},{type:\"controls_forEach\",message0:\"%{BKY_CONTROLS_FOREACH_TITLE}\",args0:[{type:\"field_variable\",name:\"VAR\",variable:null},{type:\"input_value\",name:\"LIST\",\ncheck:\"Array\"}],message1:\"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1\",args1:[{type:\"input_statement\",name:\"DO\"}],previousStatement:null,nextStatement:null,style:\"loop_blocks\",helpUrl:\"%{BKY_CONTROLS_FOREACH_HELPURL}\",extensions:[\"contextMenu_newGetVariableBlock\",\"controls_forEach_tooltip\"]},{type:\"controls_flow_statements\",message0:\"%1\",args0:[{type:\"field_dropdown\",name:\"FLOW\",options:[[\"%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}\",\"BREAK\"],[\"%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}\",\"CONTINUE\"]]}],\npreviousStatement:null,style:\"loop_blocks\",helpUrl:\"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}\",suppressPrefixSuffix:!0,extensions:[\"controls_flow_tooltip\",\"controls_flow_in_loop_check\"]}]),WHILE_UNTIL_TOOLTIPS$$module$build$src$blocks$loops={WHILE:\"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}\",UNTIL:\"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}\"};$.register$$module$build$src$core$extensions(\"controls_whileUntil_tooltip\",$.buildTooltipForDropdown$$module$build$src$core$extensions(\"MODE\",WHILE_UNTIL_TOOLTIPS$$module$build$src$blocks$loops));\nvar BREAK_CONTINUE_TOOLTIPS$$module$build$src$blocks$loops={BREAK:\"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}\",CONTINUE:\"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}\"};$.register$$module$build$src$core$extensions(\"controls_flow_tooltip\",$.buildTooltipForDropdown$$module$build$src$core$extensions(\"FLOW\",BREAK_CONTINUE_TOOLTIPS$$module$build$src$blocks$loops));\nvar CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN$$module$build$src$blocks$loops={customContextMenu:function(a){if(!this.isInFlyout){var b=this.getField(\"VAR\"),c=b.getVariable().name;this.isCollapsed()||null===c||(b={type:\"variables_get\",fields:{VAR:b.saveState(!0)}},a.push({enabled:!0,text:$.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace(\"%1\",c),callback:$.callbackFactory$$module$build$src$core$contextmenu(this,b)}))}}};\n$.registerMixin$$module$build$src$core$extensions(\"contextMenu_newGetVariableBlock\",CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN$$module$build$src$blocks$loops);$.register$$module$build$src$core$extensions(\"controls_for_tooltip\",$.buildTooltipWithFieldText$$module$build$src$core$extensions(\"%{BKY_CONTROLS_FOR_TOOLTIP}\",\"VAR\"));$.register$$module$build$src$core$extensions(\"controls_forEach_tooltip\",$.buildTooltipWithFieldText$$module$build$src$core$extensions(\"%{BKY_CONTROLS_FOREACH_TOOLTIP}\",\"VAR\"));\nvar loopTypes$$module$build$src$blocks$loops=new Set([\"controls_repeat\",\"controls_repeat_ext\",\"controls_forEach\",\"controls_for\",\"controls_whileUntil\"]),CONTROL_FLOW_IN_LOOP_CHECK_MIXIN$$module$build$src$blocks$loops={getSurroundLoop:function(){let a=this;do{if(loopTypes$$module$build$src$blocks$loops.has(a.type))return a;a=a.getSurroundParent()}while(a);return null},onchange:function(a){var b=this.workspace;if(b.isDragging&&!b.isDragging()&&a.type===$.MOVE$$module$build$src$core$events$utils&&(b=\n!!this.getSurroundLoop(),this.setWarningText(b?null:$.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout)){const c=$.getGroup$$module$build$src$core$events$utils();$.setGroup$$module$build$src$core$events$utils(a.group);this.setEnabled(b);$.setGroup$$module$build$src$core$events$utils(c)}}};$.registerMixin$$module$build$src$core$extensions(\"controls_flow_in_loop_check\",CONTROL_FLOW_IN_LOOP_CHECK_MIXIN$$module$build$src$blocks$loops);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$loops);\nvar module$build$src$blocks$loops={blocks:blocks$$module$build$src$blocks$loops,loopTypes:loopTypes$$module$build$src$blocks$loops};var blocks$$module$build$src$blocks$logic=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"logic_boolean\",message0:\"%1\",args0:[{type:\"field_dropdown\",name:\"BOOL\",options:[[\"%{BKY_LOGIC_BOOLEAN_TRUE}\",\"TRUE\"],[\"%{BKY_LOGIC_BOOLEAN_FALSE}\",\"FALSE\"]]}],output:\"Boolean\",style:\"logic_blocks\",tooltip:\"%{BKY_LOGIC_BOOLEAN_TOOLTIP}\",helpUrl:\"%{BKY_LOGIC_BOOLEAN_HELPURL}\"},{type:\"controls_if\",message0:\"%{BKY_CONTROLS_IF_MSG_IF} %1\",args0:[{type:\"input_value\",name:\"IF0\",check:\"Boolean\"}],\nmessage1:\"%{BKY_CONTROLS_IF_MSG_THEN} %1\",args1:[{type:\"input_statement\",name:\"DO0\"}],previousStatement:null,nextStatement:null,style:\"logic_blocks\",helpUrl:\"%{BKY_CONTROLS_IF_HELPURL}\",suppressPrefixSuffix:!0,mutator:\"controls_if_mutator\",extensions:[\"controls_if_tooltip\"]},{type:\"controls_ifelse\",message0:\"%{BKY_CONTROLS_IF_MSG_IF} %1\",args0:[{type:\"input_value\",name:\"IF0\",check:\"Boolean\"}],message1:\"%{BKY_CONTROLS_IF_MSG_THEN} %1\",args1:[{type:\"input_statement\",name:\"DO0\"}],message2:\"%{BKY_CONTROLS_IF_MSG_ELSE} %1\",\nargs2:[{type:\"input_statement\",name:\"ELSE\"}],previousStatement:null,nextStatement:null,style:\"logic_blocks\",tooltip:\"%{BKYCONTROLS_IF_TOOLTIP_2}\",helpUrl:\"%{BKY_CONTROLS_IF_HELPURL}\",suppressPrefixSuffix:!0,extensions:[\"controls_if_tooltip\"]},{type:\"logic_compare\",message0:\"%1 %2 %3\",args0:[{type:\"input_value\",name:\"A\"},{type:\"field_dropdown\",name:\"OP\",options:[[\"=\",\"EQ\"],[\"\\u2260\",\"NEQ\"],[\"\\u200f<\",\"LT\"],[\"\\u200f\\u2264\",\"LTE\"],[\"\\u200f>\",\"GT\"],[\"\\u200f\\u2265\",\"GTE\"]]},{type:\"input_value\",name:\"B\"}],\ninputsInline:!0,output:\"Boolean\",style:\"logic_blocks\",helpUrl:\"%{BKY_LOGIC_COMPARE_HELPURL}\",extensions:[\"logic_compare\",\"logic_op_tooltip\"]},{type:\"logic_operation\",message0:\"%1 %2 %3\",args0:[{type:\"input_value\",name:\"A\",check:\"Boolean\"},{type:\"field_dropdown\",name:\"OP\",options:[[\"%{BKY_LOGIC_OPERATION_AND}\",\"AND\"],[\"%{BKY_LOGIC_OPERATION_OR}\",\"OR\"]]},{type:\"input_value\",name:\"B\",check:\"Boolean\"}],inputsInline:!0,output:\"Boolean\",style:\"logic_blocks\",helpUrl:\"%{BKY_LOGIC_OPERATION_HELPURL}\",extensions:[\"logic_op_tooltip\"]},\n{type:\"logic_negate\",message0:\"%{BKY_LOGIC_NEGATE_TITLE}\",args0:[{type:\"input_value\",name:\"BOOL\",check:\"Boolean\"}],output:\"Boolean\",style:\"logic_blocks\",tooltip:\"%{BKY_LOGIC_NEGATE_TOOLTIP}\",helpUrl:\"%{BKY_LOGIC_NEGATE_HELPURL}\"},{type:\"logic_null\",message0:\"%{BKY_LOGIC_NULL}\",output:null,style:\"logic_blocks\",tooltip:\"%{BKY_LOGIC_NULL_TOOLTIP}\",helpUrl:\"%{BKY_LOGIC_NULL_HELPURL}\"},{type:\"logic_ternary\",message0:\"%{BKY_LOGIC_TERNARY_CONDITION} %1\",args0:[{type:\"input_value\",name:\"IF\",check:\"Boolean\"}],\nmessage1:\"%{BKY_LOGIC_TERNARY_IF_TRUE} %1\",args1:[{type:\"input_value\",name:\"THEN\"}],message2:\"%{BKY_LOGIC_TERNARY_IF_FALSE} %1\",args2:[{type:\"input_value\",name:\"ELSE\"}],output:null,style:\"logic_blocks\",tooltip:\"%{BKY_LOGIC_TERNARY_TOOLTIP}\",helpUrl:\"%{BKY_LOGIC_TERNARY_HELPURL}\",extensions:[\"logic_ternary\"]},{type:\"controls_if_if\",message0:\"%{BKY_CONTROLS_IF_IF_TITLE_IF}\",nextStatement:null,enableContextMenu:!1,style:\"logic_blocks\",tooltip:\"%{BKY_CONTROLS_IF_IF_TOOLTIP}\"},{type:\"controls_if_elseif\",\nmessage0:\"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}\",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:\"logic_blocks\",tooltip:\"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}\"},{type:\"controls_if_else\",message0:\"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}\",previousStatement:null,enableContextMenu:!1,style:\"logic_blocks\",tooltip:\"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}\"}]),TOOLTIPS_BY_OP$$module$build$src$blocks$logic={EQ:\"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}\",NEQ:\"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}\",LT:\"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}\",\nLTE:\"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}\",GT:\"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}\",GTE:\"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}\",AND:\"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}\",OR:\"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}\"};$.register$$module$build$src$core$extensions(\"logic_op_tooltip\",$.buildTooltipForDropdown$$module$build$src$core$extensions(\"OP\",TOOLTIPS_BY_OP$$module$build$src$blocks$logic));\nvar CONTROLS_IF_MUTATOR_MIXIN$$module$build$src$blocks$logic={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");this.elseifCount_&&a.setAttribute(\"elseif\",String(this.elseifCount_));this.elseCount_&&a.setAttribute(\"else\",\"1\");return a},domToMutation:function(a){this.elseifCount_=parseInt(a.getAttribute(\"elseif\"),10)||0;this.elseCount_=parseInt(a.getAttribute(\"else\"),10)||0;this.rebuildShape_()},\nsaveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const a=Object.create(null);this.elseifCount_&&(a.elseIfCount=this.elseifCount_);this.elseCount_&&(a.hasElse=!0);return a},loadExtraState:function(a){this.elseifCount_=a.elseIfCount||0;this.elseCount_=a.hasElse?1:0;this.updateShape_()},decompose:function(a){const b=a.newBlock(\"controls_if_if\");b.initSvg();let c=b.nextConnection;for(let d=1;d<=this.elseifCount_;d++){const e=a.newBlock(\"controls_if_elseif\");e.initSvg();c.connect(e.previousConnection);\nc=e.nextConnection}this.elseCount_&&(a=a.newBlock(\"controls_if_else\"),a.initSvg(),c.connect(a.previousConnection));return b},compose:function(a){a=a.nextConnection.targetBlock();this.elseCount_=this.elseifCount_=0;const b=[null],c=[null];let d=null;for(;a;){if(!a.isInsertionMarker())switch(a.type){case \"controls_if_elseif\":this.elseifCount_++;b.push(a.valueConnection_);c.push(a.statementConnection_);break;case \"controls_if_else\":this.elseCount_++;d=a.statementConnection_;break;default:throw TypeError(\"Unknown block type: \"+\na.type);}a=a.getNextBlock()}this.updateShape_();this.reconnectChildBlocks_(b,c,d)},saveConnections:function(a){a=a.nextConnection.targetBlock();let b=1;for(;a;){if(!a.isInsertionMarker())switch(a.type){case \"controls_if_elseif\":var c=this.getInput(\"IF\"+b);const d=this.getInput(\"DO\"+b);a.valueConnection_=c&&c.connection.targetConnection;a.statementConnection_=d&&d.connection.targetConnection;b++;break;case \"controls_if_else\":c=this.getInput(\"ELSE\");a.statementConnection_=c&&c.connection.targetConnection;\nbreak;default:throw TypeError(\"Unknown block type: \"+a.type);}a=a.getNextBlock()}},rebuildShape_:function(){const a=[null],b=[null];let c=null;this.getInput(\"ELSE\")&&(c=this.getInput(\"ELSE\").connection.targetConnection);for(let d=1;this.getInput(\"IF\"+d);d++){const e=this.getInput(\"IF\"+d),f=this.getInput(\"DO\"+d);a.push(e.connection.targetConnection);b.push(f.connection.targetConnection)}this.updateShape_();this.reconnectChildBlocks_(a,b,c)},updateShape_:function(){this.getInput(\"ELSE\")&&this.removeInput(\"ELSE\");\nfor(var a=1;this.getInput(\"IF\"+a);a++)this.removeInput(\"IF\"+a),this.removeInput(\"DO\"+a);for(a=1;a<=this.elseifCount_;a++)this.appendValueInput(\"IF\"+a).setCheck(\"Boolean\").appendField($.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput(\"DO\"+a).appendField($.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput(\"ELSE\").appendField($.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(a,b,c){for(let d=\n1;d<=this.elseifCount_;d++){let e;null==(e=a[d])||e.reconnect(this,\"IF\"+d);let f;null==(f=b[d])||f.reconnect(this,\"DO\"+d)}null==c||c.reconnect(this,\"ELSE\")}};$.registerMutator$$module$build$src$core$extensions(\"controls_if_mutator\",CONTROLS_IF_MUTATOR_MIXIN$$module$build$src$blocks$logic,null,[\"controls_if_elseif\",\"controls_if_else\"]);\nvar CONTROLS_IF_TOOLTIP_EXTENSION$$module$build$src$blocks$logic=function(){this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return $.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return $.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return $.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4}else return $.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1;\nreturn\"\"}.bind(this))};$.register$$module$build$src$core$extensions(\"controls_if_tooltip\",CONTROLS_IF_TOOLTIP_EXTENSION$$module$build$src$blocks$logic);\nvar LOGIC_COMPARE_ONCHANGE_MIXIN$$module$build$src$blocks$logic={onchange:function(a){this.prevBlocks_||(this.prevBlocks_=[null,null]);var b=this.getInputTargetBlock(\"A\");const c=this.getInputTargetBlock(\"B\");b&&c&&!this.workspace.connectionChecker.doTypeChecks(b.outputConnection,c.outputConnection)&&($.setGroup$$module$build$src$core$events$utils(a.group),a=this.prevBlocks_[0],a!==b&&(b.unplug(),!a||a.isDisposed()||a.isShadow()||this.getInput(\"A\").connection.connect(a.outputConnection)),b=this.prevBlocks_[1],\nb!==c&&(c.unplug(),!b||b.isDisposed()||b.isShadow()||this.getInput(\"B\").connection.connect(b.outputConnection)),this.bumpNeighbours(),$.setGroup$$module$build$src$core$events$utils(!1));this.prevBlocks_[0]=this.getInputTargetBlock(\"A\");this.prevBlocks_[1]=this.getInputTargetBlock(\"B\")}},LOGIC_COMPARE_EXTENSION$$module$build$src$blocks$logic=function(){this.mixin(LOGIC_COMPARE_ONCHANGE_MIXIN$$module$build$src$blocks$logic)};$.register$$module$build$src$core$extensions(\"logic_compare\",LOGIC_COMPARE_EXTENSION$$module$build$src$blocks$logic);\nvar LOGIC_TERNARY_ONCHANGE_MIXIN$$module$build$src$blocks$logic={prevParentConnection_:null,onchange:function(a){const b=this.getInputTargetBlock(\"THEN\"),c=this.getInputTargetBlock(\"ELSE\"),d=this.outputConnection.targetConnection;if((b||c)&&d)for(let e=0;2>e;e++){const f=1===e?b:c;f&&!f.workspace.connectionChecker.doTypeChecks(f.outputConnection,d)&&($.setGroup$$module$build$src$core$events$utils(a.group),d===this.prevParentConnection_?(this.unplug(),d.getSourceBlock().bumpNeighbours()):(f.unplug(),\nf.bumpNeighbours()),$.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=d}};$.registerMixin$$module$build$src$core$extensions(\"logic_ternary\",LOGIC_TERNARY_ONCHANGE_MIXIN$$module$build$src$blocks$logic);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$logic);var module$build$src$blocks$logic={blocks:blocks$$module$build$src$blocks$logic};var blocks$$module$build$src$blocks$lists=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"lists_create_empty\",message0:\"%{BKY_LISTS_CREATE_EMPTY_TITLE}\",output:\"Array\",style:\"list_blocks\",tooltip:\"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}\",helpUrl:\"%{BKY_LISTS_CREATE_EMPTY_HELPURL}\"},{type:\"lists_repeat\",message0:\"%{BKY_LISTS_REPEAT_TITLE}\",args0:[{type:\"input_value\",name:\"ITEM\"},{type:\"input_value\",name:\"NUM\",check:\"Number\"}],output:\"Array\",style:\"list_blocks\",tooltip:\"%{BKY_LISTS_REPEAT_TOOLTIP}\",\nhelpUrl:\"%{BKY_LISTS_REPEAT_HELPURL}\"},{type:\"lists_reverse\",message0:\"%{BKY_LISTS_REVERSE_MESSAGE0}\",args0:[{type:\"input_value\",name:\"LIST\",check:\"Array\"}],output:\"Array\",inputsInline:!0,style:\"list_blocks\",tooltip:\"%{BKY_LISTS_REVERSE_TOOLTIP}\",helpUrl:\"%{BKY_LISTS_REVERSE_HELPURL}\"},{type:\"lists_isEmpty\",message0:\"%{BKY_LISTS_ISEMPTY_TITLE}\",args0:[{type:\"input_value\",name:\"VALUE\",check:[\"String\",\"Array\"]}],output:\"Boolean\",style:\"list_blocks\",tooltip:\"%{BKY_LISTS_ISEMPTY_TOOLTIP}\",helpUrl:\"%{BKY_LISTS_ISEMPTY_HELPURL}\"},\n{type:\"lists_length\",message0:\"%{BKY_LISTS_LENGTH_TITLE}\",args0:[{type:\"input_value\",name:\"VALUE\",check:[\"String\",\"Array\"]}],output:\"Number\",style:\"list_blocks\",tooltip:\"%{BKY_LISTS_LENGTH_TOOLTIP}\",helpUrl:\"%{BKY_LISTS_LENGTH_HELPURL}\"}]),LISTS_CREATE_WITH$$module$build$src$blocks$lists={init:function(){this.setHelpUrl($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL);this.setStyle(\"list_blocks\");this.itemCount_=3;this.updateShape_();this.setOutput(!0,\"Array\");this.setMutator(new $.MutatorIcon$$module$build$src$core$icons$mutator_icon([\"lists_create_with_item\"],\nthis));this.setTooltip($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"items\",String(this.itemCount_));return a},domToMutation:function(a){a=a.getAttribute(\"items\");if(!a)throw new TypeError(\"element did not have items\");this.itemCount_=parseInt(a,10);this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(a){this.itemCount_=a.itemCount;\nthis.updateShape_()},decompose:function(a){const b=a.newBlock(\"lists_create_with_container\");b.initSvg();let c=b.getInput(\"STACK\").connection;for(let d=0;d<this.itemCount_;d++){const e=a.newBlock(\"lists_create_with_item\");e.initSvg();if(!e.previousConnection)throw Error(\"itemBlock has no previousConnection\");c.connect(e.previousConnection);c=e.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock(\"STACK\");for(a=[];b;)b.isInsertionMarker()||a.push(b.valueConnection_),b=b.getNextBlock();\nfor(b=0;b<this.itemCount_;b++){const c=this.getInput(\"ADD\"+b).connection.targetConnection;c&&-1===a.indexOf(c)&&c.disconnect()}this.itemCount_=a.length;this.updateShape_();for(b=0;b<this.itemCount_;b++){let c;null==(c=a[b])||c.reconnect(this,\"ADD\"+b)}},saveConnections:function(a){a=a.getInputTargetBlock(\"STACK\");let b=0;for(;a;){if(a.isInsertionMarker()){a=a.getNextBlock();continue}const c=this.getInput(\"ADD\"+b);let d;a.valueConnection_=null==(d=c)?void 0:d.connection.targetConnection;a=a.getNextBlock();\nb++}},updateShape_:function(){this.itemCount_&&this.getInput(\"EMPTY\")?this.removeInput(\"EMPTY\"):this.itemCount_||this.getInput(\"EMPTY\")||this.appendDummyInput(\"EMPTY\").appendField($.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var a=0;a<this.itemCount_;a++)if(!this.getInput(\"ADD\"+a)){const b=this.appendValueInput(\"ADD\"+a).setAlign($.Align$$module$build$src$core$inputs$align.RIGHT);0===a&&b.appendField($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(a=this.itemCount_;this.getInput(\"ADD\"+\na);a++)this.removeInput(\"ADD\"+a)}};blocks$$module$build$src$blocks$lists.lists_create_with=LISTS_CREATE_WITH$$module$build$src$blocks$lists;var LISTS_CREATE_WITH_CONTAINER$$module$build$src$blocks$lists={init:function(){this.setStyle(\"list_blocks\");this.appendDummyInput().appendField($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD);this.appendStatementInput(\"STACK\");this.setTooltip($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP);this.contextMenu=!1}};\nblocks$$module$build$src$blocks$lists.lists_create_with_container=LISTS_CREATE_WITH_CONTAINER$$module$build$src$blocks$lists;var LISTS_CREATE_WITH_ITEM$$module$build$src$blocks$lists={init:function(){this.setStyle(\"list_blocks\");this.appendDummyInput().appendField($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip($.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP);this.contextMenu=!1}};\nblocks$$module$build$src$blocks$lists.lists_create_with_item=LISTS_CREATE_WITH_ITEM$$module$build$src$blocks$lists;\nvar LISTS_INDEXOF$$module$build$src$blocks$lists={init:function(){var a=[[$.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,\"FIRST\"],[$.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,\"LAST\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL);this.setStyle(\"list_blocks\");this.setOutput(!0,\"Number\");this.appendValueInput(\"VALUE\").setCheck(\"Array\").appendField($.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST);a=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",\noptions:a});if(!a)throw Error(\"field_dropdown not found\");this.appendValueInput(\"FIND\").appendField(a,\"END\");this.setInputsInline(!0);this.setTooltip(()=>$.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace(\"%1\",this.workspace.options.oneBasedIndex?\"0\":\"-1\"))}};blocks$$module$build$src$blocks$lists.lists_indexOf=LISTS_INDEXOF$$module$build$src$blocks$lists;\nvar LISTS_GETINDEX$$module$build$src$blocks$lists={init:function(){var a=[[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,\"GET\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,\"GET_REMOVE\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,\"REMOVE\"]];this.WHERE_OPTIONS=[[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,\"FROM_START\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,\"FROM_END\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,\"FIRST\"],\n[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,\"LAST\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,\"RANDOM\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL);this.setStyle(\"list_blocks\");a=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:a});a.setValidator(function(b){b=\"REMOVE\"===b;this.getSourceBlock().updateStatement_(b)});this.appendValueInput(\"VALUE\").setCheck(\"Array\").appendField($.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST);\nthis.appendDummyInput().appendField(a,\"MODE\").appendField(\"\",\"SPACE\");this.appendDummyInput(\"AT\");$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput(\"TAIL\").appendField($.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL);this.setInputsInline(!0);this.setOutput(!0);this.updateAt_(!0);this.setTooltip(()=>{const b=this.getFieldValue(\"MODE\"),c=this.getFieldValue(\"WHERE\");let d=\"\";switch(b+\" \"+c){case \"GET FROM_START\":case \"GET FROM_END\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;\nbreak;case \"GET FIRST\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case \"GET LAST\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case \"GET RANDOM\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case \"GET_REMOVE FROM_START\":case \"GET_REMOVE FROM_END\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case \"GET_REMOVE FIRST\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;\nbreak;case \"GET_REMOVE LAST\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case \"GET_REMOVE RANDOM\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case \"REMOVE FROM_START\":case \"REMOVE FROM_END\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case \"REMOVE FIRST\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case \"REMOVE LAST\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;\nbreak;case \"REMOVE RANDOM\":d=$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}if(\"FROM_START\"===c||\"FROM_END\"===c)d+=\"  \"+(\"FROM_START\"===c?$.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:$.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace(\"%1\",this.workspace.options.oneBasedIndex?\"#1\":\"#0\");return d})},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"statement\",String(!this.outputConnection));\nconst b=this.getInput(\"AT\")instanceof $.ValueInput$$module$build$src$core$inputs$value_input;a.setAttribute(\"at\",String(b));return a},domToMutation:function(a){const b=\"true\"===a.getAttribute(\"statement\");this.updateStatement_(b);a=\"false\"!==a.getAttribute(\"at\");this.updateAt_(a)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(a){a.isStatement?this.updateStatement_(!0):\"string\"===typeof a&&this.domToMutation($.textToDom$$module$build$src$core$utils$xml(a))},\nupdateStatement_:function(a){a!==!this.outputConnection&&(this.unplug(!0,!0),a?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(a){this.removeInput(\"AT\");this.removeInput(\"ORDINAL\",!0);a?(this.appendValueInput(\"AT\").setCheck(\"Number\"),$.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput(\"ORDINAL\").appendField($.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):\nthis.appendDummyInput(\"AT\");const b=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:this.WHERE_OPTIONS});b.setValidator(function(c){const d=\"FROM_START\"===c||\"FROM_END\"===c;if(d!==a){const e=this.getSourceBlock();e.updateAt_(d);e.setFieldValue(c,\"WHERE\");return null}});this.getInput(\"AT\").appendField(b,\"WHERE\");$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore(\"TAIL\",null)}};blocks$$module$build$src$blocks$lists.lists_getIndex=LISTS_GETINDEX$$module$build$src$blocks$lists;\nvar LISTS_SETINDEX$$module$build$src$blocks$lists={init:function(){var a=[[$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,\"SET\"],[$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,\"INSERT\"]];this.WHERE_OPTIONS=[[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,\"FROM_START\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,\"FROM_END\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,\"FIRST\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,\"LAST\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,\n\"RANDOM\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL);this.setStyle(\"list_blocks\");this.appendValueInput(\"LIST\").setCheck(\"Array\").appendField($.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST);a=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:a});this.appendDummyInput().appendField(a,\"MODE\").appendField(\"\",\"SPACE\");this.appendDummyInput(\"AT\");this.appendValueInput(\"TO\").appendField($.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO);\nthis.setInputsInline(!0);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip($.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP);this.updateAt_(!0);this.setTooltip(()=>{const b=this.getFieldValue(\"MODE\"),c=this.getFieldValue(\"WHERE\");let d=\"\";switch(b+\" \"+c){case \"SET FROM_START\":case \"SET FROM_END\":d=$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case \"SET FIRST\":d=$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case \"SET LAST\":d=\n$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case \"SET RANDOM\":d=$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case \"INSERT FROM_START\":case \"INSERT FROM_END\":d=$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case \"INSERT FIRST\":d=$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case \"INSERT LAST\":d=$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case \"INSERT RANDOM\":d=\n$.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}if(\"FROM_START\"===c||\"FROM_END\"===c)d+=\"  \"+$.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace(\"%1\",this.workspace.options.oneBasedIndex?\"#1\":\"#0\");return d})},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\"),b=this.getInput(\"AT\")instanceof $.ValueInput$$module$build$src$core$inputs$value_input;a.setAttribute(\"at\",String(b));return a},domToMutation:function(a){a=\n\"false\"!==a.getAttribute(\"at\");this.updateAt_(a)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(a){this.removeInput(\"AT\");this.removeInput(\"ORDINAL\",!0);a?(this.appendValueInput(\"AT\").setCheck(\"Number\"),$.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput(\"ORDINAL\").appendField($.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput(\"AT\");const b=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",\noptions:this.WHERE_OPTIONS});b.setValidator(function(c){const d=\"FROM_START\"===c||\"FROM_END\"===c;if(d!==a){const e=this.getSourceBlock();e.updateAt_(d);e.setFieldValue(c,\"WHERE\");return null}});this.moveInputBefore(\"AT\",\"TO\");this.getInput(\"ORDINAL\")&&this.moveInputBefore(\"ORDINAL\",\"TO\");this.getInput(\"AT\").appendField(b,\"WHERE\")}};blocks$$module$build$src$blocks$lists.lists_setIndex=LISTS_SETINDEX$$module$build$src$blocks$lists;\nvar LISTS_GETSUBLIST$$module$build$src$blocks$lists={init:function(){this.WHERE_OPTIONS_1=[[$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,\"FROM_START\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,\"FROM_END\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,\"FIRST\"]];this.WHERE_OPTIONS_2=[[$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,\"FROM_START\"],[$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,\"FROM_END\"],\n[$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,\"LAST\"]];this.setHelpUrl($.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL);this.setStyle(\"list_blocks\");this.appendValueInput(\"LIST\").setCheck(\"Array\").appendField($.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);this.appendDummyInput(\"AT1\");this.appendDummyInput(\"AT2\");$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput(\"TAIL\").appendField($.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL);\nthis.setInputsInline(!0);this.setOutput(!0,\"Array\");this.updateAt_(1,!0);this.updateAt_(2,!0);this.setTooltip($.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");var b=this.getInput(\"AT1\")instanceof $.ValueInput$$module$build$src$core$inputs$value_input;a.setAttribute(\"at1\",String(b));b=this.getInput(\"AT2\")instanceof $.ValueInput$$module$build$src$core$inputs$value_input;a.setAttribute(\"at2\",String(b));\nreturn a},domToMutation:function(a){const b=\"true\"===a.getAttribute(\"at1\");a=\"true\"===a.getAttribute(\"at2\");this.updateAt_(1,b);this.updateAt_(2,a)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(a,b){this.removeInput(\"AT\"+a);this.removeInput(\"ORDINAL\"+a,!0);b?(this.appendValueInput(\"AT\"+a).setCheck(\"Number\"),$.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput(\"ORDINAL\"+a).appendField($.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):\nthis.appendDummyInput(\"AT\"+a);const c=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:this[\"WHERE_OPTIONS_\"+a]});c.setValidator(function(d){const e=\"FROM_START\"===d||\"FROM_END\"===d;if(e!==b){const f=this.getSourceBlock();f.updateAt_(a,e);f.setFieldValue(d,\"WHERE\"+a);return null}});this.getInput(\"AT\"+a).appendField(c,\"WHERE\"+a);1===a&&(this.moveInputBefore(\"AT1\",\"AT2\"),this.getInput(\"ORDINAL1\")&&this.moveInputBefore(\"ORDINAL1\",\"AT2\"));$.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&\nthis.moveInputBefore(\"TAIL\",null)}};blocks$$module$build$src$blocks$lists.lists_getSublist=LISTS_GETSUBLIST$$module$build$src$blocks$lists;\nblocks$$module$build$src$blocks$lists.lists_sort={init:function(){this.jsonInit({message0:\"%{BKY_LISTS_SORT_TITLE}\",args0:[{type:\"field_dropdown\",name:\"TYPE\",options:[[\"%{BKY_LISTS_SORT_TYPE_NUMERIC}\",\"NUMERIC\"],[\"%{BKY_LISTS_SORT_TYPE_TEXT}\",\"TEXT\"],[\"%{BKY_LISTS_SORT_TYPE_IGNORECASE}\",\"IGNORE_CASE\"]]},{type:\"field_dropdown\",name:\"DIRECTION\",options:[[\"%{BKY_LISTS_SORT_ORDER_ASCENDING}\",\"1\"],[\"%{BKY_LISTS_SORT_ORDER_DESCENDING}\",\"-1\"]]},{type:\"input_value\",name:\"LIST\",check:\"Array\"}],output:\"Array\",\nstyle:\"list_blocks\",tooltip:\"%{BKY_LISTS_SORT_TOOLTIP}\",helpUrl:\"%{BKY_LISTS_SORT_HELPURL}\"})}};\nblocks$$module$build$src$blocks$lists.lists_split={init:function(){const a=$.fromJson$$module$build$src$core$field_registry({type:\"field_dropdown\",options:[[$.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,\"SPLIT\"],[$.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,\"JOIN\"]]});if(!a)throw Error(\"field_dropdown not found\");a.setValidator(b=>{this.updateType_(b)});this.setHelpUrl($.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL);this.setStyle(\"list_blocks\");this.appendValueInput(\"INPUT\").setCheck(\"String\").appendField(a,\n\"MODE\");this.appendValueInput(\"DELIM\").setCheck(\"String\").appendField($.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER);this.setInputsInline(!0);this.setOutput(!0,\"Array\");this.setTooltip(()=>{const b=this.getFieldValue(\"MODE\");if(\"SPLIT\"===b)return $.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if(\"JOIN\"===b)return $.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error(\"Unknown mode: \"+b);})},updateType_:function(a){if(this.getFieldValue(\"MODE\")!==a){const b=\nthis.getInput(\"INPUT\").connection;b.setShadowDom(null);const c=b.targetBlock();c&&(b.disconnect(),c.isShadow()?c.dispose(!1):this.bumpNeighbours())}\"SPLIT\"===a?(this.outputConnection.setCheck(\"Array\"),this.getInput(\"INPUT\").setCheck(\"String\")):(this.outputConnection.setCheck(\"String\"),this.getInput(\"INPUT\").setCheck(\"Array\"))},mutationToDom:function(){const a=$.createElement$$module$build$src$core$utils$xml(\"mutation\");a.setAttribute(\"mode\",this.getFieldValue(\"MODE\"));return a},domToMutation:function(a){this.updateType_(a.getAttribute(\"mode\"))},\nsaveExtraState:function(){return null},loadExtraState:function(){}};$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$lists);var module$build$src$blocks$lists={blocks:blocks$$module$build$src$blocks$lists};var blocks$$module$build$src$blocks$colour=$.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:\"colour_picker\",message0:\"%1\",args0:[{type:\"field_colour\",name:\"COLOUR\",colour:\"#ff0000\"}],output:\"Colour\",helpUrl:\"%{BKY_COLOUR_PICKER_HELPURL}\",style:\"colour_blocks\",tooltip:\"%{BKY_COLOUR_PICKER_TOOLTIP}\",extensions:[\"parent_tooltip_when_inline\"]},{type:\"colour_random\",message0:\"%{BKY_COLOUR_RANDOM_TITLE}\",output:\"Colour\",helpUrl:\"%{BKY_COLOUR_RANDOM_HELPURL}\",style:\"colour_blocks\",\ntooltip:\"%{BKY_COLOUR_RANDOM_TOOLTIP}\"},{type:\"colour_rgb\",message0:\"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3\",args0:[{type:\"input_value\",name:\"RED\",check:\"Number\",align:\"RIGHT\"},{type:\"input_value\",name:\"GREEN\",check:\"Number\",align:\"RIGHT\"},{type:\"input_value\",name:\"BLUE\",check:\"Number\",align:\"RIGHT\"}],output:\"Colour\",helpUrl:\"%{BKY_COLOUR_RGB_HELPURL}\",style:\"colour_blocks\",tooltip:\"%{BKY_COLOUR_RGB_TOOLTIP}\"},{type:\"colour_blend\",message0:\"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3\",\nargs0:[{type:\"input_value\",name:\"COLOUR1\",check:\"Colour\",align:\"RIGHT\"},{type:\"input_value\",name:\"COLOUR2\",check:\"Colour\",align:\"RIGHT\"},{type:\"input_value\",name:\"RATIO\",check:\"Number\",align:\"RIGHT\"}],output:\"Colour\",helpUrl:\"%{BKY_COLOUR_BLEND_HELPURL}\",style:\"colour_blocks\",tooltip:\"%{BKY_COLOUR_BLEND_TOOLTIP}\"}]);$.defineBlocks$$module$build$src$core$common(blocks$$module$build$src$blocks$colour);var module$build$src$blocks$colour={blocks:blocks$$module$build$src$blocks$colour};var blocks$$module$build$src$blocks$blocks=Object.assign({},blocks$$module$build$src$blocks$colour,blocks$$module$build$src$blocks$lists,blocks$$module$build$src$blocks$logic,blocks$$module$build$src$blocks$loops,blocks$$module$build$src$blocks$math,blocks$$module$build$src$blocks$procedures,blocks$$module$build$src$blocks$variables,blocks$$module$build$src$blocks$variables_dynamic),module$build$src$blocks$blocks={blocks:blocks$$module$build$src$blocks$blocks,colour:module$build$src$blocks$colour,\nlists:module$build$src$blocks$lists,loops:module$build$src$blocks$loops,math:module$build$src$blocks$math,procedures:module$build$src$blocks$procedures,texts:module$build$src$blocks$text,variables:module$build$src$blocks$variables,variablesDynamic:module$build$src$blocks$variables_dynamic};\nmodule$build$src$blocks$blocks.__namespace__=$;\nreturn module$build$src$blocks$blocks;\n}));\n\n\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/blocks_compressed.js?");

/***/ }),

/***/ "./node_modules/blockly/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/blockly/browser.js ***!
  \*****************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./core-browser */ \"./node_modules/blockly/core-browser.js\"), __webpack_require__(/*! ./msg/en */ \"./node_modules/blockly/msg/en.js\"), __webpack_require__(/*! ./blocks */ \"./node_modules/blockly/blocks.js\"), __webpack_require__(/*! ./javascript */ \"./node_modules/blockly/javascript.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(Blockly, En, BlocklyBlocks, BlocklyJS) {\n/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly module for the browser. This includes Blockly core\n * and built in blocks, the JavaScript code generator and the English block\n * localization files.\n */\n\n/* eslint-disable */\n'use strict';\n\n// Include the EN Locale by default.\nBlockly.setLocale(En);\n\nreturn Blockly;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/browser.js?");

/***/ }),

/***/ "./node_modules/blockly/core-browser.js":
/*!**********************************************!*\
  !*** ./node_modules/blockly/core-browser.js ***!
  \**********************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./blockly */ \"./node_modules/blockly/blockly.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(Blockly) {\n/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly core module for the browser. It includes blockly.js\n *               and adds a helper method for setting the locale.\n */\n\n/* eslint-disable */\n'use strict';\n\nreturn Blockly;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/core-browser.js?");

/***/ }),

/***/ "./node_modules/blockly/index.js":
/*!***************************************!*\
  !*** ./node_modules/blockly/index.js ***!
  \***************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./browser */ \"./node_modules/blockly/browser.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(Blockly) {\n/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Blockly module; this is a wrapper which selects\n *     either browser.js or node.js, depending on which environment we\n *     are running in.\n */\n\nreturn Blockly;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/index.js?");

/***/ }),

/***/ "./node_modules/blockly/javascript.js":
/*!********************************************!*\
  !*** ./node_modules/blockly/javascript.js ***!
  \********************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./core */ \"./node_modules/blockly/core-browser.js\"), __webpack_require__(/*! ./javascript_compressed.js */ \"./node_modules/blockly/javascript_compressed.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(Blockly, BlocklyJavaScript) {\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview JavaScript Generator module; just a wrapper for\n *     javascript_compressed.js.\n */\n\nreturn BlocklyJavaScript;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/javascript.js?");

/***/ }),

/***/ "./node_modules/blockly/javascript_compressed.js":
/*!*******************************************************!*\
  !*** ./node_modules/blockly/javascript_compressed.js ***!
  \*******************************************************/
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// Do not edit this file; automatically generated.\n\n/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./blockly_compressed.js */ \"./node_modules/blockly/blockly_compressed.js\")], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n}(this, function(__parent__) {\nvar $=__parent__.__namespace__;\nvar colour_picker$$module$build$src$generators$javascript$colour=function(a,b){return[b.quote_(a.getFieldValue(\"COLOUR\")),Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},colour_random$$module$build$src$generators$javascript$colour=function(a,b){return[b.provideFunction_(\"colourRandom\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}() {\n  var num = Math.floor(Math.random() * Math.pow(2, 24));\n  return '#' + ('00000' + num.toString(16)).substr(-6);\n}\n`)+\"()\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},colour_rgb$$module$build$src$generators$javascript$colour=function(a,b){const c=b.valueToCode(a,\"RED\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||0,d=b.valueToCode(a,\"GREEN\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||0;a=b.valueToCode(a,\"BLUE\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||0;return[b.provideFunction_(\"colourRgb\",\n`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {\n  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;\n  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;\n  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;\n  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);\n  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);\n  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n`)+\"(\"+c+\", \"+d+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},colour_blend$$module$build$src$generators$javascript$colour=function(a,b){const c=b.valueToCode(a,\"COLOUR1\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"'#000000'\",d=b.valueToCode(a,\"COLOUR2\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"'#000000'\";a=b.valueToCode(a,\"RATIO\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\n.5;return[b.provideFunction_(\"colourBlend\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {\n  ratio = Math.max(Math.min(Number(ratio), 1), 0);\n  var r1 = parseInt(c1.substring(1, 3), 16);\n  var g1 = parseInt(c1.substring(3, 5), 16);\n  var b1 = parseInt(c1.substring(5, 7), 16);\n  var r2 = parseInt(c2.substring(1, 3), 16);\n  var g2 = parseInt(c2.substring(3, 5), 16);\n  var b2 = parseInt(c2.substring(5, 7), 16);\n  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);\n  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);\n  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);\n  r = ('0' + (r || 0).toString(16)).slice(-2);\n  g = ('0' + (g || 0).toString(16)).slice(-2);\n  b = ('0' + (b || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n`)+\"(\"+c+\", \"+d+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},lists_create_empty$$module$build$src$generators$javascript$lists=function(a,b){return[\"[]\",Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},lists_create_with$$module$build$src$generators$javascript$lists=function(a,b){const c=Array(a.itemCount_);for(let d=0;d<a.itemCount_;d++)c[d]=b.valueToCode(a,\"ADD\"+d,Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\n\"null\";return[\"[\"+c.join(\", \")+\"]\",Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},lists_repeat$$module$build$src$generators$javascript$lists=function(a,b){const c=b.provideFunction_(\"listsRepeat\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(value, n) {\n  var array = [];\n  for (var i = 0; i < n; i++) {\n    array[i] = value;\n  }\n  return array;\n}\n`),d=b.valueToCode(a,\"ITEM\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"null\";a=b.valueToCode(a,\"NUM\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\";return[c+\"(\"+d+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},lists_length$$module$build$src$generators$javascript$lists=function(a,b){return[(b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\n\"[]\")+\".length\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER]},lists_isEmpty$$module$build$src$generators$javascript$lists=function(a,b){return[\"!\"+(b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"[]\")+\".length\",Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_NOT]},lists_indexOf$$module$build$src$generators$javascript$lists=function(a,b){const c=\"FIRST\"===a.getFieldValue(\"END\")?\"indexOf\":\"lastIndexOf\",\nd=b.valueToCode(a,\"FIND\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";b=(b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"[]\")+\".\"+c+\"(\"+d+\")\";return a.workspace.options.oneBasedIndex?[b+\" + 1\",Order$$module$build$src$generators$javascript$javascript_generator.ADDITION]:[b,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},lists_getIndex$$module$build$src$generators$javascript$lists=\nfunction(a,b){const c=a.getFieldValue(\"MODE\")||\"GET\",d=a.getFieldValue(\"WHERE\")||\"FROM_START\";var e=b.valueToCode(a,\"VALUE\",\"RANDOM\"===d?Order$$module$build$src$generators$javascript$javascript_generator.NONE:Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"[]\";switch(d){case \"FIRST\":if(\"GET\"===c)return[e+\"[0]\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER];if(\"GET_REMOVE\"===c)return[e+\".shift()\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER];\nif(\"REMOVE\"===c)return e+\".shift();\\n\";break;case \"LAST\":if(\"GET\"===c)return[e+\".slice(-1)[0]\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER];if(\"GET_REMOVE\"===c)return[e+\".pop()\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER];if(\"REMOVE\"===c)return e+\".pop();\\n\";break;case \"FROM_START\":a=b.getAdjusted(a,\"AT\");if(\"GET\"===c)return[e+\"[\"+a+\"]\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER];if(\"GET_REMOVE\"===c)return[e+\n\".splice(\"+a+\", 1)[0]\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];if(\"REMOVE\"===c)return e+\".splice(\"+a+\", 1);\\n\";break;case \"FROM_END\":a=b.getAdjusted(a,\"AT\",1,!0);if(\"GET\"===c)return[e+\".slice(\"+a+\")[0]\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];if(\"GET_REMOVE\"===c)return[e+\".splice(\"+a+\", 1)[0]\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];if(\"REMOVE\"===c)return e+\".splice(\"+a+\", 1);\";\nbreak;case \"RANDOM\":e=b.provideFunction_(\"listsGetRandomItem\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {\n  var x = Math.floor(Math.random() * list.length);\n  if (remove) {\n    return list.splice(x, 1)[0];\n  } else {\n    return list[x];\n  }\n}\n`)+\"(\"+e+\", \"+(\"GET\"!==c)+\")\";if(\"GET\"===c||\"GET_REMOVE\"===c)return[e,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];if(\"REMOVE\"===c)return e+\";\\n\"}throw Error(\"Unhandled combination (lists_getIndex).\");},lists_setIndex$$module$build$src$generators$javascript$lists=function(a,b){function c(){if(d.match(/^\\w+$/))return\"\";const h=b.nameDB_.getDistinctName(\"tmpList\",$.NameType$$module$build$src$core$names.VARIABLE),k=\"var \"+h+\" = \"+d+\";\\n\";d=h;return k}let d=b.valueToCode(a,\n\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"[]\";const e=a.getFieldValue(\"MODE\")||\"GET\";var f=a.getFieldValue(\"WHERE\")||\"FROM_START\";const g=b.valueToCode(a,\"TO\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"null\";switch(f){case \"FIRST\":if(\"SET\"===e)return d+\"[0] = \"+g+\";\\n\";if(\"INSERT\"===e)return d+\".unshift(\"+g+\");\\n\";break;case \"LAST\":if(\"SET\"===e)return c()+(d+\"[\"+d+\".length - 1] = \"+g+\";\\n\");if(\"INSERT\"===e)return d+\".push(\"+\ng+\");\\n\";break;case \"FROM_START\":a=b.getAdjusted(a,\"AT\");if(\"SET\"===e)return d+\"[\"+a+\"] = \"+g+\";\\n\";if(\"INSERT\"===e)return d+\".splice(\"+a+\", 0, \"+g+\");\\n\";break;case \"FROM_END\":a=b.getAdjusted(a,\"AT\",1,!1,Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION);f=c();if(\"SET\"===e)return f+(d+\"[\"+d+\".length - \"+a+\"] = \"+g+\";\\n\");if(\"INSERT\"===e)return f+(d+\".splice(\"+d+\".length - \"+a+\", 0, \"+g+\");\\n\");break;case \"RANDOM\":a=c();f=b.nameDB_.getDistinctName(\"tmpX\",$.NameType$$module$build$src$core$names.VARIABLE);\na+=\"var \"+f+\" = Math.floor(Math.random() * \"+d+\".length);\\n\";if(\"SET\"===e)return a+(d+\"[\"+f+\"] = \"+g+\";\\n\");if(\"INSERT\"===e)return a+(d+\".splice(\"+f+\", 0, \"+g+\");\\n\")}throw Error(\"Unhandled combination (lists_setIndex).\");},lists_getSublist$$module$build$src$generators$javascript$lists=function(a,b){var c={FIRST:\"First\",LAST:\"Last\",FROM_START:\"FromStart\",FROM_END:\"FromEnd\"},d=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"[]\";const e=a.getFieldValue(\"WHERE1\"),\nf=a.getFieldValue(\"WHERE2\");if(\"FIRST\"===e&&\"LAST\"===f)d+=\".slice(0)\";else if(d.match(/^\\w+$/)||\"FROM_END\"!==e&&\"FROM_START\"===f){switch(e){case \"FROM_START\":c=b.getAdjusted(a,\"AT1\");break;case \"FROM_END\":c=b.getAdjusted(a,\"AT1\",1,!1,Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION);c=d+\".length - \"+c;break;case \"FIRST\":c=\"0\";break;default:throw Error(\"Unhandled option (lists_getSublist).\");}switch(f){case \"FROM_START\":b=b.getAdjusted(a,\"AT2\",1);break;case \"FROM_END\":b=\nb.getAdjusted(a,\"AT2\",0,!1,Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION);b=d+\".length - \"+b;break;case \"LAST\":b=d+\".length\";break;default:throw Error(\"Unhandled option (lists_getSublist).\");}d=d+\".slice(\"+c+\", \"+b+\")\"}else{const g=b.getAdjusted(a,\"AT1\");a=b.getAdjusted(a,\"AT2\");d=b.provideFunction_(\"subsequence\"+c[e]+c[f],`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(sequence${\"FROM_END\"===e||\"FROM_START\"===e?\", at1\":\"\"}${\"FROM_END\"===f||\"FROM_START\"===f?\", at2\":\"\"}) {\n  var start = ${getSubstringIndex$$module$build$src$generators$javascript$lists(\"sequence\",e,\"at1\")};\n  var end = ${getSubstringIndex$$module$build$src$generators$javascript$lists(\"sequence\",f,\"at2\")} + 1;\n  return sequence.slice(start, end);\n}\n`)+\"(\"+d+(\"FROM_END\"===e||\"FROM_START\"===e?\", \"+g:\"\")+(\"FROM_END\"===f||\"FROM_START\"===f?\", \"+a:\"\")+\")\"}return[d,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},lists_sort$$module$build$src$generators$javascript$lists=function(a,b){const c=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL)||\"[]\",d=\"1\"===a.getFieldValue(\"DIRECTION\")?1:-1;a=a.getFieldValue(\"TYPE\");b=b.provideFunction_(\"listsGetSortCompare\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {\n  var compareFuncs = {\n    'NUMERIC': function(a, b) {\n        return Number(a) - Number(b); },\n    'TEXT': function(a, b) {\n        return String(a) > String(b) ? 1 : -1; },\n    'IGNORE_CASE': function(a, b) {\n        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },\n  };\n  var compare = compareFuncs[type];\n  return function(a, b) { return compare(a, b) * direction; };\n}\n      `);return[c+\".slice().sort(\"+b+'(\"'+a+'\", '+d+\"))\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},lists_split$$module$build$src$generators$javascript$lists=function(a,b){let c=b.valueToCode(a,\"INPUT\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER);b=b.valueToCode(a,\"DELIM\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";a=a.getFieldValue(\"MODE\");if(\"SPLIT\"===a)c||(c=\"''\"),a=\"split\";else if(\"JOIN\"===\na)c||(c=\"[]\"),a=\"join\";else throw Error(\"Unknown mode: \"+a);return[c+\".\"+a+\"(\"+b+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},lists_reverse$$module$build$src$generators$javascript$lists=function(a,b){return[(b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL)||\"[]\")+\".slice().reverse()\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},controls_if$$module$build$src$generators$javascript$logic=\nfunction(a,b){var c=0;let d=\"\";b.STATEMENT_PREFIX&&(d+=b.injectId(b.STATEMENT_PREFIX,a));do{const e=b.valueToCode(a,\"IF\"+c,Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"false\";let f=b.statementToCode(a,\"DO\"+c);b.STATEMENT_SUFFIX&&(f=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,a),b.INDENT)+f);d+=(0<c?\" else \":\"\")+\"if (\"+e+\") {\\n\"+f+\"}\";c++}while(a.getInput(\"IF\"+c));if(a.getInput(\"ELSE\")||b.STATEMENT_SUFFIX)c=b.statementToCode(a,\"ELSE\"),b.STATEMENT_SUFFIX&&(c=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,\na),b.INDENT)+c),d+=\" else {\\n\"+c+\"}\";return d+\"\\n\"},logic_compare$$module$build$src$generators$javascript$logic=function(a,b){const c={EQ:\"==\",NEQ:\"!=\",LT:\"<\",LTE:\"<=\",GT:\">\",GTE:\">=\"}[a.getFieldValue(\"OP\")],d=\"==\"===c||\"!=\"===c?Order$$module$build$src$generators$javascript$javascript_generator.EQUALITY:Order$$module$build$src$generators$javascript$javascript_generator.RELATIONAL,e=b.valueToCode(a,\"A\",d)||\"0\";a=b.valueToCode(a,\"B\",d)||\"0\";return[e+\" \"+c+\" \"+a,d]},logic_operation$$module$build$src$generators$javascript$logic=\nfunction(a,b){const c=\"AND\"===a.getFieldValue(\"OP\")?\"&&\":\"||\",d=\"&&\"===c?Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_AND:Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_OR;let e=b.valueToCode(a,\"A\",d);a=b.valueToCode(a,\"B\",d);e||a?(b=\"&&\"===c?\"true\":\"false\",e||(e=b),a||(a=b)):a=e=\"false\";return[e+\" \"+c+\" \"+a,d]},logic_negate$$module$build$src$generators$javascript$logic=function(a,b){const c=Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_NOT;\nreturn[\"!\"+(b.valueToCode(a,\"BOOL\",c)||\"true\"),c]},logic_boolean$$module$build$src$generators$javascript$logic=function(a,b){return[\"TRUE\"===a.getFieldValue(\"BOOL\")?\"true\":\"false\",Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},logic_null$$module$build$src$generators$javascript$logic=function(a,b){return[\"null\",Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},logic_ternary$$module$build$src$generators$javascript$logic=function(a,b){const c=b.valueToCode(a,\n\"IF\",Order$$module$build$src$generators$javascript$javascript_generator.CONDITIONAL)||\"false\",d=b.valueToCode(a,\"THEN\",Order$$module$build$src$generators$javascript$javascript_generator.CONDITIONAL)||\"null\";a=b.valueToCode(a,\"ELSE\",Order$$module$build$src$generators$javascript$javascript_generator.CONDITIONAL)||\"null\";return[c+\" ? \"+d+\" : \"+a,Order$$module$build$src$generators$javascript$javascript_generator.CONDITIONAL]},controls_repeat_ext$$module$build$src$generators$javascript$loops=function(a,\nb){let c;c=a.getField(\"TIMES\")?String(Number(a.getFieldValue(\"TIMES\"))):b.valueToCode(a,\"TIMES\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"0\";let d=b.statementToCode(a,\"DO\");d=b.addLoopTrap(d,a);a=\"\";const e=b.nameDB_.getDistinctName(\"count\",$.NameType$$module$build$src$core$names.VARIABLE);let f=c;c.match(/^\\w+$/)||$.isNumber$$module$build$src$core$utils$string(c)||(f=b.nameDB_.getDistinctName(\"repeat_end\",$.NameType$$module$build$src$core$names.VARIABLE),a+=\n\"var \"+f+\" = \"+c+\";\\n\");return a+(\"for (var \"+e+\" = 0; \"+e+\" < \"+f+\"; \"+e+\"++) {\\n\"+d+\"}\\n\")},controls_whileUntil$$module$build$src$generators$javascript$loops=function(a,b){const c=\"UNTIL\"===a.getFieldValue(\"MODE\");let d=b.valueToCode(a,\"BOOL\",c?Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_NOT:Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"false\",e=b.statementToCode(a,\"DO\");e=b.addLoopTrap(e,a);c&&(d=\"!\"+d);return\"while (\"+d+\") {\\n\"+e+\"}\\n\"},\ncontrols_for$$module$build$src$generators$javascript$loops=function(a,b){var c=b.getVariableName(a.getFieldValue(\"VAR\")),d=b.valueToCode(a,\"FROM\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"0\",e=b.valueToCode(a,\"TO\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"0\";const f=b.valueToCode(a,\"BY\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"1\";let g=b.statementToCode(a,\"DO\");g=b.addLoopTrap(g,a);\nif($.isNumber$$module$build$src$core$utils$string(d)&&$.isNumber$$module$build$src$core$utils$string(e)&&$.isNumber$$module$build$src$core$utils$string(f))b=Number(d)<=Number(e),a=\"for (\"+c+\" = \"+d+\"; \"+c+(b?\" <= \":\" >= \")+e+\"; \"+c,c=Math.abs(Number(f)),a=1===c?a+(b?\"++\":\"--\"):a+((b?\" += \":\" -= \")+c),a+=\") {\\n\"+g+\"}\\n\";else{a=\"\";let h=d;d.match(/^\\w+$/)||$.isNumber$$module$build$src$core$utils$string(d)||(h=b.nameDB_.getDistinctName(c+\"_start\",$.NameType$$module$build$src$core$names.VARIABLE),a+=\n\"var \"+h+\" = \"+d+\";\\n\");d=e;e.match(/^\\w+$/)||$.isNumber$$module$build$src$core$utils$string(e)||(d=b.nameDB_.getDistinctName(c+\"_end\",$.NameType$$module$build$src$core$names.VARIABLE),a+=\"var \"+d+\" = \"+e+\";\\n\");e=b.nameDB_.getDistinctName(c+\"_inc\",$.NameType$$module$build$src$core$names.VARIABLE);a+=\"var \"+e+\" = \";a=$.isNumber$$module$build$src$core$utils$string(f)?a+(Math.abs(Number(f))+\";\\n\"):a+(\"Math.abs(\"+f+\");\\n\");a+=\"if (\"+h+\" > \"+d+\") {\\n\";a+=b.INDENT+e+\" = -\"+e+\";\\n\";a=a+\"}\\nfor (\"+(c+\" = \"+\nh+\"; \"+e+\" >= 0 ? \"+c+\" <= \"+d+\" : \"+c+\" >= \"+d+\"; \"+c+\" += \"+e+\") {\\n\"+g+\"}\\n\")}return a},controls_forEach$$module$build$src$generators$javascript$loops=function(a,b){const c=b.getVariableName(a.getFieldValue(\"VAR\"));var d=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"[]\";let e=b.statementToCode(a,\"DO\");e=b.addLoopTrap(e,a);a=\"\";let f=d;d.match(/^\\w+$/)||(f=b.nameDB_.getDistinctName(c+\"_list\",$.NameType$$module$build$src$core$names.VARIABLE),\na+=\"var \"+f+\" = \"+d+\";\\n\");d=b.nameDB_.getDistinctName(c+\"_index\",$.NameType$$module$build$src$core$names.VARIABLE);e=b.INDENT+c+\" = \"+f+\"[\"+d+\"];\\n\"+e;return a+(\"for (var \"+d+\" in \"+f+\") {\\n\"+e+\"}\\n\")},controls_flow_statements$$module$build$src$generators$javascript$loops=function(a,b){let c=\"\";b.STATEMENT_PREFIX&&(c+=b.injectId(b.STATEMENT_PREFIX,a));b.STATEMENT_SUFFIX&&(c+=b.injectId(b.STATEMENT_SUFFIX,a));if(b.STATEMENT_PREFIX){const d=a.getSurroundLoop();d&&!d.suppressPrefixSuffix&&(c+=b.injectId(b.STATEMENT_PREFIX,\nd))}switch(a.getFieldValue(\"FLOW\")){case \"BREAK\":return c+\"break;\\n\";case \"CONTINUE\":return c+\"continue;\\n\"}throw Error(\"Unknown flow statement.\");},math_number$$module$build$src$generators$javascript$math=function(a,b){a=Number(a.getFieldValue(\"NUM\"));return[String(a),0<=a?Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC:Order$$module$build$src$generators$javascript$javascript_generator.UNARY_NEGATION]},math_arithmetic$$module$build$src$generators$javascript$math=function(a,\nb){var c={ADD:[\" + \",Order$$module$build$src$generators$javascript$javascript_generator.ADDITION],MINUS:[\" - \",Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION],MULTIPLY:[\" * \",Order$$module$build$src$generators$javascript$javascript_generator.MULTIPLICATION],DIVIDE:[\" / \",Order$$module$build$src$generators$javascript$javascript_generator.DIVISION],POWER:[null,Order$$module$build$src$generators$javascript$javascript_generator.NONE]}[a.getFieldValue(\"OP\")];const d=c[0];\nc=c[1];const e=b.valueToCode(a,\"A\",c)||\"0\";a=b.valueToCode(a,\"B\",c)||\"0\";return d?[e+d+a,c]:[\"Math.pow(\"+e+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},math_single$$module$build$src$generators$javascript$math=function(a,b){const c=a.getFieldValue(\"OP\");let d;if(\"NEG\"===c)return a=b.valueToCode(a,\"NUM\",Order$$module$build$src$generators$javascript$javascript_generator.UNARY_NEGATION)||\"0\",\"-\"===a[0]&&(a=\" \"+a),[\"-\"+a,Order$$module$build$src$generators$javascript$javascript_generator.UNARY_NEGATION];\na=\"SIN\"===c||\"COS\"===c||\"TAN\"===c?b.valueToCode(a,\"NUM\",Order$$module$build$src$generators$javascript$javascript_generator.DIVISION)||\"0\":b.valueToCode(a,\"NUM\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\";switch(c){case \"ABS\":d=\"Math.abs(\"+a+\")\";break;case \"ROOT\":d=\"Math.sqrt(\"+a+\")\";break;case \"LN\":d=\"Math.log(\"+a+\")\";break;case \"EXP\":d=\"Math.exp(\"+a+\")\";break;case \"POW10\":d=\"Math.pow(10,\"+a+\")\";break;case \"ROUND\":d=\"Math.round(\"+a+\")\";break;case \"ROUNDUP\":d=\"Math.ceil(\"+\na+\")\";break;case \"ROUNDDOWN\":d=\"Math.floor(\"+a+\")\";break;case \"SIN\":d=\"Math.sin(\"+a+\" / 180 * Math.PI)\";break;case \"COS\":d=\"Math.cos(\"+a+\" / 180 * Math.PI)\";break;case \"TAN\":d=\"Math.tan(\"+a+\" / 180 * Math.PI)\"}if(d)return[d,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];switch(c){case \"LOG10\":d=\"Math.log(\"+a+\") / Math.log(10)\";break;case \"ASIN\":d=\"Math.asin(\"+a+\") / Math.PI * 180\";break;case \"ACOS\":d=\"Math.acos(\"+a+\") / Math.PI * 180\";break;case \"ATAN\":d=\"Math.atan(\"+\na+\") / Math.PI * 180\";break;default:throw Error(\"Unknown math operator: \"+c);}return[d,Order$$module$build$src$generators$javascript$javascript_generator.DIVISION]},math_constant$$module$build$src$generators$javascript$math=function(a,b){return{PI:[\"Math.PI\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER],E:[\"Math.E\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER],GOLDEN_RATIO:[\"(1 + Math.sqrt(5)) / 2\",Order$$module$build$src$generators$javascript$javascript_generator.DIVISION],\nSQRT2:[\"Math.SQRT2\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER],SQRT1_2:[\"Math.SQRT1_2\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER],INFINITY:[\"Infinity\",Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]}[a.getFieldValue(\"CONSTANT\")]},math_number_property$$module$build$src$generators$javascript$math=function(a,b){var c={EVEN:[\" % 2 === 0\",Order$$module$build$src$generators$javascript$javascript_generator.MODULUS,\nOrder$$module$build$src$generators$javascript$javascript_generator.EQUALITY],ODD:[\" % 2 === 1\",Order$$module$build$src$generators$javascript$javascript_generator.MODULUS,Order$$module$build$src$generators$javascript$javascript_generator.EQUALITY],WHOLE:[\" % 1 === 0\",Order$$module$build$src$generators$javascript$javascript_generator.MODULUS,Order$$module$build$src$generators$javascript$javascript_generator.EQUALITY],POSITIVE:[\" > 0\",Order$$module$build$src$generators$javascript$javascript_generator.RELATIONAL,\nOrder$$module$build$src$generators$javascript$javascript_generator.RELATIONAL],NEGATIVE:[\" < 0\",Order$$module$build$src$generators$javascript$javascript_generator.RELATIONAL,Order$$module$build$src$generators$javascript$javascript_generator.RELATIONAL],DIVISIBLE_BY:[null,Order$$module$build$src$generators$javascript$javascript_generator.MODULUS,Order$$module$build$src$generators$javascript$javascript_generator.EQUALITY],PRIME:[null,Order$$module$build$src$generators$javascript$javascript_generator.NONE,\nOrder$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]};const d=a.getFieldValue(\"PROPERTY\"),[e,f,g]=c[d];c=b.valueToCode(a,\"NUMBER_TO_CHECK\",f)||\"0\";\"PRIME\"===d?a=b.provideFunction_(\"mathIsPrime\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(n) {\n  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods\n  if (n == 2 || n == 3) {\n    return true;\n  }\n  // False if n is NaN, negative, is 1, or not whole.\n  // And false if n is divisible by 2 or 3.\n  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {\n    return false;\n  }\n  // Check all the numbers of form 6k +/- 1, up to sqrt(n).\n  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {\n    if (n % (x - 1) === 0 || n % (x + 1) === 0) {\n      return false;\n    }\n  }\n  return true;\n}\n`)+\"(\"+c+\")\":\"DIVISIBLE_BY\"===d?(a=b.valueToCode(a,\"DIVISOR\",Order$$module$build$src$generators$javascript$javascript_generator.MODULUS)||\"0\",a=c+\" % \"+a+\" === 0\"):a=c+e;return[a,g]},math_change$$module$build$src$generators$javascript$math=function(a,b){const c=b.valueToCode(a,\"DELTA\",Order$$module$build$src$generators$javascript$javascript_generator.ADDITION)||\"0\";a=b.getVariableName(a.getFieldValue(\"VAR\"));return a+\" = (typeof \"+a+\" === 'number' ? \"+a+\" : 0) + \"+c+\";\\n\"},math_on_list$$module$build$src$generators$javascript$math=\nfunction(a,b){var c=a.getFieldValue(\"OP\");switch(c){case \"SUM\":a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"[]\";a+=\".reduce(function(x, y) {return x + y;}, 0)\";break;case \"MIN\":a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=\"Math.min.apply(null, \"+a+\")\";break;case \"MAX\":a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=\"Math.max.apply(null, \"+\na+\")\";break;case \"AVERAGE\":c=b.provideFunction_(\"mathMean\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(myList) {\n  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;\n}\n`);a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=c+\"(\"+a+\")\";break;case \"MEDIAN\":c=b.provideFunction_(\"mathMedian\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(myList) {\n  var localList = myList.filter(function (x) {return typeof x === 'number';});\n  if (!localList.length) return null;\n  localList.sort(function(a, b) {return b - a;});\n  if (localList.length % 2 === 0) {\n    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;\n  } else {\n    return localList[(localList.length - 1) / 2];\n  }\n}\n`);a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=c+\"(\"+a+\")\";break;case \"MODE\":c=b.provideFunction_(\"mathModes\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(values) {\n  var modes = [];\n  var counts = [];\n  var maxCount = 0;\n  for (var i = 0; i < values.length; i++) {\n    var value = values[i];\n    var found = false;\n    var thisCount;\n    for (var j = 0; j < counts.length; j++) {\n      if (counts[j][0] === value) {\n        thisCount = ++counts[j][1];\n        found = true;\n        break;\n      }\n    }\n    if (!found) {\n      counts.push([value, 1]);\n      thisCount = 1;\n    }\n    maxCount = Math.max(thisCount, maxCount);\n  }\n  for (var j = 0; j < counts.length; j++) {\n    if (counts[j][1] === maxCount) {\n        modes.push(counts[j][0]);\n    }\n  }\n  return modes;\n}\n`);a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=c+\"(\"+a+\")\";break;case \"STD_DEV\":c=b.provideFunction_(\"mathStandardDeviation\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(numbers) {\n  var n = numbers.length;\n  if (!n) return null;\n  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;\n  var variance = 0;\n  for (var j = 0; j < n; j++) {\n    variance += Math.pow(numbers[j] - mean, 2);\n  }\n  variance = variance / n;\n  return Math.sqrt(variance);\n}\n`);a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=c+\"(\"+a+\")\";break;case \"RANDOM\":c=b.provideFunction_(\"mathRandomList\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(list) {\n  var x = Math.floor(Math.random() * list.length);\n  return list[x];\n}\n`);a=b.valueToCode(a,\"LIST\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"[]\";a=c+\"(\"+a+\")\";break;default:throw Error(\"Unknown operator: \"+c);}return[a,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},math_modulo$$module$build$src$generators$javascript$math=function(a,b){const c=b.valueToCode(a,\"DIVIDEND\",Order$$module$build$src$generators$javascript$javascript_generator.MODULUS)||\"0\";a=b.valueToCode(a,\"DIVISOR\",Order$$module$build$src$generators$javascript$javascript_generator.MODULUS)||\n\"0\";return[c+\" % \"+a,Order$$module$build$src$generators$javascript$javascript_generator.MODULUS]},math_constrain$$module$build$src$generators$javascript$math=function(a,b){const c=b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\",d=b.valueToCode(a,\"LOW\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\";a=b.valueToCode(a,\"HIGH\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"Infinity\";return[\"Math.min(Math.max(\"+\nc+\", \"+d+\"), \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},math_random_int$$module$build$src$generators$javascript$math=function(a,b){const c=b.valueToCode(a,\"FROM\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\";a=b.valueToCode(a,\"TO\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\";return[b.provideFunction_(\"mathRandomInt\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(a, b) {\n  if (a > b) {\n    // Swap a and b to ensure a is smaller.\n    var c = a;\n    a = b;\n    b = c;\n  }\n  return Math.floor(Math.random() * (b - a + 1) + a);\n}\n`)+\"(\"+c+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},math_random_float$$module$build$src$generators$javascript$math=function(a,b){return[\"Math.random()\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},math_atan2$$module$build$src$generators$javascript$math=function(a,b){const c=b.valueToCode(a,\"X\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\";return[\"Math.atan2(\"+(b.valueToCode(a,\"Y\",\nOrder$$module$build$src$generators$javascript$javascript_generator.NONE)||\"0\")+\", \"+c+\") / Math.PI * 180\",Order$$module$build$src$generators$javascript$javascript_generator.DIVISION]},procedures_defreturn$$module$build$src$generators$javascript$procedures=function(a,b){const c=b.getProcedureName(a.getFieldValue(\"NAME\"));var d=\"\";b.STATEMENT_PREFIX&&(d+=b.injectId(b.STATEMENT_PREFIX,a));b.STATEMENT_SUFFIX&&(d+=b.injectId(b.STATEMENT_SUFFIX,a));d&&(d=b.prefixLines(d,b.INDENT));let e=\"\";b.INFINITE_LOOP_TRAP&&\n(e=b.prefixLines(b.injectId(b.INFINITE_LOOP_TRAP,a),b.INDENT));const f=b.statementToCode(a,\"STACK\");let g=b.valueToCode(a,\"RETURN\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"\",h=\"\";f&&g&&(h=d);g&&(g=b.INDENT+\"return \"+g+\";\\n\");const k=[],l=a.getVars();for(let m=0;m<l.length;m++)k[m]=b.getVariableName(l[m]);d=\"function \"+c+\"(\"+k.join(\", \")+\") {\\n\"+d+e+f+h+g+\"}\";d=b.scrub_(a,d);b.definitions_[\"%\"+c]=d;return null},procedures_callreturn$$module$build$src$generators$javascript$procedures=\nfunction(a,b){const c=b.getProcedureName(a.getFieldValue(\"NAME\")),d=[],e=a.getVars();for(let f=0;f<e.length;f++)d[f]=b.valueToCode(a,\"ARG\"+f,Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"null\";return[c+\"(\"+d.join(\", \")+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},procedures_callnoreturn$$module$build$src$generators$javascript$procedures=function(a,b){return b.forBlock.procedures_callreturn(a,b)[0]+\";\\n\"},procedures_ifreturn$$module$build$src$generators$javascript$procedures=\nfunction(a,b){let c=\"if (\"+(b.valueToCode(a,\"CONDITION\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"false\")+\") {\\n\";b.STATEMENT_SUFFIX&&(c+=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,a),b.INDENT));a.hasReturnValue_?(a=b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"null\",c+=b.INDENT+\"return \"+a+\";\\n\"):c+=b.INDENT+\"return;\\n\";return c+\"}\\n\"},text$$module$build$src$generators$javascript$text=function(a,b){return[b.quote_(a.getFieldValue(\"TEXT\")),\nOrder$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},text_multiline$$module$build$src$generators$javascript$text=function(a,b){a=b.multiline_quote_(a.getFieldValue(\"TEXT\"));b=-1!==a.indexOf(\"+\")?Order$$module$build$src$generators$javascript$javascript_generator.ADDITION:Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC;return[a,b]},text_join$$module$build$src$generators$javascript$text=function(a,b){switch(a.itemCount_){case 0:return[\"''\",Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC];\ncase 1:return a=b.valueToCode(a,\"ADD0\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\",forceString$$module$build$src$generators$javascript$text(a);case 2:var c=b.valueToCode(a,\"ADD0\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";a=b.valueToCode(a,\"ADD1\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";return[forceString$$module$build$src$generators$javascript$text(c)[0]+\" + \"+forceString$$module$build$src$generators$javascript$text(a)[0],\nOrder$$module$build$src$generators$javascript$javascript_generator.ADDITION];default:c=Array(a.itemCount_);for(let d=0;d<a.itemCount_;d++)c[d]=b.valueToCode(a,\"ADD\"+d,Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";return[\"[\"+c.join(\",\")+\"].join('')\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]}},text_append$$module$build$src$generators$javascript$text=function(a,b){const c=b.getVariableName(a.getFieldValue(\"VAR\"));a=b.valueToCode(a,\n\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";return c+\" += \"+forceString$$module$build$src$generators$javascript$text(a)[0]+\";\\n\"},text_length$$module$build$src$generators$javascript$text=function(a,b){return[(b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"''\")+\".length\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER]},text_isEmpty$$module$build$src$generators$javascript$text=\nfunction(a,b){return[\"!\"+(b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"''\")+\".length\",Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_NOT]},text_indexOf$$module$build$src$generators$javascript$text=function(a,b){const c=\"FIRST\"===a.getFieldValue(\"END\")?\"indexOf\":\"lastIndexOf\",d=b.valueToCode(a,\"FIND\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";b=(b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\n\"''\")+\".\"+c+\"(\"+d+\")\";return a.workspace.options.oneBasedIndex?[b+\" + 1\",Order$$module$build$src$generators$javascript$javascript_generator.ADDITION]:[b,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},text_charAt$$module$build$src$generators$javascript$text=function(a,b){const c=a.getFieldValue(\"WHERE\")||\"FROM_START\",d=b.valueToCode(a,\"VALUE\",\"RANDOM\"===c?Order$$module$build$src$generators$javascript$javascript_generator.NONE:Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\n\"''\";switch(c){case \"FIRST\":return[d+\".charAt(0)\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];case \"LAST\":return[d+\".slice(-1)\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];case \"FROM_START\":return a=b.getAdjusted(a,\"AT\"),[d+\".charAt(\"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];case \"FROM_END\":return a=b.getAdjusted(a,\"AT\",1,!0),[d+\".slice(\"+a+\").charAt(0)\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL];\ncase \"RANDOM\":return[b.provideFunction_(\"textRandomLetter\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(text) {\n  var x = Math.floor(Math.random() * text.length);\n  return text[x];\n}\n`)+\"(\"+d+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]}throw Error(\"Unhandled option (text_charAt).\");},text_getSubstring$$module$build$src$generators$javascript$text=function(a,b){var c={FIRST:\"First\",LAST:\"Last\",FROM_START:\"FromStart\",FROM_END:\"FromEnd\"};const d=a.getFieldValue(\"WHERE1\"),e=a.getFieldValue(\"WHERE2\");var f=\"FROM_END\"!==d&&\"LAST\"!==d&&\"FROM_END\"!==e&&\"LAST\"!==e,g=b.valueToCode(a,\"STRING\",f?Order$$module$build$src$generators$javascript$javascript_generator.MEMBER:\nOrder$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";if(\"FIRST\"===d&&\"LAST\"===e)return[g,Order$$module$build$src$generators$javascript$javascript_generator.NONE];if(g.match(/^'?\\w+'?$/)||f){switch(d){case \"FROM_START\":c=b.getAdjusted(a,\"AT1\");break;case \"FROM_END\":c=b.getAdjusted(a,\"AT1\",1,!1,Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION);c=g+\".length - \"+c;break;case \"FIRST\":c=\"0\";break;default:throw Error(\"Unhandled option (text_getSubstring).\");\n}switch(e){case \"FROM_START\":b=b.getAdjusted(a,\"AT2\",1);break;case \"FROM_END\":b=b.getAdjusted(a,\"AT2\",0,!1,Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION);b=g+\".length - \"+b;break;case \"LAST\":b=g+\".length\";break;default:throw Error(\"Unhandled option (text_getSubstring).\");}g=g+\".slice(\"+c+\", \"+b+\")\"}else f=b.getAdjusted(a,\"AT1\"),a=b.getAdjusted(a,\"AT2\"),g=b.provideFunction_(\"subsequence\"+c[d]+c[e],`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(sequence${\"FROM_END\"===d||\"FROM_START\"===d?\", at1\":\"\"}${\"FROM_END\"===e||\"FROM_START\"===e?\", at2\":\"\"}) {\n  var start = ${getSubstringIndex$$module$build$src$generators$javascript$text(\"sequence\",d,\"at1\")};\n  var end = ${getSubstringIndex$$module$build$src$generators$javascript$text(\"sequence\",e,\"at2\")} + 1;\n  return sequence.slice(start, end);\n}\n`)+\"(\"+g+(\"FROM_END\"===d||\"FROM_START\"===d?\", \"+f:\"\")+(\"FROM_END\"===e||\"FROM_START\"===e?\", \"+a:\"\")+\")\";return[g,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},text_changeCase$$module$build$src$generators$javascript$text=function(a,b){const c={UPPERCASE:\".toUpperCase()\",LOWERCASE:\".toLowerCase()\",TITLECASE:null}[a.getFieldValue(\"CASE\")];a=b.valueToCode(a,\"TEXT\",c?Order$$module$build$src$generators$javascript$javascript_generator.MEMBER:Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\n\"''\";return[c?a+c:b.provideFunction_(\"textToTitleCase\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(str) {\n  return str.replace(/\\\\S+/g,\n      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});\n}\n`)+\"(\"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},text_trim$$module$build$src$generators$javascript$text=function(a,b){const c={LEFT:\".replace(/^[\\\\s\\\\xa0]+/, '')\",RIGHT:\".replace(/[\\\\s\\\\xa0]+$/, '')\",BOTH:\".trim()\"}[a.getFieldValue(\"MODE\")];return[(b.valueToCode(a,\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"''\")+c,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},text_print$$module$build$src$generators$javascript$text=\nfunction(a,b){return\"window.alert(\"+(b.valueToCode(a,\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\")+\");\\n\"},text_prompt_ext$$module$build$src$generators$javascript$text=function(a,b){b=\"window.prompt(\"+(a.getField(\"TEXT\")?b.quote_(a.getFieldValue(\"TEXT\")):b.valueToCode(a,\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\")+\")\";\"NUMBER\"===a.getFieldValue(\"TYPE\")&&(b=\"Number(\"+b+\")\");return[b,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},\ntext_count$$module$build$src$generators$javascript$text=function(a,b){const c=b.valueToCode(a,\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";a=b.valueToCode(a,\"SUB\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";return[b.provideFunction_(\"textCount\",`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {\n  if (needle.length === 0) {\n    return haystack.length + 1;\n  } else {\n    return haystack.split(needle).length - 1;\n  }\n}\n`)+\"(\"+c+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},text_replace$$module$build$src$generators$javascript$text=function(a,b){const c=b.valueToCode(a,\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\",d=b.valueToCode(a,\"FROM\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";a=b.valueToCode(a,\"TO\",Order$$module$build$src$generators$javascript$javascript_generator.NONE)||\"''\";return[b.provideFunction_(\"textReplace\",\n`\nfunction ${b.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {\n  needle = needle.replace(/([-()\\\\[\\\\]{}+?*.$\\\\^|,:#<!\\\\\\\\])/g, '\\\\\\\\$1')\n                 .replace(/\\\\x08/g, '\\\\\\\\x08');\n  return haystack.replace(new RegExp(needle, 'g'), replacement);\n}\n`)+\"(\"+c+\", \"+d+\", \"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},text_reverse$$module$build$src$generators$javascript$text=function(a,b){return[(b.valueToCode(a,\"TEXT\",Order$$module$build$src$generators$javascript$javascript_generator.MEMBER)||\"''\")+\".split('').reverse().join('')\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},variables_get$$module$build$src$generators$javascript$variables=function(a,b){return[b.getVariableName(a.getFieldValue(\"VAR\")),\nOrder$$module$build$src$generators$javascript$javascript_generator.ATOMIC]},variables_set$$module$build$src$generators$javascript$variables=function(a,b){const c=b.valueToCode(a,\"VALUE\",Order$$module$build$src$generators$javascript$javascript_generator.ASSIGNMENT)||\"0\";return b.getVariableName(a.getFieldValue(\"VAR\"))+\" = \"+c+\";\\n\"},Order$$module$build$src$generators$javascript$javascript_generator;\n(function(a){a[a.ATOMIC=0]=\"ATOMIC\";a[a.NEW=1.1]=\"NEW\";a[a.MEMBER=1.2]=\"MEMBER\";a[a.FUNCTION_CALL=2]=\"FUNCTION_CALL\";a[a.INCREMENT=3]=\"INCREMENT\";a[a.DECREMENT=3]=\"DECREMENT\";a[a.BITWISE_NOT=4.1]=\"BITWISE_NOT\";a[a.UNARY_PLUS=4.2]=\"UNARY_PLUS\";a[a.UNARY_NEGATION=4.3]=\"UNARY_NEGATION\";a[a.LOGICAL_NOT=4.4]=\"LOGICAL_NOT\";a[a.TYPEOF=4.5]=\"TYPEOF\";a[a.VOID=4.6]=\"VOID\";a[a.DELETE=4.7]=\"DELETE\";a[a.AWAIT=4.8]=\"AWAIT\";a[a.EXPONENTIATION=5]=\"EXPONENTIATION\";a[a.MULTIPLICATION=5.1]=\"MULTIPLICATION\";a[a.DIVISION=\n5.2]=\"DIVISION\";a[a.MODULUS=5.3]=\"MODULUS\";a[a.SUBTRACTION=6.1]=\"SUBTRACTION\";a[a.ADDITION=6.2]=\"ADDITION\";a[a.BITWISE_SHIFT=7]=\"BITWISE_SHIFT\";a[a.RELATIONAL=8]=\"RELATIONAL\";a[a.IN=8]=\"IN\";a[a.INSTANCEOF=8]=\"INSTANCEOF\";a[a.EQUALITY=9]=\"EQUALITY\";a[a.BITWISE_AND=10]=\"BITWISE_AND\";a[a.BITWISE_XOR=11]=\"BITWISE_XOR\";a[a.BITWISE_OR=12]=\"BITWISE_OR\";a[a.LOGICAL_AND=13]=\"LOGICAL_AND\";a[a.LOGICAL_OR=14]=\"LOGICAL_OR\";a[a.CONDITIONAL=15]=\"CONDITIONAL\";a[a.ASSIGNMENT=16]=\"ASSIGNMENT\";a[a.YIELD=17]=\"YIELD\";\na[a.COMMA=18]=\"COMMA\";a[a.NONE=99]=\"NONE\"})(Order$$module$build$src$generators$javascript$javascript_generator||(Order$$module$build$src$generators$javascript$javascript_generator={}));\nvar JavascriptGenerator$$module$build$src$generators$javascript$javascript_generator=class extends $.CodeGenerator$$module$build$src$core$generator{constructor(a=\"JavaScript\"){super(a);this.ORDER_OVERRIDES=[[Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL,Order$$module$build$src$generators$javascript$javascript_generator.MEMBER],[Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL],\n[Order$$module$build$src$generators$javascript$javascript_generator.MEMBER,Order$$module$build$src$generators$javascript$javascript_generator.MEMBER],[Order$$module$build$src$generators$javascript$javascript_generator.MEMBER,Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL],[Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_NOT,Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_NOT],[Order$$module$build$src$generators$javascript$javascript_generator.MULTIPLICATION,\nOrder$$module$build$src$generators$javascript$javascript_generator.MULTIPLICATION],[Order$$module$build$src$generators$javascript$javascript_generator.ADDITION,Order$$module$build$src$generators$javascript$javascript_generator.ADDITION],[Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_AND,Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_AND],[Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_OR,Order$$module$build$src$generators$javascript$javascript_generator.LOGICAL_OR]];\nthis.isInitialized=!1;for(const b in Order$$module$build$src$generators$javascript$javascript_generator)a=Order$$module$build$src$generators$javascript$javascript_generator[b],\"string\"!==typeof a&&(this[\"ORDER_\"+b]=a);this.addReservedWords(\"break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,\"+\nObject.getOwnPropertyNames(globalThis).join(\",\"))}init(a){super.init(a);this.nameDB_?this.nameDB_.reset():this.nameDB_=new $.Names$$module$build$src$core$names(this.RESERVED_WORDS_);this.nameDB_.setVariableMap(a.getVariableMap());this.nameDB_.populateVariables(a);this.nameDB_.populateProcedures(a);const b=[];var c=$.allDeveloperVariables$$module$build$src$core$variables(a);for(let d=0;d<c.length;d++)b.push(this.nameDB_.getName(c[d],$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));a=$.allUsedVarModels$$module$build$src$core$variables(a);\nfor(c=0;c<a.length;c++)b.push(this.nameDB_.getName(a[c].getId(),$.NameType$$module$build$src$core$names.VARIABLE));b.length&&(this.definitions_.variables=\"var \"+b.join(\", \")+\";\");this.isInitialized=!0}finish(a){const b=Object.values(this.definitions_);super.finish(a);this.isInitialized=!1;this.nameDB_.reset();return b.join(\"\\n\\n\")+\"\\n\\n\\n\"+a}scrubNakedValue(a){return a+\";\\n\"}quote_(a){a=a.replace(/\\\\/g,\"\\\\\\\\\").replace(/\\n/g,\"\\\\\\n\").replace(/'/g,\"\\\\'\");return\"'\"+a+\"'\"}multiline_quote_(a){return a.split(/\\n/g).map(this.quote_).join(\" + '\\\\n' +\\n\")}scrub_(a,\nb,c=!1){let d=\"\";if(!a.outputConnection||!a.outputConnection.targetConnection){var e=a.getCommentText();e&&(e=$.wrap$$module$build$src$core$utils$string(e,this.COMMENT_WRAP-3),d+=this.prefixLines(e+\"\\n\",\"// \"));for(let f=0;f<a.inputList.length;f++)a.inputList[f].type===$.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(e=a.inputList[f].connection.targetBlock())&&(e=this.allNestedComments(e))&&(d+=this.prefixLines(e,\"// \"))}a=a.nextConnection&&a.nextConnection.targetBlock();c=c?\"\":this.blockToCode(a);\nreturn d+b+c}getAdjusted(a,b,c=0,d=!1,e=Order$$module$build$src$generators$javascript$javascript_generator.NONE){a.workspace.options.oneBasedIndex&&c--;const f=a.workspace.options.oneBasedIndex?\"1\":\"0\";let g=e;0<c?g=Order$$module$build$src$generators$javascript$javascript_generator.ADDITION:0>c?g=Order$$module$build$src$generators$javascript$javascript_generator.SUBTRACTION:d&&(g=Order$$module$build$src$generators$javascript$javascript_generator.UNARY_NEGATION);a=this.valueToCode(a,b,g)||f;if(0===\nc&&!d)return a;if($.isNumber$$module$build$src$core$utils$string(a))return a=String(Number(a)+c),d&&(a=String(-Number(a))),a;0<c?a=`${a} + ${c}`:0>c&&(a=`${a} - ${-c}`);d&&(a=c?`-(${a})`:`-${a}`);Math.floor(e)>=Math.floor(g)&&(a=`(${a})`);return a}},module$build$src$generators$javascript$javascript_generator={};module$build$src$generators$javascript$javascript_generator.JavascriptGenerator=JavascriptGenerator$$module$build$src$generators$javascript$javascript_generator;\nmodule$build$src$generators$javascript$javascript_generator.Order=Order$$module$build$src$generators$javascript$javascript_generator;var module$build$src$generators$javascript$colour={};module$build$src$generators$javascript$colour.colour_blend=colour_blend$$module$build$src$generators$javascript$colour;module$build$src$generators$javascript$colour.colour_picker=colour_picker$$module$build$src$generators$javascript$colour;module$build$src$generators$javascript$colour.colour_random=colour_random$$module$build$src$generators$javascript$colour;module$build$src$generators$javascript$colour.colour_rgb=colour_rgb$$module$build$src$generators$javascript$colour;var getSubstringIndex$$module$build$src$generators$javascript$lists=function(a,b,c){return\"FIRST\"===b?\"0\":\"FROM_END\"===b?a+\".length - 1 - \"+c:\"LAST\"===b?a+\".length - 1\":c},module$build$src$generators$javascript$lists={};module$build$src$generators$javascript$lists.lists_create_empty=lists_create_empty$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_create_with=lists_create_with$$module$build$src$generators$javascript$lists;\nmodule$build$src$generators$javascript$lists.lists_getIndex=lists_getIndex$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_getSublist=lists_getSublist$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_indexOf=lists_indexOf$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_isEmpty=lists_isEmpty$$module$build$src$generators$javascript$lists;\nmodule$build$src$generators$javascript$lists.lists_length=lists_length$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_repeat=lists_repeat$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_reverse=lists_reverse$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_setIndex=lists_setIndex$$module$build$src$generators$javascript$lists;\nmodule$build$src$generators$javascript$lists.lists_sort=lists_sort$$module$build$src$generators$javascript$lists;module$build$src$generators$javascript$lists.lists_split=lists_split$$module$build$src$generators$javascript$lists;var controls_ifelse$$module$build$src$generators$javascript$logic=controls_if$$module$build$src$generators$javascript$logic,module$build$src$generators$javascript$logic={};module$build$src$generators$javascript$logic.controls_if=controls_if$$module$build$src$generators$javascript$logic;module$build$src$generators$javascript$logic.controls_ifelse=controls_if$$module$build$src$generators$javascript$logic;module$build$src$generators$javascript$logic.logic_boolean=logic_boolean$$module$build$src$generators$javascript$logic;\nmodule$build$src$generators$javascript$logic.logic_compare=logic_compare$$module$build$src$generators$javascript$logic;module$build$src$generators$javascript$logic.logic_negate=logic_negate$$module$build$src$generators$javascript$logic;module$build$src$generators$javascript$logic.logic_null=logic_null$$module$build$src$generators$javascript$logic;module$build$src$generators$javascript$logic.logic_operation=logic_operation$$module$build$src$generators$javascript$logic;\nmodule$build$src$generators$javascript$logic.logic_ternary=logic_ternary$$module$build$src$generators$javascript$logic;var controls_repeat$$module$build$src$generators$javascript$loops=controls_repeat_ext$$module$build$src$generators$javascript$loops,module$build$src$generators$javascript$loops={};module$build$src$generators$javascript$loops.controls_flow_statements=controls_flow_statements$$module$build$src$generators$javascript$loops;module$build$src$generators$javascript$loops.controls_for=controls_for$$module$build$src$generators$javascript$loops;module$build$src$generators$javascript$loops.controls_forEach=controls_forEach$$module$build$src$generators$javascript$loops;\nmodule$build$src$generators$javascript$loops.controls_repeat=controls_repeat_ext$$module$build$src$generators$javascript$loops;module$build$src$generators$javascript$loops.controls_repeat_ext=controls_repeat_ext$$module$build$src$generators$javascript$loops;module$build$src$generators$javascript$loops.controls_whileUntil=controls_whileUntil$$module$build$src$generators$javascript$loops;var math_round$$module$build$src$generators$javascript$math=math_single$$module$build$src$generators$javascript$math,math_trig$$module$build$src$generators$javascript$math=math_single$$module$build$src$generators$javascript$math,module$build$src$generators$javascript$math={};module$build$src$generators$javascript$math.math_arithmetic=math_arithmetic$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_atan2=math_atan2$$module$build$src$generators$javascript$math;\nmodule$build$src$generators$javascript$math.math_change=math_change$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_constant=math_constant$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_constrain=math_constrain$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_modulo=math_modulo$$module$build$src$generators$javascript$math;\nmodule$build$src$generators$javascript$math.math_number=math_number$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_number_property=math_number_property$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_on_list=math_on_list$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_random_float=math_random_float$$module$build$src$generators$javascript$math;\nmodule$build$src$generators$javascript$math.math_random_int=math_random_int$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_round=math_single$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_single=math_single$$module$build$src$generators$javascript$math;module$build$src$generators$javascript$math.math_trig=math_single$$module$build$src$generators$javascript$math;var procedures_defnoreturn$$module$build$src$generators$javascript$procedures=procedures_defreturn$$module$build$src$generators$javascript$procedures,module$build$src$generators$javascript$procedures={};module$build$src$generators$javascript$procedures.procedures_callnoreturn=procedures_callnoreturn$$module$build$src$generators$javascript$procedures;module$build$src$generators$javascript$procedures.procedures_callreturn=procedures_callreturn$$module$build$src$generators$javascript$procedures;\nmodule$build$src$generators$javascript$procedures.procedures_defnoreturn=procedures_defreturn$$module$build$src$generators$javascript$procedures;module$build$src$generators$javascript$procedures.procedures_defreturn=procedures_defreturn$$module$build$src$generators$javascript$procedures;module$build$src$generators$javascript$procedures.procedures_ifreturn=procedures_ifreturn$$module$build$src$generators$javascript$procedures;var strRegExp$$module$build$src$generators$javascript$text=/^\\s*'([^']|\\\\')*'\\s*$/,forceString$$module$build$src$generators$javascript$text=function(a){return strRegExp$$module$build$src$generators$javascript$text.test(a)?[a,Order$$module$build$src$generators$javascript$javascript_generator.ATOMIC]:[\"String(\"+a+\")\",Order$$module$build$src$generators$javascript$javascript_generator.FUNCTION_CALL]},getSubstringIndex$$module$build$src$generators$javascript$text=function(a,b,c){return\"FIRST\"===b?\"0\":\n\"FROM_END\"===b?a+\".length - 1 - \"+c:\"LAST\"===b?a+\".length - 1\":c},text_prompt$$module$build$src$generators$javascript$text=text_prompt_ext$$module$build$src$generators$javascript$text,module$build$src$generators$javascript$text={};module$build$src$generators$javascript$text.text=text$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_append=text_append$$module$build$src$generators$javascript$text;\nmodule$build$src$generators$javascript$text.text_changeCase=text_changeCase$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_charAt=text_charAt$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_count=text_count$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_getSubstring=text_getSubstring$$module$build$src$generators$javascript$text;\nmodule$build$src$generators$javascript$text.text_indexOf=text_indexOf$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_isEmpty=text_isEmpty$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_join=text_join$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_length=text_length$$module$build$src$generators$javascript$text;\nmodule$build$src$generators$javascript$text.text_multiline=text_multiline$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_print=text_print$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_prompt=text_prompt_ext$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_prompt_ext=text_prompt_ext$$module$build$src$generators$javascript$text;\nmodule$build$src$generators$javascript$text.text_replace=text_replace$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_reverse=text_reverse$$module$build$src$generators$javascript$text;module$build$src$generators$javascript$text.text_trim=text_trim$$module$build$src$generators$javascript$text;var module$build$src$generators$javascript$variables={};module$build$src$generators$javascript$variables.variables_get=variables_get$$module$build$src$generators$javascript$variables;module$build$src$generators$javascript$variables.variables_set=variables_set$$module$build$src$generators$javascript$variables;var module$build$src$generators$javascript$variables_dynamic={};module$build$src$generators$javascript$variables_dynamic.variables_get_dynamic=variables_get$$module$build$src$generators$javascript$variables;module$build$src$generators$javascript$variables_dynamic.variables_set_dynamic=variables_set$$module$build$src$generators$javascript$variables;var javascriptGenerator$$module$build$src$generators$javascript=new JavascriptGenerator$$module$build$src$generators$javascript$javascript_generator,generators$$module$build$src$generators$javascript=Object.assign({},module$build$src$generators$javascript$colour,module$build$src$generators$javascript$lists,module$build$src$generators$javascript$logic,module$build$src$generators$javascript$loops,module$build$src$generators$javascript$math,module$build$src$generators$javascript$procedures,module$build$src$generators$javascript$text,\nmodule$build$src$generators$javascript$variables,module$build$src$generators$javascript$variables_dynamic);for(const a in generators$$module$build$src$generators$javascript)javascriptGenerator$$module$build$src$generators$javascript.forBlock[a]=generators$$module$build$src$generators$javascript[a];var module$build$src$generators$javascript={};module$build$src$generators$javascript.JavascriptGenerator=JavascriptGenerator$$module$build$src$generators$javascript$javascript_generator;\nmodule$build$src$generators$javascript.Order=Order$$module$build$src$generators$javascript$javascript_generator;module$build$src$generators$javascript.javascriptGenerator=javascriptGenerator$$module$build$src$generators$javascript;\nmodule$build$src$generators$javascript.__namespace__=$;\nreturn module$build$src$generators$javascript;\n}));\n\n\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/javascript_compressed.js?");

/***/ }),

/***/ "./node_modules/blockly/msg/en.js":
/*!****************************************!*\
  !*** ./node_modules/blockly/msg/en.js ***!
  \****************************************/
/***/ (function(module, exports) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */\n;(function(root, factory) {\n  if (true) { // AMD\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else { var key, messages; }\n}(this, function() {\n// This file was automatically generated.  Do not modify.\n\n'use strict';\n\nvar Blockly = Blockly || { Msg: Object.create(null) };\n\nBlockly.Msg[\"ADD_COMMENT\"] = \"Add Comment\";\nBlockly.Msg[\"CANNOT_DELETE_VARIABLE_PROCEDURE\"] = \"Can't delete the variable '%1' because it's part of the definition of the function '%2'\";\nBlockly.Msg[\"CHANGE_VALUE_TITLE\"] = \"Change value:\";\nBlockly.Msg[\"CLEAN_UP\"] = \"Clean up Blocks\";\nBlockly.Msg[\"COLLAPSED_WARNINGS_WARNING\"] = \"Collapsed blocks contain warnings.\";\nBlockly.Msg[\"COLLAPSE_ALL\"] = \"Collapse Blocks\";\nBlockly.Msg[\"COLLAPSE_BLOCK\"] = \"Collapse Block\";\nBlockly.Msg[\"COLOUR_BLEND_COLOUR1\"] = \"colour 1\";\nBlockly.Msg[\"COLOUR_BLEND_COLOUR2\"] = \"colour 2\";\nBlockly.Msg[\"COLOUR_BLEND_HELPURL\"] = \"https://meyerweb.com/eric/tools/color-blend/#:::rgbp\";\nBlockly.Msg[\"COLOUR_BLEND_RATIO\"] = \"ratio\";\nBlockly.Msg[\"COLOUR_BLEND_TITLE\"] = \"blend\";\nBlockly.Msg[\"COLOUR_BLEND_TOOLTIP\"] = \"Blends two colours together with a given ratio (0.0 - 1.0).\";\nBlockly.Msg[\"COLOUR_PICKER_HELPURL\"] = \"https://en.wikipedia.org/wiki/Color\";\nBlockly.Msg[\"COLOUR_PICKER_TOOLTIP\"] = \"Choose a colour from the palette.\";\nBlockly.Msg[\"COLOUR_RANDOM_HELPURL\"] = \"http://randomcolour.com\";\nBlockly.Msg[\"COLOUR_RANDOM_TITLE\"] = \"random colour\";\nBlockly.Msg[\"COLOUR_RANDOM_TOOLTIP\"] = \"Choose a colour at random.\";\nBlockly.Msg[\"COLOUR_RGB_BLUE\"] = \"blue\";\nBlockly.Msg[\"COLOUR_RGB_GREEN\"] = \"green\";\nBlockly.Msg[\"COLOUR_RGB_HELPURL\"] = \"https://www.december.com/html/spec/colorpercompact.html\";\nBlockly.Msg[\"COLOUR_RGB_RED\"] = \"red\";\nBlockly.Msg[\"COLOUR_RGB_TITLE\"] = \"colour with\";\nBlockly.Msg[\"COLOUR_RGB_TOOLTIP\"] = \"Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.\";\nBlockly.Msg[\"CONTROLS_FLOW_STATEMENTS_HELPURL\"] = \"https://github.com/google/blockly/wiki/Loops#loop-termination-blocks\";\nBlockly.Msg[\"CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK\"] = \"break out of loop\";\nBlockly.Msg[\"CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE\"] = \"continue with next iteration of loop\";\nBlockly.Msg[\"CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK\"] = \"Break out of the containing loop.\";\nBlockly.Msg[\"CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE\"] = \"Skip the rest of this loop, and continue with the next iteration.\";\nBlockly.Msg[\"CONTROLS_FLOW_STATEMENTS_WARNING\"] = \"Warning: This block may only be used within a loop.\";\nBlockly.Msg[\"CONTROLS_FOREACH_HELPURL\"] = \"https://github.com/google/blockly/wiki/Loops#for-each\";\nBlockly.Msg[\"CONTROLS_FOREACH_TITLE\"] = \"for each item %1 in list %2\";\nBlockly.Msg[\"CONTROLS_FOREACH_TOOLTIP\"] = \"For each item in a list, set the variable '%1' to the item, and then do some statements.\";\nBlockly.Msg[\"CONTROLS_FOR_HELPURL\"] = \"https://github.com/google/blockly/wiki/Loops#count-with\";\nBlockly.Msg[\"CONTROLS_FOR_TITLE\"] = \"count with %1 from %2 to %3 by %4\";\nBlockly.Msg[\"CONTROLS_FOR_TOOLTIP\"] = \"Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.\";\nBlockly.Msg[\"CONTROLS_IF_ELSEIF_TOOLTIP\"] = \"Add a condition to the if block.\";\nBlockly.Msg[\"CONTROLS_IF_ELSE_TOOLTIP\"] = \"Add a final, catch-all condition to the if block.\";\nBlockly.Msg[\"CONTROLS_IF_HELPURL\"] = \"https://github.com/google/blockly/wiki/IfElse\";\nBlockly.Msg[\"CONTROLS_IF_IF_TOOLTIP\"] = \"Add, remove, or reorder sections to reconfigure this if block.\";\nBlockly.Msg[\"CONTROLS_IF_MSG_ELSE\"] = \"else\";\nBlockly.Msg[\"CONTROLS_IF_MSG_ELSEIF\"] = \"else if\";\nBlockly.Msg[\"CONTROLS_IF_MSG_IF\"] = \"if\";\nBlockly.Msg[\"CONTROLS_IF_TOOLTIP_1\"] = \"If a value is true, then do some statements.\";\nBlockly.Msg[\"CONTROLS_IF_TOOLTIP_2\"] = \"If a value is true, then do the first block of statements. Otherwise, do the second block of statements.\";\nBlockly.Msg[\"CONTROLS_IF_TOOLTIP_3\"] = \"If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.\";\nBlockly.Msg[\"CONTROLS_IF_TOOLTIP_4\"] = \"If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.\";\nBlockly.Msg[\"CONTROLS_REPEAT_HELPURL\"] = \"https://en.wikipedia.org/wiki/For_loop\";\nBlockly.Msg[\"CONTROLS_REPEAT_INPUT_DO\"] = \"do\";\nBlockly.Msg[\"CONTROLS_REPEAT_TITLE\"] = \"repeat %1 times\";\nBlockly.Msg[\"CONTROLS_REPEAT_TOOLTIP\"] = \"Do some statements several times.\";\nBlockly.Msg[\"CONTROLS_WHILEUNTIL_HELPURL\"] = \"https://github.com/google/blockly/wiki/Loops#repeat\";\nBlockly.Msg[\"CONTROLS_WHILEUNTIL_OPERATOR_UNTIL\"] = \"repeat until\";\nBlockly.Msg[\"CONTROLS_WHILEUNTIL_OPERATOR_WHILE\"] = \"repeat while\";\nBlockly.Msg[\"CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL\"] = \"While a value is false, then do some statements.\";\nBlockly.Msg[\"CONTROLS_WHILEUNTIL_TOOLTIP_WHILE\"] = \"While a value is true, then do some statements.\";\nBlockly.Msg[\"DELETE_ALL_BLOCKS\"] = \"Delete all %1 blocks?\";\nBlockly.Msg[\"DELETE_BLOCK\"] = \"Delete Block\";\nBlockly.Msg[\"DELETE_VARIABLE\"] = \"Delete the '%1' variable\";\nBlockly.Msg[\"DELETE_VARIABLE_CONFIRMATION\"] = \"Delete %1 uses of the '%2' variable?\";\nBlockly.Msg[\"DELETE_X_BLOCKS\"] = \"Delete %1 Blocks\";\nBlockly.Msg[\"DIALOG_CANCEL\"] = \"Cancel\";\nBlockly.Msg[\"DIALOG_OK\"] = \"OK\";\nBlockly.Msg[\"DISABLE_BLOCK\"] = \"Disable Block\";\nBlockly.Msg[\"DUPLICATE_BLOCK\"] = \"Duplicate\";\nBlockly.Msg[\"DUPLICATE_COMMENT\"] = \"Duplicate Comment\";\nBlockly.Msg[\"ENABLE_BLOCK\"] = \"Enable Block\";\nBlockly.Msg[\"EXPAND_ALL\"] = \"Expand Blocks\";\nBlockly.Msg[\"EXPAND_BLOCK\"] = \"Expand Block\";\nBlockly.Msg[\"EXTERNAL_INPUTS\"] = \"External Inputs\";\nBlockly.Msg[\"HELP\"] = \"Help\";\nBlockly.Msg[\"INLINE_INPUTS\"] = \"Inline Inputs\";\nBlockly.Msg[\"LISTS_CREATE_EMPTY_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#create-empty-list\";\nBlockly.Msg[\"LISTS_CREATE_EMPTY_TITLE\"] = \"create empty list\";\nBlockly.Msg[\"LISTS_CREATE_EMPTY_TOOLTIP\"] = \"Returns a list, of length 0, containing no data records\";\nBlockly.Msg[\"LISTS_CREATE_WITH_CONTAINER_TITLE_ADD\"] = \"list\";\nBlockly.Msg[\"LISTS_CREATE_WITH_CONTAINER_TOOLTIP\"] = \"Add, remove, or reorder sections to reconfigure this list block.\";\nBlockly.Msg[\"LISTS_CREATE_WITH_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#create-list-with\";\nBlockly.Msg[\"LISTS_CREATE_WITH_INPUT_WITH\"] = \"create list with\";\nBlockly.Msg[\"LISTS_CREATE_WITH_ITEM_TOOLTIP\"] = \"Add an item to the list.\";\nBlockly.Msg[\"LISTS_CREATE_WITH_TOOLTIP\"] = \"Create a list with any number of items.\";\nBlockly.Msg[\"LISTS_GET_INDEX_FIRST\"] = \"first\";\nBlockly.Msg[\"LISTS_GET_INDEX_FROM_END\"] = \"# from end\";\nBlockly.Msg[\"LISTS_GET_INDEX_FROM_START\"] = \"#\";\nBlockly.Msg[\"LISTS_GET_INDEX_GET\"] = \"get\";\nBlockly.Msg[\"LISTS_GET_INDEX_GET_REMOVE\"] = \"get and remove\";\nBlockly.Msg[\"LISTS_GET_INDEX_LAST\"] = \"last\";\nBlockly.Msg[\"LISTS_GET_INDEX_RANDOM\"] = \"random\";\nBlockly.Msg[\"LISTS_GET_INDEX_REMOVE\"] = \"remove\";\nBlockly.Msg[\"LISTS_GET_INDEX_TAIL\"] = \"\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_FIRST\"] = \"Returns the first item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_FROM\"] = \"Returns the item at the specified position in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_LAST\"] = \"Returns the last item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_RANDOM\"] = \"Returns a random item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST\"] = \"Removes and returns the first item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM\"] = \"Removes and returns the item at the specified position in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST\"] = \"Removes and returns the last item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM\"] = \"Removes and returns a random item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST\"] = \"Removes the first item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM\"] = \"Removes the item at the specified position in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST\"] = \"Removes the last item in a list.\";\nBlockly.Msg[\"LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM\"] = \"Removes a random item in a list.\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_END_FROM_END\"] = \"to # from end\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_END_FROM_START\"] = \"to #\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_END_LAST\"] = \"to last\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#getting-a-sublist\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_START_FIRST\"] = \"get sub-list from first\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_START_FROM_END\"] = \"get sub-list from # from end\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_START_FROM_START\"] = \"get sub-list from #\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_TAIL\"] = \"\";\nBlockly.Msg[\"LISTS_GET_SUBLIST_TOOLTIP\"] = \"Creates a copy of the specified portion of a list.\";\nBlockly.Msg[\"LISTS_INDEX_FROM_END_TOOLTIP\"] = \"%1 is the last item.\";\nBlockly.Msg[\"LISTS_INDEX_FROM_START_TOOLTIP\"] = \"%1 is the first item.\";\nBlockly.Msg[\"LISTS_INDEX_OF_FIRST\"] = \"find first occurrence of item\";\nBlockly.Msg[\"LISTS_INDEX_OF_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list\";\nBlockly.Msg[\"LISTS_INDEX_OF_LAST\"] = \"find last occurrence of item\";\nBlockly.Msg[\"LISTS_INDEX_OF_TOOLTIP\"] = \"Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.\";\nBlockly.Msg[\"LISTS_INLIST\"] = \"in list\";\nBlockly.Msg[\"LISTS_ISEMPTY_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#is-empty\";\nBlockly.Msg[\"LISTS_ISEMPTY_TITLE\"] = \"%1 is empty\";\nBlockly.Msg[\"LISTS_ISEMPTY_TOOLTIP\"] = \"Returns true if the list is empty.\";\nBlockly.Msg[\"LISTS_LENGTH_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#length-of\";\nBlockly.Msg[\"LISTS_LENGTH_TITLE\"] = \"length of %1\";\nBlockly.Msg[\"LISTS_LENGTH_TOOLTIP\"] = \"Returns the length of a list.\";\nBlockly.Msg[\"LISTS_REPEAT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#create-list-with\";\nBlockly.Msg[\"LISTS_REPEAT_TITLE\"] = \"create list with item %1 repeated %2 times\";\nBlockly.Msg[\"LISTS_REPEAT_TOOLTIP\"] = \"Creates a list consisting of the given value repeated the specified number of times.\";\nBlockly.Msg[\"LISTS_REVERSE_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#reversing-a-list\";\nBlockly.Msg[\"LISTS_REVERSE_MESSAGE0\"] = \"reverse %1\";\nBlockly.Msg[\"LISTS_REVERSE_TOOLTIP\"] = \"Reverse a copy of a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#in-list--set\";\nBlockly.Msg[\"LISTS_SET_INDEX_INPUT_TO\"] = \"as\";\nBlockly.Msg[\"LISTS_SET_INDEX_INSERT\"] = \"insert at\";\nBlockly.Msg[\"LISTS_SET_INDEX_SET\"] = \"set\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST\"] = \"Inserts the item at the start of a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_INSERT_FROM\"] = \"Inserts the item at the specified position in a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_INSERT_LAST\"] = \"Append the item to the end of a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM\"] = \"Inserts the item randomly in a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_SET_FIRST\"] = \"Sets the first item in a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_SET_FROM\"] = \"Sets the item at the specified position in a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_SET_LAST\"] = \"Sets the last item in a list.\";\nBlockly.Msg[\"LISTS_SET_INDEX_TOOLTIP_SET_RANDOM\"] = \"Sets a random item in a list.\";\nBlockly.Msg[\"LISTS_SORT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#sorting-a-list\";\nBlockly.Msg[\"LISTS_SORT_ORDER_ASCENDING\"] = \"ascending\";\nBlockly.Msg[\"LISTS_SORT_ORDER_DESCENDING\"] = \"descending\";\nBlockly.Msg[\"LISTS_SORT_TITLE\"] = \"sort %1 %2 %3\";\nBlockly.Msg[\"LISTS_SORT_TOOLTIP\"] = \"Sort a copy of a list.\";\nBlockly.Msg[\"LISTS_SORT_TYPE_IGNORECASE\"] = \"alphabetic, ignore case\";\nBlockly.Msg[\"LISTS_SORT_TYPE_NUMERIC\"] = \"numeric\";\nBlockly.Msg[\"LISTS_SORT_TYPE_TEXT\"] = \"alphabetic\";\nBlockly.Msg[\"LISTS_SPLIT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists\";\nBlockly.Msg[\"LISTS_SPLIT_LIST_FROM_TEXT\"] = \"make list from text\";\nBlockly.Msg[\"LISTS_SPLIT_TEXT_FROM_LIST\"] = \"make text from list\";\nBlockly.Msg[\"LISTS_SPLIT_TOOLTIP_JOIN\"] = \"Join a list of texts into one text, separated by a delimiter.\";\nBlockly.Msg[\"LISTS_SPLIT_TOOLTIP_SPLIT\"] = \"Split text into a list of texts, breaking at each delimiter.\";\nBlockly.Msg[\"LISTS_SPLIT_WITH_DELIMITER\"] = \"with delimiter\";\nBlockly.Msg[\"LOGIC_BOOLEAN_FALSE\"] = \"false\";\nBlockly.Msg[\"LOGIC_BOOLEAN_HELPURL\"] = \"https://github.com/google/blockly/wiki/Logic#values\";\nBlockly.Msg[\"LOGIC_BOOLEAN_TOOLTIP\"] = \"Returns either true or false.\";\nBlockly.Msg[\"LOGIC_BOOLEAN_TRUE\"] = \"true\";\nBlockly.Msg[\"LOGIC_COMPARE_HELPURL\"] = \"https://en.wikipedia.org/wiki/Inequality_(mathematics)\";\nBlockly.Msg[\"LOGIC_COMPARE_TOOLTIP_EQ\"] = \"Return true if both inputs equal each other.\";\nBlockly.Msg[\"LOGIC_COMPARE_TOOLTIP_GT\"] = \"Return true if the first input is greater than the second input.\";\nBlockly.Msg[\"LOGIC_COMPARE_TOOLTIP_GTE\"] = \"Return true if the first input is greater than or equal to the second input.\";\nBlockly.Msg[\"LOGIC_COMPARE_TOOLTIP_LT\"] = \"Return true if the first input is smaller than the second input.\";\nBlockly.Msg[\"LOGIC_COMPARE_TOOLTIP_LTE\"] = \"Return true if the first input is smaller than or equal to the second input.\";\nBlockly.Msg[\"LOGIC_COMPARE_TOOLTIP_NEQ\"] = \"Return true if both inputs are not equal to each other.\";\nBlockly.Msg[\"LOGIC_NEGATE_HELPURL\"] = \"https://github.com/google/blockly/wiki/Logic#not\";\nBlockly.Msg[\"LOGIC_NEGATE_TITLE\"] = \"not %1\";\nBlockly.Msg[\"LOGIC_NEGATE_TOOLTIP\"] = \"Returns true if the input is false. Returns false if the input is true.\";\nBlockly.Msg[\"LOGIC_NULL\"] = \"null\";\nBlockly.Msg[\"LOGIC_NULL_HELPURL\"] = \"https://en.wikipedia.org/wiki/Nullable_type\";\nBlockly.Msg[\"LOGIC_NULL_TOOLTIP\"] = \"Returns null.\";\nBlockly.Msg[\"LOGIC_OPERATION_AND\"] = \"and\";\nBlockly.Msg[\"LOGIC_OPERATION_HELPURL\"] = \"https://github.com/google/blockly/wiki/Logic#logical-operations\";\nBlockly.Msg[\"LOGIC_OPERATION_OR\"] = \"or\";\nBlockly.Msg[\"LOGIC_OPERATION_TOOLTIP_AND\"] = \"Return true if both inputs are true.\";\nBlockly.Msg[\"LOGIC_OPERATION_TOOLTIP_OR\"] = \"Return true if at least one of the inputs is true.\";\nBlockly.Msg[\"LOGIC_TERNARY_CONDITION\"] = \"test\";\nBlockly.Msg[\"LOGIC_TERNARY_HELPURL\"] = \"https://en.wikipedia.org/wiki/%3F:\";\nBlockly.Msg[\"LOGIC_TERNARY_IF_FALSE\"] = \"if false\";\nBlockly.Msg[\"LOGIC_TERNARY_IF_TRUE\"] = \"if true\";\nBlockly.Msg[\"LOGIC_TERNARY_TOOLTIP\"] = \"Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.\";\nBlockly.Msg[\"MATH_ADDITION_SYMBOL\"] = \"+\";\nBlockly.Msg[\"MATH_ARITHMETIC_HELPURL\"] = \"https://en.wikipedia.org/wiki/Arithmetic\";\nBlockly.Msg[\"MATH_ARITHMETIC_TOOLTIP_ADD\"] = \"Return the sum of the two numbers.\";\nBlockly.Msg[\"MATH_ARITHMETIC_TOOLTIP_DIVIDE\"] = \"Return the quotient of the two numbers.\";\nBlockly.Msg[\"MATH_ARITHMETIC_TOOLTIP_MINUS\"] = \"Return the difference of the two numbers.\";\nBlockly.Msg[\"MATH_ARITHMETIC_TOOLTIP_MULTIPLY\"] = \"Return the product of the two numbers.\";\nBlockly.Msg[\"MATH_ARITHMETIC_TOOLTIP_POWER\"] = \"Return the first number raised to the power of the second number.\";\nBlockly.Msg[\"MATH_ATAN2_HELPURL\"] = \"https://en.wikipedia.org/wiki/Atan2\";\nBlockly.Msg[\"MATH_ATAN2_TITLE\"] = \"atan2 of X:%1 Y:%2\";\nBlockly.Msg[\"MATH_ATAN2_TOOLTIP\"] = \"Return the arctangent of point (X, Y) in degrees from -180 to 180.\";\nBlockly.Msg[\"MATH_CHANGE_HELPURL\"] = \"https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter\";\nBlockly.Msg[\"MATH_CHANGE_TITLE\"] = \"change %1 by %2\";\nBlockly.Msg[\"MATH_CHANGE_TOOLTIP\"] = \"Add a number to variable '%1'.\";\nBlockly.Msg[\"MATH_CONSTANT_HELPURL\"] = \"https://en.wikipedia.org/wiki/Mathematical_constant\";\nBlockly.Msg[\"MATH_CONSTANT_TOOLTIP\"] = \"Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).\";\nBlockly.Msg[\"MATH_CONSTRAIN_HELPURL\"] = \"https://en.wikipedia.org/wiki/Clamping_(graphics)\";\nBlockly.Msg[\"MATH_CONSTRAIN_TITLE\"] = \"constrain %1 low %2 high %3\";\nBlockly.Msg[\"MATH_CONSTRAIN_TOOLTIP\"] = \"Constrain a number to be between the specified limits (inclusive).\";\nBlockly.Msg[\"MATH_DIVISION_SYMBOL\"] = \"÷\";\nBlockly.Msg[\"MATH_IS_DIVISIBLE_BY\"] = \"is divisible by\";\nBlockly.Msg[\"MATH_IS_EVEN\"] = \"is even\";\nBlockly.Msg[\"MATH_IS_NEGATIVE\"] = \"is negative\";\nBlockly.Msg[\"MATH_IS_ODD\"] = \"is odd\";\nBlockly.Msg[\"MATH_IS_POSITIVE\"] = \"is positive\";\nBlockly.Msg[\"MATH_IS_PRIME\"] = \"is prime\";\nBlockly.Msg[\"MATH_IS_TOOLTIP\"] = \"Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.\";\nBlockly.Msg[\"MATH_IS_WHOLE\"] = \"is whole\";\nBlockly.Msg[\"MATH_MODULO_HELPURL\"] = \"https://en.wikipedia.org/wiki/Modulo_operation\";\nBlockly.Msg[\"MATH_MODULO_TITLE\"] = \"remainder of %1 ÷ %2\";\nBlockly.Msg[\"MATH_MODULO_TOOLTIP\"] = \"Return the remainder from dividing the two numbers.\";\nBlockly.Msg[\"MATH_MULTIPLICATION_SYMBOL\"] = \"×\";\nBlockly.Msg[\"MATH_NUMBER_HELPURL\"] = \"https://en.wikipedia.org/wiki/Number\";\nBlockly.Msg[\"MATH_NUMBER_TOOLTIP\"] = \"A number.\";\nBlockly.Msg[\"MATH_ONLIST_HELPURL\"] = \"\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_AVERAGE\"] = \"average of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_MAX\"] = \"max of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_MEDIAN\"] = \"median of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_MIN\"] = \"min of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_MODE\"] = \"modes of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_RANDOM\"] = \"random item of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_STD_DEV\"] = \"standard deviation of list\";\nBlockly.Msg[\"MATH_ONLIST_OPERATOR_SUM\"] = \"sum of list\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_AVERAGE\"] = \"Return the average (arithmetic mean) of the numeric values in the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_MAX\"] = \"Return the largest number in the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_MEDIAN\"] = \"Return the median number in the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_MIN\"] = \"Return the smallest number in the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_MODE\"] = \"Return a list of the most common item(s) in the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_RANDOM\"] = \"Return a random element from the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_STD_DEV\"] = \"Return the standard deviation of the list.\";\nBlockly.Msg[\"MATH_ONLIST_TOOLTIP_SUM\"] = \"Return the sum of all the numbers in the list.\";\nBlockly.Msg[\"MATH_POWER_SYMBOL\"] = \"^\";\nBlockly.Msg[\"MATH_RANDOM_FLOAT_HELPURL\"] = \"https://en.wikipedia.org/wiki/Random_number_generation\";\nBlockly.Msg[\"MATH_RANDOM_FLOAT_TITLE_RANDOM\"] = \"random fraction\";\nBlockly.Msg[\"MATH_RANDOM_FLOAT_TOOLTIP\"] = \"Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).\";\nBlockly.Msg[\"MATH_RANDOM_INT_HELPURL\"] = \"https://en.wikipedia.org/wiki/Random_number_generation\";\nBlockly.Msg[\"MATH_RANDOM_INT_TITLE\"] = \"random integer from %1 to %2\";\nBlockly.Msg[\"MATH_RANDOM_INT_TOOLTIP\"] = \"Return a random integer between the two specified limits, inclusive.\";\nBlockly.Msg[\"MATH_ROUND_HELPURL\"] = \"https://en.wikipedia.org/wiki/Rounding\";\nBlockly.Msg[\"MATH_ROUND_OPERATOR_ROUND\"] = \"round\";\nBlockly.Msg[\"MATH_ROUND_OPERATOR_ROUNDDOWN\"] = \"round down\";\nBlockly.Msg[\"MATH_ROUND_OPERATOR_ROUNDUP\"] = \"round up\";\nBlockly.Msg[\"MATH_ROUND_TOOLTIP\"] = \"Round a number up or down.\";\nBlockly.Msg[\"MATH_SINGLE_HELPURL\"] = \"https://en.wikipedia.org/wiki/Square_root\";\nBlockly.Msg[\"MATH_SINGLE_OP_ABSOLUTE\"] = \"absolute\";\nBlockly.Msg[\"MATH_SINGLE_OP_ROOT\"] = \"square root\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_ABS\"] = \"Return the absolute value of a number.\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_EXP\"] = \"Return e to the power of a number.\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_LN\"] = \"Return the natural logarithm of a number.\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_LOG10\"] = \"Return the base 10 logarithm of a number.\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_NEG\"] = \"Return the negation of a number.\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_POW10\"] = \"Return 10 to the power of a number.\";\nBlockly.Msg[\"MATH_SINGLE_TOOLTIP_ROOT\"] = \"Return the square root of a number.\";\nBlockly.Msg[\"MATH_SUBTRACTION_SYMBOL\"] = \"-\";\nBlockly.Msg[\"MATH_TRIG_ACOS\"] = \"acos\";\nBlockly.Msg[\"MATH_TRIG_ASIN\"] = \"asin\";\nBlockly.Msg[\"MATH_TRIG_ATAN\"] = \"atan\";\nBlockly.Msg[\"MATH_TRIG_COS\"] = \"cos\";\nBlockly.Msg[\"MATH_TRIG_HELPURL\"] = \"https://en.wikipedia.org/wiki/Trigonometric_functions\";\nBlockly.Msg[\"MATH_TRIG_SIN\"] = \"sin\";\nBlockly.Msg[\"MATH_TRIG_TAN\"] = \"tan\";\nBlockly.Msg[\"MATH_TRIG_TOOLTIP_ACOS\"] = \"Return the arccosine of a number.\";\nBlockly.Msg[\"MATH_TRIG_TOOLTIP_ASIN\"] = \"Return the arcsine of a number.\";\nBlockly.Msg[\"MATH_TRIG_TOOLTIP_ATAN\"] = \"Return the arctangent of a number.\";\nBlockly.Msg[\"MATH_TRIG_TOOLTIP_COS\"] = \"Return the cosine of a degree (not radian).\";\nBlockly.Msg[\"MATH_TRIG_TOOLTIP_SIN\"] = \"Return the sine of a degree (not radian).\";\nBlockly.Msg[\"MATH_TRIG_TOOLTIP_TAN\"] = \"Return the tangent of a degree (not radian).\";\nBlockly.Msg[\"NEW_COLOUR_VARIABLE\"] = \"Create colour variable...\";\nBlockly.Msg[\"NEW_NUMBER_VARIABLE\"] = \"Create number variable...\";\nBlockly.Msg[\"NEW_STRING_VARIABLE\"] = \"Create string variable...\";\nBlockly.Msg[\"NEW_VARIABLE\"] = \"Create variable...\";\nBlockly.Msg[\"NEW_VARIABLE_TITLE\"] = \"New variable name:\";\nBlockly.Msg[\"NEW_VARIABLE_TYPE_TITLE\"] = \"New variable type:\";\nBlockly.Msg[\"ORDINAL_NUMBER_SUFFIX\"] = \"\";\nBlockly.Msg[\"PROCEDURES_ALLOW_STATEMENTS\"] = \"allow statements\";\nBlockly.Msg[\"PROCEDURES_BEFORE_PARAMS\"] = \"with:\";\nBlockly.Msg[\"PROCEDURES_CALLNORETURN_HELPURL\"] = \"https://en.wikipedia.org/wiki/Subroutine\";\nBlockly.Msg[\"PROCEDURES_CALLNORETURN_TOOLTIP\"] = \"Run the user-defined function '%1'.\";\nBlockly.Msg[\"PROCEDURES_CALLRETURN_HELPURL\"] = \"https://en.wikipedia.org/wiki/Subroutine\";\nBlockly.Msg[\"PROCEDURES_CALLRETURN_TOOLTIP\"] = \"Run the user-defined function '%1' and use its output.\";\nBlockly.Msg[\"PROCEDURES_CALL_BEFORE_PARAMS\"] = \"with:\";\nBlockly.Msg[\"PROCEDURES_CREATE_DO\"] = \"Create '%1'\";\nBlockly.Msg[\"PROCEDURES_DEFNORETURN_COMMENT\"] = \"Describe this function...\";\nBlockly.Msg[\"PROCEDURES_DEFNORETURN_DO\"] = \"\";\nBlockly.Msg[\"PROCEDURES_DEFNORETURN_HELPURL\"] = \"https://en.wikipedia.org/wiki/Subroutine\";\nBlockly.Msg[\"PROCEDURES_DEFNORETURN_PROCEDURE\"] = \"do something\";\nBlockly.Msg[\"PROCEDURES_DEFNORETURN_TITLE\"] = \"to\";\nBlockly.Msg[\"PROCEDURES_DEFNORETURN_TOOLTIP\"] = \"Creates a function with no output.\";\nBlockly.Msg[\"PROCEDURES_DEFRETURN_HELPURL\"] = \"https://en.wikipedia.org/wiki/Subroutine\";\nBlockly.Msg[\"PROCEDURES_DEFRETURN_RETURN\"] = \"return\";\nBlockly.Msg[\"PROCEDURES_DEFRETURN_TOOLTIP\"] = \"Creates a function with an output.\";\nBlockly.Msg[\"PROCEDURES_DEF_DUPLICATE_WARNING\"] = \"Warning: This function has duplicate parameters.\";\nBlockly.Msg[\"PROCEDURES_HIGHLIGHT_DEF\"] = \"Highlight function definition\";\nBlockly.Msg[\"PROCEDURES_IFRETURN_HELPURL\"] = \"https://c2.com/cgi/wiki?GuardClause\";\nBlockly.Msg[\"PROCEDURES_IFRETURN_TOOLTIP\"] = \"If a value is true, then return a second value.\";\nBlockly.Msg[\"PROCEDURES_IFRETURN_WARNING\"] = \"Warning: This block may be used only within a function definition.\";\nBlockly.Msg[\"PROCEDURES_MUTATORARG_TITLE\"] = \"input name:\";\nBlockly.Msg[\"PROCEDURES_MUTATORARG_TOOLTIP\"] = \"Add an input to the function.\";\nBlockly.Msg[\"PROCEDURES_MUTATORCONTAINER_TITLE\"] = \"inputs\";\nBlockly.Msg[\"PROCEDURES_MUTATORCONTAINER_TOOLTIP\"] = \"Add, remove, or reorder inputs to this function.\";\nBlockly.Msg[\"REDO\"] = \"Redo\";\nBlockly.Msg[\"REMOVE_COMMENT\"] = \"Remove Comment\";\nBlockly.Msg[\"RENAME_VARIABLE\"] = \"Rename variable...\";\nBlockly.Msg[\"RENAME_VARIABLE_TITLE\"] = \"Rename all '%1' variables to:\";\nBlockly.Msg[\"TEXT_APPEND_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#text-modification\";\nBlockly.Msg[\"TEXT_APPEND_TITLE\"] = \"to %1 append text %2\";\nBlockly.Msg[\"TEXT_APPEND_TOOLTIP\"] = \"Append some text to variable '%1'.\";\nBlockly.Msg[\"TEXT_CHANGECASE_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#adjusting-text-case\";\nBlockly.Msg[\"TEXT_CHANGECASE_OPERATOR_LOWERCASE\"] = \"to lower case\";\nBlockly.Msg[\"TEXT_CHANGECASE_OPERATOR_TITLECASE\"] = \"to Title Case\";\nBlockly.Msg[\"TEXT_CHANGECASE_OPERATOR_UPPERCASE\"] = \"to UPPER CASE\";\nBlockly.Msg[\"TEXT_CHANGECASE_TOOLTIP\"] = \"Return a copy of the text in a different case.\";\nBlockly.Msg[\"TEXT_CHARAT_FIRST\"] = \"get first letter\";\nBlockly.Msg[\"TEXT_CHARAT_FROM_END\"] = \"get letter # from end\";\nBlockly.Msg[\"TEXT_CHARAT_FROM_START\"] = \"get letter #\";\nBlockly.Msg[\"TEXT_CHARAT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#extracting-text\";\nBlockly.Msg[\"TEXT_CHARAT_LAST\"] = \"get last letter\";\nBlockly.Msg[\"TEXT_CHARAT_RANDOM\"] = \"get random letter\";\nBlockly.Msg[\"TEXT_CHARAT_TAIL\"] = \"\";\nBlockly.Msg[\"TEXT_CHARAT_TITLE\"] = \"in text %1 %2\";\nBlockly.Msg[\"TEXT_CHARAT_TOOLTIP\"] = \"Returns the letter at the specified position.\";\nBlockly.Msg[\"TEXT_COUNT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#counting-substrings\";\nBlockly.Msg[\"TEXT_COUNT_MESSAGE0\"] = \"count %1 in %2\";\nBlockly.Msg[\"TEXT_COUNT_TOOLTIP\"] = \"Count how many times some text occurs within some other text.\";\nBlockly.Msg[\"TEXT_CREATE_JOIN_ITEM_TOOLTIP\"] = \"Add an item to the text.\";\nBlockly.Msg[\"TEXT_CREATE_JOIN_TITLE_JOIN\"] = \"join\";\nBlockly.Msg[\"TEXT_CREATE_JOIN_TOOLTIP\"] = \"Add, remove, or reorder sections to reconfigure this text block.\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_END_FROM_END\"] = \"to letter # from end\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_END_FROM_START\"] = \"to letter #\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_END_LAST\"] = \"to last letter\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_INPUT_IN_TEXT\"] = \"in text\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_START_FIRST\"] = \"get substring from first letter\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_START_FROM_END\"] = \"get substring from letter # from end\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_START_FROM_START\"] = \"get substring from letter #\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_TAIL\"] = \"\";\nBlockly.Msg[\"TEXT_GET_SUBSTRING_TOOLTIP\"] = \"Returns a specified portion of the text.\";\nBlockly.Msg[\"TEXT_INDEXOF_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#finding-text\";\nBlockly.Msg[\"TEXT_INDEXOF_OPERATOR_FIRST\"] = \"find first occurrence of text\";\nBlockly.Msg[\"TEXT_INDEXOF_OPERATOR_LAST\"] = \"find last occurrence of text\";\nBlockly.Msg[\"TEXT_INDEXOF_TITLE\"] = \"in text %1 %2 %3\";\nBlockly.Msg[\"TEXT_INDEXOF_TOOLTIP\"] = \"Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.\";\nBlockly.Msg[\"TEXT_ISEMPTY_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#checking-for-empty-text\";\nBlockly.Msg[\"TEXT_ISEMPTY_TITLE\"] = \"%1 is empty\";\nBlockly.Msg[\"TEXT_ISEMPTY_TOOLTIP\"] = \"Returns true if the provided text is empty.\";\nBlockly.Msg[\"TEXT_JOIN_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#text-creation\";\nBlockly.Msg[\"TEXT_JOIN_TITLE_CREATEWITH\"] = \"create text with\";\nBlockly.Msg[\"TEXT_JOIN_TOOLTIP\"] = \"Create a piece of text by joining together any number of items.\";\nBlockly.Msg[\"TEXT_LENGTH_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#text-modification\";\nBlockly.Msg[\"TEXT_LENGTH_TITLE\"] = \"length of %1\";\nBlockly.Msg[\"TEXT_LENGTH_TOOLTIP\"] = \"Returns the number of letters (including spaces) in the provided text.\";\nBlockly.Msg[\"TEXT_PRINT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#printing-text\";\nBlockly.Msg[\"TEXT_PRINT_TITLE\"] = \"print %1\";\nBlockly.Msg[\"TEXT_PRINT_TOOLTIP\"] = \"Print the specified text, number or other value.\";\nBlockly.Msg[\"TEXT_PROMPT_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#getting-input-from-the-user\";\nBlockly.Msg[\"TEXT_PROMPT_TOOLTIP_NUMBER\"] = \"Prompt for user for a number.\";\nBlockly.Msg[\"TEXT_PROMPT_TOOLTIP_TEXT\"] = \"Prompt for user for some text.\";\nBlockly.Msg[\"TEXT_PROMPT_TYPE_NUMBER\"] = \"prompt for number with message\";\nBlockly.Msg[\"TEXT_PROMPT_TYPE_TEXT\"] = \"prompt for text with message\";\nBlockly.Msg[\"TEXT_REPLACE_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#replacing-substrings\";\nBlockly.Msg[\"TEXT_REPLACE_MESSAGE0\"] = \"replace %1 with %2 in %3\";\nBlockly.Msg[\"TEXT_REPLACE_TOOLTIP\"] = \"Replace all occurances of some text within some other text.\";\nBlockly.Msg[\"TEXT_REVERSE_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#reversing-text\";\nBlockly.Msg[\"TEXT_REVERSE_MESSAGE0\"] = \"reverse %1\";\nBlockly.Msg[\"TEXT_REVERSE_TOOLTIP\"] = \"Reverses the order of the characters in the text.\";\nBlockly.Msg[\"TEXT_TEXT_HELPURL\"] = \"https://en.wikipedia.org/wiki/String_(computer_science)\";\nBlockly.Msg[\"TEXT_TEXT_TOOLTIP\"] = \"A letter, word, or line of text.\";\nBlockly.Msg[\"TEXT_TRIM_HELPURL\"] = \"https://github.com/google/blockly/wiki/Text#trimming-removing-spaces\";\nBlockly.Msg[\"TEXT_TRIM_OPERATOR_BOTH\"] = \"trim spaces from both sides of\";\nBlockly.Msg[\"TEXT_TRIM_OPERATOR_LEFT\"] = \"trim spaces from left side of\";\nBlockly.Msg[\"TEXT_TRIM_OPERATOR_RIGHT\"] = \"trim spaces from right side of\";\nBlockly.Msg[\"TEXT_TRIM_TOOLTIP\"] = \"Return a copy of the text with spaces removed from one or both ends.\";\nBlockly.Msg[\"TODAY\"] = \"Today\";\nBlockly.Msg[\"UNDO\"] = \"Undo\";\nBlockly.Msg[\"UNNAMED_KEY\"] = \"unnamed\";\nBlockly.Msg[\"VARIABLES_DEFAULT_NAME\"] = \"item\";\nBlockly.Msg[\"VARIABLES_GET_CREATE_SET\"] = \"Create 'set %1'\";\nBlockly.Msg[\"VARIABLES_GET_HELPURL\"] = \"https://github.com/google/blockly/wiki/Variables#get\";\nBlockly.Msg[\"VARIABLES_GET_TOOLTIP\"] = \"Returns the value of this variable.\";\nBlockly.Msg[\"VARIABLES_SET\"] = \"set %1 to %2\";\nBlockly.Msg[\"VARIABLES_SET_CREATE_GET\"] = \"Create 'get %1'\";\nBlockly.Msg[\"VARIABLES_SET_HELPURL\"] = \"https://github.com/google/blockly/wiki/Variables#set\";\nBlockly.Msg[\"VARIABLES_SET_TOOLTIP\"] = \"Sets this variable to be equal to the input.\";\nBlockly.Msg[\"VARIABLE_ALREADY_EXISTS\"] = \"A variable named '%1' already exists.\";\nBlockly.Msg[\"VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE\"] = \"A variable named '%1' already exists for another type: '%2'.\";\nBlockly.Msg[\"WORKSPACE_ARIA_LABEL\"] = \"Blockly Workspace\";\nBlockly.Msg[\"WORKSPACE_COMMENT_DEFAULT_TEXT\"] = \"Say something...\";\nBlockly.Msg[\"CONTROLS_FOREACH_INPUT_DO\"] = Blockly.Msg[\"CONTROLS_REPEAT_INPUT_DO\"];\nBlockly.Msg[\"CONTROLS_FOR_INPUT_DO\"] = Blockly.Msg[\"CONTROLS_REPEAT_INPUT_DO\"];\nBlockly.Msg[\"CONTROLS_IF_ELSEIF_TITLE_ELSEIF\"] = Blockly.Msg[\"CONTROLS_IF_MSG_ELSEIF\"];\nBlockly.Msg[\"CONTROLS_IF_ELSE_TITLE_ELSE\"] = Blockly.Msg[\"CONTROLS_IF_MSG_ELSE\"];\nBlockly.Msg[\"CONTROLS_IF_IF_TITLE_IF\"] = Blockly.Msg[\"CONTROLS_IF_MSG_IF\"];\nBlockly.Msg[\"CONTROLS_IF_MSG_THEN\"] = Blockly.Msg[\"CONTROLS_REPEAT_INPUT_DO\"];\nBlockly.Msg[\"CONTROLS_WHILEUNTIL_INPUT_DO\"] = Blockly.Msg[\"CONTROLS_REPEAT_INPUT_DO\"];\nBlockly.Msg[\"LISTS_CREATE_WITH_ITEM_TITLE\"] = Blockly.Msg[\"VARIABLES_DEFAULT_NAME\"];\nBlockly.Msg[\"LISTS_GET_INDEX_HELPURL\"] = Blockly.Msg[\"LISTS_INDEX_OF_HELPURL\"];\nBlockly.Msg[\"LISTS_GET_INDEX_INPUT_IN_LIST\"] = Blockly.Msg[\"LISTS_INLIST\"];\nBlockly.Msg[\"LISTS_GET_SUBLIST_INPUT_IN_LIST\"] = Blockly.Msg[\"LISTS_INLIST\"];\nBlockly.Msg[\"LISTS_INDEX_OF_INPUT_IN_LIST\"] = Blockly.Msg[\"LISTS_INLIST\"];\nBlockly.Msg[\"LISTS_SET_INDEX_INPUT_IN_LIST\"] = Blockly.Msg[\"LISTS_INLIST\"];\nBlockly.Msg[\"MATH_CHANGE_TITLE_ITEM\"] = Blockly.Msg[\"VARIABLES_DEFAULT_NAME\"];\nBlockly.Msg[\"PROCEDURES_DEFRETURN_COMMENT\"] = Blockly.Msg[\"PROCEDURES_DEFNORETURN_COMMENT\"];\nBlockly.Msg[\"PROCEDURES_DEFRETURN_DO\"] = Blockly.Msg[\"PROCEDURES_DEFNORETURN_DO\"];\nBlockly.Msg[\"PROCEDURES_DEFRETURN_PROCEDURE\"] = Blockly.Msg[\"PROCEDURES_DEFNORETURN_PROCEDURE\"];\nBlockly.Msg[\"PROCEDURES_DEFRETURN_TITLE\"] = Blockly.Msg[\"PROCEDURES_DEFNORETURN_TITLE\"];\nBlockly.Msg[\"TEXT_APPEND_VARIABLE\"] = Blockly.Msg[\"VARIABLES_DEFAULT_NAME\"];\nBlockly.Msg[\"TEXT_CREATE_JOIN_ITEM_TITLE_ITEM\"] = Blockly.Msg[\"VARIABLES_DEFAULT_NAME\"];\n\nBlockly.Msg[\"MATH_HUE\"] = \"230\";\nBlockly.Msg[\"LOOPS_HUE\"] = \"120\";\nBlockly.Msg[\"LISTS_HUE\"] = \"260\";\nBlockly.Msg[\"LOGIC_HUE\"] = \"210\";\nBlockly.Msg[\"VARIABLES_HUE\"] = \"330\";\nBlockly.Msg[\"TEXTS_HUE\"] = \"160\";\nBlockly.Msg[\"PROCEDURES_HUE\"] = \"290\";\nBlockly.Msg[\"COLOUR_HUE\"] = \"20\";\nBlockly.Msg[\"VARIABLES_DYNAMIC_HUE\"] = \"310\";\nreturn Blockly.Msg;\n}));\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./node_modules/blockly/msg/en.js?");

/***/ }),

/***/ "./src/index.js":
/*!***********************************!*\
  !*** ./src/index.js + 30 modules ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// NAMESPACE OBJECT: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/shared.js\nvar shared_namespaceObject = {};\n__webpack_require__.r(shared_namespaceObject);\n__webpack_require__.d(shared_namespaceObject, {\n  GLOBAL_KEYWORD: () => (GLOBAL_KEYWORD),\n  handlerParameterPrefix: () => (handlerParameterPrefix),\n  localNamePrefix: () => (localNamePrefix),\n  loopParameterPrefix: () => (loopParameterPrefix),\n  loopRangeParameterPrefix: () => (loopRangeParameterPrefix),\n  menuSeparator: () => (menuSeparator),\n  possiblyPrefixGeneratedVarName: () => (possiblyPrefixGeneratedVarName),\n  possiblyPrefixMenuNameWith: () => (possiblyPrefixMenuNameWith),\n  prefixGlobalMenuName: () => (prefixGlobalMenuName),\n  prefixSeparator: () => (prefixSeparator),\n  procedureParameterPrefix: () => (procedureParameterPrefix),\n  showPrefixToUser: () => (showPrefixToUser),\n  unprefixName: () => (unprefixName),\n  usePrefixInCode: () => (usePrefixInCode)\n});\n\n// EXTERNAL MODULE: ./node_modules/blockly/index.js\nvar blockly = __webpack_require__(\"./node_modules/blockly/index.js\");\n// EXTERNAL MODULE: ./node_modules/blockly/javascript.js\nvar javascript = __webpack_require__(\"./node_modules/blockly/javascript.js\");\n// EXTERNAL MODULE: ./node_modules/blockly/core-browser.js\nvar core_browser = __webpack_require__(\"./node_modules/blockly/core-browser.js\");\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/css.js\n\n\n\n\n/**\n * Array making up the extra CSS content for added Blockly fields.\n */\nconst EXTRA_CSS = `\n  .blocklyFieldParameter>rect {\n    fill: rgb(222, 143, 108);\n    fill-opacity: 1.0;\n    stroke-width: 2;\n    stroke: rgb(231, 175, 150);\n  }\n  .blocklyFieldParameter>text {\n    stroke-width: 1;\n    fill: #000;\n  }\n  .blocklyFieldParameter:hover>rect {\n    stroke-width: 2;\n    stroke: rgb(231,175,150);\n    fill: rgb(231,175,150);\n    fill-opacity: 1.0;\n  }\n  /*\n   * [lyn, 10/08/13] Control flydown with the getter/setter blocks.\n   */\n  .blocklyFieldParameterFlydown {\n    fill: rgb(231,175,150);\n    fill-opacity: 0.8;\n  }\n  /*\n   * [lyn, 10/08/13] Control parameter fields with flydown procedure\n   * caller block.\n   */\n  .blocklyFieldProcedure>rect {\n    fill: rgb(215,203,218);\n    fill-opacity: 1.0;\n    stroke-width: 0;\n    stroke: #000;\n  }\n  .blocklyFieldProcedure>text {\n    fill: #000;\n  }\n  .blocklyFieldProcedure:hover>rect {\n    stroke-width: 2;\n    stroke: #fff;\n    fill: rgb(215,203,218);\n    fill-opacity: 1.0;\n  }\n  /*\n   * [lyn, 10/08/13] Control flydown with the procedure caller block.\n   */\n  .blocklyFieldProcedureFlydown {\n    fill: rgb(215,203,218);\n    fill-opacity: 0.8;\n  }\n`;\n\n/**\n * Register our extra CSS with Blockly.\n */\nfunction registerCss() {\n  core_browser.Css.register(EXTRA_CSS);\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/msg.js\n/**\n * @license\n * Copyright 2021 Mark Friedman\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Translatable messages used in lexical variable code.\n * @author mark.friedman@gmail.com (Mark Friedman)\n * Based on code from MIT App Inventor\n */\n\n\n\ncore_browser.Msg['LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT'] =\n    'initialize global';\ncore_browser.Msg['LANG_VARIABLES_GLOBAL_DECLARATION_NAME'] = 'name';\ncore_browser.Msg['LANG_VARIABLES_GLOBAL_DECLARATION_TO'] = 'to';\ncore_browser.Msg['LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT'] = 'global';\ncore_browser.Msg['LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP'] =\n    'Creates a global variable and gives it the value of the attached blocks.';\ncore_browser.Msg['LANG_VARIABLES_GLOBAL_PREFIX'] = 'global';\ncore_browser.Msg['LANG_VARIABLES_GET_TITLE_GET'] = 'get';\ncore_browser.Msg['LANG_VARIABLES_GET_COLLAPSED_TEXT'] = 'get';\ncore_browser.Msg['LANG_VARIABLES_GET_TOOLTIP'] =\n    'Returns the value of this variable.';\ncore_browser.Msg['LANG_VARIABLES_SET_TITLE_SET'] = 'set';\ncore_browser.Msg['LANG_VARIABLES_SET_TITLE_TO'] = 'to';\ncore_browser.Msg['LANG_VARIABLES_SET_COLLAPSED_TEXT'] = 'set';\ncore_browser.Msg['LANG_VARIABLES_SET_TOOLTIP'] =\n    'Sets this variable to be equal to the input.';\ncore_browser.Msg['LANG_VARIABLES_VARIABLE'] = ' variable';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT'] = 'initialize local';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME'] = 'name';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO'] = 'to';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_IN_DO'] = 'in';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT'] = 'local';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP'] =\n    'Allows you to create variables that are only accessible in the do part' +\n    ' of this block.';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME'] =\n    'initialize local in do';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN'] = 'in';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT'] =\n    'local';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP'] =\n    'Allows you to create variables that are only accessible in the return' +\n    ' part of this block.';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME'] =\n    'initialize local in return';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES'] =\n    'local names';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP'] = '';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME'] = 'name';\ncore_browser.Msg['LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE'] = 'x';\ncore_browser.Msg['LANG_PROCEDURES_DEFNORETURN_DEFINE'] = 'to';\ncore_browser.Msg['LANG_PROCEDURES_DEFNORETURN_PROCEDURE'] = 'procedure';\ncore_browser.Msg['LANG_PROCEDURES_DEFNORETURN_DO'] = 'do';\ncore_browser.Msg['LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX'] = 'to ';\ncore_browser.Msg['LANG_PROCEDURES_DEFNORETURN_TOOLTIP'] =\n    'A procedure that does not return a value.';\ncore_browser.Msg['LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN'] = 'result';\ncore_browser.Msg['LANG_PROCEDURES_DOTHENRETURN_DO'] = 'do';\ncore_browser.Msg['LANG_PROCEDURES_DOTHENRETURN_RETURN'] = 'result';\ncore_browser.Msg['LANG_PROCEDURES_DOTHENRETURN_TOOLTIP'] =\n    'Runs the blocks in \\'do\\' and returns a statement. Useful if you need' +\n    ' to run a procedure before returning a value to a variable.';\ncore_browser.Msg['LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT'] = 'do/result';\ncore_browser.Msg['LANG_PROCEDURES_DEFRETURN_DEFINE'] = 'to';\ncore_browser.Msg['LANG_PROCEDURES_DEFRETURN_PROCEDURE'] = 'procedure';\ncore_browser.Msg['LANG_PROCEDURES_DEFRETURN_RETURN'] = 'result';\ncore_browser.Msg['LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX'] = 'to ';\ncore_browser.Msg['LANG_PROCEDURES_DEFRETURN_TOOLTIP'] =\n    'A procedure returning a result value.';\ncore_browser.Msg['LANG_PROCEDURES_DEF_DUPLICATE_WARNING'] =\n    'Warning:\\nThis procedure has\\nduplicate inputs.';\ncore_browser.Msg['LANG_PROCEDURES_CALLNORETURN_CALL'] = 'call ';\ncore_browser.Msg['LANG_PROCEDURES_CALLNORETURN_PROCEDURE'] = 'procedure';\ncore_browser.Msg['LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX'] = 'call ';\ncore_browser.Msg['LANG_PROCEDURES_CALLNORETURN_TOOLTIP'] =\n    'Call a procedure with no return value.';\ncore_browser.Msg['LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME'] = 'call no return';\ncore_browser.Msg['LANG_PROCEDURES_CALLRETURN_CALL'] = 'call ';\ncore_browser.Msg['LANG_PROCEDURES_CALLRETURN_PROCEDURE'] = 'procedure';\ncore_browser.Msg['LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX'] = 'call ';\ncore_browser.Msg['LANG_PROCEDURES_CALLRETURN_TOOLTIP'] =\n    'Call a procedure with a return value.';\ncore_browser.Msg['LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME'] = 'call return';\ncore_browser.Msg['LANG_PROCEDURES_MUTATORCONTAINER_TITLE'] = 'inputs';\ncore_browser.Msg['LANG_PROCEDURES_MUTATORARG_TITLE'] = 'input:';\ncore_browser.Msg['LANG_PROCEDURES_HIGHLIGHT_DEF'] = 'Highlight Procedure';\ncore_browser.Msg['LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP'] = '';\ncore_browser.Msg['LANG_PROCEDURES_MUTATORARG_TOOLTIP'] = '';\ncore_browser.Msg['LANG_CONTROLS_FOR_INPUT_WITH'] = 'count with';\ncore_browser.Msg['LANG_CONTROLS_FOR_INPUT_VAR'] = 'x';\ncore_browser.Msg['LANG_CONTROLS_FOR_INPUT_FROM'] = 'from';\ncore_browser.Msg['LANG_CONTROLS_FOR_INPUT_TO'] = 'to';\ncore_browser.Msg['LANG_CONTROLS_FOR_INPUT_DO'] = 'do';\ncore_browser.Msg['LANG_CONTROLS_FOR_TOOLTIP'] =\n    'Count from a start number to an end number.\\nFor each count, set the' +\n    ' current count number to\\nvariable \\'%1\\', and then do some statements.';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_ITEM'] = 'for each';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_VAR'] = 'number';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_START'] = 'from';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_END'] = 'to';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_STEP'] = 'by';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_DO'] = 'do';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT'] =\n    'for number in range';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX'] = 'for';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX'] = ' in range';\ncore_browser.Msg['LANG_CONTROLS_FORRANGE_TOOLTIP'] =\n    'Runs the blocks in the \\'do\\' section for each numeric value in the' +\n    ' range from start to end, stepping the value each time.  Use the given' +\n    ' variable name to refer to the current value.';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_ITEM'] = 'for each';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_VAR'] = 'item';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_INLIST'] = 'in list';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_DO'] = 'do';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT'] = 'for item in list';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX'] = 'for ';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX'] = ' in list';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_TOOLTIP'] =\n    'Runs the blocks in the \\'do\\'  section for each item in the list.  Use' +\n    ' the given variable name to refer to the current list item.';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_DICT_INPUT'] =\n    'for each %1 with %2 in dictionary %3';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_DICT_INPUT_DO'] = 'do';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_DICT_INPUT_KEY'] = 'key';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE'] = 'value';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_DICT_TITLE'] = 'for each in dictionary';\ncore_browser.Msg['LANG_CONTROLS_FOREACH_DICT_TOOLTIP'] =\n    'Runs the blocks in the \\'do\\' section for each key-value entry in the' +\n    ' dictionary. Use the given variable names to refer to the key/value of' +\n    ' the current dictionary item.';\ncore_browser.Msg['ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN'] =\n    'Select a valid item in the drop down.';\ncore_browser.Msg['ERROR_BLOCK_CANNOT_BE_IN_DEFINITION'] =\n    'This block cannot be in a definition';\ncore_browser.Msg['HORIZONTAL_PARAMETERS'] = 'Arrange Parameters Horizontally';\ncore_browser.Msg['VERTICAL_PARAMETERS'] = 'Arrange Parameters Vertically';\ncore_browser.Msg['LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO'] = 'do';\ncore_browser.Msg['LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN'] = 'result';\ncore_browser.Msg['LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP'] =\n    'Runs the blocks in \\'do\\' and returns a statement. Useful if you need to' +\n    ' run a procedure before returning a value to a variable.';\ncore_browser.Msg['LANG_CONTROLS_DO_THEN_RETURN_COLLAPSED_TEXT'] = 'do/result';\ncore_browser.Msg['LANG_CONTROLS_DO_THEN_RETURN_TITLE'] = 'do result';\ncore_browser.Msg['PROCEDURES_DEFNORETURN_PROCEDURE'] = core_browser.Msg['LANG_PROCEDURES_DEFNORETURN_PROCEDURE'];\ncore_browser.Msg['PROCEDURES_DEFRETURN_PROCEDURE'] = core_browser.Msg['LANG_PROCEDURES_DEFRETURN_PROCEDURE'];\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/utilities.js\n/**\n * @fileoverview Block utilities for Blockly, modified for App Inventor.\n * @author mckinney@mit.edu (Andrew F. McKinney)\n * @author hal@mit.edu (Hal Abelson)\n * @author fraser@google.com (Neil Fraser)\n * Due to the frequency of long strings, the 80-column wrap rule need not apply\n * to language files.\n */\n\n\n\n\n\n\n/**\n * Checks that the given otherConnection is compatible with an InstantInTime\n * connection. If the workspace is currently loading (eg the blocks are not\n * yet rendered) this always returns true for backwards compatibility.\n * @param {!Blockly.Connection} myConn The parent connection.\n * @param {!Blockly.Connection} otherConn The child connection.\n *\n * @return {boolean}\n */\nconst InstantInTime = function(myConn, otherConn) {\n  if (!myConn.sourceBlock_.rendered ||\n      !otherConn.sourceBlock_.rendered) {\n    if (otherConn.check_ && !otherConn.check_.includes('InstantInTime')) {\n      otherConn.sourceBlock_.badBlock();\n    }\n    return true;\n  }\n  return !otherConn.check_ || otherConn.check_.includes('InstantInTime');\n};\n\n\n// Convert Yail types to Blockly types\n// Yail types are represented by strings: number, text, list, any, ...\n// Blockly types are represented by objects: Number, String, ...\n// and by the string \"COMPONENT\"\n// The Yail type 'any' is repsented by Javascript null, to match\n// Blockly's convention\nconst YailTypeToBlocklyTypeMap = {\n  'number': {\n    'input': ['Number'],\n    'output': ['Number', 'String', 'Key'],\n  },\n  'text': {\n    'input': ['String'],\n    'output': ['Number', 'String', 'Key'],\n  },\n  'boolean': {\n    'input': ['Boolean'],\n    'output': ['Boolean', 'String'],\n  },\n  'list': {\n    'input': ['Array'],\n    'output': ['Array', 'String'],\n  },\n  'component': {\n    'input': ['COMPONENT'],\n    'output': ['COMPONENT', 'Key'],\n  },\n  'InstantInTime': {\n    'input': ['InstantInTime', InstantInTime],\n    'output': ['InstantInTime', InstantInTime],\n  },\n  'any': {\n    'input': null,\n    'output': null,\n  },\n  'dictionary': {\n    'input': ['Dictionary'],\n    'output': ['Dictionary', 'String', 'Array'],\n  },\n  'pair': {\n    'input': ['Pair'],\n    'output': ['Pair', 'String', 'Array'],\n  },\n  'key': {\n    'input': ['Key'],\n    'output': ['String', 'Key'],\n  },\n};\n\nconst OUTPUT = 'output';\nconst INPUT = 'input';\n\n/**\n * Gets the equivalent Blockly type for a given Yail type.\n * @param {string} yail The Yail type.\n * @param {!string} inputOrOutput Either Utilities.OUTPUT or Utilities.INPUT.\n * @param {Array<string>=} opt_currentType A type array to append, or null.\n *\n * @return {string}\n */\nconst yailTypeToBlocklyType = function(yail, inputOrOutput) {\n  const type = YailTypeToBlocklyTypeMap[yail][inputOrOutput];\n  if (type === undefined) {\n    throw new Error('Unknown Yail type: ' + yail + ' -- YailTypeToBlocklyType');\n  }\n  return type;\n};\n\n\n// Blockly doesn't wrap tooltips, so these can get too wide.  We'll create our\n// own tooltip setter that wraps to length 60.\n\nconst setTooltip = function(block, tooltip) {\n  block.setTooltip(wrapSentence(tooltip, 60));\n};\n\n// Wrap a string by splitting at spaces. Permit long chunks if there\n// are no spaces.\n\nconst wrapSentence = function(str, len) {\n  str = str.trim();\n  if (str.length < len) return str;\n  const place = (str.lastIndexOf(' ', len));\n  if (place == -1) {\n    return str.substring(0, len).trim() +\n        wrapSentence(str.substring(len), len);\n  } else {\n    return str.substring(0, place).trim() + '\\n' +\n        wrapSentence(str.substring(place), len);\n  }\n};\n\n/**\n * Returns an array containing just the element children of the given element.\n * @param {Element} element The element whose element children we want.\n * @return {!(Array<!Element>|NodeList<!Element>)} An array or array-like list\n *     of just the element children of the given element.\n */\nconst getChildren = function(element) {\n  'use strict';\n  // We check if the children attribute is supported for child elements\n  // since IE8 misuses the attribute by also including comments.\n  if (element.children !== undefined) {\n    return element.children;\n  }\n  // Fall back to manually filtering the element's child nodes.\n  return Array.prototype.filter.call(element.childNodes, function(node) {\n    return node.nodeType == core_browser.utils.dom.NodeType.ELEMENT_NODE;\n  });\n};\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/warningHandler.js\n// -*- mode: javascript; c-basic-offset: 2; -*-\n// Copyright © 2013-2016 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * Methods to handle warnings in the block editor.\n *\n * @author mckinney@mit.edu (Andrew F. McKinney)\n * @author mark.friedman@gmail.com (Mark Friedman)\n */\n\n\n\n\n\n\nclass WarningHandler {\n  /**\n   * Takes a block as the context (this), puts the appropriate error or warning\n   * on the block.\n   * @param {Blockly.Block} block The block to check for errors.\n   */\n  checkErrors(block) {\n    if ((block.getSvgRoot && !block.getSvgRoot()) || block.readOnly) {\n      // remove from error count\n      if (block.hasWarning) {\n        block.hasWarning = false;\n      }\n      if (block.hasError) {\n        block.hasError = false;\n      }\n      return;\n    }\n\n    // give the block empty arrays of errors and warnings to check if they aren't\n    // defined.\n    if (!block.errors) {\n      block.errors = [];\n    }\n    if (!block.warnings) {\n      block.warnings = [];\n    }\n\n    // add warnings and errors that are on every block\n    const errorTestArray = block.errors;\n    const warningTestArray = block.warnings;\n\n    // check if there are any errors\n    for (let i=0; i<errorTestArray.length; i++) {\n      if (errorTestArray[i].func &&\n          errorTestArray[i].func.call(this, block, errorTestArray[i])) {\n        if (!block.hasError) {\n          block.hasError = true;\n        }\n        if (block.hasWarning) {\n          block.hasWarning = false;\n        }\n        return;\n      }\n    }\n\n    if (block.hasError) {\n      block.hasError = false;\n    }\n    // if there are no errors, check for warnings\n    for (let i=0; i<warningTestArray.length; i++) {\n      if (warningTestArray[i].func &&\n          warningTestArray[i].func.call(this, block, warningTestArray[i])) {\n        if (!block.hasWarning) {\n          block.hasWarning = true;\n        }\n        return;\n      }\n    }\n\n    // remove the warning icon, if there is one\n    if (block.warning) {\n      block.setWarningText(null);\n    }\n    if (block.hasWarning) {\n      block.hasWarning = false;\n    }\n  };\n  setError(block, message) {\n    block.setWarningText(message);\n  }\n\n  setWarning(block, message) {\n    block.setWarningText(message);\n  }\n}\n\nclass ErrorCheckers {\n  // Errors\n\n// Errors indicate that the project will not run\n// Each function returns true if there is an error, and sets the error text on\n// the block\n\n// Check if the block is inside of a variable declaration block, if so, create\n// an error\n  static checkIsInDefinition(block) {\n    // Allow property getters as they should be pure.\n    const rootBlock = block.getRootBlock();\n    if (rootBlock.type === 'global_declaration') {\n      const errorMessage = core_browser.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION;\n      block.workspace.getWarningHandler().setError(block, errorMessage);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n\n// Check if the block has an invalid drop down value, if so, create an error\n  static checkDropDownContainsValidValue(block, params) {\n    if (block.workspace.isDragging && block.workspace.isDragging()) {\n      return false; // wait until the user is done dragging to check validity.\n    }\n    for (let i=0; i<params.dropDowns.length; i++) {\n      const dropDown = block.getField(params.dropDowns[i]);\n      const dropDownList = dropDown.menuGenerator_();\n      const text = dropDown.getText();\n      const value = dropDown.getValue();\n      let textInDropDown = false;\n      if (dropDown.updateMutation) {\n        dropDown.updateMutation();\n      }\n      for (let k=0; k<dropDownList.length; k++) {\n        if (dropDownList[k][1] === value && value !== ' ') {\n          textInDropDown = true;\n          // A mismatch in the untranslated value and translated text can be\n          // corrected.\n          if (dropDownList[k][0] !== text) {\n            dropDown.setValue(dropDownList[k][0]);\n          }\n          break;\n        }\n      }\n      if (!textInDropDown) {\n        const errorMessage = core_browser.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN;\n        block.workspace.getWarningHandler().setError(block, errorMessage);\n        return true;\n      }\n    }\n    return false;\n  };\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/instrument.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2013-2014 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Visual blocks editor for MIT App Inventor\n * Instrumentation (timing and statistics) for core blockly functionality\n * that's useful for figuring out where time is being spent.\n * Lyn used this in conjunction with Chrome profiling to speed up\n * loading, dragging, and expanding collapsed blocks in large projecsts.\n *\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n\n\n// TODO: Maybe just delete this file and delete all the instrumentation\n// booleans since they all are set to true by default.\n\n/** Is instrumentation turned on? */\n// isOn = true;\nlet isOn = false; // [lyn, 04/08/14] Turn off for production\n\n/**\n * Turn instrumentation on/off.\n * @param bool\n */\nconst setOn = function(bool) {\n  isOn = bool;\n};\n\n/** The following are global flags to control rendering.\n * The default settings give the best performance.\n * Other settings can be use to show slowdowns for different choices/algorithms.\n */\n\n/**\n * [lyn, 04/01/14] Should we use the Blockly.Block.isRenderingOn flag?\n * Default value = true.\n */\nconst useIsRenderingOn = true;\n\n/**\n * [lyn, 04/01/14] Should we avoid workspace render in Blockly.Block.onMouseUp_?\n * Default value = true.\n */\nconst avoidRenderWorkspaceInMouseUp = true;\n\n/** [lyn, 04/01/14] Global flag to control rendering algorithm,\n * Used to show that renderDown() is better than render() in many situations.\n * Default value = true.\n */\nconst useRenderDown = true;\n\n/** [lyn, 04/01/14] Should we avoid renderDown on subblocks of collapsed blocks\n * Default value = true.\n */\nconst avoidRenderDownOnCollapsedSubblocks = true;\n\n/** [lyn, 04/01/14] Use Neil's fix to Blockly.Block.getHeightWidth, which\n * sidesteps the inexplicable quadratic problem with getHeightWidth.\n * Default value = true.\n */\nconst useNeilGetHeightWidthFix = true;\n\n/** [lyn, 04/01/14] Use my fix to Blockly.Workspace.prototype.getAllBlocks,\n *  which avoids quadratic behavior in Neil's original version.\n */\nconst useLynGetAllBlocksFix = true;\n\n/** [lyn, 04/01/14] Use my fix to Blockly.FieldLexicalVariable.getGlobalNames,\n *  which just looks at top blocks in workspace, and not all blocks.\n */\nconst useLynGetGlobalNamesFix = true;\n\n/** [lyn, 04/01/14] In\n * Blockly.WarningHandler.checkAllBlocksForWarningsAndErrors,\n * compute Blockly.FieldLexicalVariable.getGlobalNames only once and cache it\n * so that it needn't be computed again.\n */\nconst useLynCacheGlobalNames = true;\n\n/** [lyn, 04/05/14] Stats to track improvements in slow removal */\nconst stats = {};\n\nconst statNames = [\n  'totalTime',\n  'topBlockCount',\n  'blockCount',\n  'domToBlockCalls',\n  'domToBlockTime',\n  'domToBlockInnerCalls',\n  'domToWorkspaceCalls',\n  'domToWorkspaceTime',\n  'workspaceRenderCalls',\n  'workspaceRenderTime',\n  'renderCalls',\n  // Hard to track without double counting because of its recursive nature. Use\n  // renderHereTime instead.\n  // \"renderTime\",\n  'renderDownCalls',\n  'renderDownTime',\n  'renderHereCalls',\n  'renderHereTime',\n  'getHeightWidthCalls',\n  'getHeightWidthTime',\n  'getTopBlocksCalls',\n  'getTopBlocksTime',\n  'getAllBlocksCalls',\n  'getAllBlocksTime',\n  'getAllBlocksAllocationCalls',\n  'getAllBlocksAllocationSpace',\n  'checkAllBlocksForWarningsAndErrorsCalls',\n  'checkAllBlocksForWarningsAndErrorsTime',\n  'scrollBarResizeCalls',\n  'scrollBarResizeTime',\n  'trashCanPositionCalls',\n  'trashCanPositionTime',\n  'expandCollapsedCalls',\n  'expandCollapsedTime',\n];\n\nconst initializeStats = function(name) {\n  if (isOn) {\n    console.log('Initializing stats for ' + name);\n    const names = statNames;\n    const stats = stats;\n    for (let i = 0, name; name = names[i]; i++) {\n      stats[name] = 0;\n    }\n  }\n};\n\nconst displayStats = function(name) {\n  if (isOn) {\n    const names = statNames;\n    const stats = stats;\n    console.log('Displaying stats for ' + name + ':');\n    console.log('  Instrument.useRenderDown=' +\n        useRenderDown);\n    console.log('  Instrument.useIsRenderingOn=' +\n        useIsRenderingOn);\n    console.log('  Instrument.avoidRenderWorkspaceInMouseUp=' +\n        avoidRenderWorkspaceInMouseUp);\n    console.log('  Instrument.avoidRenderDownOnCollapsedSubblocks=' +\n        avoidRenderDownOnCollapsedSubblocks);\n    console.log('  Instrument.useNeilGetHeightWidthFix=' +\n        useNeilGetHeightWidthFix);\n    console.log('  Instrument.useLynGetAllBlocksFix=' +\n        useLynGetAllBlocksFix);\n    console.log('  Instrument.useLynGetGlobalNamesFix=' +\n        useLynGetGlobalNamesFix);\n    console.log('  Instrument.useLynCacheGlobalNames=' +\n        useLynCacheGlobalNames);\n    for (let i = 0, name; name = names[i]; i++) {\n      console.log('  ' + name + '=' + stats[name]);\n    }\n  }\n};\n\nconst timer = function(thunk, callback) {\n  if (isOn) {\n    const start = new Date().getTime();\n    const result = thunk();\n    const stop = new Date().getTime();\n    return callback(result, stop - start);\n  } else {\n    const result = thunk();\n    return callback(result, 0);\n  }\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/shared.js\n\n\n\n/* [Added by paulmw in patch 15]\n   There are three ways that you can change how lexical variables\n   are handled:\n\n   1. Show prefixes to users, and separate namespace in code\n   Blockly.showPrefixToUser = true;\n   Blockly.usePrefixInCode = true;\n\n   2. Show prefixes to users, lexical variables share namespace code\n   Blockly.showPrefixToUser = true;\n   Blockly.usePrefixInCode = false;\n\n   3. Hide prefixes from users, lexical variables share namespace code\n   //The default (as of 12/21/12)\n   Blockly.showPrefixToUser = false;\n   Blockly.usePrefixInCode = false;\n\n   It is not possible to hide the prefix and have separate namespaces\n   because Blockly does not allow to items in a list to have the same name\n   (plus it would be confusing...)\n\n*/\n\nconst showPrefixToUser = false;\nconst usePrefixInCode = false;\n\n/** ****************************************************************************\n [lyn, 12/23-27/2012, patch 16]\n Prefix labels for parameters, locals, and index variables,\n Might want to experiment with different combintations of these. E.g.,\n maybe all non global parameters have prefix \"local\" or all have prefix \"param\".\n Maybe index variables have prefix \"index\", or maybe instead they are treated as\n \"param\".\n */\n\n/**\n * The global keyword. Users may be shown a translated keyword instead but this\n * is the internal token used to identify global variables.\n * @type {string}\n * @const\n */\n// used internally to identify global variables; not translated\nconst GLOBAL_KEYWORD = 'global';\n// For names introduced by procedure/function declarations\nconst procedureParameterPrefix = 'input';\n// For names introduced by event handlers\nconst handlerParameterPrefix = 'input';\n// For names introduced by local variable declarations\nconst localNamePrefix = 'local';\n// For names introduced by for loops\nconst loopParameterPrefix = 'item';\n// For names introduced by for range loops\nconst loopRangeParameterPrefix = 'counter';\n// Separate prefix from name with this. E.g., space in \"param x\"\nconst menuSeparator = ' ';\n// Separate prefix from name with this. E.g., underscore \"param_ x\"\nconst prefixSeparator = '_';\n\n// Curried for convenient use in field_lexical_variable.js\n// e.g., \"param x\" vs \"x\"\nconst possiblyPrefixMenuNameWith = function(prefix) {\n  return function(name) {\n    return (showPrefixToUser ? (prefix + menuSeparator) : '') +\n      name;\n  };\n};\n\nconst prefixGlobalMenuName = function(name) {\n  return core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX +\n    menuSeparator + name;\n};\n\n// Return a list of (1) prefix (if it exists, \"\" if not) and (2) unprefixed name\nconst unprefixName = function(name) {\n  if (name.indexOf(\n      core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX + menuSeparator) === 0) {\n    // Globals always have prefix, regardless of flags. Handle these specially\n    return [\n      core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX,\n      name.substring(core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX.length +\n        menuSeparator.length)];\n  } else if (name.indexOf(GLOBAL_KEYWORD + menuSeparator) === 0) {\n    return [GLOBAL_KEYWORD, name.substring(6 + menuSeparator.length)];\n  } else if (!showPrefixToUser) {\n    return ['', name];\n  } else {\n    const prefixes = [\n      procedureParameterPrefix,\n      handlerParameterPrefix,\n      localNamePrefix,\n      loopParameterPrefix,\n      loopRangeParameterPrefix,\n    ];\n    for (let i=0; i < prefixes.length; i++) {\n      if (name.indexOf(prefixes[i]) === 0) {\n        // name begins with prefix\n        return [\n          prefixes[i],\n          name.substring(prefixes[i].length + menuSeparator.length),\n        ];\n      }\n    }\n    // Really an error if get here ...\n    return ['', name];\n  }\n};\n\n// Curried for convenient use in generators/lexical-variables.js\nconst possiblyPrefixGeneratedVarName = function(prefix) {\n  return function(name) {\n    // e.g., \"param_x\" vs \"x\"\n    return (usePrefixInCode ? (prefix + prefixSeparator) : '') + name;\n  };\n};\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/nameSet.js\n/**\n * @fileoverview Represent sets of strings and numbers as JavaScript objects\n *   with an elements field that is itself an object mapping each element to true.\n * Note that ECMAScript 6 supports sets, but we cannot rely on sites using this recent a version\n * TODO(mark-friedman): We may now be safe to rewrite this using ECMAScript 6\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n\n/**\n * History:\n * [lyn, 06/30/14] added to ai2inter (should also add to master)\n * [lyn, 11/16/13] created\n */\n\n/**\n * Construct a set from a list. If no list is provided, construct the empty set.\n */\nconst nameSet_NameSet = function(names) {\n    if (!names) {\n        names = [];\n    }\n    this.elements = {};\n    for (let i = 0, name; name = names[i]; i++) {\n        this.elements[name] = true;\n    }\n}\n\n/**\n * Set membership\n * @param x: any value\n * @returns true if x is in set and false otherwise\n */\nnameSet_NameSet.prototype.isMember = function(x) {\n    return !!this.elements[x]; // !! converts falsey to false\n}\n\n/**\n * Set emptiness\n * @returns true if set is empty and false otherwise.\n */\nnameSet_NameSet.prototype.isEmpty = function() {\n    for(let elt in this.elements) {\n        return false;\n    }\n    return true;\n}\n\n/**\n * Set size\n * @returns the number of elements in the set\n */\nnameSet_NameSet.prototype.size = function() {\n    let size = 0;\n    for(let elt in this.elements) {\n        size++;\n    }\n    return size;\n}\n\n/**\n * Return a list (i.e. array) of names in this set, in lexicographic order.\n */\nnameSet_NameSet.prototype.toList = function() {\n    const result = [];\n    for (let elt in this.elements) {\n        result.push(elt);\n    }\n    return result.sort();\n}\n\n/**\n * @returns a string representation of this set.\n */\nnameSet_NameSet.prototype.toString = function() {\n    return \"NameSet{\" + this.toList().join(\",\")  + \"}\";\n}\n\n/**\n * Return a copy of this set\n */\nnameSet_NameSet.prototype.copy = function() {\n    const result = new nameSet_NameSet();\n    for (let elt in this.elements) {\n        result.insert(elt);\n    }\n    return result;\n}\n\n/**\n * Change this set to have the same elements as otherSet\n */\nnameSet_NameSet.prototype.mirror = function(otherSet) {\n    let elt;\n    for (elt in this.elements) {\n        delete this.elements[elt];\n    }\n    for (elt in otherSet.elements) {\n        this.elements[elt] = true;\n    }\n}\n\n/************************************************************\n * DESTRUCTIVE OPERATIONS\n * Change the existing set\n ************************************************************/\n\n/**\n * Destructive set insertion\n * Insert x into the set. Does not complain if x already in the set.\n * @param x: any value\n */\nnameSet_NameSet.prototype.insert = function(x) {\n    this.elements[x] = true;\n}\n\n/**\n * Destructive set deletion.\n * Removes x from the set. Does not complain if x not in the set.\n * Note: This used to be called just \"delete\" but delete is a reserved\n * word, so we call this deleteName instead\n *\n * @param x: any value\n */\nnameSet_NameSet.prototype.deleteName = function(x) {\n    delete this.elements[x];\n}\n\n/**\n * Destructive set union\n * Change this set to have the union of its elements with the elements of the other set\n * @param otherSet: a NameSet\n */\nnameSet_NameSet.prototype.unite = function(otherSet) {\n    for (let elt in otherSet.elements) {\n        this.elements[elt] = true;\n    }\n}\n\n/**\n * Destructive set intersection\n * Change this set to have the intersection of its elements with the elements of the other set\n * @param otherSet: a NameSet\n */\nnameSet_NameSet.prototype.intersect = function(otherSet) {\n    for (let elt in this.elements) {\n        if (!otherSet.elements[elt]) {\n            delete this.elements[elt];\n        }\n    }\n}\n\n/**\n * Destructive set difference\n * Change this set to have the difference of its elements with the elements of the other set\n * @param otherSet: a NameSet\n */\nnameSet_NameSet.prototype.subtract = function(otherSet) {\n    for (let elt in this.elements) {\n        if (otherSet.elements[elt]) {\n            delete this.elements[elt];\n        }\n    }\n}\n\n/**\n * Destructive set renaming\n * Modifies existing set to rename those elements that are in the given renaming.\n * Since multiple elements may rename to the same element, this may reduce the\n * size of the set.\n * @param substitution: a substitution mapping old names to new names\n *\n */\nnameSet_NameSet.prototype.rename = function(substitution) {\n    this.mirror(this.renamed(substitution));\n}\n\n/************************************************************\n * NONDESTRUCTIVE OPERATIONS\n * Return new sets/lists/strings\n ************************************************************/\n\n/**\n * Nondestructive set insertion\n * Insert x into the set. Does not complain if x already in the set.\n * @param x: any value\n */\nnameSet_NameSet.prototype.insertion = function(x) {\n    const result = this.copy();\n    result.insert(x);\n    return result;\n}\n\n/**\n * Nondestructive set deletion.\n * Returns a new set containing the elements of this set except for x.\n * * @param x: any value\n */\nnameSet_NameSet.prototype.deletion = function(x) {\n    const result = this.copy();\n    result.deleteName(x);\n    return result;\n}\n\n\n/**\n * Nondestructive set union\n * @param otherSet: a NameSet\n * @returns a new set that is the union of this set and the other set.\n */\nnameSet_NameSet.prototype.union = function(otherSet) {\n    const result = this.copy();\n    result.unite(otherSet);\n    return result;\n}\n\n/**\n * Nondestructive set intersection\n * @param otherSet: a NameSet\n * @returns a new set that is the intersection of this set and the other set.\n */\nnameSet_NameSet.prototype.intersection = function(otherSet) {\n    const result = this.copy();\n    result.intersect(otherSet);\n    return result;\n}\n\n/**\n * Nondestructive set difference\n * @param otherSet: a NameSet\n * @returns a new set that is the differences of this set and the other set.\n */\nnameSet_NameSet.prototype.difference = function(otherSet) {\n    const result = this.copy();\n    result.subtract(otherSet);\n    return result;\n}\n\n/**\n * @param substitution: a substitution mapping old names to new names\n * @returns a new set that renames the elements of this set using the given renaming.\n * If a name is not in the dictionary, it is inserted unchange in the output set.\n */\nnameSet_NameSet.prototype.renamed = function(substitution) {\n    const result = new nameSet_NameSet();\n    for (let elt in this.elements) {\n        const renamedElt = substitution.apply(elt);\n        if (renamedElt) {\n            result.insert(renamedElt);\n        } else {\n            result.insert(elt);\n        }\n    }\n    return result;\n}\n\n/**\n * @param setList: an array of NameSets\n * @returns a NameSet that is the union of all the given sets\n */\nnameSet_NameSet.unionAll = function(setList) {\n    const result = new nameSet_NameSet();\n    for (let i = 0, oneSet; oneSet = setList[i]; i++) {\n        result.unite(oneSet)\n    }\n    return result;\n}\n\n/**\n * @param setList: an array of NameSets\n * @returns a NameSet that is the intersection of all the given sets\n */\nnameSet_NameSet.intersectAll = function(setList) {\n    if (setList.length === 0) {\n        return new nameSet_NameSet();\n    } else {\n        const result = setList[0];\n        for (let i = 1, oneSet; oneSet = setList[i]; i++) {\n            result.intersect(oneSet)\n        }\n        return result;\n    }\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/substitution.js\n/**\n * @fileoverview A substitution is an abstract set of input/output name pairs used for renaming.\n * The inputs form the domain of the substitution; the outputs form the range.\n * Applying a substitution to a name that's an input in its domain maps it to the associated output;\n * Applying a substitution to a name that's not in its domain returns the name unchanged.\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n/**\n * History:\n * [lyn, 06/30/14] added to ai2inter (should also add to master)\n * [lyn, 11/16-17/13] created\n */\n\n/**\n * If the arguments are two equal-length arrays of strings, construct a substitution\n *    by creating a bindings object that maps input strings from the first array\n *    to corresponding strings in the second.\n * If the argument is a single object describing the input/output bindings,\n *   construct a substitution from that.\n * If all other cases (e.g., no argument is provided)/ construct the empty substitution.\n */\nconst Substitution = function(arg1, arg2) {\n    this.bindings = {}; // empty substitution is default.\n    // Test that arg1 and arg2 are equal length arrays of strings\n    if (Substitution.isAllStringsArray(arg2)\n        && Substitution.isAllStringsArray(arg1)\n        && arg1.length === arg2.length) {\n        for (var i = 0; i < arg1.length; i++) {\n            this.bindings[arg1[i]] = arg2[i];\n        }\n    } else if (!arg2 && Substitution.isBindingsObject(arg1)) {\n        // Make a copy of the bindings so not sharing binding structure with argument.\n        this.bindings = {};\n        for (var oldName in arg1) {\n            this.bindings[oldName] = arg1[oldName];\n        }\n    }\n}\n\n/**\n * @param things\n * @returns true iff things is an array containing only strings. Otherwise returns false.\n */\nSubstitution.isAllStringsArray = function(things) {\n    // [lyn, 11/17/13] This fails for things that are obviously arrays. Dunno why\n    // if (!(things instanceof Array)) {\n    //  return false;\n    //}\n    if (typeof(things) !== \"object\" || !things.length) { // Say it's not an array if it's not an object with a length field.\n        return false;\n    }\n    for (var i = 0; i < things.length; i++) {\n        if (typeof(things[i]) !== \"string\") {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * @param obj An object\n * @returns true iff obj is an Object containting only string properties with string values.\n *   Otherwise returns false.\n */\nSubstitution.isBindingsObject = function(thing) {\n    // [lyn, 11/17/13] This fails for things that are obviously Objects. Dunno why\n    // if (!(obj instanceof Object)) {\n    //  return false;\n    if (typeof(thing) != \"object\") {\n        return false;\n    } else {\n        for (var prop in thing) {\n            if (! (typeof(prop) === \"string\")\n                || !(typeof(thing[prop] === \"string\"))) {\n                return false\n            }\n        }\n    }\n    return true;\n}\n\n/**\n * @param oldName\n * @param newName\n * @returns {Substitution} A substitution with one pair from oldName to newName\n */\nSubstitution.simpleSubstitution = function(oldName, newName) {\n    var bindings = {};\n    bindings[oldName] = newName;\n    return new Substitution(bindings);\n}\n\n/**\n * Apply a substitution to a name.\n * @param name: a string\n * @returns if the name is in the domain of the substition, returns the corresponding\n *   element in the range; otherwise, returns name unchanged.\n */\nSubstitution.prototype.apply = function (name) {\n    var output = this.bindings[name];\n    if (output) {\n        return output;\n    } else {\n        return name;\n    }\n}\n\n/**\n * @param names: A list of strings\n * @returns {Array of strings} the result of applying this substitution to each element of names\n */\nSubstitution.prototype.map = function(names) {\n    const thisSubst = this; // Need to name \"this\" for use in function closure passed to map.\n    return names.map( function(name) { return thisSubst.apply(name); } );\n}\n\n/**\n * @returns {string} A string representation of this substitution\n */\nSubstitution.prototype.toString = function() {\n    var bindingStrings = [];\n    for (var oldName in this.bindings) {\n        bindingStrings.push(oldName + \":\" + this.bindings[oldName]);\n    }\n    return \"Substitution{\" + bindingStrings.sort().join(\",\") + \"}\";\n}\n\n/**\n * @returns {Substitution} a new copy of this substitution\n */\nSubstitution.prototype.copy = function() {\n    var newSubst = new Substitution();\n    for (var oldName in this.bindings) {\n        newSubst.bindings[oldName] = this.bindings[oldName];\n    }\n    return newSubst;\n}\n\n/**\n * @param names: A list of strings\n * @returns {Substitution} a new substitution whose domain is the intersection of\n *   names and the domain of this substitution.\n */\nSubstitution.prototype.restrictDomain = function(names) {\n    var newSubst = new Substitution();\n    for (var i = 0; i < names.length; i++) {\n        var result = this.bindings[names[i]];\n        if (result) {\n            newSubst.bindings[names[i]] = result;\n        }\n    }\n    return newSubst;\n}\n\n/**\n * @param names: A list of strings\n * @returns {Substitution} a new substitution whose domain is the difference of\n *   the domain of this substitution and names\n */\nSubstitution.prototype.remove = function(names) {\n    var newSubst = new Substitution();\n    for (var oldName in this.bindings) {\n        if (names.indexOf(oldName) == -1) {\n            newSubst.bindings[oldName] = this.bindings[oldName];\n        }\n    }\n    return newSubst;\n}\n\n/**\n * @param otherSubst: A substitution\n * @returns {Substitution} a new substitution whose domain is the union of the domains of\n *   this substitution and otherSubst. Any input/output mapping in otherSubst whose\n *   input is in this substitution overrides the input in this substitution.\n */\nSubstitution.prototype.extend = function(otherSubst) {\n    var newSubst = this.copy();\n    for (var oldName in otherSubst.bindings) {\n        newSubst.bindings[oldName] = otherSubst.bindings[oldName];\n    }\n    return newSubst;\n}\n\n/**\n * @returns {Array of String} a list of all the old names in the domain of this substitution.\n */\nSubstitution.prototype.domain = function() {\n    var oldNames = [];\n    for (var oldName in this.bindings) {\n        oldNames.push(oldName);\n    }\n    return oldNames.sort();\n}\n\n/**\n * @returns {Array of String} a copy of the input/output bindings in this substitution.\n */\nSubstitution.prototype.getBindings = function() {\n    var bindings = {};\n    for (var oldName in this.bindings) {\n        bindings[oldName] = this.bindings[oldName];\n    }\n    return bindings;\n}\n\n\n\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/field_lexical_variable.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2013-2014 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Drop-down chooser of variables in the current lexical scope\n *     for App Inventor.\n * @author fturbak@wellesley.com (Lyn Turbak)\n */\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Lyn's History:\n *  *  [lyn, written 11/15-17/13 but added 07/01/14] Overhauled parameter\n * renaming:\n *    + Refactored FieldLexicalVariable method getNamesInScope to have same\n * named function that works on any block, and a separate function\n * getLexicalNamesInScope that works on any block\n *    + Refactored monolithic renameParam into parts that are useful on their\n * own\n *    + Previously, renaming param from oldName to newName might require\n * renaming newName itself\n *      (adding a number to the end) to avoid renaming inner declarations that\n * might be captured by renaming oldName to newName. Now, there is a choice\n * between this previous behavior and a new behavior in which newName is *not*\n * renamed and capture is avoided by renaming the inner declarations when\n * necessary.\n *    + Created Blockly.Lexical.freeVariables for calculating free variables\n *    + Created Blockly.Lexical.renameBound for renaming of boundVariables in\n * declarations\n *    + Created Blockly.Lexical.renameFree for renaming of freeVariables in\n * declarations\n *    + Created LexicalVariable.stringListsEqual for testing equality\n * of string lists.\n *  [lyn, 06/11/14] Modify checkIdentifier to work for i8n.\n *  [lyn, 04/13/14] Modify calculation of global variable names:\n *    1. Use getTopBlocks rather than getAllBlocks; the latter, in combination\n * with quadratic memory allocation space from Neil's getAllBlocks, was leading\n * to cubic memory allocation space, which led to lots of time wasted due to\n * allocation and GC. This change dramatically reduces allocation times and GC\n *    2. Introduce caching for\n * Blockly.WarningHandler.checkAllBlocksForWarningsAndErrors(). This change\n * reduces allocation times and GC even further.\n *  [lyn, 10/28/13] Made identifier legality check more restrictive by removing\n * arithmetic and logical ops as possible identifier characters\n *  [lyn, 10/27/13] Create legality filter & transformer for AI2 variable names\n *  [lyn, 10/26/13] Fixed renaming of globals and lexical vars involving empty\n * strings and names with internal spaces.\n *  [lyn, 12/23-27/12] Updated to:\n *     (1) handle renaming involving local declaration statements/expressions\n * and\n *     (2) treat name prefixes correctly when they're used.\n *  [lyn, 11/29/12] handle control constructs in getNamesInScope and\n * referenceResult\n *  [lyn, 11/24/12] Sort and remove duplicates from namespaces\n *  [lyn, 11/19/12]\n *    + renameGlobal renames global references and prevents duplicates in\n * global names;\n *    + renameParam is similar for procedure and loop names.\n *    + define referenceResult, which is renaming workhorse\n *  [lyn, 11/18/12] nameNotIn function for renaming by adding number at end\n *  [lyn, 11/10/12] getGlobalNames and getNamesInScope.\n */\n\n// Get all global names\n\n/**\n * Class for a variable's dropdown field.\n * @param {!string} varname The default name for the variable.  If null,\n *     a unique variable name will be generated.\n * @extends Blockly.FieldDropdown\n * @constructor\n */\nclass FieldLexicalVariable extends core_browser.FieldDropdown {\n  constructor(varname) {\n    // Call parent's constructor.\n    super(FieldLexicalVariable.dropdownCreate);\n    if (varname) {\n      this.doValueUpdate_(varname);\n    } else {\n      this.doValueUpdate_(core_browser.Variables.generateUniqueName());\n    }\n  };\n\n  /**\n   * Set the variable name.\n   * @param {string} text New text.\n   */\n  // setValue(text) {\n  //   // Fix for issue #1901. If the variable name contains a space separating two\n  //   // words, and the first isn't \"global\", then replace the first word with\n  //   // global. This fixes an issue where the translated \"global\" keyword was\n  //   // being stored instead of the English keyword, resulting in errors when\n  //   // moving between languages in the App Inventor UI. NB: This makes an\n  //   // assumption that we won't allow for multi-word variables in the future.\n  //   // Right now variables identifiers still need to be a sequence of\n  //   // non-whitespace characters, so only global variables will split on a space.\n  //   if (text && text !== ' ') {\n  //     const parts = text.split(' ');\n  //     if (parts.length == 2 && parts[0] !== 'global') {\n  //       text = 'global ' + parts[1];\n  //     }\n  //   }\n  //   super.setValue(text);\n  // };\n}\n\nFieldLexicalVariable.prototype.doClassValidation_ = function(\n    opt_newValue) {\n  return /** @type {string} */ (opt_newValue);\n};\n\n/**\n * Get the block holding this drop-down variable chooser.\n * @return {string} Block holding this drop-down variable chooser.\n */\nFieldLexicalVariable.prototype.getBlock = function() {\n  return this.block_;\n};\n\n/**\n * Set the block holding this drop-down variable chooser.\n * @param {?Blockly.Block} block Block holding this drop-down variable chooser.\n */\nFieldLexicalVariable.prototype.setBlock = function(block) {\n  this.block_ = block;\n};\n\n// [lyn, 11/10/12] Returns the names of all global definitions as a list of\n// strings [lyn, 11/18/12] * Removed from prototype and stripped off \"global\"\n// prefix (add it elsewhere) * Add optional excluded block argument as in\n// Neil's code to avoid global declaration being created\nFieldLexicalVariable.getGlobalNames = function(optExcludedBlock) {\n  // TODO: Maybe switch to injectable warning/error handling\n  const mainWorkspace = core_browser.common.getMainWorkspace();\n  const rootWorkspace = mainWorkspace.getRootWorkspace() || mainWorkspace;\n  if (useLynCacheGlobalNames && rootWorkspace &&\n      rootWorkspace.getWarningHandler &&\n      rootWorkspace.getWarningHandler().cacheGlobalNames) {\n    return rootWorkspace.getWarningHandler().cachedGlobalNames;\n  }\n  const globals = [];\n  if (rootWorkspace && !rootWorkspace.isFlyout) {\n    let blocks = [];\n    if (useLynGetGlobalNamesFix) {\n      // [lyn, 04/13/14] Only need top blocks, not all blocks!\n      blocks = rootWorkspace.getTopBlocks();\n    } else {\n      // [lyn, 11/10/12] Is there a better way to get workspace?\n      blocks = rootWorkspace.getAllBlocks();\n    }\n    for (let i = 0; i < blocks.length; i++) {\n      const block = blocks[i];\n      if ((block.getGlobalNames) &&\n          (block != optExcludedBlock)) {\n        globals.push(...block.getGlobalNames());\n      }\n    }\n  }\n  return globals;\n};\n\n/**\n * @this A FieldLexicalVariable instance\n * @return {list} A list of all global and lexical names in scope at the point\n *     of the getter/setter block containing this FieldLexicalVariable\n *     instance. Global names are listed in sorted order before lexical names\n *     in sorted order.\n */\n// [lyn, 12/24/12] Clean up of name prefixes; most work done earlier by paulmw\n// [lyn, 11/29/12] Now handle params in control constructs\n// [lyn, 11/18/12] Clarified structure of namespaces\n// [lyn, 11/17/12]\n// * Commented out loop params because AI doesn't handle loop variables\n// correctly yet. [lyn, 11/10/12] Returns the names of all names in lexical\n// scope for the block associated with this menu. including global variable\n// names. * Each global name is prefixed with \"global \" * If\n// Shared.showPrefixToUser is false, non-global names are not prefixed. * If\n// Shared.showPrefixToUser is true, non-global names are prefixed with labels\n// specified in blocklyeditor.js\nFieldLexicalVariable.prototype.getNamesInScope = function() {\n  return FieldLexicalVariable.getNamesInScope(this.block_);\n};\n\n/**\n * @param block\n * @return {Array.<Array.<string>>} A list of pairs representing the translated\n * and untranslated name of every variable in the scope of the current block.\n */\n// [lyn, 11/15/13] Refactored to work on any block\nFieldLexicalVariable.getNamesInScope = function(block) {\n  let globalNames = FieldLexicalVariable.getGlobalNames(); // from\n  // global\n  // variable\n  // declarations\n  // [lyn, 11/24/12] Sort and remove duplicates from namespaces\n  globalNames = LexicalVariable.sortAndRemoveDuplicates(globalNames);\n  globalNames = globalNames.map(function(name) {\n    return [prefixGlobalMenuName(name), 'global ' + name];\n  });\n  const allLexicalNames = FieldLexicalVariable.getLexicalNamesInScope(\n      block);\n  // Return a list of all names in scope: global names followed by lexical ones.\n  return globalNames.concat(allLexicalNames);\n};\n\n/**\n * @param block\n * @return {Array.<Array.<string>>} A list of all lexical names (in sorted\n *     order) in scope at the point of the given block If\n *     Shared.usePrefixInYail is true, returns names prefixed with labels like\n *     \"param\", \"local\", \"index\"; otherwise returns unprefixed names.\n */\n// [lyn, 11/15/13] Factored this out from getNamesInScope to work on any block\nFieldLexicalVariable.getLexicalNamesInScope = function(block) {\n  // const procedureParamNames = []; // from procedure/function declarations\n  // const loopNames = []; // from for loops\n  // const rangeNames = []; // from range loops\n  // const localNames = []; // from local variable declaration\n  let allLexicalNames = []; // all non-global names\n  const innermostPrefix = {}; // paulmw's mechanism for keeping track of\n  // innermost prefix in case\n  // where prefix is an annotation rather than a separate namespace\n  let parent;\n  let child;\n  // let params;\n  // let i;\n\n  // [lyn, 12/24/2012] Abstract over name handling\n  /**\n   * @param name\n   * @param list\n   * @param prefix\n   */\n  function rememberName(name, list, prefix) {\n    let fullName;\n    if (!usePrefixInCode) { // Only a single namespace\n      if (!innermostPrefix[name]) {\n        // only set this if not already set from an inner scope.\n        innermostPrefix[name] = prefix;\n      }\n      fullName =\n          (possiblyPrefixMenuNameWith(innermostPrefix[name]))(name);\n    } else { // multiple namespaces distinguished by prefixes\n      // note: correctly handles case where some prefixes are the same\n      fullName = (possiblyPrefixMenuNameWith(prefix))(name);\n    }\n    list.push(fullName);\n  }\n\n  child = block;\n  if (child) {\n    parent = child.getParent();\n    if (parent) {\n      while (parent) {\n        if (parent.withLexicalVarsAndPrefix) {\n          parent.withLexicalVarsAndPrefix(child, (lexVar, prefix) => {\n            rememberName(lexVar, allLexicalNames, prefix);\n          });\n        }\n        child = parent;\n        parent = parent.getParent(); // keep moving up the chain.\n      }\n    }\n  }\n  allLexicalNames = LexicalVariable.sortAndRemoveDuplicates(allLexicalNames);\n  return allLexicalNames.map(function(name) {\n    return [name, name];\n  });\n};\n\n/**\n * Return a sorted list of variable names for variable dropdown menus.\n * @return {!Array.<string>} Array of variable names.\n * @this {!FieldLexicalVariable}\n */\nFieldLexicalVariable.dropdownCreate = function() {\n  const variableList = this.getNamesInScope(); // [lyn, 11/10/12] Get all\n  // global, parameter, and local\n  // names\n  return variableList.length == 0 ? [[' ', ' ']] : variableList;\n};\n\n/*\nTODO: I'm leaving the following in for now (but commented) because at one point\n  it seemed necessary.  It doesn't seem so anymore but I just want to remember\n  in case it really was needed.\n*/\n// Blockly.FieldLexicalVariable.dropdownCreate = function() {\n//   var variableList = this.getNamesInScope(); // [lyn, 11/10/12] Get all\n// global, parameter, and local names variableList = variableList.length == 0 ?\n// [[' ', ' ']] : variableList; const extraNames = []; const block =\n// this.getBlock(); if (block) { const flydown =\n// block.workspace.getTopWorkspace().getFlydown(); const flydownWorkspace =\n// flydown.getWorkspace(); if (flydownWorkspace === block.workspace) { const\n// currentVariableName = flydown.field_.getValue();\n// extraNames.push([currentVariableName, currentVariableName]); } } return\n// variableList.concat(extraNames); };\n\n/**\n * Update the value of this dropdown field.\n * @param {*} newValue The value to be saved.\n * @protected\n */\nFieldLexicalVariable.prototype.doValueUpdate_ = function(newValue) {\n  // The original call for the following looked like:\n  //   Blockly.FieldDropdown.superClass_.doValueUpdate_.call(this, newValue);\n  // but we can no longer use the Blockly.utils.object.inherits function, which sets the superclass_ property\n  // Note that if we just want the grandparent version of doValueUpdate_ we could use the following instead:\n  //   Object.getPrototypeOf(Object.getPrototypeOf(Object.getPrototypeOf(this))).doValueUpdate_(newValue);\n  // but since the original directly referenced the parent/superclass of Blockly.FieldDropdown, we do the same.\n  Object.getPrototypeOf(core_browser.FieldDropdown).prototype.doValueUpdate_.call(this, newValue);\n\n  function genLocalizedValue (value) {\n    return value.startsWith('global ')\n        ? value.replace('global ', core_browser.Msg['LANG_VARIABLES_GLOBAL_PREFIX'] + ' ')\n        : value;\n  }\n\n  // Fix for issue #1901. If the variable name contains a space separating two\n  // words, and the first isn't \"global\", then replace the first word with\n  // global. This fixes an issue where the translated \"global\" keyword was\n  // being stored instead of the English keyword, resulting in errors when\n  // moving between languages in the App Inventor UI. NB: This makes an\n  // assumption that we won't allow for multi-word variables in the future.\n  // Right now variables identifiers still need to be a sequence of\n  // non-whitespace characters, so only global variables will split on a space.\n  if (newValue && newValue !== ' ') {\n    const parts = newValue.split(' ');\n    if (parts.length == 2 && parts[0] !== 'global') {\n      newValue = 'global ' + parts[1];\n    }\n  }\n\n  this.value_ = newValue;\n  // Note that we are asking getOptions to add newValue to the list of available\n  // options.  We do that essentially to force callers up the chain to accept\n  // newValue as an option.  This could potentially cause trouble, but it seems\n  // to be ok for our use case.  It is ugly, though, since it bypasses an aspect\n  // of the normal dropdown validation.\n  const options =\n      this.getOptions(true, [[genLocalizedValue(newValue), newValue]]);\n  for (let i = 0, option; (option = options[i]); i++) {\n    if (option[1] == this.value_) {\n      this.selectedOption = option;\n      break;\n    }\n  }\n  this.updateMutation();\n  this.forceRerender();\n};\n\n/**\n * Update the eventparam mutation associated with the field's source block.\n */\nFieldLexicalVariable.prototype.updateMutation = function() {\n  const text = this.getText();\n  if (this.sourceBlock_ && this.sourceBlock_.getParent()) {\n    this.sourceBlock_.eventparam = undefined;\n    if (text.indexOf(core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX + ' ') === 0) {\n      this.sourceBlock_.eventparam = null;\n      return;\n    }\n    let i, parent = this.sourceBlock_.getParent();\n    while (parent) {\n      const variables = parent.declaredVariables ? parent.declaredVariables() : [];\n      if (parent.type != 'component_event') {\n        for (i = 0; i < variables.length; i++) {\n          if (variables[i] == text) {\n            // Innermost scope is not an event block, so eventparam can be nulled.\n            this.sourceBlock_.eventparam = null;\n            return;\n          }\n        }\n      } else {\n        for (i = 0; i < variables.length; i++) {\n          if (variables[i] == text) {\n            // text is an event parameter so compute the eventparam value\n            this.sourceBlock_.eventparam = parent.getParameters()[i].name;\n            return;\n          }\n        }\n      }\n      parent = parent.getParent();\n    }\n  }\n};\n\n/**\n * Return a list of the options for this dropdown.\n * @param {boolean=} opt_useCache For dynamic options, whether or not to use the\n *     cached options or to re-generate them.\n * @param {boolean=} opt_extraOption A possible extra option to add.\n * @return {!Array<!Array>} A non-empty array of option tuples:\n *     (human-readable text or image, language-neutral name).\n * @throws {TypeError} If generated options are incorrectly structured.\n */\nFieldLexicalVariable.prototype.getOptions = function(opt_useCache,\n    opt_extraOption) {\n  if (Array.isArray(opt_useCache)) {\n    opt_extraOption = opt_useCache;\n  }\n  const extraOption = opt_extraOption || [];\n  if (this.isOptionListDynamic()) {\n    if (!this.generatedOptions_ || !opt_useCache) {\n      this.generatedOptions_ =\n          this.menuGenerator_.call(this).concat(extraOption);\n      validateOptions(this.generatedOptions_);\n    }\n    return this.generatedOptions_.concat(extraOption);\n  }\n  return /** @type {!Array<!Array<string>>} */ (this.menuGenerator_);\n};\n\n// validateOptions copied from Blockly source since it's not exported from\n// field_dropdown.js\n/**\n * Validates the data structure to be processed as an options list.\n * @param {?} options The proposed dropdown options.\n * @throws {TypeError} If proposed options are incorrectly structured.\n */\nconst validateOptions = function(options) {\n  if (!Array.isArray(options)) {\n    throw TypeError('FieldDropdown options must be an array.');\n  }\n  if (!options.length) {\n    throw TypeError('FieldDropdown options must not be an empty array.');\n  }\n  let foundError = false;\n  for (let i = 0; i < options.length; ++i) {\n    const tuple = options[i];\n    if (!Array.isArray(tuple)) {\n      foundError = true;\n      console.error(\n          'Invalid option[' + i + ']: Each FieldDropdown option must be an ' +\n          'array. Found: ',\n          tuple);\n    } else if (typeof tuple[1] != 'string') {\n      foundError = true;\n      console.error(\n          'Invalid option[' + i + ']: Each FieldDropdown option id must be ' +\n          'a string. Found ' + tuple[1] + ' in: ',\n          tuple);\n    } else if (\n      tuple[0] && (typeof tuple[0] != 'string') &&\n        (typeof tuple[0].src != 'string')) {\n      foundError = true;\n      console.error(\n          'Invalid option[' + i + ']: Each FieldDropdown option must have a ' +\n          'string label or image description. Found' + tuple[0] + ' in: ',\n          tuple);\n    }\n  }\n  if (foundError) {\n    throw TypeError('Found invalid FieldDropdown options.');\n  }\n};\n\n/**\n * Event handler for a change in variable name.\n * // [lyn, 11/10/12] *** Not clear this needs to do anything for lexically\n * scoped variables. Special case the 'New variable...' and 'Rename\n * variable...' options. In both of these special cases, prompt the user for a\n * new name.\n * @param {string} text The selected dropdown menu option.\n * @this {!FieldLexicalVariable}\n */\nFieldLexicalVariable.dropdownChange = function(text) {\n  if (text) {\n    this.doValueUpdate_(text);\n    const topWorkspace = this.sourceBlock_.workspace.getTopWorkspace();\n    if (topWorkspace.getWarningHandler) {\n      topWorkspace.getWarningHandler().checkErrors(this.sourceBlock_);\n    }\n  }\n  // window.setTimeout(Blockly.Variables.refreshFlyoutCategory, 1);\n};\n\n\n// [lyn, 11/18/12]\n/**\n * Possibly add a digit to name to disintguish it from names in list.\n * Used to guarantee that two names aren't the same in situations that prohibit\n * this.\n * @param {string} name Proposed name.\n * @param {string list} nameList List of names with which name can't conflict.\n * @return {string} Non-colliding name.\n */\nFieldLexicalVariable.nameNotIn = function(name, nameList) {\n  // First find the nonempty digit suffixes of all names in nameList that have\n  // the same prefix as name e.g. for name \"foo3\" and nameList = [\"foo\",\n  // \"bar4\", \"foo17\", \"bar\" \"foo5\"] suffixes is [\"17\", \"5\"]\n  const namePrefixSuffix = FieldLexicalVariable.prefixSuffix(name);\n  const namePrefix = namePrefixSuffix[0];\n  const nameSuffix = namePrefixSuffix[1];\n  let emptySuffixUsed = false; // Tracks whether \"\" is a suffix.\n  let isConflict = false; // Tracks whether nameSuffix is used\n  const suffixes = [];\n  for (let i = 0; i < nameList.length; i++) {\n    const prefixSuffix = FieldLexicalVariable.prefixSuffix(nameList[i]);\n    const prefix = prefixSuffix[0];\n    const suffix = prefixSuffix[1];\n    if (prefix === namePrefix) {\n      if (suffix === nameSuffix) {\n        isConflict = true;\n      }\n      if (suffix === '') {\n        emptySuffixUsed = true;\n      } else {\n        suffixes.push(suffix);\n      }\n    }\n  }\n  if (!isConflict) {\n    // There is no conflict; just return name\n    return name;\n  } else if (!emptySuffixUsed) {\n    // There is a conflict, but empty suffix not used, so use that\n    return namePrefix;\n  } else {\n    // There is a possible conflict and empty suffix is not an option.\n    // First sort the suffixes as numbers from low to high\n    const suffixesAsNumbers = suffixes.map(function(elt, i, arr) {\n      return parseInt(elt, 10);\n    });\n    suffixesAsNumbers.sort(function(a, b) {\n      return a - b;\n    });\n    // Now find smallest number >= 2 that is unused\n    let smallest = 2; // Don't allow 0 or 1 an indices\n    let index = 0;\n    while (index < suffixesAsNumbers.length) {\n      if (smallest < suffixesAsNumbers[index]) {\n        return namePrefix + smallest;\n      } else if (smallest == suffixesAsNumbers[index]) {\n        smallest++;\n        index++;\n      } else { // smallest is greater; move on to next one\n        index++;\n      }\n    }\n    // Only get here if exit loop\n    return namePrefix + smallest;\n  }\n};\n\n/**\n * Split name into digit suffix and prefix before it.\n * Return two-element list of prefix and suffix strings. Suffix is empty if no\n * digits.\n * @param {string} name Input string.\n * @return {string[]} Two-element list of prefix and suffix.\n */\nFieldLexicalVariable.prefixSuffix = function(name) {\n  const matchResult = name.match(/^(.*?)(\\d+)$/);\n  if (matchResult) {\n    // List of prefix and suffix\n    return [matchResult[1], matchResult[2]];\n  } else {\n    return [name, ''];\n  }\n};\n\n/**\n * Constructs a FieldLexicalVariable from a JSON arg object.\n * @param {!Object} options A JSON object with options.\n * @return {FieldLexicalVariable} The new field instance.\n * @package\n * @nocollapse\n */\nFieldLexicalVariable.fromJson = function(options) {\n  const name = core_browser.utils.replaceMessageReferences(options['name']);\n  return new FieldLexicalVariable(name);\n};\n\ncore_browser.fieldRegistry.register('field_lexical_variable',\n    FieldLexicalVariable);\n\nconst LexicalVariable = {};\n// [lyn, 11/19/12] Rename global to a new name.\n//\n// [lyn, 10/26/13] Modified to replace sequences of internal spaces by\n// underscores (none were allowed before), and to replace empty string by '_'.\n// Without special handling of empty string, the connection between a\n// declaration field and its references is lots.\nLexicalVariable.renameGlobal = function(newName) {\n  // this is bound to field_textinput object\n  const oldName = this.value_;\n\n  // [lyn, 10/27/13] now check legality of identifiers\n  newName = LexicalVariable.makeLegalIdentifier(newName);\n\n  this.sourceBlock_.getField('NAME').doValueUpdate_(newName);\n\n  const globals = FieldLexicalVariable.getGlobalNames(this.sourceBlock_);\n  // this.sourceBlock excludes block being renamed from consideration\n  // Potentially rename declaration against other occurrences\n  newName = FieldLexicalVariable.nameNotIn(newName, globals);\n  if (this.sourceBlock_.rendered) {\n    // Rename getters and setters\n    if (core_browser.common.getMainWorkspace()) {\n      const blocks = core_browser.common.getMainWorkspace().getAllBlocks();\n      for (let i = 0; i < blocks.length; i++) {\n        const block = blocks[i];\n        const renamingFunction = block.renameLexicalVar;\n        if (renamingFunction) {\n          renamingFunction.call(block,\n              GLOBAL_KEYWORD + menuSeparator + oldName,\n              GLOBAL_KEYWORD + menuSeparator + newName,\n              core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX + menuSeparator +\n              oldName,\n              core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX + menuSeparator +\n              newName);\n        }\n      }\n    }\n  }\n  return newName;\n};\n\n/**\n * Rename the old name currently in this field to newName in the block assembly\n * rooted at the source block of this field (where \"this\" names the field of\n * interest). See the documentation for renameParamFromTo for more details.\n * @param newName\n * @return {string} The (possibly changed version of) newName, which may be\n *     changed to avoid variable capture with both external declarations\n *     (declared above the declaration of this name) or internal declarations\n *     (declared inside the scope of this name).\n */\n// [lyn, 11/19/12 (revised 10/11/13)]\n// Rename procedure parameter, local name, or loop index variable to a new\n// name,\n// avoiding variable capture in the scope of the param. Consistently renames\n// all\n// references to the name in getter and setter blocks. The proposed new name\n// may be changed (by adding numbers to the end) so that it does not conflict\n// with existing names. Returns the (possibly changed) new name.\n//\n// [lyn, 10/26/13] Modified to replace sequences of internal spaces by\n// underscores (none were allowed before), and to replace empty string by '_'.\n// Without special handling of empty string, the connection between a\n// declaration field and its references is lost.  [lyn, 11/15/13] Refactored\n// monolithic renameParam into parts that are useful on their own\nLexicalVariable.renameParam = function(newName) {\n  const htmlInput = this.htmlInput_;\n  // this is bound to field_textinput object\n  const oldName = this.getValue() ||\n      (htmlInput && htmlInput.defaultValue) ||\n      this.getText(); // name being changed to newName\n\n  // [lyn, 10/27/13] now check legality of identifiers\n  newName = LexicalVariable.makeLegalIdentifier(newName);\n\n  // Default behavior consistent with previous behavior is to use \"false\" for\n  // last argument -- I.e., will not rename inner declarations, but may rename\n  // newName\n  return LexicalVariable.renameParamFromTo(this.sourceBlock_, oldName,\n      newName, false);\n  // Default should be false (as above), but can also play with true:\n  // return LexicalVariable.renameParamFromTo(this.sourceBlock_,\n  // oldName, newName, true);\n};\n\n/**\n * [lyn, written 11/15/13, installed 07/01/14]\n * Refactored from renameParam and extended.\n * Rename oldName to newName in the block assembly rooted at this block\n * (where \"this\" names the block of interest). The names may refer to any\n * nonglobal parameter name (procedure parameter, local name, or loop index\n * variable). This function consistently renames all references to oldName by\n * newName in all getter and setter blocks that refer to oldName, correctly\n * handling inner declarations that use oldName. In cases where renaming\n * oldName to newName would result in variable capture of newName by another\n * declaration, such capture is avoided by either:\n *    1. (If renameCapturables is true):  consistently renaming the capturing\n * declarations\n *       (by adding numbers to the end) so that they do not conflict with\n * newName (or each other).\n *    2. (If renameCapturables is false): renaming the proposed newName (by\n * adding numbers to the end) so that it does not conflict with capturing\n * declarations).\n * @param block  the root source block containing the parameter being renamed\n * @param oldName\n * @param newName\n * @param renameCapturables in capture situations, determines whether capturing\n *     declarations are renamed (true) or newName is renamed (false)\n * @return {string} if renameCapturables is true, returns the given newName;\n *     if renameCapturables is false, returns the (possibly renamed version of)\n *     newName, which may be changed to avoid variable capture with both\n *     external declarations (declared above the declaration of this name) or\n *     internal declarations (declared inside the scope of this name).\n */\nLexicalVariable.renameParamFromTo =\n    function(block, oldName, newName, renameCapturables) {\n      // Handle mutator blocks specially\n      if (block.mustNotRenameCapturables) {\n        return LexicalVariable.renameParamWithoutRenamingCapturables(\n            block, oldName, newName, []);\n      } else if (renameCapturables) {\n        LexicalVariable.renameParamRenamingCapturables(block, oldName,\n            newName);\n        return newName;\n      } else {\n        return LexicalVariable.renameParamWithoutRenamingCapturables(\n            block, oldName, newName, []);\n      }\n    };\n\n/**\n * [lyn, written 11/15/13, installed 07/01/14]\n * Rename oldName to newName in the block assembly rooted at this block.\n * In the case where newName would be captured by an internal declaration,\n *  consistently rename the declaration and all its uses to avoid variable\n * capture. In the case where newName would be captured by an external\n * declaration, throw an exception.\n * @param sourceBlock  the root source block containing the declaration of\n *     oldName\n * @param oldName\n * @param newName\n */\nLexicalVariable.renameParamRenamingCapturables =\n    function(sourceBlock, oldName, newName) {\n      if (newName !== oldName) { // Do nothing if names are the same\n        const namesDeclaredHere = sourceBlock.declaredNames ?\n            sourceBlock.declaredNames() : [];\n        if (namesDeclaredHere.indexOf(oldName) == -1) {\n          throw Error('LexicalVariable.renamingCapturables: oldName ' +\n              oldName +\n              ' is not in declarations {' + namesDeclaredHere.join(',') + '}');\n        }\n        const namesDeclaredAbove = [];\n        FieldLexicalVariable.getNamesInScope(sourceBlock)\n            .map(function(pair) {\n              if (pair[0] == pair[1]) {\n                namesDeclaredAbove.push(pair[0]);\n              } else {\n                namesDeclaredAbove.push(pair[0], pair[1]);\n              }\n            }); // uses translated param names\n        const declaredNames = namesDeclaredHere.concat(namesDeclaredAbove);\n        // Should really check which forbidden names are free vars in the body\n        // of declBlock.\n        if (declaredNames.indexOf(newName) != -1) {\n          throw Error(\n              'LexicalVariable.renameParamRenamingCapturables:' +\n              ' newName ' +\n              newName +\n              ' is in existing declarations {' + declaredNames.join(',') + '}');\n        } else {\n          if (sourceBlock.renameBound) {\n            const boundSubstitution = Substitution.simpleSubstitution(\n                oldName, newName);\n            const freeSubstitution = new Substitution(); // an empty\n            // substitution\n            sourceBlock.renameBound(boundSubstitution, freeSubstitution);\n          } else {\n            throw Error(\n                'LexicalVariable.renameParamRenamingCapturables:' +\n                ' block ' +\n                sourceBlock.type +\n                ' is not a declaration block.');\n          }\n        }\n      }\n    };\n\n/**\n * [lyn, written 11/15/13, installed 07/01/14]\n * Rename all free variables in this block according to the given renaming.\n * @param block: any block\n * @param block\n * @param freeSubstitution\n * @param freeRenaming: a dictionary (i.e., object) mapping old names to new\n *     names\n */\nLexicalVariable.renameFree = function(block, freeSubstitution) {\n  if (block) { // If block is falsey, do nothing.\n    if (block.renameFree) { // should be defined on every declaration block\n      block.renameFree(freeSubstitution);\n    } else {\n      block.getChildren().map(function(blk) {\n        LexicalVariable.renameFree(blk, freeSubstitution);\n      });\n    }\n  }\n};\n\n/**\n * [lyn, written 11/15/13, installed 07/01/14]\n * Return a nameSet of all free variables in the given block.\n * @param block\n * @return (NameSet) set of all free names in block\n */\nLexicalVariable.freeVariables = function(block) {\n  let result = [];\n  if (!block) {\n    // input and next block slots might not empty\n    result = new nameSet_NameSet();\n  } else if (block.freeVariables) {\n    // should be defined on every declaration block\n    result = block.freeVariables();\n  } else {\n    const nameSets = block.getChildren().map(function(blk) {\n      return LexicalVariable.freeVariables(blk);\n    });\n    result = nameSet_NameSet.unionAll(nameSets);\n  }\n  // console.log(\"freeVariables(\" + (block ? block.type : \"*empty-socket*\") +\n  // \") = \" + result.toString());\n  return result;\n};\n\n/**\n * [lyn, written 11/15/13, installed 07/01/14] Refactored from renameParam\n * Rename oldName to newName in the block assembly rooted at this block.\n * In the case where newName would be captured by internal or external\n * declaration, change it to a name (with a number suffix) that would not be\n * captured.\n * @param sourceBlock  the root source block containing the declaration of\n *     oldName\n * @param oldName\n * @param newName\n * @param OKNewNames\n * @return {string} the (possibly renamed version of) newName, which may be\n *     changed to avoid variable capture with both external declarations\n *     (declared above the declaration of this name) or internal declarations\n *     (declared inside the scope of this name).\n */\nLexicalVariable.renameParamWithoutRenamingCapturables =\n    function(sourceBlock, oldName, newName, OKNewNames) {\n      if (oldName === newName) {\n        return oldName;\n      }\n      let sourcePrefix = '';\n      if (showPrefixToUser) {\n        sourcePrefix = this.lexicalVarPrefix;\n      }\n      const helperInfo =\n          LexicalVariable.renameParamWithoutRenamingCapturablesInfo(\n              sourceBlock, oldName, sourcePrefix);\n      const blocksToRename = helperInfo[0];\n      const capturables = helperInfo[1];\n      let declaredNames = []; // declared names in source block, with which\n      // newName cannot conflict\n      if (sourceBlock.declaredNames) {\n        declaredNames = sourceBlock.declaredNames();\n        // Remove oldName from list of names. We can rename oldName to itself\n        // if we desire!\n        const oldIndex = declaredNames.indexOf(oldName);\n        if (oldIndex != -1) {\n          declaredNames.splice(oldIndex, 1);\n        }\n        // Remove newName from list of declared names if it's in OKNewNames.\n        if (OKNewNames.indexOf(newName) != -1) {\n          const newIndex = declaredNames.indexOf(newName);\n          if (newIndex != -1) {\n            declaredNames.splice(newIndex, 1);\n          }\n        }\n      }\n      const conflicts = LexicalVariable.sortAndRemoveDuplicates(\n          capturables.concat(declaredNames));\n      newName = FieldLexicalVariable.nameNotIn(newName, conflicts);\n\n      // Special case: if newName is oldName, we're done!\n      if (!(newName === oldName)) {\n        // [lyn, 12/27/2012] I don't understand what this code is for.\n        //  I think it had something to do with locals that has now been\n        // repaired?\n        /* var oldNameInDeclaredNames = false;\n          for (var i = 0; i < declaredNames.length; i++) {\n          if(oldName === declaredNames[i]){\n            oldNameInDeclaredNames = true;\n          }\n        }\n        if(!oldNameInDeclaredNames){\n        */\n        const oldNameValid = (declaredNames.indexOf(oldName) != -1);\n        if (!oldNameValid) {\n          // Rename getters and setters\n          for (let i = 0; i < blocksToRename.length; i++) {\n            const block = blocksToRename[i];\n            const renamingFunction = block.renameLexicalVar;\n            if (renamingFunction) {\n              renamingFunction.call(block,\n                  (possiblyPrefixMenuNameWith(sourcePrefix))(oldName),\n                  (possiblyPrefixMenuNameWith(sourcePrefix))(newName));\n            }\n          }\n        }\n      }\n      return newName;\n    };\n\n/**\n * [lyn, written 11/15/13, installed 07/01/14] Refactored from renameParam().\n * @param sourceBlock\n * @param oldName\n * @param sourcePrefix\n * @return {pair} Returns a pair of\n * (1) All getter/setter blocks that reference oldName\n * (2) A list of all non-global names to which oldName cannot be renamed\n *     because doing so would change the reference \"wiring diagram\" and thus\n *     the meaning of the program. This is the union of:\n * (a) all names declared between the declaration of oldName and a reference to\n *     old name; and\n * (b) all names declared in a parent of the oldName declaration that are\n *     referenced in the scope of oldName. In the case where prefixes are used\n *     (e.g., \"param a\", \"index i, \"local x\") this is a list of *unprefixed*\n *     names.\n */\nLexicalVariable.renameParamWithoutRenamingCapturablesInfo =\n    function(sourceBlock, oldName, sourcePrefix) {\n      // var sourceBlock = this; // The block containing the declaration of\n      // oldName sourceBlock is block in which name is being changed. Can be\n      // one of:\n      //   * For procedure param: procedures_mutatorarg, procedures_defnoreturn,\n      //     procedures_defreturn (last two added by lyn on 10/11/13).\n      //   * For local name: local_mutatorarg, local_declaration_statement,\n      //     local_declaration_expression\n      //   * For loop name: controls_forEach, controls_forRange, controls_for\n      let inScopeBlocks = []; // list of root blocks in scope of oldName and in\n      // which\n      // renaming must take place.\n      if (sourceBlock.blocksInScope) { // Find roots of blocks in scope.\n        inScopeBlocks = sourceBlock.blocksInScope();\n      }\n      // console.log(\"inScopeBlocksRoots: \" + JSON.stringify(inScopeBlocks.map(\n      // function(elt) { return elt.type; })));\n\n      // referenceResult is Array of (0) list of getter/setter blocks refering\n      // to old name and (1) capturable names = names to which oldName cannot\n      // be renamed without changing meaning of program.\n      const referenceResults = inScopeBlocks.map(function(blk) {\n        return LexicalVariable.referenceResult(blk, oldName,\n            sourcePrefix, []);\n      });\n      let blocksToRename = []; // A list of all getter/setter blocks whose that\n      // reference oldName\n      // and need to have their name changed to newName\n      let capturables = []; // A list of all non-global names to which oldName\n      // cannot be renamed because doing\n      // so would change the reference \"wiring diagram\" and thus the meaning\n      // of the program. This is the union of:\n      // (1) all names declared between the declaration of oldName and a\n      // reference to old name; and (2) all names declared in a parent of the\n      // oldName declaration that are referenced in the scope of oldName. In\n      // the case where prefixes are used (e.g., \"param a\", \"index i, \"local\n      // x\") this is a list of *unprefixed* names.\n      for (let r = 0; r < referenceResults.length; r++) {\n        blocksToRename = blocksToRename.concat(referenceResults[r][0]);\n        capturables = capturables.concat(referenceResults[r][1]);\n      }\n      capturables =\n          LexicalVariable.sortAndRemoveDuplicates(capturables);\n      return [blocksToRename, capturables];\n    };\n\n/**\n * [lyn, 10/27/13]\n * Checks an identifier for validity. Validity rules are a simplified version\n * of Kawa identifier rules. They assume that the YAIL-generated version of the\n * identifier will be preceded by a legal Kawa prefix:\n *\n * <identifier> = <first><rest>*\n * <first> = letter U charsIn(\"_$?~@\")\n * <rest> = <first> U digit.\n *\n * Note: an earlier version also allowed characters in \"!&%.^/+-*>=<\",\n * but we decided to remove these because (1) they may be used for arithmetic,\n * logic, and selection infix operators in a future AI text language, and we\n * don't want things like a+b, !c, d.e to be ambiguous between variables and\n * other expressions.\n * (2) using chars in \"><&\" causes HTML problems with getters/setters in\n * flydown menu.\n *\n * First transforms the name by removing leading and trailing whitespace and\n * converting nonempty sequences of internal whitespace to '_'.\n * Returns a result object of the form {transformed: <string>, isLegal:\n * <bool>}, where: result.transformed is the transformed name and\n * result.isLegal is whether the transformed named satisfies the above rules.\n * @param ident\n * @return {{isLegal: boolean, transformed: string}}\n */\nLexicalVariable.checkIdentifier = function(ident) {\n  const transformed = ident.trim() // Remove leading and trailing whitespace\n      .replace(/[\\s\\xa0]+/g, '_'); // Replace nonempty sequences of internal\n  // spaces by underscores\n  // [lyn, 06/11/14] Previous definition focused on *legal* characters:\n  //\n  //    var legalRegexp = /^[a-zA-Z_\\$\\?~@][\\w_\\$\\?~@]*$/;\n  //\n  // Unfortunately this is geared only to English, and prevents i8n names (such\n  // as Chinese identifiers). In order to handle i8n, focus on avoiding illegal\n  // chars rather than accepting only legal ones. This is a quick solution.\n  // Needs more careful thought to work for every language. In particular, need\n  // to look at results of Java's Character.isJavaIdentifierStart(int) and\n  // Character.isJavaIdentifierPart(int) Note: to take complement of character\n  // set, put ^ first. Note: to include '-' in character set, put it first or\n  // right after ^\n  const legalStartCharRegExp = '^[^-0-9!&%^/>=<`\\'\"#:;,\\\\\\\\*+.()|{}[\\\\] ]';\n  const legalRestCharsRegExp = '[^-!&%^/>=<\\'\"#:;,\\\\\\\\*+.()|{}[\\\\] ]*$';\n  const legalRegexp = new RegExp(legalStartCharRegExp + legalRestCharsRegExp);\n  // \" Make Emacs Happy\n  const isLegal = transformed.search(legalRegexp) == 0;\n  return {isLegal: isLegal, transformed: transformed};\n};\n\nLexicalVariable.makeLegalIdentifier = function(ident) {\n  const check = LexicalVariable.checkIdentifier(ident);\n  if (check.isLegal) {\n    return check.transformed;\n  } else if (check.transformed === '') {\n    return '_';\n  } else {\n    return 'name'; // Use identifier 'name' to replace illegal name\n  }\n};\n\n// [lyn, 11/19/12] Given a block, return an Array of\n//   (0) all getter/setter blocks referring to name in block and its children\n//   (1) all (unprefixed) names within block that would be captured if name\n// were renamed to one of those names. If Shared.showPrefixToUser, prefix is\n// the prefix associated with name; otherwise prefix is \"\". env is a list of\n// internally declared names in scope at this point; if Shared.usePrefixInYail\n// is true, the env names have prefixes, otherwise they do not. [lyn,\n// 12/25-27/2012] Updated to (1) add prefix argument, (2) handle local\n// declaration statements/expressions, and (3) treat prefixes correctly when\n// they're used.\nLexicalVariable.referenceResult = function(block, name, prefix, env) {\n  if (!block) { // special case when block is null\n    return [[], []];\n  }\n  const referenceResults = block.referenceResults ?\n      block.referenceResults(name, prefix, env) :\n      block.getChildren().map(function(blk) {\n        return LexicalVariable.referenceResult(blk, name, prefix, env);\n      });\n  let blocksToRename = [];\n  let capturables = [];\n  for (let r = 0; r < referenceResults.length; r++) {\n    blocksToRename = blocksToRename.concat(referenceResults[r][0]);\n    capturables = capturables.concat(referenceResults[r][1]);\n  }\n  return [blocksToRename, capturables];\n};\n\nLexicalVariable.sortAndRemoveDuplicates = function(strings) {\n  const sorted = strings.sort();\n  const nodups = [];\n  if (strings.length >= 1) {\n    let prev = sorted[0];\n    nodups.push(prev);\n    for (let i = 1; i < sorted.length; i++) {\n      if (!(sorted[i] === prev)) {\n        prev = sorted[i];\n        nodups.push(prev);\n      }\n    }\n  }\n  return nodups;\n};\n\n// [lyn, 11/23/12] Given a block, return the block connected to its next\n// connection; If there is no next connection or no block, return null.\nLexicalVariable.getNextTargetBlock = function(block) {\n  if (block && block.nextConnection && block.nextConnection.targetBlock()) {\n    return block.nextConnection.targetBlock();\n  } else {\n    return null;\n  }\n};\n\n/**\n * [lyn, 11/16/13] Created.\n * @param strings1: An array of strings.\n * @param strings1\n * @param strings2\n * @param strings2: An array of strings.\n * @return True iff strings1 and strings2 have the same names in the same\n *     order; false otherwise.\n */\nLexicalVariable.stringListsEqual = function(strings1, strings2) {\n  const len1 = strings1.length;\n  const len2 = strings2.length;\n  if (len1 !== len2) {\n    return false;\n  } else {\n    for (let i = 0; i < len1; i++) {\n      if (strings1[i] !== strings2[i]) {\n        return false;\n      }\n    }\n  }\n  return true; // get here iff lists are equal\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/procedure_utils.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2013-2014 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Visual blocks editor for App Inventor\n * Methods to handle serialization of the blocks workspace.\n *\n * @author sharon@google.com (Sharon Perl)\n */\n\n\n\n\n\n\n\nconst procDefaultValue = ['', ''];\n\nconst onChange = function(procedureId) {\n  let workspace = this.block.workspace.getTopWorkspace();\n  // [lyn, 10/14/13] .editable is undefined on blocks. Changed to .editable_\n  if (!this.block.isEditable()) {\n    workspace = core_browser.Drawer.flyout_.workspace_;\n    return;\n  }\n\n  const def = workspace.getProcedureDatabase().getProcedure(procedureId);\n  // loading but the definition block hasn't been processed yet.\n  if (!def) return;\n  const text = def.getFieldValue('NAME');\n  if (text == '' || text != this.getValue()) {\n    for (let i=0; this.block.getInput('ARG' + i) != null; i++) {\n      this.block.removeInput('ARG' + i);\n    }\n    // return;\n  }\n  this.doValueUpdate_(text);\n  if (def) {\n    // [lyn, 10/27/13] Lyn sez: this causes complications (e.g., might open up\n    // mutator on collapsed procedure declaration block) and is no longer\n    // necessary with changes to setProedureParameters.\n    // if(def.paramIds_ == null){\n    //  def.mutator.setVisible(true);\n    //  def.mutator.shouldHide = true;\n    // }\n    // It's OK if def.paramIds is null\n    this.block.setProcedureParameters(def.arguments_, def.paramIds_, true);\n  }\n};\n\nconst getProcedureNames = function(returnValue, opt_workspace) {\n  const workspace = opt_workspace || core_browser.common.getMainWorkspace();\n  const topBlocks = workspace.getTopBlocks();\n  const procNameArray = [procDefaultValue];\n  for (let i=0; i<topBlocks.length; i++) {\n    const procName = topBlocks[i].getFieldValue('NAME');\n    if (topBlocks[i].type == 'procedures_defnoreturn' && !returnValue) {\n      procNameArray.push([procName, procName]);\n    } else if (topBlocks[i].type == 'procedures_defreturn' && returnValue) {\n      procNameArray.push([procName, procName]);\n    }\n  }\n  if (procNameArray.length > 1 ) {\n    procNameArray.splice(0, 1);\n  }\n  return procNameArray;\n};\n\n// [lyn, 10/22/13] Return a list of all procedure declaration blocks\n// If returnValue is false, lists all fruitless procedure declarations\n// (defnoreturn) If returnValue is true, lists all fruitful procedure\n// declaraations (defreturn)\nconst getProcedureDeclarationBlocks = function(returnValue,\n    opt_workspace) {\n  const workspace = opt_workspace || core_browser.common.getMainWorkspace();\n  const topBlocks = workspace.getTopBlocks(false);\n  const blockArray = [];\n  for (let i=0; i<topBlocks.length; i++) {\n    if (topBlocks[i].type == 'procedures_defnoreturn' && !returnValue) {\n      blockArray.push(topBlocks[i]);\n    } else if (topBlocks[i].type == 'procedures_defreturn' && returnValue) {\n      blockArray.push(topBlocks[i]);\n    }\n  }\n  return blockArray;\n};\n\nconst getAllProcedureDeclarationBlocksExcept = function(block) {\n  const topBlocks = block.workspace.getTopBlocks(false);\n  const blockArray = [];\n  for (let i=0; i<topBlocks.length; i++) {\n    if (topBlocks[i].type === 'procedures_defnoreturn' ||\n        topBlocks[i].type === 'procedures_defreturn') {\n      if (topBlocks[i] !== block) {\n        blockArray.push(topBlocks[i]);\n      }\n    }\n  }\n  return blockArray;\n};\n\nconst removeProcedureValues = function(name, workspace) {\n  if (workspace && // [lyn, 04/13/14] ensure workspace isn't undefined\n      workspace === core_browser.common.getMainWorkspace()) {\n    const blockArray = workspace.getAllBlocks();\n    for (let i=0; i<blockArray.length; i++) {\n      const block = blockArray[i];\n      if (block.type == 'procedures_callreturn' ||\n          block.type == 'procedures_callnoreturn') {\n        if (block.getFieldValue('PROCNAME') == name) {\n          block.removeProcedureValue();\n        }\n      }\n    }\n  }\n};\n\n// [lyn, 10/27/13] Defined as a replacement for Blockly.Procedures.rename\n/**\n * Rename a procedure definition to a new name.\n *\n * @this FieldProcedureName\n * @param {!string} newName New name for the procedure represented by the\n *     field's source block.\n * @return {string} The new, validated name of the block.\n */\nconst renameProcedure = function(newName) {\n  // this is bound to field_textinput object\n  const oldName = this.oldName_ || this.getValue();\n  const originalNewName = newName;\n\n  // [lyn, 10/27/13] now check legality of identifiers\n  newName = LexicalVariable.makeLegalIdentifier(newName);\n\n  // [lyn, 10/28/13] Prevent two procedures from having the same name.\n  const procBlocks = getAllProcedureDeclarationBlocksExcept(\n      this.sourceBlock_);\n  const procNames = procBlocks.map(function(decl) {\n    return decl.getFieldValue('NAME');\n  });\n  newName = FieldLexicalVariable.nameNotIn(newName, procNames);\n  if (newName !== originalNewName) {\n    this.doValueUpdate_(newName);\n  }\n  // Rename any callers.\n  const blocks = this.sourceBlock_.workspace.getAllBlocks();\n  for (let x = 0; x < blocks.length; x++) {\n    const func = blocks[x].renameProcedure;\n    if (func) {\n      func.call(blocks[x], oldName, newName);\n    }\n  }\n  this.oldName_ = newName;\n  return newName;\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/procedure_database.js\n/* -*- mode: javascript; js-indent-level: 2; -*- */\n/**\n * @license\n * Copyright © 2016-2017 Massachusetts Institute of Technology. All rights\n *     reserved.\n */\n\n/**\n * @fileoverview A database for tracking user-defined procedures.\n * @author Evan W. Patton <ewpatton@mit.edu>\n */\n\n\n\n\n\n\n\n/**\n * ProcedureDatabase provides a per-workspace data store for manipulating\n * procedure definitions in the Blocks editor.\n *\n * @param workspace The workspace containing procedures indexed by the\n *     ProcedureDatabase.\n * @constructor\n */\nconst ProcedureDatabase = function(workspace) {\n  /**\n   * The source workspace for the ProcedureDatabase.\n   * @type {!Blockly.WorkspaceSvg}\n   * @private\n   */\n  this.workspace_ = workspace;\n\n  /**\n   * Procedure definition map from block ID to block. This is a subset of\n   * {@link Blockly.Workspace.blockDB_}.\n   * @type {{string: !Blockly.BlockSvg}}\n   * @private\n   */\n  this.procedures_ = {};\n\n  /**\n   * Procedure definition map for procedures that return values. This is a\n   * subset of\n   * {@link #procedures_}.\n   * @type {{string: !Blockly.BlockSvg}}\n   * @private\n   */\n  this.returnProcedures_ = {};\n\n  /**\n   * Procedure definition map for procedures that do not return values. This is\n   * a subset of\n   * {@link #procedures_}.\n   * @type {{string: !Blockly.BlockSvg}}\n   * @private\n   */\n  this.voidProcedures_ = {};\n\n  /**\n   * Number of procedures in the database.\n   * @type {number}\n   */\n  this.length = 0;\n\n  /**\n   * Number of procedure definitions in the database that return a value.\n   * @type {number}\n   */\n  this.returnProcedures = 0;\n\n  /**\n   * Number of procedure definitions in the database that do not return a value.\n   * @type {number}\n   */\n  this.voidProcedures = 0;\n};\n\nProcedureDatabase.defaultValue = ['', 'none'];\n\n/**\n * Get a list of names for procedures in the database.\n *\n * @param {Boolean=false} returnValue Return names of procedures with return\n *     values (true) or without return values (false).\n * @return {!string[]}\n */\nProcedureDatabase.prototype.getNames = function(returnValue) {\n  return getProcedureNames(returnValue, this.workspace_)\n      .map(function(v) {\n        return v[0];\n      });\n};\n\n/**\n * Get a list of (name, id) tuples for showing procedure names in a dropdown\n * field.\n * @return {!Array.<Array.<string>>}\n * @param returnValue\n */\nProcedureDatabase.prototype.getMenuItems = function(returnValue) {\n  return getProcedureNames(returnValue, this.workspace_);\n};\n\n/**\n * Get a list of procedure definition blocks.\n *\n * @param {Boolean=false} returnValue Return procedure definition blocks with\n *     return values (true) or without return values (false).\n * @return {!Blockly.Block[]}\n */\nProcedureDatabase.prototype.getDeclarationBlocks =\n    function(returnValue) {\n      return core_browser.utils.object.values(\n          returnValue ? this.returnProcedures_ : this.voidProcedures_);\n    };\n\nProcedureDatabase.prototype.getDeclarationsBlocksExcept = function(block) {\n  const blockArray = [];\n  core_browser.utils.values(this.procedures_).forEach(function(b) {\n    if (b !== block) blockArray.push(b);\n  });\n  return blockArray;\n};\n\nProcedureDatabase.prototype.getAllDeclarationNames = function() {\n  return core_browser.utils.values(this.procedures_)\n      .map(function(block) {\n        return block.getFieldValue('NAME');\n      });\n};\n\n/**\n * Add a procedure to the database.\n *\n * @param {!string} name\n * @param {!Blockly.Block} block\n * @return {boolean} True if the definition was added, otherwise false.\n */\nProcedureDatabase.prototype.addProcedure = function(name, block) {\n  if (block.type != 'procedures_defnoreturn' &&\n      block.type != 'procedures_defreturn') {\n    // not a procedure block!\n    console.warn('Attempt to addProcedure with block type ' + block.type);\n    return false;\n  }\n  const id = block.id;\n  if (id in this.procedures_) {\n    return false;\n  }\n  this.procedures_[id] = block;\n  this.length++;\n  if (block.type == 'procedures_defnoreturn') {\n    this.voidProcedures_[id] = block;\n    this.voidProcedures++;\n  } else {\n    this.returnProcedures_[id] = block;\n    this.returnProcedures++;\n  }\n  return true;\n};\n\n/**\n * Remove a procedure from the database.\n *\n * @param {!string} id\n * @return {boolean}\n */\nProcedureDatabase.prototype.removeProcedure = function(id) {\n  if (id in this.procedures_) {\n    const block = this.procedures_[id];\n    if (block.type == 'procedures_defnoreturn') {\n      delete this.voidProcedures_[id];\n      this.voidProcedures--;\n    } else {\n      delete this.returnProcedures_[id];\n      this.returnProcedures--;\n    }\n    delete this.procedures_[id];\n    this.length--;\n  }\n  return true;\n};\n\n/**\n * Rename a procedure in the database with the given oldNmae to newName.\n *\n * @param {!string} procId\n * @param {!string} oldName\n * @param {!string} newName\n * @returns {boolean} True if the procedure was renamed in the database,\n *     otherwise false.\n */\nProcedureDatabase.prototype.renameProcedure =\n    function(procId, oldName, newName) {\n      /*\n      if (newName in this.procedures_) {\n        return false;\n      }\n      if (oldName in this.procedures_) {\n        var block = this.procedures_[oldName];\n        if (block.type == 'procedures_defnoreturn') {\n          this.voidProcedures_[newName] = block;\n          delete this.voidProcedures_[oldName];\n        } else {\n          this.returnProcedures_[newName] = block;\n          delete this.returnProcedures_[oldName];\n        }\n        this.procedures_[newName] = block;\n        delete this.procedures_[oldName];\n        return true;\n      } else {\n        console.warn('Attempt to renameProcedure \"' + oldName +\n            '\" not in the database.');\n        return false;\n      }\n      */\n    };\n\n/**\n * Get the procedure identified by {@link #id}. If the id does not identify a\n * procedure, undefined will be returned.\n *\n * @param {?string} id The procedure's id.\n * @return {?Blockly.BlockSvg} The procedure block defining the procedure\n *     identified by {@link #id}.\n */\nProcedureDatabase.prototype.getProcedure = function(id) {\n  const proc = this.procedures_[id];\n  return proc ? proc : this.getProcedureByName(id);\n};\n\nProcedureDatabase.prototype.getProcedureByName = function(name) {\n  for (const id in this.procedures_) {\n    if (this.procedures_[id].getFieldValue('NAME') === name) {\n      return this.procedures_[id];\n    }\n  }\n  return undefined;\n};\n\nProcedureDatabase.prototype.clear = function() {\n  this.procedures_ = {};\n  this.returnProcedures_ = {};\n  this.voidProcedures_ = {};\n  this.length = 0;\n  this.returnProcedures = 0;\n  this.voidProcedures = 0;\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/workspace.js\n\n\n\n\n// This ia a bit kludgey and we'll need a better way to make this play nice with\n// apps that already define some of these things (e.g. App Inventor).  It's also\n// kludgey in that we're defining methods on both Blockly.Workspace and Blockly.WorkspaceSvg.\n// That's to cover the cases where we're not clear which class is actually defining the method.\n\n/**\n * Shared flydown for parameters and variables.\n * @type {Flydown}\n * @private\n */\ncore_browser.Workspace.prototype.flydown_ = core_browser.Workspace.prototype.flydown_ || null;\n\ncore_browser.Workspace.prototype.getFlydown = core_browser.Workspace.prototype.getFlydown || function() {\n  return this.flydown_;\n};\n\n/**\n * Obtain the {@link Blockly.ProcedureDatabase} associated with the workspace.\n * @return {!Blockly.ProcedureDatabase}\n */\ncore_browser.Workspace.prototype.getProcedureDatabase = core_browser.Workspace.prototype.getProcedureDatabase || function() {\n  if (!this.procedureDb_) {\n    this.procedureDb_ = new ProcedureDatabase(this);\n  }\n  return this.procedureDb_;\n};\n\n/**\n * Get the topmost workspace in the workspace hierarchy.\n * @return {Blockly.Workspace}\n */\ncore_browser.Workspace.prototype.getTopWorkspace = core_browser.Workspace.prototype.getTopWorkspace || function() {\n  let parent = this;\n  while (parent.targetWorkspace) {\n    parent = parent.targetWorkspace;\n  }\n  return parent;\n};\n\ncore_browser.Workspace.prototype.getWarningHandler = core_browser.Workspace.prototype.getWarningHandler || function() {\n  if (!this.warningHandler_) {\n    this.warningHandler_ = new WarningHandler;\n  }\n  return this.warningHandler_;\n};\n\n/**\n * Shared flydown for parameters and variables.\n * @type {Flydown}\n * @private\n */\ncore_browser.WorkspaceSvg.prototype.flydown_ = core_browser.WorkspaceSvg.prototype.flydown_ || null;\n\ncore_browser.WorkspaceSvg.prototype.getFlydown = core_browser.WorkspaceSvg.prototype.getFlydown || function() {\n  return this.flydown_;\n};\n\n/**\n * Obtain the {@link Blockly.ProcedureDatabase} associated with the workspace.\n * @return {!Blockly.ProcedureDatabase}\n */\ncore_browser.WorkspaceSvg.prototype.getProcedureDatabase = core_browser.WorkspaceSvg.prototype.getProcedureDatabase || function() {\n  if (!this.procedureDb_) {\n    this.procedureDb_ = new ProcedureDatabase(this);\n  }\n  return this.procedureDb_;\n};\n\n/**\n * Get the topmost workspace in the workspace hierarchy.\n * @return {Blockly.WorkspaceSvg}\n */\ncore_browser.WorkspaceSvg.prototype.getTopWorkspace = core_browser.WorkspaceSvg.prototype.getTopWorkspace || function() {\n  let parent = this;\n  while (parent.targetWorkspace) {\n    parent = parent.targetWorkspace;\n  }\n  return parent;\n};\n\ncore_browser.WorkspaceSvg.prototype.getWarningHandler = core_browser.WorkspaceSvg.prototype.getWarningHandler || function() {\n  return WarningHandler;\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/inputs/indented_input.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2023 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n\n\n/**\n * The IndentedInput represents results of computations that run in a\n * statement-like rather than a value-lke context. In particular, it is useful\n * for representing function bodies and macros that compute values.\n */\nclass IndentedInput extends core_browser.inputs.ValueInput {\n  /**\n   * Construct a new IndentedInput.\n   * @param {string} name the name of the input\n   * @param {Blockly.Block} block the block the input belongs to\n   */\n  constructor(name, block) {\n    super(name, block);\n    this.connection = this.makeConnection(core_browser.ConnectionType.INPUT_VALUE);\n    this.type = core_browser.inputTypes.VALUE;\n  }\n}\n\ncore_browser.registry.register(core_browser.registry.Type.INPUT, 'indented_input',\n    IndentedInput);\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/field_flydown.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright © 2013-2016 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Field in which mouseover displays flyout-like menu of blocks\n * and mouse click edits the field name.\n * Flydowns are used in App Inventor for displaying get/set blocks for\n *     parameter names and callers for procedure declarations.\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n\n\n\n\n\n/**\n * Class for a clickable parameter field.\n * @param {string} name The initial parameter name in the field.\n * @param {boolean} isEditable Whether the user is allowed to change the name\n *     of this parameter or not.\n * @param {string=} opt_displayLocation The location to display the flydown at\n *     Either: FieldFlydown.DISPLAY_BELOW,\n *             FieldFlydown.DISPLAY_RIGHT\n *     Defaults to DISPLAY_RIGHT.\n * @param {Function} opt_changeHandler An optional function that is called\n *     to validate any constraints on what the user entered.  Takes the new\n *     text as an argument and returns the accepted text or null to abort\n *     the change. E.g., for an associated getter/setter this could change\n *     references to names in this field.\n * @extends {Blockly.FieldTextInput}\n * @constructor\n */\nclass FieldFlydown extends core_browser.FieldTextInput {\n  /**\n   * Milliseconds to wait before showing flydown after mouseover event on flydown\n   * field.\n   * @type {number}\n   * @const\n   */\n  static timeout = 500;\n\n  /**\n   * Process ID for timer event to show flydown (scheduled by mouseover event).\n   * @type {number}\n   * @const\n   */\n  static showPid_ = 0;\n\n  /**\n   * Which instance of FieldFlydown (or a subclass) is an open flydown attached\n   * to?\n   * @type {FieldFlydown}\n   * @private\n   */\n  static openFieldFlydown_ = null;\n\n// These control the positions of the flydown.\n  static DISPLAY_BELOW = 'BELOW';\n  static DISPLAY_RIGHT = 'RIGHT';\n  static DISPLAY_LOCATION = FieldFlydown.DISPLAY_BELOW;\n\n  constructor(name, isEditable, opt_displayLocation, opt_changeHandler) {\n      super(name, opt_changeHandler);\n      // This by itself does not control editability\n      this.EDITABLE = isEditable;\n      // [lyn, 10/27/13] Make flydown direction an instance variable\n\n      this.displayLocation = opt_displayLocation ||\n          FieldFlydown.DISPLAY_RIGHT;\n  };\n\n  // Override FieldTextInput's showEditor_ so it's only called for EDITABLE field.\n  showEditor_() {\n    if (!this.EDITABLE) {\n      return;\n    }\n    if (FieldFlydown.showPid_) { // cancel a pending flydown for editing\n      clearTimeout(FieldFlydown.showPid_);\n      FieldFlydown.showPid_ = 0;\n      core_browser.common.getMainWorkspace().hideChaff();\n    }\n    super.showEditor_();\n  };\n\n  init(block) {\n    super.init(block);\n    // Remove inherited field css classes ...\n    core_browser.utils.dom.removeClass(/** @type {!Element} */ (this.fieldGroup_),\n        'blocklyEditableText');\n    core_browser.utils.dom.removeClass(/** @type {!Element} */ (this.fieldGroup_),\n        'blocklyNoNEditableText');\n    // ... and add new ones, so that look and feel of flyout fields can be\n    // customized\n    core_browser.utils.dom.addClass(/** @type {!Element} */ (this.fieldGroup_),\n        this.fieldCSSClassName);\n\n    this.mouseOverWrapper_ =\n        core_browser.browserEvents.bind(this.fieldGroup_, 'mouseover', this,\n            this.onMouseOver_);\n    this.mouseOutWrapper_ =\n        core_browser.browserEvents.bind(this.fieldGroup_, 'mouseout', this,\n            this.onMouseOut_);\n  };\n}\n\n/**\n * Default CSS class name for the field itself.\n * @type {string}\n * @const\n */\nFieldFlydown.prototype.fieldCSSClassName = 'blocklyFieldFlydownField';\n\n/**\n * Default CSS class name for the flydown that flies down from the field.\n * @type {string}\n * @const\n */\nFieldFlydown.prototype.flyoutCSSClassName =\n    'blocklyFieldFlydownFlydown';\n\nFieldFlydown.prototype.onMouseOver_ = function(e) {\n  // [lyn, 10/22/13] No flydowns in a flyout!\n  if (!this.sourceBlock_.isInFlyout && FieldFlydown.showPid_ == 0) {\n    FieldFlydown.showPid_ =\n        window.setTimeout(this.showFlydownMaker_(),\n            FieldFlydown.timeout);\n  }\n  // This event has been handled.  No need to bubble up to the document.\n  e.stopPropagation();\n};\n\nFieldFlydown.prototype.onMouseOut_ = function(e) {\n  // Clear any pending timer event to show flydown\n  window.clearTimeout(FieldFlydown.showPid_);\n  FieldFlydown.showPid_ = 0;\n  e.stopPropagation();\n};\n\n/**\n * Returns a thunk that creates a Flydown block of the getter and setter blocks\n * for receiver field.\n *  @return A thunk (zero-parameter function).\n */\nFieldFlydown.prototype.showFlydownMaker_ = function() {\n  // Name receiver in variable so can close over this variable in returned thunk\n  const field = this;\n  return function() {\n    if (FieldFlydown.showPid_ !== 0 &&\n        !field.getSourceBlock().workspace.isDragging() &&\n        !this.htmlInput_) {\n      try {\n        field.showFlydown_();\n      } catch (e) {\n        console.error('Failed to show flydown', e);\n      }\n    }\n    FieldFlydown.showPid_ = 0;\n  };\n};\n\n/**\n * Shows the blocks generated by flydownBlocksXML_ in the flydown. Xml should be\n * wrapped in <xml> tags.\n */\nFieldFlydown.prototype.showFlydown_ = function() {\n  core_browser.common.getMainWorkspace().hideChaff();\n  const flydown = core_browser.common.getMainWorkspace().getFlydown();\n\n  // Add flydown to top-level svg, *not* to main workspace svg\n  // This is essential for correct positioning of flydown via translation\n  // (If it's in workspace svg, it will be additionally translated by\n  //  workspace svg translation relative to Blockly.svg.)\n  core_browser.common.getMainWorkspace().getParentSvg().appendChild(flydown.svgGroup_);\n\n  // Adjust scale for current zoom level\n  const scale = flydown.targetWorkspace.scale;\n  flydown.workspace_.setScale(scale);\n\n  flydown.setCSSClass(this.flyoutCSSClassName);\n\n  const blocksXMLText = this.flydownBlocksXML_();\n  const blocksDom = core_browser.utils.xml.textToDom(blocksXMLText);\n  // [lyn, 11/10/13] Use goog.dom.getChildren rather than .children or\n  //    .childNodes to make this code work across browsers.\n  const blocksXMLList = getChildren(blocksDom);\n\n  const xy = core_browser.common.getMainWorkspace().getSvgXY(this.borderRect_);\n  const borderBBox = this.borderRect_.getBBox();\n  if (this.displayLocation === FieldFlydown.DISPLAY_BELOW) {\n    xy.y += borderBBox.height * scale;\n  } else { // Display right.\n    xy.x += borderBBox.width * scale;\n  }\n\n  // Set the flydown's current field.  Note that this is subtly differnt than\n  // FieldFlydown.openFieldFlydown_ because the latter might get reset\n  // by an iterim hiding of the field and not get set again by an interim call\n  // to show().\n  flydown.field_ = this;\n  flydown.showAt(blocksXMLList, xy.x, xy.y);\n  FieldFlydown.openFieldFlydown_ = this;\n};\n\n/**\n * Hide the flydown menu and squash any timer-scheduled flyout creation.\n */\nFieldFlydown.hide = function() {\n  // Clear any pending timer event to show flydown.\n  window.clearTimeout(FieldFlydown.showPid_);\n  // Hide any displayed flydown.\n  const flydown = core_browser.common.getMainWorkspace().getFlydown();\n  if (flydown) {\n    flydown.hide();\n  }\n};\n\n\n/**\n * Calls the validation function for this field, as well as all the validation\n * function for the field's class and its parents.\n * @param {Blockly.Field} field The field to validate.\n * @param {string} text Proposed text.\n * @return {?string} Revised text, or null if invalid.\n */\nfunction callAllValidators(field, text) {\n  const classResult = field.doClassValidation_(text);\n  if (classResult === null) {\n    // Class validator rejects value.  Game over.\n    return null;\n  } else if (classResult !== undefined) {\n    text = classResult;\n  }\n  const userValidator = field.getValidator();\n  if (userValidator) {\n    const userResult = userValidator.call(field, text);\n    if (userResult === null) {\n      // User validator rejects value.  Game over.\n      return null;\n    } else if (userResult !== undefined) {\n      text = userResult;\n    }\n  }\n  return text;\n}\n\n// TODO: Changing how validators work is not very future proof.\n// Override Blockly's behavior; they call the validator after setting the text,\n// which is incompatible with how our validators work (we expect to be called\n// before the change since in order to find the old references to be renamed).\nFieldFlydown.prototype.onHtmlInputChange_ = function(e) {\n  const htmlInput = this.htmlInput_;\n  const text = htmlInput.value;\n  if (text !== htmlInput.oldValue_) {\n    htmlInput.oldValue_ = text;\n    let valid = true;\n    if (this.sourceBlock_) {\n      valid = callAllValidators(this, htmlInput.value);\n    }\n    if (valid === null) {\n      core_browser.utils.dom.addClass(htmlInput, 'blocklyInvalidInput');\n    } else {\n      core_browser.utils.dom.removeClass(htmlInput, 'blocklyInvalidInput');\n      this.doValueUpdate_(valid);\n    }\n  } else if (core_browser.utils.userAgent.WEBKIT) {\n    // Cursor key.  Render the source block to show the caret moving.\n    // Chrome only (version 26, OS X).\n    this.sourceBlock_.render();\n  }\n\n  // We need all of the following to cause the field to resize!\n  this.textContent_.nodeValue = text;\n  this.forceRerender();\n  this.resizeEditor_();\n\n  core_browser.svgResize(this.sourceBlock_.workspace);\n};\n\n/**\n * Close the flydown and dispose of all UI.\n */\nFieldFlydown.prototype.dispose = function() {\n  if (FieldFlydown.openFieldFlydown_ == this) {\n    FieldFlydown.hide();\n  }\n  // Call parent's destructor.\n  core_browser.FieldTextInput.prototype.dispose.call(this);\n};\n\n/**\n * Constructs a FieldFlydown from a JSON arg object.\n * @param {!Object} options A JSON object with options.\n * @return {FieldFlydown} The new field instance.\n * @package\n * @nocollapse\n */\nFieldFlydown.fromJson = function(options) {\n  const name = core_browser.utils.replaceMessageReferences(options['name']);\n  return new FieldFlydown(name, options['is_editable']);\n};\n\ncore_browser.fieldRegistry.register('field_flydown', FieldFlydown);\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/flydown.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright © 2013-2016 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Flydown is an abstract class for a flyout-like dropdown\n *     containing blocks. Unlike a regular flyout, for simplicity it does not\n *     support scrolling. Any non-abstract subclass must provide a\n *     flydownBlocksXML_ () method that returns an XML element whose children\n *     are blocks that should appear in the flyout.\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n\n\n\n\n/**\n * Class for a flydown.\n * @constructor\n * @param workspaceOptions\n */\nclass Flydown extends core_browser.VerticalFlyout {\n  constructor(workspaceOptions) {\n    super(workspaceOptions);\n    this.dragAngleRange_ = 360;\n  }\n};\n\n/**\n * Previous CSS class for this flydown.\n * @type {string}\n */\nFlydown.prototype.previousCSSClassName_ = '';\n\n/**\n * Override flyout factor to be smaller for flydowns.\n * @type {number}\n * @const\n */\nFlydown.prototype.VERTICAL_SEPARATION_FACTOR = 1;\n\n/**\n * Creates the flydown's DOM.  Only needs to be called once.  Overrides the\n * flyout createDom method.\n * @param {!String} cssClassName The name of the CSS class for this flydown.\n * @return {!Element} The flydown's SVG group.\n */\nFlydown.prototype.createDom = function(cssClassName) {\n  /*\n  <g>\n    <path class={cssClassName}/>\n    <g></g>\n  </g>\n  */\n  this.previousCSSClassName_ = cssClassName; // Remember class name for later\n  this.svgGroup_ =\n      core_browser.utils.dom.createSvgElement('g', {'class': cssClassName}, null);\n  this.svgBackground_ =\n      core_browser.utils.dom.createSvgElement('path', {}, this.svgGroup_);\n  this.svgGroup_.appendChild(this.workspace_.createDom());\n  return this.svgGroup_;\n};\n\n/**\n * Set the CSS class of the flydown SVG group. Need to remove previous class if\n * there is one.\n * @param {!String} newCSSClassName The name of the new CSS class replacing the\n *     old one.\n */\nFlydown.prototype.setCSSClass = function(newCSSClassName) {\n  if (newCSSClassName !== this.previousCSSClassName_) {\n    core_browser.utils.dom.removeClass(this.svgGroup_, this.previousCSSClassName_);\n    core_browser.utils.dom.addClass(this.svgGroup_, newCSSClassName);\n    this.previousCSSClassName_ = newCSSClassName;\n  }\n};\n\n/**\n * Initializes the Flydown.\n * @param {!Blockly.Workspace} workspace The workspace in which to create new\n *     blocks.\n */\nFlydown.prototype.init = function(workspace) {\n  // Flydowns have no scrollbar\n  core_browser.Flyout.prototype.init.call(this, workspace, false);\n  this.workspace_.setTheme(workspace.getTheme());\n  workspace.getComponentManager().addCapability(this.id,\n      core_browser.ComponentManager.Capability.AUTOHIDEABLE);\n};\n\n/**\n * Override the flyout position method to do nothing instead.\n * @private\n */\nFlydown.prototype.position = function() {\n  return;\n};\n\n/**\n * Show and populate the flydown.\n * @param {!Array|string} xmlList List of blocks to show.\n * @param {!num} x X-position of upper-left corner of flydown.\n * @param {!num} y Y-position of upper-left corner of flydown.\n */\nFlydown.prototype.showAt = function(xmlList, x, y) {\n  core_browser.Events.disable();\n  try {\n    // invoke flyout method, which adds blocks to flydown\n    // and calculates width and height.\n    this.show(xmlList);\n  } finally {\n    core_browser.Events.enable();\n  }\n  // this.svgGroup_.setAttribute('transform', 'translate(' + x + ',' + y +\n  // ')');\n  // Calculate path around flydown blocks. Based on code in flyout position_\n  // method.\n\n  // Start at bottom of top left arc and proceed clockwise\n  // Flydown outline shape is symmetric about vertical axis, so no need to\n  // differentiate LTR and RTL paths.\n  const margin = this.CORNER_RADIUS * this.workspace_.scale;\n  const edgeWidth = this.width_ - 2 * margin;\n  const edgeHeight = this.height_ - 2 * margin;\n  const path = ['M 0,' + margin];\n  path.push('a', margin, margin, 0, 0, 1, margin, -margin); // upper left arc\n  path.push('h', edgeWidth); // top edge\n  path.push('a', margin, margin, 0, 0, 1, margin, margin); // upper right arc\n  path.push('v', edgeHeight); // right edge\n  path.push('a', margin, margin, 0, 0, 1, -margin, margin); // bottom right arc\n  path.push('h', -edgeWidth); // bottom edge, drawn backwards\n  path.push('a', margin, margin, 0, 0, 1, -margin, -margin); // bottom left arc\n  path.push('z'); // complete path by drawing left edge\n  this.svgBackground_.setAttribute('d', path.join(' '));\n  this.svgGroup_.setAttribute('transform', 'translate(' + x + ', ' + y + ')');\n};\n\n/**\n * Compute width and height of Flydown.  Position button under each block.\n * Overrides the reflow method of flyout\n * For RTL: Lay out the blocks right-aligned.\n */\nFlydown.prototype.reflow = function() {\n  this.workspace_.scale = this.targetWorkspace.scale;\n  const scale = this.workspace_.scale;\n  let flydownWidth = 0;\n  let flydownHeight = 0;\n  const margin = this.CORNER_RADIUS * scale;\n  const blocks = this.workspace_.getTopBlocks(false);\n  for (let i = 0, block; block = blocks[i]; i++) {\n    const blockHW = block.getHeightWidth();\n    flydownWidth = Math.max(flydownWidth, blockHW.width * scale);\n    flydownHeight += blockHW.height * scale;\n  }\n  flydownWidth += 2 * margin + this.tabWidth_ * scale; // tabWidth is width of\n  // a plug\n  const rendererConstants = this.workspace_.getRenderer().getConstants();\n  const startHatHeight = rendererConstants.ADD_START_HATS ?\n      rendererConstants.START_HAT_HEIGHT : 0;\n  flydownHeight += 3 * margin +\n      margin * this.VERTICAL_SEPARATION_FACTOR * (blocks.length) +\n      startHatHeight * scale / 2.0;\n  if (this.width_ != flydownWidth) {\n    for (let j = 0, block; block = blocks[j]; j++) {\n      const blockHW = block.getHeightWidth();\n      const blockXY = block.getRelativeToSurfaceXY();\n      if (this.RTL) {\n        // With the FlydownWidth known, right-align the blocks.\n        const dx = flydownWidth - margin - scale * (this.tabWidth_ - blockXY.x);\n        block.moveBy(dx, 0);\n        blockXY.x += dx;\n      }\n      if (block.flyoutRect_) {\n        block.flyoutRect_.setAttribute('width', blockHW.width);\n        block.flyoutRect_.setAttribute('height', blockHW.height);\n        block.flyoutRect_.setAttribute('x',\n            this.RTL ? blockXY.x - blockHW.width : blockXY.x);\n        block.flyoutRect_.setAttribute('y', blockXY.y);\n      }\n    }\n    // Record the width for us in showAt method\n    this.width_ = flydownWidth;\n    this.height_ = flydownHeight;\n  }\n};\n\nFlydown.prototype.onMouseMove_ = function(e) {\n  // override Blockly's flyout behavior for moving the flyout.\n  return;\n};\n\n/**\n * Copy a block from the flyout to the workspace and position it correctly.\n * @param {!Blockly.Block} originBlock The flyout block to copy..\n * @return {!Blockly.Block} The new block in the main workspace.\n * @private\n */\nFlydown.prototype.placeNewBlock_ = function(originBlock) {\n  const targetWorkspace = this.targetWorkspace;\n  const svgRootOld = originBlock.getSvgRoot();\n  if (!svgRootOld) {\n    throw Error('originBlock is not rendered.');\n  }\n  // Figure out where the original block is on the screen, relative to the upper\n  // left corner of the main workspace.\n  let scale = this.workspace_.scale;\n  // const margin = this.CORNER_RADIUS * scale;\n  const xyOld = this.workspace_.getSvgXY(svgRootOld);\n  // var scrollX = this.svgGroup_.getScreenCTM().e + margin;\n  const scrollX = xyOld.x;\n  xyOld.x += scrollX / targetWorkspace.scale - scrollX;\n  // var scrollY = this.svgGroup_.getScreenCTM().f + margin;\n  const scrollY = xyOld.y;\n  scale = targetWorkspace.scale;\n  xyOld.y += scrollY / scale - scrollY;\n\n  // Create the new block by cloning the block in the flyout (via XML).\n  const xml = core_browser.Xml.blockToDom(originBlock);\n  const block = core_browser.Xml.domToBlock(xml, targetWorkspace);\n  const svgRootNew = block.getSvgRoot();\n  if (!svgRootNew) {\n    throw Error('block is not rendered.');\n  }\n  // Figure out where the new block got placed on the screen, relative to the\n  // upper left corner of the workspace.  This may not be the same as the\n  // original block because the flyout's origin may not be the same as the\n  // main workspace's origin.\n  const xyNew = targetWorkspace.getSvgXY(svgRootNew);\n  // Scale the scroll (getSvgXY did not do this).\n  xyNew.x +=\n      targetWorkspace.scrollX / targetWorkspace.scale - targetWorkspace.scrollX;\n  xyNew.y +=\n      targetWorkspace.scrollY / targetWorkspace.scale - targetWorkspace.scrollY;\n  // If the flyout is collapsible and the workspace can't be scrolled.\n  if (targetWorkspace.toolbox_ && !targetWorkspace.scrollbar) {\n    xyNew.x += targetWorkspace.toolbox_.getWidth() / targetWorkspace.scale;\n    xyNew.y += targetWorkspace.toolbox_.getHeight() / targetWorkspace.scale;\n  }\n\n  // Move the new block to where the old block is.\n  block.moveBy(xyOld.x - xyNew.x, xyOld.y - xyNew.y);\n  return block;\n};\n\nFlydown.prototype.shouldHide = true;\n\nFlydown.prototype.hide = function() {\n  if (this.shouldHide) {\n    core_browser.Flyout.prototype.hide.call(this);\n    FieldFlydown.openFieldFlydown_ = null;\n  }\n  this.shouldHide = true;\n};\n\nFlydown.prototype.autoHide = function() {\n  this.hide();\n};\n\n// Note: nothing additional beyond flyout disposal needs to be done to dispose\n// of a flydown.\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/field_global_flydown.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright © 2013-2016 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Clickable field with flydown menu of global getter and setter\n *     blocks.\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n\n\n\n\n\n\n\n/**\n * Class for a clickable global variable declaration field.\n * @param name\n * @param displayLocation\n * @param {string} text The initial parameter name in the field.\n * @extends {Blockly.Field}\n * @constructor\n */\nclass FieldGlobalFlydown extends FieldFlydown {\n  constructor(name, displayLocation) {\n    super(name, true, displayLocation,\n        // rename all references to this global variable\n        LexicalVariable.renameGlobal);\n  };\n}\n\nFieldGlobalFlydown.prototype.fieldCSSClassName =\n    'blocklyFieldParameter';\n\nFieldGlobalFlydown.prototype.flyoutCSSClassName =\n    'blocklyFieldParameterFlydown';\n\n/**\n * Block creation menu for global variables\n * Returns a list of two XML elements: a getter block for name and a setter\n * block for this parameter field.\n *  @return {!Array.<string>} List of two XML elements.\n **/\nFieldGlobalFlydown.prototype.flydownBlocksXML_ = function() {\n  // global name for this parameter field.\n  const name = core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX + ' ' + this.getText();\n  const getterSetterXML =\n      '<xml>' +\n        '<block type=\"lexical_variable_get\">' +\n          '<title name=\"VAR\">' +\n            name +\n          '</title>' +\n        '</block>' +\n        '<block type=\"lexical_variable_set\">' +\n          '<title name=\"VAR\">' +\n            name +\n          '</title>' +\n        '</block>' +\n      '</xml>';\n  return getterSetterXML;\n};\n\n/**\n * Constructs a FieldGlobalFlydown from a JSON arg object.\n * @param {!Object} options A JSON object with options.\n * @return {FieldParameterFlydown} The new field instance.\n * @package\n * @nocollapse\n */\nFieldGlobalFlydown.fromJson = function(options) {\n  const name = core_browser.utils.replaceMessageReferences(options['name']);\n  return new FieldGlobalFlydown(name);\n};\n\ncore_browser.fieldRegistry.register('field_global_flydown',\n    FieldGlobalFlydown);\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/field_nocheck_dropdown.js\n// -*- mode: javascript; js-indent-level: 2; -*-\n// Copyright © 2017 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @fileoverview Specialization of Blockly's FieldDropdown to allow setting\n * the value even if it's not one of the dynamically generated options.  We use\n * this in situations where we know that the value will eventually be in the\n * generated set.  This can occur, for example, when we are loading from XML and\n * we have procedure call blocks being created before their respective\n * procedure definition block.\n *\n * @author mark.friedman@gmail.com (Mark Friedman)\n */\n\n\n\n\n\n\nclass FieldNoCheckDropdown extends core_browser.FieldDropdown {\n  constructor(...args) {\n    // Call superclass constructor\n    super(...args);\n  };\n}\n\nFieldNoCheckDropdown.prototype.doClassValidation_ = function(opt_newValue) {\n  let isValueValid = false;\n  const options = this.getOptions(true);\n  for (let i = 0, option; (option = options[i]); i++) {\n    // Options are tuples of human-readable text and language-neutral values.\n    if (option[1] === opt_newValue) {\n      isValueValid = true;\n      break;\n    }\n  }\n  if (!isValueValid) {\n    // Add the value to the cached options array.  Note that this is\n    // potentially fragile, as it depends on knowledge of the\n    // Blockly.FieldDropdown implementation.\n    this.generatedOptions_.push([opt_newValue, opt_newValue]);\n  }\n  return /** @type {string} */ (opt_newValue);\n};\n\n/**\n * Construct a FieldNoCheckDropdown from a JSON arg object.\n * @param {!Object} options A JSON object with options (options).\n * @return {!FieldNoCheckDropdown} The new field instance.\n * @package\n * @nocollapse\n */\nFieldNoCheckDropdown.fromJson = function(options) {\n  return new FieldNoCheckDropdown(options['options'],\n      undefined, options);\n};\n\ncore_browser.fieldRegistry.register('field_nocheck_dropdown',\n    FieldNoCheckDropdown);\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/field_parameter_flydown.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright © 2013-2016 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n/**\n * @license\n * @fileoverview Editable parameter field with flydown menu of a getter and\n *   setter block.\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n\n\n\n\n\n\n\n/**\n * Class for a parameter declaration field with flyout menu of getter/setter\n * blocks on mouse over.\n * @param {string} name The initial parameter name in the field.\n * @param {boolean} isEditable Indicates whether the the name in the flydown is\n *     editable.\n * @param {?string=} opt_displayLocation The location to display the flydown at\n *     Either: FieldFlydown.DISPLAY_BELOW,\n *             FieldFlydown.DISPLAY_RIGHT\n *     Defaults to DISPLAY_RIGHT.\n * @param {?function=} opt_additionalChangeHandler A one-arg function indicating\n *     what to do in addition to renaming lexical variables. May be\n *     null/undefined to indicate nothing extra to be done.\n * @extends {FieldFlydown}\n * @constructor\n */\n// [lyn, 10/26/13] Added opt_additionalChangeHandler to handle propagation of\n//    renaming of proc decl params\nclass FieldParameterFlydown extends FieldFlydown {\n  constructor(name, isEditable, opt_displayLocation, opt_additionalChangeHandler) {\n    const changeHandler = function(text) {\n      if (!FieldParameterFlydown.changeHandlerEnabled) {\n        return text;\n      }\n\n      // Both of these should be called in the context of the field (ie\n      // 'this').\n      const possiblyRenamedText =\n          LexicalVariable.renameParam.call(this, text);\n      if (opt_additionalChangeHandler) {\n        opt_additionalChangeHandler.call(this, possiblyRenamedText);\n      }\n      return possiblyRenamedText;\n    };\n\n    super(name, isEditable, opt_displayLocation, changeHandler);\n  };\n}\n\nFieldParameterFlydown.prototype.fieldCSSClassName =\n    'blocklyFieldParameter';\n\nFieldParameterFlydown.prototype.flyoutCSSClassName =\n    'blocklyFieldParameterFlydown';\n\n// [lyn, 07/02/14] Added this flag to control changeHandler\n//   There are several spots where we want to disable the changeHandler to avoid\n//   unwanted calls to renameParam, such as when these fields are deleted and\n//   then readded in updates to procedures and local variable declarations.\nFieldParameterFlydown.changeHandlerEnabled = true;\n\n// [lyn, 07/02/14] Execute thunk with changeHandler disabled\nFieldParameterFlydown.withChangeHanderDisabled = function(thunk) {\n  const oldFlag = FieldParameterFlydown.changeHandlerEnabled;\n  FieldParameterFlydown.changeHandlerEnabled = false;\n  try {\n    thunk();\n  } finally {\n    FieldParameterFlydown.changeHandlerEnabled = oldFlag;\n  }\n};\n\n/**\n * Returns the stringified xml representation of the blocks we want to have in\n * the flydown. In this case a variable getter and a variable setter.\n * @return {string} The stringified XML.\n */\nFieldParameterFlydown.prototype.flydownBlocksXML_ = function() {\n  // TODO: Refactor this to use getValue() instead of getText(). getText()\n  //   refers to the view, while getValue refers to the model (in MVC terms).\n\n  // Name in this parameter field.\n  const name = this.getText();\n  const getterSetterXML =\n      '<xml>' +\n      '<block type=\"lexical_variable_get\">' +\n      '<field name=\"VAR\">' +\n      name +\n      '</field>' +\n      '</block>' +\n      '<block type=\"lexical_variable_set\">' +\n      '<field name=\"VAR\">' +\n      name +\n      '</field>' +\n      '</block>' +\n      '</xml>';\n  return getterSetterXML;\n};\n\n/**\n * [lyn, 10/24/13]\n * Add an option for toggling horizontal vs. Vertical placement of parameter\n * lists on the given block. Put before \"Collapse Block in uncollapsed block\"\n * [lyn, 10/27/13] Also remove any \"Inline Inputs\" option, since vertical\n * params\n * doesn't interact well with it (in procedures_defreturn).\n * @param block\n * @param options\n */\nFieldParameterFlydown.addHorizontalVerticalOption = function(\n    block, options) {\n  let numParams = 0;\n  if (block.getParameters) {\n    numParams = block.getParameters().length;\n  }\n  if (block.isCollapsed() || numParams <= 0) {\n    return;\n  }\n\n  const horizVertOption = {\n    enabled: true,\n    text: block.horizontalParameters ?\n        core_browser.Msg.VERTICAL_PARAMETERS :\n        core_browser.Msg.HORIZONTAL_PARAMETERS,\n    callback: function() {\n      // TODO: We should force the inputs to be external when we do this.\n      //   If someone sets the inputs inline and then sets the parameters to\n      //   vertical we get the same visual bug as 10/27/13.\n      block.setParameterOrientation(!block.horizontalParameters);\n    },\n  };\n\n  // Find the index of \"Collapse Block\" and insert this option before it.\n  let insertionIndex = 0;\n  for (let option; option = options[insertionIndex]; insertionIndex++) {\n    if (option.text == core_browser.Msg.COLLAPSE_BLOCK) {\n      break;\n    }\n  }\n  // Insert even if we didn't find the option.\n  options.splice(insertionIndex, 0, horizVertOption);\n\n  // Remove an \"Inline Inputs\" option (if there is one).\n  for (let i = 0, option; option = options[i]; i++) {\n    if (option.text == core_browser.Msg.INLINE_INPUTS) {\n      options.splice(i, 1);\n      break;\n    }\n  }\n};\n\n/**\n * Constructs a FieldParameterFlydown from a JSON arg object.\n * @param {!Object} options A JSON object with options.\n * @return {FieldParameterFlydown} The new field instance.\n * @package\n * @nocollapse\n */\nFieldParameterFlydown.fromJson = function(options) {\n  const name = core_browser.utils.replaceMessageReferences(options['name']);\n  return new FieldParameterFlydown(name, options['is_editable']);\n};\n\ncore_browser.fieldRegistry.register('field_parameter_flydown',\n    FieldParameterFlydown);\n\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/fields/field_procedurename.js\n// -*- mode: javascript; js-indent-level: 2; -*-\n// Copyright © 2017 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Specialization of Blockly's FieldTextInput to handle logic of\n *     procedure renaming.\n * @author ewpatton@mit.edu (Evan W. Patton)\n */\n\n\n\n\n\n\n/**\n * FieldProcedureName is a specialization of {@link Blockly.FieldTextInput}\n * that handles renaming procedures in the {@link ProcedureDatabase}\n * when the procedure's name is changed.\n * @param {?string} text\n * @constructor\n */\nclass FieldProcedureName extends core_browser.FieldTextInput {\n  constructor(text) {\n    super(text, renameProcedure);\n  };\n  /**\n   * Set the value of the field.\n   *\n   * @see Blockly.FieldTextInput.setValue\n   * @param {?string} newValue The new value of the field.\n   * @override\n   */\n  setValue(newValue) {\n    const oldValue = this.getValue();\n    this.oldName_ = oldValue;\n    this.doValueUpdate_(newValue);\n    super.setValue(newValue);\n    newValue = this.getValue();\n    if (typeof newValue === 'string' && this.sourceBlock_) {\n      const procDb = this.sourceBlock_.workspace.getProcedureDatabase();\n      if (procDb) {\n        if (procDb.getProcedure(this.sourceBlock_.id)) {\n          procDb.renameProcedure(this.sourceBlock_.id, oldValue, newValue);\n        } else {\n          procDb.addProcedure(newValue, this.sourceBlock_);\n        }\n      }\n    }\n    this.oldName_ = undefined;\n  };\n\n}\n\n/*\nFieldProcedureName.prototype.onHtmlInputChange_ = function(e) {\n  if (e.type == 'keypress') {\n    console.log('Suppressed keypress event');\n    return;  // suppress change handling on key press\n  }\n  console.log(\"input's value is \" + Blockly.FieldTextInput.htmlInput_.value);\n  FieldProcedureName.superClass_.onHtmlInputChange_.call(this, e);\n};\n*/\n\n/**\n * Constructs a FieldProcedureName from a JSON arg object.\n * @param {!Object} options A JSON object with options.\n * @return {FieldProcedureName} The new field instance.\n * @package\n * @nocollapse\n */\nFieldProcedureName.fromJson = function(options) {\n  const name = core_browser.utils.replaceMessageReferences(options['name']);\n  return new FieldProcedureName(name);\n};\n\ncore_browser.fieldRegistry.register('field_procedurename',\n    FieldProcedureName);\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/renderers/geras.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2023 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n\n\n\n/**\n * The IndentedInputMeasurable provides the dimensions of the\n * indented input in the rendering pipeline.\n */\nclass IndentedInputMeasurable extends\n  core_browser.blockRendering.ExternalValueInput {\n  /**\n   * Creates a new IndentedInputMeasurable for the given input assuming the\n   * given renderer constants.\n   * @param {Blockly.blockRendering.ConstantProvider} constants\n   *     the parent renderer's constant pool\n   * @param {IndentedInput} input the input measured by this measurable\n   */\n  constructor(constants, input) {\n    super(constants, input);\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;\n    } else {\n      this.height = this.connectedBlockHeight;\n    }\n  }\n}\n\n/**\n * An extension of the Geras highlighter to support indented inputs.\n */\nclass GerasHighlighter extends core_browser.geras.Highlighter {\n  /**\n   * Constructs a new Geras highlighter.\n   * @param {Blockly.blockRendering.RenderInfo} info the render info state\n   */\n  constructor(info) {\n    super(info);\n  }\n\n  /**\n   * Renders the indented input present at the specified row.\n   * @param {Blockly.blockRendering.Row} row the row being drawn\n   */\n  drawIndentedInput(row) {\n    const input = row.getLastInput();\n    if (this.RTL_) {\n      const belowTabHeight = row.height - input.connectionHeight -\n        input.connectionOffsetY;\n\n      this.steps_ +=\n        core_browser.utils.svgPaths.moveTo(\n            input.xPos + this.highlightOffset + input.connectionWidth - 1,\n            row.yPos) +\n        core_browser.utils.svgPaths.lineOnAxis('v', input.connectionOffsetY) +\n        this.puzzleTabPaths_.pathDown(this.RTL_) +\n        core_browser.utils.svgPaths.lineOnAxis('v', belowTabHeight);\n    } else {\n      this.steps_ +=\n        core_browser.utils.svgPaths.moveTo(input.xPos + input.connectionWidth,\n            row.yPos + input.connectionOffsetY) +\n        this.puzzleTabPaths_.pathDown(this.RTL_) +\n        core_browser.utils.svgPaths.moveTo(input.xPos + input.connectionWidth + 1,\n            row.yPos + input.height);\n    }\n  }\n}\n\n/**\n * GerasDrawer is an extension of the Geras Drawer object to handle indented\n * inputs.\n */\nclass GerasDrawer extends core_browser.geras.Drawer {\n  /**\n   * Creates a new Drawer for the block with the given render info.\n   * @param {Blockly.BlockSvg} block The block to render.\n   * @param {Blockly.blockRendering.RenderInfo} info An object containing all\n   *     information needed to render this block.\n   */\n  constructor(block, info) {\n    super(block, info);\n    this.highlighter_ = new GerasHighlighter(info);\n  }\n\n  /**\n   * Create the outline of the block. This is a single continuous path.\n   */\n  drawOutline_() {\n    this.drawTop_();\n    for (let r = 1; r < this.info_.rows.length - 1; r++) {\n      const row = this.info_.rows[r];\n      if (row.getLastInput() instanceof IndentedInputMeasurable) {\n        this.drawIndentedInput_(row);\n      } else if (row.hasJaggedEdge) {\n        this.drawJaggedEdge_(row);\n      } else if (row.hasStatement) {\n        this.drawStatementInput_(row);\n      } else if (row.hasExternalInput) {\n        this.drawValueInput_(row);\n      } else {\n        this.drawRightSideRow_(row);\n      }\n    }\n    this.drawBottom_();\n    this.drawLeft_();\n  }\n\n  /**\n   * Draws an indented input in the block.\n   * @param {Blockly.blockRendering.Row} row the row being drawn\n   * @private\n   */\n  drawIndentedInput_(row) {\n    const input = row.getLastInput();\n    this.positionIndentedValueConnection_(row);\n    (/** @type {GerasHighlighter} */ this.highlighter_).drawIndentedInput(row);\n\n    const pathDown = (typeof input.shape.pathDown == 'function') ?\n      input.shape.pathDown(input.height) :\n      input.shape.pathDown;\n\n    this.outlinePath_ +=\n      core_browser.utils.svgPaths.lineOnAxis('H',\n          input.xPos + input.connectionWidth) +\n      core_browser.utils.svgPaths.lineOnAxis('v', input.connectionOffsetY) +\n      pathDown +\n      core_browser.utils.svgPaths.lineOnAxis('v',\n          row.height - input.connectionHeight - input.connectionOffsetY) +\n      core_browser.utils.svgPaths.lineOnAxis('H', input.xPos + input.width);\n  }\n\n  positionIndentedValueConnection_ = function(row) {\n    const input = row.getLastInput();\n    if (input.connectionModel) {\n      let connX = row.xPos + row.statementEdge + row.constants_.TAB_WIDTH;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX,\n          row.yPos + input.connectionOffsetY);\n    }\n  };\n}\n\n/**\n * An extension of the Blockly Geras RenderInfo object that understands\n * indented inputs.\n */\nclass GerasRenderInfo extends core_browser.geras.RenderInfo {\n  /**\n   * Adds a measurable for the given input to the active row.\n   * @param {Blockly.Input} input the current input being processed\n   * @param {Blockly.blockRendering.Row} activeRow the active row\n   */\n  addInput_(input, activeRow) {\n    if (input instanceof IndentedInput) {\n      activeRow.elements.push(\n          new IndentedInputMeasurable(this.constants_, input)\n      );\n      activeRow.hasStatement = true;\n    } else {\n      super.addInput_(input, activeRow);\n    }\n  }\n}\n\n/**\n * The GerasRenderer class provides an extension of the built-in\n * Blockly Geras renderer to support indented inputs in the style of\n * MIT App Inventor.\n */\nclass GerasRenderer extends core_browser.geras.Renderer {\n  /**\n   * @inheritDoc\n   * @param {Blockly.BlockSvg} block the block to be rendered\n   * @returns {Blockly.geras.RenderInfo} render info object\n   * @private\n   */\n  makeRenderInfo_(block) {\n    return new GerasRenderInfo(this, block);\n  }\n\n  /**\n   * Make a custom Drawer for the GerasRenderer.\n   * @param {Blockly.BlockSvg} block a BlockSvg to be drawn\n   * @param {Blockly.blockRendering.RenderInfo} info\n   *     rendering info for the block\n   * @returns {GerasDrawer} the Drawer for the block\n   */\n  makeDrawer_(block, info) {\n    return new GerasDrawer(block, info);\n  }\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/core.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2024 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n\n\n\nregisterCss();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass LexicalVariablesPlugin {\n\n    /**\n     * @param workspace\n     */\n    static init(workspace) {\n        // TODO: Might need the next line\n        // Blockly.DropDownDiv.createDom();\n        const flydown = new Flydown(\n            new core_browser.Options({\n                scrollbars: false,\n                rtl: workspace.RTL,\n                renderer: workspace.options.renderer,\n                rendererOverrides: workspace.options.rendererOverrides,\n                parentWorkspace: workspace,\n            })\n        );\n        // ***** [lyn, 10/05/2013] NEED TO WORRY ABOUT MULTIPLE BLOCKLIES! *****\n        workspace.flydown_ = flydown;\n        core_browser.utils.dom.insertAfter(flydown.createDom('g'),\n            workspace.svgBubbleCanvas_);\n        flydown.init(workspace);\n        flydown.autoClose = true; // Flydown closes after selecting a block\n    }\n\n    static Flydown = Flydown;\n    static FieldFlydown = FieldFlydown;\n    static FieldGlobalFlydown = FieldGlobalFlydown;\n    static FieldParameterFlydown = FieldParameterFlydown;\n    static LexicalVariable = LexicalVariable;\n    static FieldLexicalVariable = FieldLexicalVariable;\n    static FieldProcedureName = FieldProcedureName;\n    static NameSet = nameSet_NameSet;\n    static Shared = shared_namespaceObject;\n    static Substitution = Substitution;\n}\n\ncore_browser.blockRendering.register('geras2_renderer', GerasRenderer);\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/blocks/lexical-variables.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2013-2014 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Variables blocks for Blockly, modified for MIT App Inventor.\n * @author fturbak@wellesley.edu (Lyn Turbak)\n */\n\n/**\n * Lyn's History:\n *  * [lyn, written 11/16-17/13, added 07/01/14]\n *   + Added freeVariables, renameFree, and renameBound to local declarations\n *   + Added freeVariables and renameFree to getters and setters\n *   + Added renameVar and renameVars to local declaration\n *   + renamed addDeclarationInputs_ to updatedDeclarationInputs_\n * [lyn, 03/04/13]\n *   + Remove notion of collapsed input from local variable declaration\n * statements/expressions, which has been eliminated in updated to Blockly\n * v1636.\n *   + Update appendTitle* to appendField*\n * [lyn, 01/18/13] Remove onchange from lexical_variable_get and\n * lexical_variable_set. This fixes issue 667 (Variable getter/setter names\n * deleted in copied blocks) and improves laggy drag problem.\n * [lyn, 10/27/13]\n *   + Modified local declaration parameter flydowns so editing the name\n * changes corresponding name in an open mutator.\n *   + Changed local declaration compose() to rebuild inputs only if local\n * names have changed.\n *     (essential for getting param flydown name changes reflected in open\n * mutator).\n *   + Fixed local declaration expression compose() to be the same as that for\n * local declaration statements.\n *   + Modified addDeclarationInputs_ to remove existing declarations, add new\n * ones, and keep last two declarations (body and collapsed text) rather than\n * recreating them. This is now used by both domToMutation() and compose(),\n * eliminating duplicated code.\n *   + Eliminated dummy declarations.\n *   + Specify direction of flydowns\n * [lyn, 10/25/13] Made collapsed block labels more sensible.\n * [lyn, 10/10-14/13]\n *   + Installed variable declaration flydowns in global definition and local\n * variable declaration statements and expressions.\n *   + Abstracted over string labels on all blocks using constants defined in\n * en/_messages.js\n *   + Cleaned up code, including refactoring to increase sharing between\n *     local_declaration_statement and local_declaration_expression.\n *   + Fixed bug: Modified onchange for local declarations to keep localNames_\n * instance variable updated when param is edited directly on declaration\n * block.\n *   + In local variable statements/expression, changed both \"in do\" and \"in\n * return\" to \"scope\" (shape distinguishes them). But maybe these should just\n * be empty string?\n * [lyn, 11/18/12] Renaming for globals (still working on renaming of procedure\n * and loop params)\n * [lyn, 11/17/12] Integration of simple naming into App Inventor\n * [lyn, 11/11/12] More work on onchange event. Allow invalid names for\n * untethered getters/setters on workspace, but not when click in to other\n * blocks.\n * [lyn, 11/08-10/12] Get dropdown list of names in scope to work for globals\n * and params\n *                    (including loops) in raw blockly. Pass along to Andrew\n * for integration into AI. Initial work on onchange event to change names when\n * getters/setters copied and moved.\n * [lyn, 11/05-07/12] Add local variable declaration expressions. Get mutator\n * working for local declaration statements and expressions. But these don't\n * save/load properly from XML Helpful 10/7 hangout with Andrew and Paul.\n * [lyn, 11/04/12] Created. Add global declarations. Work on local variable\n * declaration statement.\n */\n\n/*\n// For debugging only\nfunction myStringify (obj) {\n  var seen = [];\n  return JSON.stringify(obj, function(key, val) {\n   if (typeof val == \"object\") {\n       if (seen.indexOf(val) >= 0) {\n           return undefined;\n       }\n       seen.push(val);\n   }\n   return val\n   });\n}\n*/\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndelete core_browser.Blocks['global_declaration'];\n/**\n * Prototype bindings for a global variable declaration block.\n */\ncore_browser.Blocks['global_declaration'] = {\n  // Global var defn\n  category: 'Variables',\n  helpUrl: core_browser.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_HELPURL,\n  init: function() {\n    this.setStyle('variable_blocks');\n    this.appendValueInput('VALUE')\n        .appendField(core_browser.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT)\n        .appendField(new FieldGlobalFlydown(\n            core_browser.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME,\n            FieldFlydown.DISPLAY_BELOW), 'NAME')\n        .appendField(core_browser.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO);\n    this.setTooltip(core_browser.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP);\n  },\n  getVars: function() {\n    const field = this.getField('NAME');\n    return field ? [field.getText()] : [];\n  },\n  getGlobalNames: function() {\n    return this.getVars();\n  },\n  renameVar: function(oldName, newName) {\n    if (core_browser.Names.equals(oldName, this.getFieldValue('NAME'))) {\n      this.setFieldValue(newName, 'NAME');\n    }\n  },\n};\n\n/**\n * Prototype bindings for a variable getter block.\n */\ncore_browser.Blocks['lexical_variable_get'] = {\n  // Variable getter.\n  category: 'Variables',\n  helpUrl: core_browser.Msg.LANG_VARIABLES_GET_HELPURL,\n  init: function() {\n    this.setStyle('variable_blocks');\n    this.fieldVar_ = new FieldLexicalVariable(' ');\n    this.fieldVar_.setBlock(this);\n    this.appendDummyInput()\n        .appendField(core_browser.Msg.LANG_VARIABLES_GET_TITLE_GET)\n        .appendField(this.fieldVar_, 'VAR');\n    this.setOutput(true, null);\n    this.setTooltip(core_browser.Msg.LANG_VARIABLES_GET_TOOLTIP);\n    this.errors = [\n      {func: ErrorCheckers.checkIsInDefinition},\n      {\n        func: ErrorCheckers.checkDropDownContainsValidValue,\n        dropDowns: ['VAR'],\n      },\n    ];\n    this.setOnChange(function(changeEvent) {\n      this.workspace.getWarningHandler().checkErrors(this);\n    });\n  },\n  referenceResults: function(name, prefix, env) {\n    const childrensReferenceResults = this.getChildren().map(function(blk) {\n      return LexicalVariable.referenceResult(blk, name, prefix, env);\n    });\n    let blocksToRename = [];\n    let capturables = [];\n    for (let r = 0; r < childrensReferenceResults.length; r++) {\n      blocksToRename = blocksToRename.concat(childrensReferenceResults[r][0]);\n      capturables = capturables.concat(childrensReferenceResults[r][1]);\n    }\n    const possiblyPrefixedReferenceName = this.getField('VAR').getText();\n    const unprefixedPair = unprefixName(possiblyPrefixedReferenceName);\n    const referencePrefix = unprefixedPair[0];\n    const referenceName = unprefixedPair[1];\n    const referenceNotInEnv = ((usePrefixInCode &&\n            (env.indexOf(possiblyPrefixedReferenceName) == -1)) ||\n        ((!usePrefixInCode) && (env.indexOf(referenceName) == -1)));\n    if (!(referencePrefix === core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX)) {\n      if ((referenceName === name) && referenceNotInEnv) {\n        // if referenceName refers to name and not some intervening\n        // declaration, it's a reference to be renamed:\n        blocksToRename.push(this);\n        // Any intervening declared name with the same prefix as the searched\n        // for name can be captured:\n        if (usePrefixInCode) {\n          for (let i = 0; i < env.length; i++) {\n            // env is a list of prefixed names.\n            const unprefixedEntry = unprefixName(env[i]);\n            if (prefix === unprefixedEntry[0]) {\n              capturables.push(unprefixedEntry[1]);\n            }\n          }\n        } else { // Shared.usePrefixInCode\n          capturables = capturables.concat(env);\n        }\n      } else if (referenceNotInEnv &&\n          (!usePrefixInCode || prefix === referencePrefix)) {\n        // If reference is not in environment, it's externally declared and\n        // capturable When Shared.usePrefixInYail is true, only consider names\n        // with same prefix to be capturable\n        capturables.push(referenceName);\n      }\n    }\n    return [[blocksToRename, capturables]];\n  },\n  getVars: function() {\n    return [this.getFieldValue('VAR')];\n  },\n  renameLexicalVar: function(oldName, newName, oldTranslatedName,\n      newTranslatedName) {\n    if (oldTranslatedName === undefined) {\n      // Local variables\n      if (oldName === this.getFieldValue('VAR')) {\n        this.setFieldValue(newName, 'VAR');\n      }\n    } else if (oldTranslatedName && oldTranslatedName ===\n        this.fieldVar_.getText()) {\n      // Global variables\n\n      // Force a regeneration of the dropdown options, so the subsequent\n      // calls to setValue and setFieldValue will work properly.\n      this.fieldVar_.getOptions(false);\n      this.fieldVar_.setValue(newName);\n      if (oldName === newName) {\n        this.setFieldValue(newName, 'VAR');\n      }\n      this.fieldVar_.forceRerender();\n    }\n  },\n  renameFree: function(freeSubstitution) {\n    const prefixPair = unprefixName(this.getFieldValue('VAR'));\n    const prefix = prefixPair[0];\n    // Only rename lexical (nonglobal) names\n    if (prefix !== core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX) {\n      const oldName = prefixPair[1];\n      const newName = freeSubstitution.apply(oldName);\n      if (newName !== oldName) {\n        this.renameLexicalVar(oldName, newName);\n      }\n    }\n  },\n  freeVariables: function() { // return the free lexical variables of this block\n    const prefixPair = unprefixName(this.getFieldValue('VAR'));\n    const prefix = prefixPair[0];\n    // Only return lexical (nonglobal) names\n    if (prefix !== core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX) {\n      const oldName = prefixPair[1];\n      return new nameSet_NameSet([oldName]);\n    } else {\n      return new nameSet_NameSet();\n    }\n  },\n};\n\n/**\n * Prototype bindings for a variable setter block.\n */\ncore_browser.Blocks['lexical_variable_set'] = {\n  // Variable setter.\n  category: 'Variables',\n  helpUrl: core_browser.Msg.LANG_VARIABLES_SET_HELPURL, // *** [lyn, 11/10/12] Fix\n  // this\n  init: function() {\n    this.setStyle('variable_blocks');\n    this.fieldVar_ = new FieldLexicalVariable(' ');\n    this.fieldVar_.setBlock(this);\n    this.appendValueInput('VALUE')\n        .appendField(core_browser.Msg.LANG_VARIABLES_SET_TITLE_SET)\n        .appendField(this.fieldVar_, 'VAR')\n        .appendField(core_browser.Msg.LANG_VARIABLES_SET_TITLE_TO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(core_browser.Msg.LANG_VARIABLES_SET_TOOLTIP);\n    this.errors = [\n      {func: ErrorCheckers.checkIsInDefinition},\n      {\n        func: ErrorCheckers.checkDropDownContainsValidValue,\n        dropDowns: ['VAR'],\n      },\n    ];\n    this.setOnChange(function(changeEvent) {\n      this.workspace.getWarningHandler().checkErrors(this);\n    });\n  },\n  referenceResults: core_browser.Blocks.lexical_variable_get.referenceResults,\n  getVars: function() {\n    return [this.getFieldValue('VAR')];\n  },\n  renameLexicalVar: core_browser.Blocks.lexical_variable_get.renameLexicalVar,\n  renameFree: function(freeSubstitution) {\n    // potentially rename the set variable\n    const prefixPair = unprefixName(this.getFieldValue('VAR'));\n    const prefix = prefixPair[0];\n    // Only rename lexical (nonglobal) names\n    if (prefix !== core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX) {\n      const oldName = prefixPair[1];\n      const newName = freeSubstitution.apply(oldName);\n      if (newName !== oldName) {\n        this.renameLexicalVar(oldName, newName);\n      }\n    }\n    // [lyn, 06/26/2014] Don't forget to rename children!\n    this.getChildren().map(function(blk) {\n      LexicalVariable.renameFree(blk, freeSubstitution);\n    });\n  },\n  freeVariables: function() { // return the free lexical variables of this block\n    // [lyn, 06/27/2014] Find free vars of *all* children, including subsequent\n    // commands in NEXT slot.\n    const childrenFreeVars = this.getChildren().map(function(blk) {\n      return LexicalVariable.freeVariables(blk);\n    });\n    const result = nameSet_NameSet.unionAll(childrenFreeVars);\n    const prefixPair = unprefixName(this.getFieldValue('VAR'));\n    const prefix = prefixPair[0];\n    // Only return lexical (nonglobal) names\n    if (prefix !== core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX) {\n      const oldName = prefixPair[1];\n      result.insert(oldName);\n    }\n    return result;\n  },\n};\n\n/**\n * Prototype bindings for a statement block that declares local names for use\n * in a statement body.\n * [lyn, 10/13/13] Refactored to share more code with\n * Blockly.Blocks.local_declaration_expression.\n */\ncore_browser.Blocks['local_declaration_statement'] = {\n  // Define a procedure with no return value.\n  // category: null,  // Procedures are handled specially.\n  category: 'Variables', // *** [lyn, 11/07/12] Abstract over this\n  helpUrl: core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_HELPURL,\n  bodyInputName: 'STACK',\n  init: function() {\n    this.setStyle('variable_blocks');\n    this.initLocals();\n    this.appendStatementInput('STACK')\n        .appendField(core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO);\n\n    // Add notch and nub for vertical statement composition\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n\n    this.setTooltip(core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP);\n    this.lexicalVarPrefix = localNamePrefix;\n  },\n  referenceResults: function(name, prefix, env) {\n    // Collect locally declared names ...\n    const localDeclNames = [];\n    for (let i = 0; this.getInput('DECL' + i); i++) {\n      let localName = this.getFieldValue('VAR' + i);\n      // Invariant: Shared.showPrefixToUser must also be true!\n      if (usePrefixInCode) {\n        localName = (possiblyPrefixMenuNameWith(localNamePrefix))(\n            localName);\n      }\n      localDeclNames.push(localName);\n    }\n    const newEnv = env.concat(localDeclNames); // ... and add to environment\n    // Collect locally initialization expressions:\n    const localInits = [];\n    for (let i = 0; this.getInput('DECL' + i); i++) {\n      const init = this.getInputTargetBlock('DECL' + i);\n      if (init) {\n        localInits.push(init);\n      }\n    }\n    const initResults = localInits.map(function(init) {\n      return LexicalVariable.referenceResult(init, name, prefix, env);\n    });\n    const doResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('STACK'), name, prefix, newEnv);\n    const nextResults = LexicalVariable.referenceResult(\n        LexicalVariable.getNextTargetBlock(this), name, prefix, env);\n    return initResults.concat([doResults, nextResults]);\n  },\n  withLexicalVarsAndPrefix: function(child, proc) {\n    if (this.getInputTargetBlock(this.bodyInputName) == child) {\n      const localNames = this.declaredNames();\n      // not arguments_ instance var\n      for (let i = 0; i < localNames.length; i++) {\n        proc(localNames[i], this.lexicalVarPrefix);\n      }\n    }\n  },\n  initLocals: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.VARIABLE_CATEGORY_HUE);\n    this.setStyle('variable_blocks');\n    this.localNames_ =\n        [core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME];\n    const declInput = this.appendValueInput('DECL0');\n    declInput.appendField(\n        core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT)\n        .appendField(this.parameterFlydown(0), 'VAR0')\n        .appendField(core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n\n    // Add mutator for editing local variable names\n    this.setMutator(new core_browser.icons.MutatorIcon(['local_mutatorarg'], this));\n  },\n  onchange: function() {\n    this.localNames_ = this.declaredNames(); // ensure localNames_ is in sync\n    // with paramFlydown fields\n  },\n  // Store local names in mutation element of XML for block\n  mutationToDom: function() {\n    const container = core_browser.utils.xml.createElement('mutation');\n    for (let i = 0; i < this.localNames_.length; i++) {\n      const parameter = core_browser.utils.xml.createElement('localname');\n      parameter.setAttribute('name', this.localNames_[i]);\n      container.appendChild(parameter);\n    }\n    return container;\n  },\n  // Retrieve local names from mutation element of XML for block\n  domToMutation: function(xmlElement) {\n    // and replace existing declarations\n    const children = getChildren(xmlElement);\n    if (children.length > 0) { // Ensure xml element is nonempty\n      // Else we'll overwrite initial list with \"name\" for new block\n      this.localNames_ = [];\n      for (let i = 0, childNode; childNode = children[i]; i++) {\n        if (childNode.nodeName.toLowerCase() == 'localname') {\n          this.localNames_.push(childNode.getAttribute('name'));\n        }\n      }\n    }\n    this.updateDeclarationInputs_(this.localNames_); // add declarations; inits\n    // are undefined\n  },\n  updateDeclarationInputs_: function(names, inits) {\n    // Modify this block to replace existing initializers by new declaration\n    // inputs created from names and inits. If inits is undefined, treat all\n    // initial expressions as undefined. Keep existing body at end of input\n    // list. [lyn, 03/04/13] As of change to, Blockly 1636, there is no longer\n    // a collapsed input at end.\n\n    // Remember last (= body) input\n    const bodyInput = this.inputList[this.inputList.length - 1]; // Body input\n    // for local\n    // declaration\n    const numDecls = this.inputList.length - 1;\n\n    // [lyn, 07/03/14] stop rendering until block is recreated\n    const savedRendered = this.rendered;\n    this.rendered = false;\n\n    // Modify this local-in-do block according to arrangement of name blocks in\n    // mutator editor. Remove all the local declaration inputs ...\n    const thisBlock = this; // Grab correct object for use in thunk below\n    FieldParameterFlydown.withChangeHanderDisabled(\n        // [lyn, 07/02/14] Need to disable change handler, else this will try\n        // to rename params removed fields.\n        function() {\n          for (let i = 0; i < numDecls; i++) {\n            thisBlock.removeInput('DECL' + i);\n          }\n        },\n    );\n\n    // Empty the inputList and recreate it, building local initializers from\n    // mutator\n    this.inputList = [];\n    this.localNames_ = names;\n\n    for (let i = 0; i < names.length; i++) {\n      const declInput = this.appendValueInput('DECL' + i);\n      // [lyn, 11/06/12]\n      //   This was for case where tried to put \"local\" keyword on same line\n      // with first local name. But even though alignment set to\n      // Blockly.inputs.Align.RIGHT, the input was left justified and covered the plus\n      // sign for popping up the mutator. So I put the \"local\" keyword on it's\n      // own line even though this wastes vertical space. This should be fixed\n      // in the future. if (i == 0) { declInput.appendField(\"local\"); // Only\n      // put keyword \"local\" on top line. }\n      declInput.appendField(\n          core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT)\n          .appendField(this.parameterFlydown(i), 'VAR' + i)\n          .appendField(core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO)\n          .setAlign(core_browser.inputs.Align.RIGHT);\n      if (inits && inits[i]) { // If there is an initializer, connect it\n        declInput.connection.connect(inits[i]);\n      }\n    }\n\n    // Now put back last (= body) input\n    this.inputList = this.inputList.concat(bodyInput);\n\n    this.rendered = savedRendered;\n    if (this.rendered) {\n      this.initSvg();\n      this.render();\n    }\n  },\n  // [lyn, 10/27/13] Introduced this to correctly handle renaming of mutatorarg\n  // in open mutator when procedure parameter flydown name is edited.\n\n  // Return a new local variable parameter flydown\n  parameterFlydown: function(paramIndex) {\n    const initialParamName = this.localNames_[paramIndex];\n    const localDecl = this; // Here, \"this\" is the local decl block. Name it to\n    // use in function below\n    const localParameterChangeHandler = function(newParamName) {\n      // This handler has the same subtleties as\n      // procedureParameterChangeHandler in language/common/procedures.js, but\n      // is somewhat simpler since doesn't have associated callers to change.\n      // See the notes there.\n\n      // See Subtleties #1 and #2 in  procedureParameterChangeHandler in\n      // language/common/procedures.js\n      const newLocals = localDecl.localNames_;\n      newLocals[paramIndex] = newParamName;\n\n      // If there's an open mutator, change the name in the corresponding slot.\n      if (localDecl.mutator && localDecl.mutator.rootBlock_) {\n        // Iterate through mutatorarg param blocks and change name of one at\n        // paramIndex\n        const mutatorContainer = localDecl.mutator.rootBlock_;\n        let mutatorargIndex = 0;\n        let mutatorarg = mutatorContainer.getInputTargetBlock('STACK');\n        while (mutatorarg && mutatorargIndex < paramIndex) {\n          mutatorarg = mutatorarg.nextConnection &&\n              mutatorarg.nextConnection.targetBlock();\n          mutatorargIndex++;\n        }\n        if (mutatorarg && mutatorargIndex == paramIndex) {\n          // See Subtlety #3 in  procedureParameterChangeHandler in\n          // language/common/procedures.js\n          core_browser.Field.prototype.setValue.call(mutatorarg.getField('NAME'),\n              newParamName);\n        }\n      }\n    };\n    return new FieldParameterFlydown(initialParamName,\n        true, // name is editable\n        FieldFlydown.DISPLAY_RIGHT,\n        localParameterChangeHandler);\n  },\n  decompose: function(workspace) {\n    // Create \"mutator\" editor populated with name blocks with local variable\n    // names\n    const containerBlock = workspace.newBlock('local_mutatorcontainer');\n    containerBlock.initSvg();\n    containerBlock.setDefBlock(this);\n    let connection = containerBlock.getInput('STACK').connection;\n    for (let i = 0; i < this.localNames_.length; i++) {\n      const localName = this.getFieldValue('VAR' + i);\n      const nameBlock = workspace.newBlock('local_mutatorarg');\n      nameBlock.initSvg();\n      nameBlock.setFieldValue(localName, 'NAME');\n      // Store the old location.\n      nameBlock.oldLocation = i;\n      connection.connect(nameBlock.previousConnection);\n      connection = nameBlock.nextConnection;\n    }\n    return containerBlock;\n  },\n  compose: function(containerBlock) {\n    // [lyn, 10/27/13] Modified this so that doesn't rebuild block if names\n    // haven't changed. This is *essential* to handle Subtlety #3 in\n    // localParameterChangeHandler within parameterFlydown.\n\n    const newLocalNames = [];\n    const initializers = [];\n    let mutatorarg = containerBlock.getInputTargetBlock('STACK');\n    while (mutatorarg) {\n      newLocalNames.push(mutatorarg.getFieldValue('NAME'));\n      initializers.push(mutatorarg.valueConnection_); // pushes undefined if\n      // doesn't exist\n      mutatorarg =\n          mutatorarg.nextConnection && mutatorarg.nextConnection.targetBlock();\n    }\n\n    // Reconstruct inputs only if local list has changed\n    if (!LexicalVariable.stringListsEqual(this.localNames_,\n        newLocalNames)) {\n      // Switch off rendering while the block is rebuilt.\n      // var savedRendered = this.rendered;\n      // this.rendered = false;\n\n      this.updateDeclarationInputs_(newLocalNames, initializers);\n\n      // Restore rendering and show the changes.\n      // this.rendered = savedRendered;\n      // if (this.rendered) {\n      //  this.render();\n      // }\n    }\n  },\n  saveConnections: function(containerBlock) {\n    // Store child initializer blocks for local name declarations with name\n    // blocks in mutator editor\n    let nameBlock = containerBlock.getInputTargetBlock('STACK');\n    let i = 0;\n    while (nameBlock) {\n      const localDecl = this.getInput('DECL' + i);\n      nameBlock.valueConnection_ =\n          localDecl && localDecl.connection.targetConnection;\n      i++;\n      nameBlock = nameBlock.nextConnection &&\n          nameBlock.nextConnection.targetBlock();\n    }\n    // Store body statement or expression connection\n    const bodyInput = this.getInput(this.bodyInputName); // 'STACK' or 'RETURN'\n    if (bodyInput) {\n      containerBlock.bodyConnection_ = bodyInput.connection.targetConnection;\n    }\n  },\n  getVars: function() {\n    const varList = [];\n    for (let i = 0, input; input = this.getField('VAR' + i); i++) {\n      varList.push(input.getValue());\n    }\n    return varList;\n  },\n  // Interface with LexicalVariable.renameParam\n  declaredNames: function() {\n    return this.getVars();\n  },\n  declaredVariables: function() {\n    return this.getVars();\n  },\n  // [lyn, 11/16/13 ] Return all the initializer connections\n  initializerConnections: function() {\n    const connections = [];\n    for (let i = 0, input; input = this.getInput('DECL' + i); i++) {\n      connections.push(input.connection && input.connection.targetConnection);\n    }\n    return connections;\n  },\n  // Interface with LexicalVariable.renameParam\n  blocksInScope: function() {\n    // *** [lyn, 11/24/12]\n    // This will go away with DO-AND-RETURN block\n    const doBody = this.getInputTargetBlock(this.bodyInputName);\n    // List of non-null doBody or empty list for null doBody\n    const doBodyList = (doBody && [doBody]) || [];\n    return doBodyList; // List of non-null body elements.\n  },\n  renameVar: function(oldName, newName) {\n    this.renameVars(Substitution.simpleSubstitution(oldName, newName));\n  },\n  // substitution is a dict (i.e., object) mapping old names to new ones\n  renameVars: function(substitution) {\n    const localNames = this.declaredNames();\n    const renamedLocalNames = substitution.map(localNames);\n    if (!LexicalVariable.stringListsEqual(renamedLocalNames,\n        localNames)) {\n      const initializerConnections = this.initializerConnections();\n      this.updateDeclarationInputs_(renamedLocalNames, initializerConnections);\n      // Update the mutator's variables if the mutator is open.\n      if (this.mutator && this.mutator.isVisible()) {\n        const blocks = this.mutator.workspace_.getAllBlocks();\n        for (let x = 0, block; block = blocks[x]; x++) {\n          if (block.type == 'procedures_mutatorarg') {\n            const oldName = block.getFieldValue('NAME');\n            const newName = substitution.apply(oldName);\n            if (newName !== oldName) {\n              block.setFieldValue(newName, 'NAME');\n            }\n          }\n        }\n      }\n    }\n  },\n  renameBound: function(boundSubstitution, freeSubstitution) {\n    const oldMutation = core_browser.Xml.domToText(this.mutationToDom());\n    const localNames = this.declaredNames();\n    for (let i = 0; i < localNames.length; i++) {\n      // This is LET semantics, not LET* semantics, and needs to change!\n      LexicalVariable.renameFree(this.getInputTargetBlock('DECL' + i),\n          freeSubstitution);\n    }\n    const paramSubstitution = boundSubstitution.restrictDomain(localNames);\n    this.renameVars(paramSubstitution);\n    const newFreeSubstitution = freeSubstitution.remove(localNames)\n        .extend(paramSubstitution);\n    LexicalVariable.renameFree(\n        this.getInputTargetBlock(this.bodyInputName), newFreeSubstitution);\n    const newMutation = core_browser.Xml.domToText(this.mutationToDom());\n    if (core_browser.Events.isEnabled()) {\n      core_browser.Events.fire(\n          new core_browser.Events.BlockChange(this, 'mutation', null, oldMutation,\n              newMutation));\n    }\n    if (this.nextConnection) {\n      const nextBlock = this.nextConnection.targetBlock();\n      LexicalVariable.renameFree(nextBlock, freeSubstitution);\n    }\n  },\n  renameFree: function(freeSubstitution) {\n    // This is LET semantics, not LET* semantics, and needs to change!\n    const localNames = this.declaredNames();\n    const localNameSet = new nameSet_NameSet(localNames);\n    const bodyFreeVars = LexicalVariable.freeVariables(\n        this.getInputTargetBlock(this.bodyInputName));\n    bodyFreeVars.subtract(localNameSet);\n    const renamedFreeVars = bodyFreeVars.renamed(freeSubstitution);\n    const capturedVars = renamedFreeVars.intersection(localNameSet);\n    if (!capturedVars.isEmpty()) { // Case where some names are captured!\n      // Must consistently rename declarations and uses of capturedFreeVars\n      // with\n      // names that do not conflict with renamedFreeVars, localNames, or each\n      // other.\n      const forbiddenNames = localNameSet.union(renamedFreeVars).toList();\n      const boundBindings = {};\n      const capturedVarList = capturedVars.toList();\n      for (let i = 0, capturedVar; capturedVar = capturedVarList[i]; i++) {\n        const newCapturedVar = FieldLexicalVariable.nameNotIn(\n            capturedVar,\n            forbiddenNames);\n        boundBindings[capturedVar] = newCapturedVar;\n        forbiddenNames.push(newCapturedVar);\n      }\n      this.renameBound(new Substitution(boundBindings),\n          freeSubstitution);\n    } else {\n      this.renameBound(new Substitution(), freeSubstitution);\n    }\n  },\n  freeVariables: function() { // return the free lexical variables of this block\n    const result = LexicalVariable.freeVariables(\n        this.getInputTargetBlock(this.bodyInputName));\n    const localNames = this.declaredNames();\n    result.subtract(new nameSet_NameSet(localNames)); // This is LET semantics,\n    // not LET* semantics,\n    // but should be changed!\n    const numDecls = localNames.length;\n    for (let i = 0; i < numDecls; i++) {\n      result.unite(LexicalVariable.freeVariables(\n          this.getInputTargetBlock('DECL' + i)));\n    }\n    if (this.nextConnection) {\n      const nextBlock = this.nextConnection.targetBlock();\n      result.unite(LexicalVariable.freeVariables(nextBlock));\n    }\n    return result;\n  },\n};\n\n\n/**\n * Prototype bindings for an expression block that declares local names for use\n * in an expression body.\n * [lyn, 10/13/13] Refactored to share more code with\n * Blockly.Blocks.local_declaration_statement.\n */\ncore_browser.Blocks['local_declaration_expression'] = {\n  category: 'Variables', // *** [lyn, 11/07/12] Abstract over this\n  helpUrl: core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_HELPURL,\n  initLocals: core_browser.Blocks.local_declaration_statement.initLocals,\n  bodyInputName: 'RETURN',\n  init: function() {\n    this.setStyle('variables_blocks');\n    this.initLocals();\n    this.appendInputFromRegistry('indented_input', 'RETURN')\n        .appendField(\n            core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN);\n    // Create plug for expression output\n    this.setOutput(true, null);\n    this.setTooltip(\n        core_browser.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP);\n  },\n  referenceResults: function(name, prefix, env) {\n    // Collect locally declared names ...\n    const localDeclNames = [];\n    for (let i = 0; this.getInput('DECL' + i); i++) {\n      let localName = this.getFieldValue('VAR' + i);\n      // Invariant: Shared.showPrefixToUser must also be true!\n      if (usePrefixInCode) {\n        localName = (possiblyPrefixMenuNameWith(localNamePrefix))(\n            localName);\n      }\n      localDeclNames.push(localName);\n    }\n    const newEnv = env.concat(localDeclNames); // ... and add to environment\n    // Collect locally initialization expressions:\n    const localInits = [];\n    for (let i = 0; this.getInput('DECL' + i); i++) {\n      const init = this.getInputTargetBlock('DECL' + i);\n      if (init) {\n        localInits.push(init);\n      }\n    }\n    const initResults = localInits.map(function(init) {\n      return LexicalVariable.referenceResult(init, name, prefix, env);\n    });\n    const returnResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('RETURN'), name, prefix, newEnv);\n    return initResults.concat([returnResults]);\n  },\n  withLexicalVarsAndPrefix:\n    core_browser.Blocks.local_declaration_statement.withLexicalVarsAndPrefix,\n  onchange: core_browser.Blocks.local_declaration_statement.onchange,\n  mutationToDom: core_browser.Blocks.local_declaration_statement.mutationToDom,\n  domToMutation: core_browser.Blocks.local_declaration_statement.domToMutation,\n  updateDeclarationInputs_:\n    core_browser.Blocks.local_declaration_statement.updateDeclarationInputs_,\n  parameterFlydown: core_browser.Blocks.local_declaration_statement.parameterFlydown,\n  blocksInScope: core_browser.Blocks.local_declaration_statement.blocksInScope,\n  decompose: core_browser.Blocks.local_declaration_statement.decompose,\n  compose: core_browser.Blocks.local_declaration_statement.compose,\n  saveConnections: core_browser.Blocks.local_declaration_statement.saveConnections,\n  getVars: core_browser.Blocks.local_declaration_statement.getVars,\n  declaredNames: core_browser.Blocks.local_declaration_statement.declaredNames,\n  declaredVariables:\n      core_browser.Blocks.local_declaration_statement.declaredVariables,\n  renameVar: core_browser.Blocks.local_declaration_statement.renameVar,\n  renameVars: core_browser.Blocks.local_declaration_statement.renameVars,\n  renameBound: core_browser.Blocks.local_declaration_statement.renameBound,\n  renameFree: core_browser.Blocks.local_declaration_statement.renameFree,\n  freeVariables: core_browser.Blocks.local_declaration_statement.freeVariables,\n};\n\ncore_browser.Blocks['local_mutatorcontainer'] = {\n  // Local variable container (for mutator dialog).\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.VARIABLE_CATEGORY_HUE);\n    this.setStyle('variable_blocks');\n    this.appendDummyInput()\n        .appendField(\n            core_browser.Msg\n                .LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES);\n    this.appendStatementInput('STACK');\n    this.setTooltip(core_browser.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP);\n    this.contextMenu = false;\n    this.mustNotRenameCapturables = true;\n  },\n  // [lyn. 11/24/12] Set procBlock associated with this container.\n  setDefBlock: function(defBlock) {\n    this.defBlock_ = defBlock;\n  },\n  // [lyn. 11/24/12] Set procBlock associated with this container.\n  // Invariant: should not be null, since only created as mutator for a\n  // particular proc block.\n  getDefBlock: function() {\n    return this.defBlock_;\n  },\n  // [lyn. 11/24/12] Return list of param names in this container\n  // Invariant: there should be no duplicates!\n  declaredNames: function() {\n    const paramNames = [];\n    let paramBlock = this.getInputTargetBlock('STACK');\n    while (paramBlock) {\n      paramNames.push(paramBlock.getFieldValue('NAME'));\n      paramBlock = paramBlock.nextConnection &&\n          paramBlock.nextConnection.targetBlock();\n    }\n    return paramNames;\n  },\n};\n\ncore_browser.Blocks['local_mutatorarg'] = {\n  // Procedure argument (for mutator dialog).\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.VARIABLE_CATEGORY_HUE);\n    this.setStyle('variable_blocks');\n    this.appendDummyInput()\n        .appendField(core_browser.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME)\n        .appendField(new core_browser.FieldTextInput(\n            core_browser.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE,\n            LexicalVariable.renameParam),\n        'NAME');\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip('');\n    this.contextMenu = false;\n    this.lexicalVarPrefix = localNamePrefix;\n    this.mustNotRenameCapturables = true;\n  },\n  getContainerBlock: function() {\n    let parent = this.getParent();\n    while (parent && !(parent.type === 'local_mutatorcontainer')) {\n      parent = parent.getParent();\n    }\n    // [lyn, 11/24/12] Cache most recent container block so can reference it\n    // upon removal from mutator arg stack\n    this.cachedContainerBlock_ =\n        (parent && (parent.type === 'local_mutatorcontainer') && parent) ||\n        null;\n    return this.cachedContainerBlock_;\n  },\n  getDefBlock: function() {\n    const container = this.getContainerBlock();\n    return (container && container.getDefBlock()) || null;\n  },\n  blocksInScope: function() {\n    const defBlock = this.getDefBlock();\n    return (defBlock && defBlock.blocksInScope()) || [];\n  },\n  declaredNames: function() {\n    const container = this.getContainerBlock();\n    return (container && container.declaredNames()) || [];\n  },\n\n  // [lyn, 11/24/12] Check for situation in which mutator arg has been removed\n  // from stack,\n  onchange: function() {\n    const paramName = this.getFieldValue('NAME');\n    if (paramName) { // paramName is null when delete from stack\n      // console.log(\"Mutatorarg onchange: \" + paramName);\n      const cachedContainer = this.cachedContainerBlock_;\n      const container = this.getContainerBlock(); // Order is important; this\n      // must come after\n      // cachedContainer since it\n      // sets cachedContainerBlock_\n      // console.log(\"Mutatorarg onchange: \" + paramName\n      //            + \"; cachedContainer = \" + JSON.stringify((cachedContainer\n      // && cachedContainer.type) || null) + \"; container = \" +\n      // JSON.stringify((container && container.type) || null));\n      if ((!cachedContainer) && container) {\n        // Event: added mutator arg to container stack\n        // console.log(\"Mutatorarg onchange ADDED: \" + paramName);\n        const declaredNames = this.declaredNames();\n        const firstIndex = declaredNames.indexOf(paramName);\n        if (firstIndex != -1) {\n          // Assertion: we should get here, since paramName should be among\n          // names\n          const secondIndex = declaredNames.indexOf(paramName, firstIndex + 1);\n          if (secondIndex != -1) {\n            // If we get here, there is a duplicate on insertion that must be\n            // resolved\n            const newName = FieldLexicalVariable.nameNotIn(paramName,\n                declaredNames);\n            this.setFieldValue(newName, 'NAME');\n          }\n        }\n      }\n    }\n  },\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/blocks/controls.js\n/**\n * @fileoverview Control blocks for Blockly, modified for App Inventor.\n * @author fraser@google.com (Neil Fraser)\n * @author andrew.f.mckinney@gmail.com (Andrew F. McKinney)\n * Due to the frequency of long strings, the 80-column wrap rule need not apply\n * to language files.\n */\n\n/**\n * Lyn's History:\n * [lyn, written 11/16-17/13, added 07/01/14] Added freeVariables, renameFree,\n * and renameBound to forRange and forEach loops\n * [lyn, 10/27/13] Specify direction of flydowns\n * [lyn, 10/25/13] Made collapsed block labels more sensible.\n * [lyn, 10/10-14/13]\n *   + Installed flydown index variable declarations in forRange and forEach\n * loops\n *   + Abstracted over string labels on all blocks using constants defined in\n * en/_messages.js\n *   + Renamed \"for <i> start [] end [] step []\" block to \"for each <number>\n * from [] to [] by []\"\n *   + Renamed \"for each <i> in list []\" block to \"for each <item> in list []\"\n *   + Renamed \"choose test [] then-return [] else-return []\" to \"if [] then []\n * else []\"\n *     (TODO: still needs to have a mutator like  the \"if\" statement blocks).\n *   + Renamed \"evaluate\" block to \"evaluate but ignore result\"\n *   + Renamed \"do {} then-return []\" block to \"do {} result []\" and re-added\n * this block to the Control drawer (who removed it?)\n *   + Removed get block (still in Variable drawer; no longer needed with\n * parameter flydowns)\n * [lyn, 11/29-30/12]\n *   + Change forEach and forRange loops to take name as input text rather than\n * via plug.\n *   + For these blocks, add extra methods to support renaming.\n */\n\n\n\n\n\n\n\n\n\n\n\n\ncore_browser.Blocks['controls_forRange'] = {\n  // For range.\n  category: 'Control',\n  helpUrl: core_browser.Msg.LANG_CONTROLS_FORRANGE_HELPURL,\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.CONTROL_CATEGORY_HUE);\n    this.setStyle('loop_blocks');\n    // this.setOutput(true, null);\n    // Need to deal with variables here\n    // [lyn, 11/30/12] Changed variable to be text input box that does renaming\n    // right (i.e., avoids variable capture)\n    this.appendValueInput('START')\n        .setCheck(yailTypeToBlocklyType('number',\n            INPUT))\n        .appendField(core_browser.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM)\n        .appendField(new FieldParameterFlydown(\n            core_browser.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR, true,\n            FieldFlydown.DISPLAY_BELOW), 'VAR')\n        .appendField(core_browser.Msg.LANG_CONTROLS_FORRANGE_INPUT_START)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n    this.appendValueInput('END')\n        .setCheck(yailTypeToBlocklyType('number',\n            INPUT))\n        .appendField(core_browser.Msg.LANG_CONTROLS_FORRANGE_INPUT_END)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n    this.appendValueInput('STEP')\n        .setCheck(yailTypeToBlocklyType('number',\n            INPUT))\n        .appendField(core_browser.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n    this.appendStatementInput('DO')\n        .appendField(core_browser.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(core_browser.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP);\n    this.lexicalVarPrefix = loopRangeParameterPrefix;\n  },\n  referenceResults: function(name, prefix, env) {\n    let loopVar = this.getFieldValue('VAR');\n    // Invariant: Shared.showPrefixToUser must also be true!\n    if (usePrefixInCode) {\n      loopVar =\n          (possiblyPrefixMenuNameWith(loopRangeParameterPrefix))(\n              loopVar);\n    }\n    const newEnv = env.concat([loopVar]);\n    const startResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('START'), name, prefix, env);\n    const endResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('END'), name, prefix, env);\n    const stepResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('STEP'), name, prefix, env);\n    const doResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('DO'), name, prefix, newEnv);\n    const nextResults = LexicalVariable.referenceResult(\n        LexicalVariable.getNextTargetBlock(this), name, prefix, env);\n    return [startResults, endResults, stepResults, doResults, nextResults];\n  },\n  withLexicalVarsAndPrefix: function(child, proc) {\n    if (this.getInputTargetBlock('DO') == child) {\n      const lexVar = this.getFieldValue('VAR');\n      proc(lexVar, this.lexicalVarPrefix);\n    }\n  },\n  getVars: function() {\n    return [this.getFieldValue('VAR')];\n  },\n  blocksInScope: function() {\n    const doBlock = this.getInputTargetBlock('DO');\n    if (doBlock) {\n      return [doBlock];\n    } else {\n      return [];\n    }\n  },\n  declaredNames: function() {\n    return [this.getFieldValue('VAR')];\n  },\n  renameVar: function(oldName, newName) {\n    if (core_browser.Names.equals(oldName, this.getFieldValue('VAR'))) {\n      this.setFieldValue(newName, 'VAR');\n    }\n  },\n  renameBound: function(boundSubstitution, freeSubstitution) {\n    LexicalVariable.renameFree(this.getInputTargetBlock('START'),\n        freeSubstitution);\n    LexicalVariable.renameFree(this.getInputTargetBlock('END'),\n        freeSubstitution);\n    LexicalVariable.renameFree(this.getInputTargetBlock('STEP'),\n        freeSubstitution);\n    const oldIndexVar = this.getFieldValue('VAR');\n    const newIndexVar = boundSubstitution.apply(oldIndexVar);\n    if (newIndexVar !== oldIndexVar) {\n      this.renameVar(oldIndexVar, newIndexVar);\n      const indexSubstitution = Substitution.simpleSubstitution(\n          oldIndexVar, newIndexVar);\n      const extendedFreeSubstitution = freeSubstitution.extend(\n          indexSubstitution);\n      LexicalVariable.renameFree(this.getInputTargetBlock('DO'),\n          extendedFreeSubstitution);\n    } else {\n      const removedFreeSubstitution = freeSubstitution.remove([oldIndexVar]);\n      LexicalVariable.renameFree(this.getInputTargetBlock('DO'),\n          removedFreeSubstitution);\n    }\n    if (this.nextConnection) {\n      const nextBlock = this.nextConnection.targetBlock();\n      LexicalVariable.renameFree(nextBlock, freeSubstitution);\n    }\n  },\n  renameFree: function(freeSubstitution) {\n    const indexVar = this.getFieldValue('VAR');\n    const bodyFreeVars = LexicalVariable.freeVariables(\n        this.getInputTargetBlock('DO'));\n    bodyFreeVars.deleteName(indexVar);\n    const renamedBodyFreeVars = bodyFreeVars.renamed(freeSubstitution);\n    if (renamedBodyFreeVars.isMember(indexVar)) { // Variable capture!\n      const newIndexVar = FieldLexicalVariable.nameNotIn(indexVar,\n          renamedBodyFreeVars.toList());\n      const boundSubstitution = Substitution.simpleSubstitution(\n          indexVar, newIndexVar);\n      this.renameBound(boundSubstitution, freeSubstitution);\n    } else {\n      this.renameBound(new Substitution(), freeSubstitution);\n    }\n  },\n  freeVariables: function() { // return the free variables of this block\n    const result = LexicalVariable.freeVariables(\n        this.getInputTargetBlock('DO'));\n    // Remove bound index variable from body free vars\n    result.deleteName(this.getFieldValue('VAR'));\n    result.unite(LexicalVariable.freeVariables(\n        this.getInputTargetBlock('START')));\n    result.unite(\n        LexicalVariable.freeVariables(this.getInputTargetBlock('END')));\n    result.unite(LexicalVariable.freeVariables(\n        this.getInputTargetBlock('STEP')));\n    if (this.nextConnection) {\n      const nextBlock = this.nextConnection.targetBlock();\n      result.unite(LexicalVariable.freeVariables(nextBlock));\n    }\n    return result;\n  },\n};\n\n// Alias controls_for to controls_forRange We need this because\n// we can't use controls_flow_statements within controls_forRange\n// due to Blockly checking\ndelete core_browser.Blocks['controls_for'];\ncore_browser.Blocks['controls_for'] = core_browser.Blocks['controls_forRange'];\n\ncore_browser.Blocks['controls_forEach'] = {\n  // For each loop.\n  category: 'Control',\n  helpUrl: core_browser.Msg.LANG_CONTROLS_FOREACH_HELPURL,\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.CONTROL_CATEGORY_HUE);\n    this.setStyle('loop_blocks');\n    // this.setOutput(true, null);\n    // [lyn, 10/07/13] Changed default name from \"i\" to \"item\"\n    // [lyn, 11/29/12] Changed variable to be text input box that does renaming\n    // right (i.e., avoids variable capture)\n    this.appendValueInput('LIST')\n        .setCheck(yailTypeToBlocklyType('list',\n            INPUT))\n        .appendField(core_browser.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM)\n        .appendField(new FieldParameterFlydown(\n            core_browser.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR,\n            true, FieldFlydown.DISPLAY_BELOW), 'VAR')\n        .appendField(core_browser.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n    this.appendStatementInput('DO')\n        .appendField(core_browser.Msg.LANG_CONTROLS_FOREACH_INPUT_DO);\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(core_browser.Msg.LANG_CONTROLS_FOREACH_TOOLTIP);\n    this.lexicalVarPrefix = loopParameterPrefix;\n  },\n  referenceResults: function(name, prefix, env) {\n    let loopVar = this.getFieldValue('VAR');\n    // Invariant: Shared.showPrefixToUser must also be true!\n    if (usePrefixInCode) {\n      loopVar = (possiblyPrefixMenuNameWith(loopParameterPrefix))(\n          loopVar);\n    }\n    const newEnv = env.concat([loopVar]);\n    const listResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('LIST'), name, prefix, env);\n    const doResults = LexicalVariable.referenceResult(\n        this.getInputTargetBlock('DO'), name, prefix, newEnv);\n    const nextResults = LexicalVariable.referenceResult(\n        LexicalVariable.getNextTargetBlock(this), name, prefix, env);\n    return [listResults, doResults, nextResults];\n  },\n  withLexicalVarsAndPrefix:\n    core_browser.Blocks.controls_forRange.withLexicalVarsAndPrefix,\n  getVars: function() {\n    return [this.getFieldValue('VAR')];\n  },\n  blocksInScope: function() {\n    const doBlock = this.getInputTargetBlock('DO');\n    if (doBlock) {\n      return [doBlock];\n    } else {\n      return [];\n    }\n  },\n  declaredNames: function() {\n    return [this.getFieldValue('VAR')];\n  },\n  renameVar: function(oldName, newName) {\n    if (core_browser.Names.equals(oldName, this.getFieldValue('VAR'))) {\n      this.setFieldValue(newName, 'VAR');\n    }\n  },\n  renameBound: function(boundSubstitution, freeSubstitution) {\n    LexicalVariable.renameFree(this.getInputTargetBlock('LIST'),\n        freeSubstitution);\n    const oldIndexVar = this.getFieldValue('VAR');\n    const newIndexVar = boundSubstitution.apply(oldIndexVar);\n    if (newIndexVar !== oldIndexVar) {\n      this.renameVar(oldIndexVar, newIndexVar);\n      const indexSubstitution = Substitution.simpleSubstitution(\n          oldIndexVar, newIndexVar);\n      const extendedFreeSubstitution = freeSubstitution.extend(\n          indexSubstitution);\n      LexicalVariable.renameFree(this.getInputTargetBlock('DO'),\n          extendedFreeSubstitution);\n    } else {\n      const removedFreeSubstitution = freeSubstitution.remove([oldIndexVar]);\n      LexicalVariable.renameFree(this.getInputTargetBlock('DO'),\n          removedFreeSubstitution);\n    }\n    if (this.nextConnection) {\n      const nextBlock = this.nextConnection.targetBlock();\n      LexicalVariable.renameFree(nextBlock, freeSubstitution);\n    }\n  },\n  renameFree: function(freeSubstitution) {\n    const indexVar = this.getFieldValue('VAR');\n    const bodyFreeVars = LexicalVariable.freeVariables(\n        this.getInputTargetBlock('DO'));\n    bodyFreeVars.deleteName(indexVar);\n    const renamedBodyFreeVars = bodyFreeVars.renamed(freeSubstitution);\n    if (renamedBodyFreeVars.isMember(indexVar)) { // Variable capture!\n      const newIndexVar = FieldLexicalVariable.nameNotIn(indexVar,\n          renamedBodyFreeVars.toList());\n      const boundSubstitution = Substitution.simpleSubstitution(\n          indexVar, newIndexVar);\n      this.renameBound(boundSubstitution, freeSubstitution);\n    } else {\n      this.renameBound(new Substitution(), freeSubstitution);\n    }\n  },\n  freeVariables: function() { // return the free variables of this block\n    const result = LexicalVariable.freeVariables(\n        this.getInputTargetBlock('DO'));\n    // Remove bound index variable from body free vars\n    result.deleteName(this.getFieldValue('VAR'));\n    result.unite(LexicalVariable.freeVariables(\n        this.getInputTargetBlock('LIST')));\n    if (this.nextConnection) {\n      const nextBlock = this.nextConnection.targetBlock();\n      result.unite(LexicalVariable.freeVariables(nextBlock));\n    }\n    return result;\n  },\n};\n\ncore_browser.Blocks['controls_do_then_return'] = {\n  // String length.\n  category: 'Control',\n  helpUrl: core_browser.Msg.LANG_CONTROLS_DO_THEN_RETURN_HELPURL,\n  init: function() {\n    // this.setColour(Blockly.CONTROL_CATEGORY_HUE);\n    this.setStyle('loop_blocks');\n    this.appendStatementInput('STM')\n        .appendField(core_browser.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO);\n    this.appendValueInput('VALUE')\n        .appendField(core_browser.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN)\n        .setAlign(core_browser.inputs.Align.RIGHT);\n    this.setOutput(true, null);\n    this.setTooltip(core_browser.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP);\n  },\n};\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/blocks/procedures.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2013-2014 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n/**\n * @license\n * @fileoverview Procedure blocks for Blockly, modified for MIT App Inventor.\n * @author mckinney@mit.edu (Andrew F. McKinney)\n */\n\n/**\n * Lyn's Change History:\n * [lyn, written 11/16-17/13, added 07/01/14]\n *   + Added freeVariables, renameFree, and renameBound to procedure\n * declarations\n *   + Added renameVars for procedure declarations, which allows renaming\n * multiple parameters simultaneously\n *   + Modified updateParams_ to accept optional params argument\n *   + Introduced bodyInputName field for procedure declarations ('STACK' for\n * procedures_defnoreturn;\n *     'RETURN' for procedures_return), and use this to share more methods\n * between the two kinds of procedure declarations.\n *   + Replaced inlined string list equality tests by new\n * Blockly.LexicalVariable.stringListsEqual\n * [lyn, 10/28/13]\n *   + Fixed a missing change of Blockly.Procedures.rename by zdure\n *   + I was wrong about re-rendering not being needed in updatedParams_!\n *     Without it, changing horizontal -> vertical params doesn't handle body\n * slot correctly. So added it back.\n * [lyn, 10/27/13]\n *   + Fix bug in list of callers in flyout by simplifying domToMutation for\n * procedure callers. This should never look for associated declaration, but\n * just take arguments from given xml.\n *   + Removed render() call from updateParams_. Seems unnecessary. <== I WAS\n * WRONG. SEE 10/28/13 NOTE\n *   + Specify direction of flydowns\n *   + Replaced Blockly.Procedures.rename by\n * Blockly.AIProcedure.renameProcedure in proc decls\n * [lyn, 10/26/13] Modify procedure parameter changeHandler to propagate name\n * changes to caller arg labels and open mutator labels\n * [lyn, 10/25/13]\n *   + Modified procedures_defnoreturn compose method so that it doesn't call\n * updateParams_ if mutator hasn't changed parameter names. This helps avoid a\n * situation where an attempt is made to update params of a collapsed\n * declaration.\n *   + Modified collapsed decls to have 'to ' prefix and collapsed callers to\n * have 'call ' prefix.\n * [lyn, 10/24/13] Allowed switching between horizontal and vertical display of\n * arguments\n * [lyn, 10/23/13] Fixed bug in domToMutation for callers that was giving wrong\n * args to caller blocks.\n * [lyn, 10/10-14/13]\n *   + Installed variable declaration flydowns in both types of procedure\n * declarations.\n *   + Fixed bug: Modified onchange for procedure declarations to keep\n * arguments_ instance variable updated when param is edited directly on\n * declaration block.\n *   + Removed get block (still in Variable drawer; no longer needed with\n * parameter flydowns)\n *   + Removed \"do {} then-return []\" block since (1) it's in Control drawer\n * and\n *     (2) it will be superseded in the context by Michael Phox's\n * proc_defnoreturn mutator that allows adding a DO statement.\n *   + TODO: Abstract over string labels on all blocks using constants defined\n * in en/_messages.js\n *   + TODO: Clean up code, including refactoring to increase sharing between\n *     procedures_defnoreturn and procedures_defreturn.\n * [lyn, 11/29/12] Integrated into App Inventor blocks. Known bugs:\n *   + Reordering mutator_args in mutator_container changes references to ???\n * Because it interprets it as removing and inserting rather than moving.\n * [lyn, 11/24/12] Implemented procedure parameter renaming:\n *   + changing a variable name in mutator_arg for procedure changes it\n * immediately in references in body.\n *   + no duplicate names are allowed in mutator_args; alpha-renaming prevents\n * this.\n *   + no variables can be captured by renaming; alpha-renaming prevents this.\n */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncore_browser.Blocks['procedures_defnoreturn'] = {\n  // Define a procedure with no return value.\n  category: 'Procedures', // Procedures are handled specially.\n  helpUrl: core_browser.Msg['LANG_PROCEDURES_DEFNORETURN_HELPURL'],\n  bodyInputName: 'STACK',\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.PROCEDURE_CATEGORY_HUE);\n    this.setStyle('procedure_blocks');\n    const legalName = core_browser.Procedures.findLegalName(\n        core_browser.Msg['LANG_PROCEDURES_DEFNORETURN_PROCEDURE'], this);\n    this.createHeader(legalName);\n    this.horizontalParameters = true; // horizontal by default\n    this.appendStatementInput('STACK')\n        .appendField(core_browser.Msg['LANG_PROCEDURES_DEFNORETURN_DO']);\n    this.setMutator(new core_browser.icons.MutatorIcon(['procedures_mutatorarg'], this));\n    this.setTooltip(core_browser.Msg['LANG_PROCEDURES_DEFNORETURN_TOOLTIP']);\n    // List of declared local variable names; has one\n    // (\"name\") initially\n    this.arguments_ = [];\n    // Other methods guarantee the invariant that this variable contains\n    // the list of names declared in the local declaration block.\n    this.warnings = [{name: 'checkEmptySockets', sockets: ['STACK']}];\n    this.lexicalVarPrefix = procedureParameterPrefix;\n  },\n  createHeader: function(procName) {\n    return this.appendDummyInput('HEADER')\n        .appendField(core_browser.Msg['LANG_PROCEDURES_DEFNORETURN_DEFINE'])\n        .appendField(new FieldProcedureName(procName), 'NAME');\n  },\n  withLexicalVarsAndPrefix: function(_, proc) {\n    const params = this.declaredNames();\n    // not arguments_ instance var\n    for (let i = 0; i < params.length; i++) {\n      proc(params[i], this.lexicalVarPrefix);\n    }\n  },\n  onchange: function() {\n    // ensure arguments_ is in sync\n    // with paramFlydown fields\n    this.arguments_ = this.declaredNames();\n  },\n  updateParams_: function(opt_params) {\n    // make rendered block reflect the parameter names currently in\n    // this.arguments_\n    // [lyn, 11/17/13] Added optional opt_params argument:\n    //    If its falsey (null or undefined), use the existing this.arguments_\n    // list Otherwise, replace this.arguments_ by opt_params In either case,\n    // make rendered block reflect the parameter names in this.arguments_\n    if (opt_params) {\n      this.arguments_ = opt_params;\n    }\n    // Check for duplicated arguments.\n    // [lyn 10/10/13] Note that in blocks edited within AI2, duplicate\n    // parameter names should never occur because parameters are renamed to\n    // avoid duplication. But duplicates might show up in XML code hand-edited\n    // by user. console.log(\"enter procedures_defnoreturn updateParams_()\");\n    let badArg = false;\n    const hash = {};\n    for (let x = 0; x < this.arguments_.length; x++) {\n      if (hash['arg_' + this.arguments_[x].toLowerCase()]) {\n        badArg = true;\n        break;\n      }\n      hash['arg_' + this.arguments_[x].toLowerCase()] = true;\n    }\n    if (badArg) {\n      this.setWarningText(core_browser.Msg['LANG_PROCEDURES_DEF_DUPLICATE_WARNING']);\n    } else {\n      this.setWarningText(null);\n    }\n\n    const procName = this.getFieldValue('NAME');\n    // save the first two input lines and the last input line\n    // to be re added to the block later\n    // var firstInput = this.inputList[0];\n    // [lyn, 10/24/13] need to reconstruct first input\n\n    // Body of procedure\n    const bodyInput = this.inputList[this.inputList.length - 1];\n\n    // stop rendering until block is recreated\n    const savedRendered = this.rendered;\n    this.rendered = false;\n\n    // remove first input\n    // console.log(\"updateParams_: remove input HEADER\");\n    const thisBlock = this; // Grab correct object for use in thunk below\n    FieldParameterFlydown.withChangeHanderDisabled(\n        // [lyn, 07/02/14] Need to disable change handler, else this will try\n        // to rename params for horizontal arg fields!\n        function() {\n          thisBlock.removeInput('HEADER');\n        },\n    );\n\n    // Remove all existing vertical inputs (we will create new ones if\n    // necessary)\n\n    // Only args and body are left\n    const oldArgCount = this.inputList.length - 1;\n    if (oldArgCount > 0) {\n      const paramInput0 = this.getInput('VAR0');\n      if (paramInput0) { // Yes, they were vertical\n        for (let i = 0; i < oldArgCount; i++) {\n          try {\n            FieldParameterFlydown.withChangeHanderDisabled(\n                // [lyn, 07/02/14] Need to disable change handler, else this\n                // will try to rename params for vertical arg fields!\n                function() {\n                  thisBlock.removeInput('VAR' + i);\n                },\n            );\n          } catch (err) {\n            console.log(err);\n          }\n        }\n      }\n    }\n\n    // empty the inputList then recreate it\n    this.inputList = [];\n\n    // console.log(\"updateParams_: create input HEADER\");\n    const headerInput = this.createHeader(procName);\n    // const headerInput =\n    //     this.appendDummyInput('HEADER')\n    //         .appendField(Blockly.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE)\n    //         .appendField(new FieldProcedureName(procName), 'NAME');\n\n    // add an input title for each argument\n    // name each input after the block and where it appears in the block to\n    // reference it later\n    if (this.horizontalParameters) { // horizontal case\n      for (let i = 0; i < this.arguments_.length; i++) {\n        // [lyn, 10/10/13] Changed to param flydown\n        // Tag with param tag to make it easy to find later.\n        headerInput.appendField(' ')\n            .appendField(this.parameterFlydown(i), 'VAR' + i);\n      }\n    } else { // vertical case\n      for (let i = 0; i < this.arguments_.length; i++) {\n        this.appendDummyInput('VAR' + i)\n            .appendField(this.parameterFlydown(i), 'VAR' + i)\n            .setAlign(core_browser.inputs.Align.RIGHT);\n      }\n    }\n\n    // put the last two arguments back\n    this.inputList = this.inputList.concat(bodyInput);\n\n    this.rendered = savedRendered;\n    // [lyn, 10/28/13] I thought this rerendering was unnecessary. But I was\n    // wrong! Without it, get bug noticed by Andrew in which toggling\n    // horizontal -> vertical params in procedure decl doesn't handle body tag\n    // appropriately!\n    for (let i = 0; i < this.inputList.length; i++) {\n      this.inputList[i].init();\n    }\n    if (this.rendered) {\n      this.render();\n    }\n    // set in BlocklyPanel.java on successful load\n    if (this.workspace.loadCompleted) {\n      core_browser.Procedures.mutateCallers(this);\n    }\n    // console.log(\"exit procedures_defnoreturn updateParams_()\");\n  },\n  // [lyn, 10/26/13] Introduced this to correctly handle renaming of [(1)\n  // caller arg labels and (2) mutatorarg in open mutator] when procedure\n  // parameter flydown name is edited.\n\n  // Return a new procedure parameter flydown\n  parameterFlydown: function(paramIndex) {\n    const initialParamName = this.arguments_[paramIndex];\n    // Here, \"this\" is the proc decl block. Name it to\n    // use in function below\n    const procDecl = this;\n    const procedureParameterChangeHandler = function(newParamName) {\n      // console.log(\"enter procedureParameterChangeHandler\");\n\n\n      // Extra work that needs to be done when procedure param name is changed,\n      // in addition to renaming lexical variables: 1. Change all callers so\n      // label reflects new name 2. If there's an open mutator, change the\n      // corresponding slot. Note: this handler is invoked as method on field,\n      // so within the handler body, \"this\" will be bound to that field and\n      // *not* the procedure declaration object!\n\n      // Subtlety #1: within this changeHandler, procDecl.arguments_ has *not*\n      // yet been updated to include newParamName. This only happens later. But\n      // since we know newParamName *and* paramIndex, we know how to update\n      // procDecl.arguments_ ourselves!\n\n      // Subtlety #2: I would have thought we would want to create local copy\n      // of\n      // procedure arguments_ list rather than mutate that list, but I'd be\n      // wrong! Turns out that *not* mutating list here causes trouble below in\n      // the line\n      // Blockly.Field.prototype.setText.call(mutatorarg.getTitle_(\"NAME\"),\n      // newParamName);  The reason is that this fires a change event in\n      // mutator workspace, which causes a call to the proc decl compose()\n      // method, and when it detects a difference in the arguments it calls\n      // proc decl updateParams_. This removes proc decl inputs before adding\n      // them back, and all hell breaks loose when the procedure name field and\n      // previous parameter flydown fields are disposed before an attempt is\n      // made to disposed this field. At this point, the SVG element associated\n      // with the procedure name is gone but the field is still in the title\n      // list. Attempting to dispose this field attempts to hide the open HTML\n      // editor widget, which attempts to re-render the procedure declaration\n      // block. But the null SVG for the procedure name field raises an\n      // exception.  It turns out that by mutating proc decl arguments_, when\n      // compose() is called, updateParams_() is *not* called, and this\n      // prevents the above scenario. So rather than doing  var newArguments =\n      // [].concat(procDecl.arguments_)  we instead do:\n      const newArguments = procDecl.arguments_;\n      newArguments[paramIndex] = newParamName;\n\n      // 1. Change all callers so label reflects new name\n      core_browser.Procedures.mutateCallers(procDecl);\n\n      // 2. If there's an open mutator, change the name in the corresponding\n      // slot.\n      if (procDecl.mutator && procDecl.mutator.rootBlock_) {\n        // Iterate through mutatorarg param blocks and change name of one at\n        // paramIndex\n        const mutatorContainer = procDecl.mutator.rootBlock_;\n        let mutatorargIndex = 0;\n        let mutatorarg = mutatorContainer.getInputTargetBlock('STACK');\n        while (mutatorarg && mutatorargIndex < paramIndex) {\n          mutatorarg = mutatorarg.nextConnection &&\n              mutatorarg.nextConnection.targetBlock();\n          mutatorargIndex++;\n        }\n        if (mutatorarg && mutatorargIndex == paramIndex) {\n          // Subtlety #3: If call mutatorargs's setValue, its change handler\n          // will be invoked several times, and on one of those times, it will\n          // find new param name in the procedures arguments_ instance variable\n          // and will try to renumber it (e.g. \"a\" -> \"a2\"). To avoid this,\n          // invoke the setText method of its Field s superclass directly.\n          // I.e., can't do this:\n          // mutatorarg.getTitle_(\"NAME\").setValue(newParamName); so instead do\n          // this:\n          mutatorarg.getField('NAME').setValue(newParamName);\n          // mutatorarg.getField(\"NAME\").doValueUpdate_(newParamName);\n          //   Blockly.Field.prototype.setText.call(mutatorarg.getField(\"NAME\"),\n          // newParamName);\n        }\n      }\n      // console.log(\"exit procedureParameterChangeHandler\");\n    };\n    return new FieldParameterFlydown(initialParamName,\n        true, // name is editable\n        // [lyn, 10/27/13] flydown location depends on parameter orientation\n        this.horizontalParameters ? FieldFlydown.DISPLAY_BELOW :\n            FieldFlydown.DISPLAY_RIGHT,\n        procedureParameterChangeHandler);\n  },\n  setParameterOrientation: function(isHorizontal) {\n    const params = this.getParameters();\n    if (params.length != 0 && isHorizontal !== this.horizontalParameters) {\n      this.horizontalParameters = isHorizontal;\n      this.updateParams_();\n      if (core_browser.Events.isEnabled()) {\n        // Trigger a Blockly UI change event\n        core_browser.Events.fire(new core_browser.Events.Ui(this, 'parameter_orientation',\n            (!this.horizontalParameters).toString(),\n            this.horizontalParameters.toString()));\n      }\n    }\n  },\n  mutationToDom: function() {\n    const container = core_browser.utils.xml.createElement('mutation');\n    if (!this.horizontalParameters) {\n      container.setAttribute('vertical_parameters', 'true'); // Only store an\n      // element for\n      // vertical\n      // The absence of this attribute means horizontal.\n    }\n    for (let x = 0; x < this.arguments_.length; x++) {\n      const parameter = core_browser.utils.xml.createElement('arg');\n      parameter.setAttribute('name', this.arguments_[x]);\n      container.appendChild(parameter);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    const params = [];\n    const children = getChildren(xmlElement);\n    for (let x = 0, childNode; childNode = children[x]; x++) {\n      if (childNode.nodeName.toLowerCase() == 'arg') {\n        params.push(childNode.getAttribute('name'));\n      }\n    }\n    this.horizontalParameters =\n        xmlElement.getAttribute('vertical_parameters') !== 'true';\n    this.updateParams_(params);\n  },\n  decompose: function(workspace) {\n    const containerBlock = workspace.newBlock('procedures_mutatorcontainer');\n    containerBlock.initSvg();\n    // [lyn, 11/24/12] Remember the associated procedure, so can\n    // appropriately change body when update name in param block.\n    containerBlock.setProcBlock(this);\n    this.paramIds_ = []; // [lyn, 10/26/13] Added\n    let connection = containerBlock.getInput('STACK').connection;\n    for (let x = 0; x < this.arguments_.length; x++) {\n      const paramBlock = workspace.newBlock('procedures_mutatorarg');\n      this.paramIds_.push(paramBlock.id); // [lyn, 10/26/13] Added\n      paramBlock.initSvg();\n      paramBlock.setFieldValue(this.arguments_[x], 'NAME');\n      // Store the old location.\n      paramBlock.oldLocation = x;\n      connection.connect(paramBlock.previousConnection);\n      connection = paramBlock.nextConnection;\n    }\n    // [lyn, 10/26/13] Rather than passing null for paramIds, pass actual\n    // paramIds and use true flag to initialize tracking.\n    core_browser.Procedures.mutateCallers(this);\n    return containerBlock;\n  },\n  compose: function(containerBlock) {\n    const params = [];\n    this.paramIds_ = [];\n    let paramBlock = containerBlock.getInputTargetBlock('STACK');\n    while (paramBlock) {\n      params.push(paramBlock.getFieldValue('NAME'));\n      this.paramIds_.push(paramBlock.id);\n      paramBlock = paramBlock.nextConnection &&\n          paramBlock.nextConnection.targetBlock();\n    }\n    // console.log(\"enter procedures_defnoreturn compose(); prevArguments = \"\n    //    + prevArguments.join(',')\n    //    + \"; currentAguments = \"\n    //    + this.arguments_.join(',')\n    //    + \";\"\n    // );\n    // [lyn, 11/24/12] Note: update params updates param list in proc\n    // declaration, but renameParam updates procedure body appropriately.\n    if (!LexicalVariable.stringListsEqual(params, this.arguments_)) {\n      // Only need updates if param list has changed\n      this.updateParams_(params);\n      core_browser.Procedures.mutateCallers(this);\n    }\n    // console.log(\"exit procedures_defnoreturn compose()\");\n  },\n  dispose: function(...args) {\n    const name = this.getFieldValue('NAME');\n    const editable = this.editable_;\n    const workspace = this.workspace;\n\n    // This needs to happen first so that the Blockly events will be replayed\n    // in the correct order on undo\n    if (editable) {\n      // Dispose of any callers.\n      // Blockly.Procedures.disposeCallers(name, workspace);\n      removeProcedureValues(name, workspace);\n    }\n\n    // Call parent's destructor.\n    Object.getPrototypeOf(this).dispose.apply(this, args)\n\n    const procDb = workspace.getProcedureDatabase();\n    if (editable && procDb) {\n      // only true for the top-level workspaces, not flyouts/flydowns\n      procDb.removeProcedure(this.id);\n    }\n  },\n  getProcedureDef: function() {\n    // Return the name of the defined procedure,\n    // a list of all its arguments,\n    // and that it DOES NOT have a return value.\n    return [\n      this.getFieldValue('NAME'),\n      this.arguments_,\n      this.bodyInputName === 'RETURN',\n    ]; // true for procedures that return values.\n  },\n  getVars: function() {\n    const names = [];\n    for (let i = 0, param; param = this.getFieldValue('VAR' + i); i++) {\n      names.push(param);\n    }\n    return names;\n  },\n  declaredNames: function() {\n    // [lyn, 10/11/13] return the names of all parameters of this procedure\n    return this.getVars();\n  },\n  declaredVariables: function() {\n    return this.getVars();\n  },\n  renameVar: function(oldName, newName) {\n    this.renameVars(Substitution.simpleSubstitution(oldName, newName));\n  },\n  renameVars: function(substitution) {\n    // renaming is a dict (i.e., object) mapping old names to new ones\n    const oldParams = this.getParameters();\n    const newParams = substitution.map(oldParams);\n    if (!LexicalVariable.stringListsEqual(oldParams, newParams)) {\n      this.updateParams_(newParams);\n      // Update the mutator's variables if the mutator is open.\n      if (this.mutator.isVisible()) {\n        const blocks = this.mutator.workspace_.getAllBlocks();\n        for (let x = 0, block; block = blocks[x]; x++) {\n          if (block.type == 'procedures_mutatorarg') {\n            const oldName = block.getFieldValue('NAME');\n            const newName = substitution.apply(oldName);\n            if (newName !== oldName) {\n              block.setFieldValue(newName, 'NAME');\n            }\n          }\n        }\n      }\n    }\n  },\n  renameBound: function(boundSubstitution, freeSubstitution) {\n    const paramSubstitution = boundSubstitution.restrictDomain(\n        this.declaredNames());\n    this.renameVars(paramSubstitution);\n    const newFreeSubstitution = freeSubstitution.extend(paramSubstitution);\n    LexicalVariable.renameFree(\n        this.getInputTargetBlock(this.bodyInputName), newFreeSubstitution);\n  },\n  renameFree: function(freeSubstitution) {\n    // Should have no effect since only top-level procedures.\n    // Calculate free variables, which\n    // should be empty,\n    // throwing exception if not.\n    // There should be no free variables, and so nothing to rename. Do nothing\n    // else.\n    this.freeVariables();\n  },\n  freeVariables: function() { // return the free lexical variables of this block\n    // Should return the empty set: something is wrong if it doesn't!\n    const result = LexicalVariable.freeVariables(\n        this.getInputTargetBlock(this.bodyInputName));\n    result.subtract(new NameSet(this.declaredNames()));\n    if (result.isEmpty()) {\n      return result;\n    } else {\n      throw Error(\n          'Violation of invariant: procedure declaration has nonempty free' +\n          ' variables: ' +\n          result.toString());\n    }\n  },\n  // [lyn, 11/24/12] return list of procedure body (if there is one)\n  blocksInScope: function() {\n    const body = this.getInputTargetBlock(this.bodyInputName);\n    return (body && [body]) || [];\n  },\n  customContextMenu: function(options) {\n    FieldParameterFlydown.addHorizontalVerticalOption(this, options);\n    // Blockly.BlocklyEditor.addPngExportOption(this, options);\n  },\n  getParameters: function() {\n    return this.arguments_;\n  },\n};\n\n// [lyn, 01/15/2013] Edited to remove STACK (no longer necessary with\n// DO-THEN-RETURN)\ncore_browser.Blocks['procedures_defreturn'] = {\n  // Define a procedure with a return value.\n  category: 'Procedures', // Procedures are handled specially.\n  // helpUrl: Blockly.Msg.LANG_PROCEDURES_DEFRETURN_HELPURL,\n  helpUrl: core_browser.Msg['PROCEDURES_DEFRETURN_HELPURL'],\n  bodyInputName: 'RETURN',\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.PROCEDURE_CATEGORY_HUE);\n    this.setStyle('procedure_blocks');\n    // const name = Blockly.Procedures.findLegalName(\n    //     Blockly.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE, this);\n    // this.appendDummyInput('HEADER')\n    //     .appendField(Blockly.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE)\n    //     .appendField(new FieldProcedureName(name), 'NAME');\n    const legalName = core_browser.Procedures.findLegalName(\n        core_browser.Msg['LANG_PROCEDURES_DEFRETURN_PROCEDURE'], this);\n    this.createHeader(legalName);\n    this.horizontalParameters = true; // horizontal by default\n    this.appendInputFromRegistry('indented_input', 'RETURN')\n        .setAlign(core_browser.inputs.Align.RIGHT)\n        .appendField(core_browser.Msg['LANG_PROCEDURES_DEFRETURN_RETURN']);\n    this.setMutator(new core_browser.icons.MutatorIcon(['procedures_mutatorarg'], this));\n    this.setTooltip(core_browser.Msg['LANG_PROCEDURES_DEFRETURN_TOOLTIP']);\n    this.arguments_ = [];\n    this.warnings = [{name: 'checkEmptySockets', sockets: ['RETURN']}];\n  },\n  createHeader: function(procName) {\n    return this.appendDummyInput('HEADER')\n        .appendField(core_browser.Msg['LANG_PROCEDURES_DEFRETURN_DEFINE'])\n        .appendField(new FieldProcedureName(procName), 'NAME');\n  },\n  withLexicalVarsAndPrefix:\n      core_browser.Blocks.procedures_defnoreturn.withLexicalVarsAndPrefix,\n  onchange: core_browser.Blocks.procedures_defnoreturn.onchange,\n  // [lyn, 11/24/12] return list of procedure body (if there is one)\n  updateParams_: core_browser.Blocks.procedures_defnoreturn.updateParams_,\n  parameterFlydown: core_browser.Blocks.procedures_defnoreturn.parameterFlydown,\n  setParameterOrientation:\n      core_browser.Blocks.procedures_defnoreturn.setParameterOrientation,\n  mutationToDom: core_browser.Blocks.procedures_defnoreturn.mutationToDom,\n  domToMutation: core_browser.Blocks.procedures_defnoreturn.domToMutation,\n  decompose: core_browser.Blocks.procedures_defnoreturn.decompose,\n  compose: core_browser.Blocks.procedures_defnoreturn.compose,\n  dispose: core_browser.Blocks.procedures_defnoreturn.dispose,\n  getProcedureDef: core_browser.Blocks.procedures_defnoreturn.getProcedureDef,\n  getVars: core_browser.Blocks.procedures_defnoreturn.getVars,\n  declaredNames: core_browser.Blocks.procedures_defnoreturn.declaredNames,\n  declaredVariables: core_browser.Blocks.procedures_defnoreturn.declaredVariables,\n  renameVar: core_browser.Blocks.procedures_defnoreturn.renameVar,\n  renameVars: core_browser.Blocks.procedures_defnoreturn.renameVars,\n  renameBound: core_browser.Blocks.procedures_defnoreturn.renameBound,\n  renameFree: core_browser.Blocks.procedures_defnoreturn.renameFree,\n  freeVariables: core_browser.Blocks.procedures_defnoreturn.freeVariables,\n  blocksInScope: core_browser.Blocks.procedures_defnoreturn.blocksInScope,\n  customContextMenu: core_browser.Blocks.procedures_defnoreturn.customContextMenu,\n  getParameters: core_browser.Blocks.procedures_defnoreturn.getParameters,\n};\n\ncore_browser.Blocks['procedures_mutatorcontainer'] = {\n  // Procedure container (for mutator dialog).\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.PROCEDURE_CATEGORY_HUE);\n    this.setStyle('procedure_blocks');\n    this.appendDummyInput()\n        .appendField(core_browser.Msg['LANG_PROCEDURES_MUTATORCONTAINER_TITLE']);\n    this.appendStatementInput('STACK');\n    this.setTooltip(core_browser.Msg['LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP']);\n    this.contextMenu = false;\n    this.mustNotRenameCapturables = true;\n  },\n  // [lyn. 11/24/12] Set procBlock associated with this container.\n  setProcBlock: function(procBlock) {\n    this.procBlock_ = procBlock;\n  },\n  // [lyn. 11/24/12] Set procBlock associated with this container.\n  // Invariant: should not be null, since only created as mutator for a\n  // particular proc block.\n  getProcBlock: function() {\n    return this.procBlock_;\n  },\n  // [lyn. 11/24/12] Return list of param names in this container\n  // Invariant: there should be no duplicates!\n  declaredNames: function() {\n    const paramNames = [];\n    let paramBlock = this.getInputTargetBlock('STACK');\n    while (paramBlock) {\n      paramNames.push(paramBlock.getFieldValue('NAME'));\n      paramBlock = paramBlock.nextConnection &&\n          paramBlock.nextConnection.targetBlock();\n    }\n    return paramNames;\n  },\n};\n\ncore_browser.Blocks['procedures_mutatorarg'] = {\n  // Procedure argument (for mutator dialog).\n  init: function() {\n    //    var mutatorarg = this;\n    //    var mutatorargChangeHandler = function(newName) {\n    //      var proc = mutatorarg.getProcBlock();\n    //      var procArguments = proc ? proc.arguments_ : [];\n    //      console.log(\"mutatorargChangeHandler: newName = \" + newName\n    //                  + \" and proc argumnets = [\" + procArguments.join(',') +\n    // \"]\"); return Blockly.LexicalVariable.renameParam.call(this,newName); }\n    // Let the theme determine the color.\n    // this.setColour(Blockly.PROCEDURE_CATEGORY_HUE);\n    this.setStyle('procedure_blocks');\n    const editor = new core_browser.FieldTextInput('x',\n        LexicalVariable.renameParam);\n    // 2017 Blockly's text input change breaks our renaming behavior.\n    // The following is a version we've defined.\n    editor.onHtmlInputChange_ = function(e) {\n      const oldValue = this.getValue();\n      FieldFlydown.prototype.onHtmlInputChange_.call(this, e);\n      const newValue = this.getValue();\n      if (newValue && oldValue !== newValue && core_browser.Events.isEnabled()) {\n        core_browser.Events.fire(\n            new core_browser.Events.BlockChange(this.sourceBlock_, 'field', this.name,\n                oldValue, newValue));\n      }\n    };\n    this.appendDummyInput()\n        .appendField(core_browser.Msg['LANG_PROCEDURES_MUTATORARG_TITLE'])\n        .appendField(editor, 'NAME');\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(core_browser.Msg['LANG_PROCEDURES_MUTATORARG_TOOLTIP']);\n    this.contextMenu = false;\n    this.lexicalVarPrefix = procedureParameterPrefix;\n    this.mustNotRenameCapturables = true;\n  },\n  // [lyn, 11/24/12] Return the container this mutator arg is in, or null if\n  // it's not in one. Dynamically calculate this by walking up chain, because\n  // mutator arg might or might not be in container stack.\n  getContainerBlock: function() {\n    let parent = this.getParent();\n    while (parent && !(parent.type === 'procedures_mutatorcontainer')) {\n      parent = parent.getParent();\n    }\n    // [lyn, 11/24/12] Cache most recent container block so can reference it\n    // upon removal from mutator arg stack\n    this.cachedContainerBlock_ =\n        (parent && (parent.type === 'procedures_mutatorcontainer') && parent) ||\n        null;\n    return this.cachedContainerBlock_;\n  },\n  // [lyn, 11/24/12] Return the procedure associated with mutator arg is in, or\n  // null if there isn't one. Dynamically calculate this by walking up chain,\n  // because mutator arg might or might not be in container stack.\n  getProcBlock: function() {\n    const container = this.getContainerBlock();\n    return (container && container.getProcBlock()) || null;\n  },\n  // [lyn, 11/24/12] Return the declared names in the procedure associated with\n  // mutator arg, or the empty list if there isn't one. Dynamically calculate\n  // this by walking up chain, because mutator arg might or might not be in\n  // container stack.\n  declaredNames: function() {\n    const container = this.getContainerBlock();\n    return (container && container.declaredNames()) || [];\n  },\n  // [lyn, 11/24/12] Return the blocks in scope of proc params in the the\n  // procedure associated with mutator arg, or the empty list if there isn't\n  // one. Dynamically calculate this by walking up chain, because mutator arg\n  // might or might not be in container stack.\n  blocksInScope: function() {\n    const proc = this.getProcBlock();\n    return (proc && proc.blocksInScope()) || [];\n  },\n  // [lyn, 11/24/12] Check for situation in which mutator arg has been removed\n  // from stack, and change all references to its name to ???.\n  onchange: function() {\n    const paramName = this.getFieldValue('NAME');\n    if (paramName) { // paramName is null when delete from stack\n      // console.log(\"Mutatorarg onchange: \" + paramName);\n      const cachedContainer = this.cachedContainerBlock_;\n      const container = this.getContainerBlock(); // Order is important; this\n      // must come after\n      // cachedContainer\n      // since it sets cachedContainerBlock_\n      // console.log(\"Mutatorarg onchange: \" + paramName\n      //            + \"; cachedContainer = \" + JSON.stringify((cachedContainer\n      // && cachedContainer.type) || null) + \"; container = \" +\n      // JSON.stringify((container && container.type) || null));\n      if ((!cachedContainer) && container) {\n        // Event: added mutator arg to container stack\n        // console.log(\"Mutatorarg onchange ADDED: \" + paramName);\n        const declaredNames = this.declaredNames();\n        const firstIndex = declaredNames.indexOf(paramName);\n        if (firstIndex != -1) {\n          // Assertion: we should get here, since paramName should be among\n          // names\n          const secondIndex = declaredNames.indexOf(paramName, firstIndex + 1);\n          if (secondIndex != -1) {\n            // If we get here, there is a duplicate on insertion that must be\n            // resolved\n            const newName = FieldLexicalVariable.nameNotIn(paramName,\n                declaredNames);\n            this.setFieldValue(newName, 'NAME');\n          }\n        }\n      }\n    }\n  },\n};\n\ncore_browser.Blocks.procedures_mutatorarg.validator = function(newVar) {\n  // Merge runs of whitespace.  Strip leading and trailing whitespace.\n  // Beyond this, all names are legal.\n  newVar = newVar.replace(/[\\s\\xa0]+/g, ' ').replace(/^ | $/g, '');\n  return newVar || null;\n};\n\ncore_browser.Blocks['procedures_callnoreturn'] = {\n  // Call a procedure with no return value.\n  category: 'Procedures', // Procedures are handled specially.\n  helpUrl: core_browser.Msg['LANG_PROCEDURES_CALLNORETURN_HELPURL'],\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.PROCEDURE_CATEGORY_HUE);\n    this.setStyle('procedure_blocks');\n    const procDb = this.workspace.getTopWorkspace().getProcedureDatabase();\n    this.procNamesFxn = function() {\n      const items = procDb.getMenuItems(false);\n      return items.length > 0 ? items : ['', ''];\n    };\n\n    this.procDropDown = new FieldNoCheckDropdown(this.procNamesFxn,\n        onChange);\n    this.procDropDown.block = this;\n    this.appendDummyInput()\n        .appendField(core_browser.Msg['LANG_PROCEDURES_CALLNORETURN_CALL'])\n        .appendField(this.procDropDown, 'PROCNAME');\n    this.setPreviousStatement(true);\n    this.setNextStatement(true);\n    this.setTooltip(core_browser.Msg['LANG_PROCEDURES_CALLNORETURN_TOOLTIP']);\n    this.arguments_ = [];\n    this.quarkConnections_ = null;\n    this.quarkArguments_ = null;\n    this.errors = [\n      {func: ErrorCheckers.checkIsInDefinition},\n      {\n        func: ErrorCheckers.checkDropDownContainsValidValue,\n        dropDowns: ['PROCNAME'],\n      },\n    ];\n    this.setOnChange(function(changeEvent) {\n      this.workspace.getWarningHandler().checkErrors(this);\n    });\n    // Blockly.FieldProcedure.onChange.call(this.getField(\"PROCNAME\"),\n    //     this.procNamesFxn(false)[0][0]);\n    onChange.call(this.getField('PROCNAME'),\n        this.getField('PROCNAME').getValue());\n  },\n  getProcedureCall: function() {\n    return this.getFieldValue('PROCNAME');\n  },\n  renameProcedure: function(oldName, newName) {\n    if (!oldName ||\n        core_browser.Names.equals(oldName, this.getFieldValue('PROCNAME'))) {\n      const nameField = this.getField('PROCNAME');\n      // Force the options menu to get regenerated since we might be getting\n      // called because our defining procedure got renamed and\n      // this.setFieldValue() will fail if it's value isn't in the options set\n      nameField.getOptions();\n      this.setFieldValue(newName, 'PROCNAME');\n    }\n  },\n  // [lyn, 10/27/13] Renamed \"fromChange\" parameter to \"startTracking\", because\n  // it should be true in any situation where we want caller to start tracking\n  // connections associated with paramIds. This includes when a mutator is\n  // opened on a procedure declaration.\n  setProcedureParameters: function(paramNames, paramIds, startTracking) {\n    // Data structures for parameters on each call block:\n    // this.arguments = ['x', 'y']\n    //     Existing param names.\n    // paramNames = ['x', 'y', 'z']\n    //     New param names.\n    // paramIds = ['piua', 'f8b_', 'oi.o']\n    //     IDs of params (consistent for each parameter through the life of a\n    //     mutator, regardless of param renaming).\n    // this.quarkConnections_ {piua: null, f8b_: Blockly.Connection}\n    //     Look-up of paramIds to connections plugged into the call block.\n    // this.quarkArguments_ = ['piua', 'f8b_']\n    //     Existing param IDs.\n    // Note that quarkConnections_ may include IDs that no longer exist, but\n    // which might reappear if a param is reattached in the mutator.\n\n    let input;\n    let connection;\n    let x;\n\n    // fixed parameter alignment see ticket 465\n    if (!paramIds) {\n      // Reset the quarks (a mutator is about to open).\n      this.quarkConnections_ = {};\n      this.quarkArguments_ = null;\n      // return;  // [lyn, 10/27/13] No, don't return yet. We still want to add\n      // paramNames to block! For now, create dummy list of param ids. This\n      // needs to be cleaned up further!\n      paramIds = [].concat(paramNames); // create a dummy list that's a copy of\n      // paramNames.\n    }\n    if (paramIds.length != paramNames.length) {\n      throw Error('Error: paramNames and paramIds must be the same length.');\n    }\n    const paramIdToParamName = {};\n    for (let i = 0; i < paramNames.length; i++) {\n      paramIdToParamName[paramIds[i]] = paramNames[i];\n    }\n    if (typeof startTracking == 'undefined') {\n      startTracking = null;\n    }\n\n    if (!this.quarkArguments_ || startTracking) {\n      // Initialize tracking for this block.\n      this.quarkConnections_ = {};\n      if (LexicalVariable.stringListsEqual(paramNames,\n          this.arguments_) || startTracking) {\n        // No change to the parameters, allow quarkConnections_ to be\n        // populated with the existing connections.\n        this.quarkArguments_ = paramIds;\n      } else {\n        this.quarkArguments_ = [];\n      }\n    }\n    // Switch off rendering while the block is rebuilt.\n    const savedRendered = this.rendered;\n    this.rendered = false;\n    // Update the quarkConnections_ with existing connections.\n    for (x = 0; this.getInput('ARG' + x); x++) {\n      input = this.getInput('ARG' + x);\n      if (input) {\n        connection = input.connection.targetConnection;\n        this.quarkConnections_[this.quarkArguments_[x]] = connection;\n        // Disconnect all argument blocks and remove all inputs.\n        this.removeInput('ARG' + x);\n      }\n    }\n    // Rebuild the block's arguments.\n    this.arguments_ = [].concat(paramNames);\n    this.quarkArguments_ = paramIds;\n    for (x = 0; x < this.arguments_.length; x++) {\n      input = this.appendValueInput('ARG' + x)\n          .setAlign(core_browser.inputs.Align.RIGHT)\n          .appendField(this.arguments_[x]);\n      if (this.quarkArguments_) {\n        // Reconnect any child blocks.\n        const quarkName = this.quarkArguments_[x];\n        if (quarkName in this.quarkConnections_) {\n          connection = this.quarkConnections_[quarkName];\n          if (!connection || connection.targetConnection ||\n              connection.sourceBlock_.workspace != this.workspace) {\n            // Block no longer exists or has been attached elsewhere.\n            delete this.quarkConnections_[quarkName];\n          } else {\n            input.connection.connect(connection);\n          }\n        } else if (paramIdToParamName[quarkName]) {\n          connection = this.quarkConnections_[paramIdToParamName[quarkName]];\n          if (connection) {\n            input.connection.connect(connection);\n          }\n        }\n      }\n    }\n    // Restore rendering and show the changes.\n    this.rendered = savedRendered;\n    if (!this.workspace.rendered) {\n      // workspace hasn't been rendered yet, so other connections may\n      // not yet exist.\n      return;\n    }\n    // Initialize the new inputs.\n    for (x = 0; x < this.arguments_.length; x++) {\n      this.getInput('ARG' + x).init();\n    }\n    if (this.rendered) {\n      this.render();\n    }\n  },\n  mutationToDom: function() {\n    // Save the name and arguments (none of which are editable).\n    const container = core_browser.utils.xml.createElement('mutation');\n    container.setAttribute('name', this.getFieldValue('PROCNAME'));\n    for (let x = 0; this.getInput('ARG' + x); x++) {\n      const parameter = core_browser.utils.xml.createElement('arg');\n      parameter.setAttribute('name',\n          this.getInput('ARG' + x).fieldRow[0].getText());\n      container.appendChild(parameter);\n    }\n    return container;\n  },\n  domToMutation: function(xmlElement) {\n    // Restore the name and parameters.\n    const name = xmlElement.getAttribute('name');\n    this.setFieldValue(name, 'PROCNAME');\n    // [lyn, 10/27/13] Significantly cleaned up this code. Always take arg\n    // names from xmlElement. Do not attempt to find definition.\n    this.arguments_ = [];\n    const children = getChildren(xmlElement);\n    for (let x = 0, childNode; childNode = children[x]; x++) {\n      if (childNode.nodeName.toLowerCase() == 'arg') {\n        this.arguments_.push(childNode.getAttribute('name'));\n      }\n    }\n    this.setProcedureParameters(this.arguments_, null, true);\n    // [lyn, 10/27/13] Above. set tracking to true in case this is a block with\n    // argument subblocks. and there's an open mutator.\n  },\n  renameVar: function(oldName, newName) {\n    for (let x = 0; x < this.arguments_.length; x++) {\n      if (core_browser.Names.equals(oldName, this.arguments_[x])) {\n        this.arguments_[x] = newName;\n        this.getInput('ARG' + x).fieldRow[0].setValue(newName);\n      }\n    }\n  },\n  procCustomContextMenu: function(options) {\n    // Add option to find caller.\n    const option = {enabled: true};\n    option.text = core_browser.Msg['LANG_PROCEDURES_HIGHLIGHT_DEF'];\n    const name = this.getFieldValue('PROCNAME');\n    const workspace = this.workspace;\n    option.callback = function() {\n      const def = core_browser.Procedures.getDefinition(name, workspace);\n      if (def) {\n        def.select();\n        workspace.centerOnBlock(def.id);\n        workspace.getParentSvg().parentElement.focus();\n      }\n    };\n    options.push(option);\n  },\n  removeProcedureValue: function() {\n    // Detach inputs before resetting name so that undo/redo operations happen\n    // in the right order\n    for (let i = 0; this.getInput('ARG' + i) !== null; i++) {\n      this.removeInput('ARG' + i);\n    }\n    this.setFieldValue('none', 'PROCNAME');\n  },\n};\n\n\ncore_browser.Blocks['procedures_callreturn'] = {\n  // Call a procedure with a return value.\n  category: 'Procedures', // Procedures are handled specially.\n  helpUrl: core_browser.Msg['LANG_PROCEDURES_CALLRETURN_HELPURL'],\n  init: function() {\n    // Let the theme determine the color.\n    // this.setColour(Blockly.PROCEDURE_CATEGORY_HUE);\n    this.setStyle('procedure_blocks');\n    const procDb = this.workspace.getTopWorkspace().getProcedureDatabase();\n    this.procNamesFxn = function() {\n      const items = procDb.getMenuItems(true);\n      return items.length > 0 ? items : ['', ''];\n    };\n\n    this.procDropDown = new FieldNoCheckDropdown(this.procNamesFxn,\n        onChange);\n    this.procDropDown.block = this;\n    this.appendDummyInput()\n        .appendField(core_browser.Msg['LANG_PROCEDURES_CALLRETURN_CALL'])\n        .appendField(this.procDropDown, 'PROCNAME');\n    this.setOutput(true, null);\n    this.setTooltip(core_browser.Msg['LANG_PROCEDURES_CALLRETURN_TOOLTIP']);\n    this.arguments_ = [];\n    this.quarkConnections_ = null;\n    this.quarkArguments_ = null;\n    this.errors = [\n      {func: ErrorCheckers.checkIsInDefinition},\n      {\n        func: ErrorCheckers.checkDropDownContainsValidValue,\n        dropDowns: ['PROCNAME'],\n      },\n    ];\n    this.setOnChange(function(changeEvent) {\n      this.workspace.getWarningHandler().checkErrors(this);\n    });\n    // Blockly.FieldProcedure.onChange.call(this.getField(\"PROCNAME\"),\n    //     this.procNamesFxn()[0][0]);\n    onChange.call(this.getField('PROCNAME'),\n        this.getField('PROCNAME').getValue());\n  },\n  getProcedureCall: core_browser.Blocks.procedures_callnoreturn.getProcedureCall,\n  renameProcedure: core_browser.Blocks.procedures_callnoreturn.renameProcedure,\n  setProcedureParameters:\n  core_browser.Blocks.procedures_callnoreturn.setProcedureParameters,\n  mutationToDom: core_browser.Blocks.procedures_callnoreturn.mutationToDom,\n  domToMutation: core_browser.Blocks.procedures_callnoreturn.domToMutation,\n  renameVar: core_browser.Blocks.procedures_callnoreturn.renameVar,\n  procCustomContextMenu:\n      core_browser.Blocks.procedures_callnoreturn.procCustomContextMenu,\n  removeProcedureValue:\n      core_browser.Blocks.procedures_callnoreturn.removeProcedureValue,\n};\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/blocks.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2023 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n// TODO: Figure out how to package the blocks separately from the fields\n\n\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/generators/lexical-variables.js\n\n\n\n\n\n\nif (javascript) {\n// We might be loaded into an environment that doesn't have Blockly's JavaScript generator.\n  const {javascriptGenerator} = javascript;\n  javascriptGenerator['lexical_variable_get'] = function (block) {\n    const code = getVariableName(block.getFieldValue('VAR'));\n    return [code, javascriptGenerator.ORDER_ATOMIC];\n  };\n\n  /**\n   * Generate variable name\n   * @param {string} name\n   * @return {string}\n   */\n  function getVariableName(name) {\n    const pair = unprefixName(name);\n    const prefix = pair[0];\n    const unprefixedName = pair[1];\n    if (prefix === core_browser.Msg.LANG_VARIABLES_GLOBAL_PREFIX ||\n        prefix === GLOBAL_KEYWORD) {\n      return unprefixedName;\n    } else {\n      return (possiblyPrefixGeneratedVarName(prefix))(unprefixedName);\n    }\n  }\n\n  /**\n   * Generate basic variable setting code.\n   * @param {Blockly.Block} block\n   * @param {string} varFieldName\n   * @return {string} The code.\n   */\n  function genBasicSetterCode(block, varFieldName) {\n    const argument0 = javascriptGenerator.valueToCode(block, 'VALUE',\n        javascriptGenerator.ORDER_ASSIGNMENT) || '0';\n    const varName = getVariableName(block.getFieldValue(varFieldName));\n    return varName + ' = ' + argument0 + ';\\n';\n  }\n\n  javascriptGenerator['lexical_variable_set'] = function (block) {\n    // Variable setter.\n    return genBasicSetterCode(block, 'VAR');\n  };\n\n  javascriptGenerator['global_declaration'] = function (block) {\n    // Global variable declaration\n    return 'var ' + genBasicSetterCode(block, 'NAME');\n  };\n\n  function generateDeclarations(block) {\n    let code = '{\\n  let ';\n    for (let i = 0; block.getFieldValue('VAR' + i); i++) {\n      code += (usePrefixInCode ? 'local_' : '') +\n          block.getFieldValue('VAR' + i);\n      code += ' = ' + (javascriptGenerator.valueToCode(block,\n          'DECL' + i, javascriptGenerator.ORDER_NONE) || '0');\n      code += ', ';\n    }\n    // Get rid of the last comma\n    code = code.slice(0, -2);\n    code += ';\\n';\n    return code;\n  }\n\n  javascriptGenerator['local_declaration_statement'] = function () {\n    let code = generateDeclarations(this);\n    code += javascriptGenerator.statementToCode(this, 'STACK',\n        javascriptGenerator.ORDER_NONE);\n    code += '}\\n';\n    return code;\n  };\n\n  javascriptGenerator['local_declaration_expression'] = function () {\n    // TODO: This can probably be redone to use the variables as parameters to the generated function\n    // and then call the function with the generated variable values.\n    let code = '(function() {\\n'\n    code += generateDeclarations(this);\n    code += 'return ' + (javascriptGenerator.valueToCode(this,\n        'RETURN', javascriptGenerator.ORDER_NONE) || 'null');\n    code += '}})()\\n';\n    return [code, javascriptGenerator.ORDER_NONE];\n  };\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/generators/controls.js\n\n\n\n\n\nif (javascript) {\n// We might be loaded into an environment that doesn't have Blockly's JavaScript generator.\n  const {javascriptGenerator} = javascript;\n  /**\n   * This code is copied from Blockly but the 'var' keyword is replaced by 'let'\n   * in the generated code.\n   * @param {Blockly.Block} block The block to generate code for.\n   * @return {string} The generated code.\n   */\n  javascriptGenerator['controls_for'] = function (block) {\n    // For loop.\n    const variable0 = javascriptGenerator.nameDB_.getName(\n        block.getFieldValue('VAR'), core_browser.VARIABLE_CATEGORY_NAME);\n    const argument0 = javascriptGenerator.valueToCode(block, 'START',\n        javascriptGenerator.ORDER_ASSIGNMENT) || '0';\n    const argument1 = javascriptGenerator.valueToCode(block, 'END',\n        javascriptGenerator.ORDER_ASSIGNMENT) || '0';\n    const increment = javascriptGenerator.valueToCode(block, 'STEP',\n        javascriptGenerator.ORDER_ASSIGNMENT) || '1';\n    let branch = javascriptGenerator.statementToCode(block, 'DO');\n    branch = javascriptGenerator.addLoopTrap(branch, block);\n    let code;\n    if (core_browser.utils.string.isNumber(argument0) && core_browser.utils.string.isNumber(argument1) &&\n        core_browser.utils.string.isNumber(increment)) {\n      // All arguments are simple numbers.\n      const up = Number(argument0) <= Number(argument1);\n      code = 'for (let ' + variable0 + ' = ' + argument0 + '; ' +\n          variable0 + (up ? ' <= ' : ' >= ') + argument1 + '; ' +\n          variable0;\n      const step = Math.abs(Number(increment));\n      if (step == 1) {\n        code += up ? '++' : '--';\n      } else {\n        code += (up ? ' += ' : ' -= ') + step;\n      }\n      code += ') {\\n' + branch + '}\\n';\n    } else {\n      code = '';\n      // Cache non-trivial values to variables to prevent repeated look-ups.\n      let startVar = argument0;\n      if (!argument0.match(/^\\w+$/) && !core_browser.utils.string.isNumber(argument0)) {\n        startVar = javascriptGenerator.nameDB_.getDistinctName(\n            variable0 + '_start', core_browser.VARIABLE_CATEGORY_NAME);\n        code += 'let ' + startVar + ' = ' + argument0 + ';\\n';\n      }\n      let endVar = argument1;\n      if (!argument1.match(/^\\w+$/) && !core_browser.utils.string.isNumber(argument1)) {\n        endVar = javascriptGenerator.nameDB_.getDistinctName(\n            variable0 + '_end', core_browser.VARIABLE_CATEGORY_NAME);\n        code += 'let ' + endVar + ' = ' + argument1 + ';\\n';\n      }\n      // Determine loop direction at start, in case one of the bounds\n      // changes during loop execution.\n      const incVar = javascriptGenerator.nameDB_.getDistinctName(\n          variable0 + '_inc', core_browser.VARIABLE_CATEGORY_NAME);\n      code += 'let ' + incVar + ' = ';\n      if (core_browser.utils.string.isNumber(increment)) {\n        code += Math.abs(increment) + ';\\n';\n      } else {\n        code += 'Math.abs(' + increment + ');\\n';\n      }\n      code += 'if (' + startVar + ' > ' + endVar + ') {\\n';\n      code += javascriptGenerator.INDENT + incVar + ' = -' + incVar + ';\\n';\n      code += '}\\n';\n      code += 'for (' + variable0 + ' = ' + startVar + '; ' +\n          incVar + ' >= 0 ? ' +\n          variable0 + ' <= ' + endVar + ' : ' +\n          variable0 + ' >= ' + endVar + '; ' +\n          variable0 + ' += ' + incVar + ') {\\n' +\n          branch + '}\\n';\n    }\n    return code;\n  };\n// controls_forRange and controls_for are aliases.  This is to make the\n// controls_statement_flow block work correctly for controls_forRange.\n  javascriptGenerator['controls_forRange'] = javascriptGenerator['controls_for'];\n\n  /**\n   * This code is copied from Blockly but the 'var' keyword is replaced by 'let'\n   * or 'const' (as appropriate) in the generated code.\n   * @param {Blockly.Block} block The block to generate code for.\n   * @return {string} The generated code.\n   */\n  javascriptGenerator['controls_forEach'] = function (block) {\n    // For each loop.\n    const variable0 = javascriptGenerator.nameDB_.getName(\n        block.getFieldValue('VAR'), core_browser.VARIABLE_CATEGORY_NAME);\n    const argument0 = javascriptGenerator.valueToCode(block, 'LIST',\n        javascriptGenerator.ORDER_ASSIGNMENT) || '[]';\n    let branch = javascriptGenerator.statementToCode(block, 'DO');\n    branch = javascriptGenerator.addLoopTrap(branch, block);\n    let code = '';\n    // Cache non-trivial values to variables to prevent repeated look-ups.\n    let listVar = argument0;\n    if (!argument0.match(/^\\w+$/)) {\n      listVar = javascriptGenerator.nameDB_.getDistinctName(\n          variable0 + '_list', core_browser.VARIABLE_CATEGORY_NAME);\n      code += 'const ' + listVar + ' = ' + argument0 + ';\\n';\n    }\n    const indexVar = javascriptGenerator.nameDB_.getDistinctName(\n        variable0 + '_index', core_browser.VARIABLE_CATEGORY_NAME);\n    branch = javascriptGenerator.INDENT + 'const ' + variable0 + ' = ' +\n        listVar + '[' + indexVar + '];\\n' + branch;\n    code += 'for (let ' + indexVar + ' in ' + listVar + ') {\\n' + branch + '}\\n';\n    return code;\n  };\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/generators/procedures.js\n\n\n\n\n\nif (javascript) {\n// We might be loaded into an environment that doesn't have Blockly's JavaScript generator.\n  const {javascriptGenerator} = javascript;\n  /**\n   * This code is copied from Blockly but the 'NAME' field is changed to\n   * 'PROCNAME'.\n   * @param {Blockly.Block} block The block to generate code for.\n   * @return {string} The generated code.\n   */\n  javascriptGenerator['procedures_callreturn'] = function (block) {\n    // Call a procedure with a return value.\n    const funcName = javascriptGenerator.nameDB_.getName(\n        block.getFieldValue('PROCNAME'), core_browser.PROCEDURE_CATEGORY_NAME);\n    const args = [];\n    const variables = block.arguments_;\n    for (let i = 0; i < variables.length; i++) {\n      args[i] = javascriptGenerator.valueToCode(block, 'ARG' + i,\n          javascriptGenerator.ORDER_NONE) || 'null';\n    }\n    const code = funcName + '(' + args.join(', ') + ')';\n    return [code, javascriptGenerator.ORDER_FUNCTION_CALL];\n  };\n}\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/generators.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2023 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./node_modules/@mit-app-inventor/blockly-block-lexical-variables/src/index.js\n// -*- mode: java; c-basic-offset: 2; -*-\n// Copyright 2023 MIT, All rights reserved\n// Released under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./src/index.js\n/**\n * @license\n *\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Example of including Blockly with using Webpack with\n *               defaults: (English lang & JavaScript generator).\n * @author samelh@google.com (Sam El-Husseini)\n */\n\n\n\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    const workspace = blockly.inject('blocklyDiv',\n        {\n            toolbox: document.getElementById('toolbox'),\n            media: 'media/'\n        });\n\n    // Load lexical variable plugin\n    LexicalVariablesPlugin.init(workspace);\n\n    const button = document.getElementById('blocklyButton');\n    button.addEventListener('click', function () {\n        alert(\"Check the console for the generated output.\");\n        const code = javascript.javascriptGenerator.workspaceToCode(workspace);\n        console.log(code);\n    })\n});\n\n\n//# sourceURL=webpack://blockly-webpack-sample/./src/index.js_+_30_modules?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.js");
/******/ 	
/******/ })()
;